var t=Object.defineProperty,e=Object.defineProperties,n=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=Math.pow,l=(e,n,i)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i,a=(t,e)=>{for(var n in e||(e={}))o.call(e,n)&&l(t,n,e[n]);if(i)for(var n of i(e))r.call(e,n)&&l(t,n,e[n]);return t},h=(t,i)=>e(t,n(i)),c=(t,e)=>{var n={};for(var s in t)o.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(null!=t&&i)for(var s of i(t))e.indexOf(s)<0&&r.call(t,s)&&(n[s]=t[s]);return n};import{Q as u,r as d,n as g,V as f,W as m,X as p,j as w,P as v,R as y,C as b,B as C}from"./index-2a561653.js";var S=function(t){return t&&t.Math===Math&&t},R=S("object"==typeof globalThis&&globalThis)||S("object"==typeof window&&window)||S("object"==typeof self&&self)||S("object"==typeof u&&u)||S("object"==typeof u&&u)||function(){return this}()||Function("return this")(),E={},T=function(t){try{return!!t()}catch(e){return!0}},M=!T((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),x=!T((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),H=x,k=Function.prototype.call,I=H?k.bind(k):function(){return k.apply(k,arguments)},O={},A={}.propertyIsEnumerable,_=Object.getOwnPropertyDescriptor,P=_&&!A.call({1:2},1);O.f=P?function(t){var e=_(this,t);return!!e&&e.enumerable}:A;var N,D,L=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},V=x,F=Function.prototype,W=F.call,j=V&&F.bind.bind(W,W),B=V?j:function(t){return function(){return W.apply(t,arguments)}},z=B,U=z({}.toString),Y=z("".slice),$=function(t){return Y(U(t),8,-1)},G=T,K=$,X=Object,q=B("".split),Z=G((function(){return!X("z").propertyIsEnumerable(0)}))?function(t){return"String"===K(t)?q(t,""):X(t)}:X,Q=function(t){return null==t},J=Q,tt=TypeError,et=function(t){if(J(t))throw new tt("Can't call method on "+t);return t},nt=Z,it=et,ot=function(t){return nt(it(t))},rt="object"==typeof document&&document.all,st=void 0===rt&&void 0!==rt?function(t){return"function"==typeof t||t===rt}:function(t){return"function"==typeof t},lt=st,at=function(t){return"object"==typeof t?null!==t:lt(t)},ht=R,ct=st,ut=function(t,e){return arguments.length<2?(n=ht[t],ct(n)?n:void 0):ht[t]&&ht[t][e];var n},dt=B({}.isPrototypeOf),gt=R.navigator,ft=gt&&gt.userAgent,mt=ft?String(ft):"",pt=R,wt=mt,vt=pt.process,yt=pt.Deno,bt=vt&&vt.versions||yt&&yt.version,Ct=bt&&bt.v8;Ct&&(D=(N=Ct.split("."))[0]>0&&N[0]<4?1:+(N[0]+N[1])),!D&&wt&&(!(N=wt.match(/Edge\/(\d+)/))||N[1]>=74)&&(N=wt.match(/Chrome\/(\d+)/))&&(D=+N[1]);var St=D,Rt=T,Et=R.String,Tt=!!Object.getOwnPropertySymbols&&!Rt((function(){var t=Symbol("symbol detection");return!Et(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&St&&St<41})),Mt=Tt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,xt=ut,Ht=st,kt=dt,It=Object,Ot=Mt?function(t){return"symbol"==typeof t}:function(t){var e=xt("Symbol");return Ht(e)&&kt(e.prototype,It(t))},At=String,_t=function(t){try{return At(t)}catch(e){return"Object"}},Pt=st,Nt=_t,Dt=TypeError,Lt=function(t){if(Pt(t))return t;throw new Dt(Nt(t)+" is not a function")},Vt=Lt,Ft=Q,Wt=function(t,e){var n=t[e];return Ft(n)?void 0:Vt(n)},jt=I,Bt=st,zt=at,Ut=TypeError,Yt={exports:{}},$t=R,Gt=Object.defineProperty,Kt=function(t,e){try{Gt($t,t,{value:e,configurable:!0,writable:!0})}catch(n){$t[t]=e}return e},Xt=R,qt=Kt,Zt="__core-js_shared__",Qt=Yt.exports=Xt[Zt]||qt(Zt,{});(Qt.versions||(Qt.versions=[])).push({version:"3.39.0",mode:"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Jt=Yt.exports,te=Jt,ee=function(t,e){return te[t]||(te[t]=e||{})},ne=et,ie=Object,oe=function(t){return ie(ne(t))},re=oe,se=B({}.hasOwnProperty),le=Object.hasOwn||function(t,e){return se(re(t),e)},ae=B,he=0,ce=Math.random(),ue=ae(1..toString),de=function(t){return"Symbol("+(void 0===t?"":t)+")_"+ue(++he+ce,36)},ge=ee,fe=le,me=de,pe=Tt,we=Mt,ve=R.Symbol,ye=ge("wks"),be=we?ve.for||ve:ve&&ve.withoutSetter||me,Ce=function(t){return fe(ye,t)||(ye[t]=pe&&fe(ve,t)?ve[t]:be("Symbol."+t)),ye[t]},Se=I,Re=at,Ee=Ot,Te=Wt,Me=function(t,e){var n,i;if("string"===e&&Bt(n=t.toString)&&!zt(i=jt(n,t)))return i;if(Bt(n=t.valueOf)&&!zt(i=jt(n,t)))return i;if("string"!==e&&Bt(n=t.toString)&&!zt(i=jt(n,t)))return i;throw new Ut("Can't convert object to primitive value")},xe=TypeError,He=Ce("toPrimitive"),ke=function(t,e){if(!Re(t)||Ee(t))return t;var n,i=Te(t,He);if(i){if(void 0===e&&(e="default"),n=Se(i,t,e),!Re(n)||Ee(n))return n;throw new xe("Can't convert object to primitive value")}return void 0===e&&(e="number"),Me(t,e)},Ie=Ot,Oe=function(t){var e=ke(t,"string");return Ie(e)?e:e+""},Ae=at,_e=R.document,Pe=Ae(_e)&&Ae(_e.createElement),Ne=function(t){return Pe?_e.createElement(t):{}},De=Ne,Le=!M&&!T((function(){return 7!==Object.defineProperty(De("div"),"a",{get:function(){return 7}}).a})),Ve=M,Fe=I,We=O,je=L,Be=ot,ze=Oe,Ue=le,Ye=Le,$e=Object.getOwnPropertyDescriptor;E.f=Ve?$e:function(t,e){if(t=Be(t),e=ze(e),Ye)try{return $e(t,e)}catch(n){}if(Ue(t,e))return je(!Fe(We.f,t,e),t[e])};var Ge={},Ke=M&&T((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Xe=at,qe=String,Ze=TypeError,Qe=function(t){if(Xe(t))return t;throw new Ze(qe(t)+" is not an object")},Je=M,tn=Le,en=Ke,nn=Qe,on=Oe,rn=TypeError,sn=Object.defineProperty,ln=Object.getOwnPropertyDescriptor,an="enumerable",hn="configurable",cn="writable";Ge.f=Je?en?function(t,e,n){if(nn(t),e=on(e),nn(n),"function"==typeof t&&"prototype"===e&&"value"in n&&cn in n&&!n[cn]){var i=ln(t,e);i&&i[cn]&&(t[e]=n.value,n={configurable:hn in n?n[hn]:i[hn],enumerable:an in n?n[an]:i[an],writable:!1})}return sn(t,e,n)}:sn:function(t,e,n){if(nn(t),e=on(e),nn(n),tn)try{return sn(t,e,n)}catch(i){}if("get"in n||"set"in n)throw new rn("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var un=Ge,dn=L,gn=M?function(t,e,n){return un.f(t,e,dn(1,n))}:function(t,e,n){return t[e]=n,t},fn={exports:{}},mn=M,pn=le,wn=Function.prototype,vn=mn&&Object.getOwnPropertyDescriptor,yn=pn(wn,"name"),bn={EXISTS:yn,PROPER:yn&&"something"===function(){}.name,CONFIGURABLE:yn&&(!mn||mn&&vn(wn,"name").configurable)},Cn=st,Sn=Jt,Rn=B(Function.toString);Cn(Sn.inspectSource)||(Sn.inspectSource=function(t){return Rn(t)});var En,Tn,Mn,xn=Sn.inspectSource,Hn=st,kn=R.WeakMap,In=Hn(kn)&&/native code/.test(String(kn)),On=de,An=ee("keys"),_n=function(t){return An[t]||(An[t]=On(t))},Pn={},Nn=In,Dn=R,Ln=at,Vn=gn,Fn=le,Wn=Jt,jn=_n,Bn=Pn,zn="Object already initialized",Un=Dn.TypeError,Yn=Dn.WeakMap;if(Nn||Wn.state){var $n=Wn.state||(Wn.state=new Yn);$n.get=$n.get,$n.has=$n.has,$n.set=$n.set,En=function(t,e){if($n.has(t))throw new Un(zn);return e.facade=t,$n.set(t,e),e},Tn=function(t){return $n.get(t)||{}},Mn=function(t){return $n.has(t)}}else{var Gn=jn("state");Bn[Gn]=!0,En=function(t,e){if(Fn(t,Gn))throw new Un(zn);return e.facade=t,Vn(t,Gn,e),e},Tn=function(t){return Fn(t,Gn)?t[Gn]:{}},Mn=function(t){return Fn(t,Gn)}}var Kn={set:En,get:Tn,has:Mn,enforce:function(t){return Mn(t)?Tn(t):En(t,{})},getterFor:function(t){return function(e){var n;if(!Ln(e)||(n=Tn(e)).type!==t)throw new Un("Incompatible receiver, "+t+" required");return n}}},Xn=B,qn=T,Zn=st,Qn=le,Jn=M,ti=bn.CONFIGURABLE,ei=xn,ni=Kn.enforce,ii=Kn.get,oi=String,ri=Object.defineProperty,si=Xn("".slice),li=Xn("".replace),ai=Xn([].join),hi=Jn&&!qn((function(){return 8!==ri((function(){}),"length",{value:8}).length})),ci=String(String).split("String"),ui=fn.exports=function(t,e,n){"Symbol("===si(oi(e),0,7)&&(e="["+li(oi(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Qn(t,"name")||ti&&t.name!==e)&&(Jn?ri(t,"name",{value:e,configurable:!0}):t.name=e),hi&&n&&Qn(n,"arity")&&t.length!==n.arity&&ri(t,"length",{value:n.arity});try{n&&Qn(n,"constructor")&&n.constructor?Jn&&ri(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(o){}var i=ni(t);return Qn(i,"source")||(i.source=ai(ci,"string"==typeof e?e:"")),t};Function.prototype.toString=ui((function(){return Zn(this)&&ii(this).source||ei(this)}),"toString");var di=fn.exports,gi=st,fi=Ge,mi=di,pi=Kt,wi=function(t,e,n,i){i||(i={});var o=i.enumerable,r=void 0!==i.name?i.name:e;if(gi(n)&&mi(n,r,i),i.global)o?t[e]=n:pi(e,n);else{try{i.unsafe?t[e]&&(o=!0):delete t[e]}catch(s){}o?t[e]=n:fi.f(t,e,{value:n,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return t},vi={},yi=Math.ceil,bi=Math.floor,Ci=Math.trunc||function(t){var e=+t;return(e>0?bi:yi)(e)},Si=function(t){var e=+t;return e!=e||0===e?0:Ci(e)},Ri=Si,Ei=Math.max,Ti=Math.min,Mi=Si,xi=Math.min,Hi=function(t){var e=Mi(t);return e>0?xi(e,9007199254740991):0},ki=function(t){return Hi(t.length)},Ii=ot,Oi=function(t,e){var n=Ri(t);return n<0?Ei(n+e,0):Ti(n,e)},Ai=ki,_i=function(t){return function(e,n,i){var o=Ii(e),r=Ai(o);if(0===r)return!t&&-1;var s,l=Oi(i,r);if(t&&n!=n){for(;r>l;)if((s=o[l++])!=s)return!0}else for(;r>l;l++)if((t||l in o)&&o[l]===n)return t||l||0;return!t&&-1}},Pi={includes:_i(!0),indexOf:_i(!1)},Ni=le,Di=ot,Li=Pi.indexOf,Vi=Pn,Fi=B([].push),Wi=function(t,e){var n,i=Di(t),o=0,r=[];for(n in i)!Ni(Vi,n)&&Ni(i,n)&&Fi(r,n);for(;e.length>o;)Ni(i,n=e[o++])&&(~Li(r,n)||Fi(r,n));return r},ji=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Bi=Wi,zi=ji.concat("length","prototype");vi.f=Object.getOwnPropertyNames||function(t){return Bi(t,zi)};var Ui={};Ui.f=Object.getOwnPropertySymbols;var Yi=ut,$i=vi,Gi=Ui,Ki=Qe,Xi=B([].concat),qi=Yi("Reflect","ownKeys")||function(t){var e=$i.f(Ki(t)),n=Gi.f;return n?Xi(e,n(t)):e},Zi=le,Qi=qi,Ji=E,to=Ge,eo=function(t,e,n){for(var i=Qi(e),o=to.f,r=Ji.f,s=0;s<i.length;s++){var l=i[s];Zi(t,l)||n&&Zi(n,l)||o(t,l,r(e,l))}},no=T,io=st,oo=/#|\.prototype\./,ro=function(t,e){var n=lo[so(t)];return n===ho||n!==ao&&(io(e)?no(e):!!e)},so=ro.normalize=function(t){return String(t).replace(oo,".").toLowerCase()},lo=ro.data={},ao=ro.NATIVE="N",ho=ro.POLYFILL="P",co=ro,uo=R,go=E.f,fo=gn,mo=wi,po=Kt,wo=eo,vo=co,yo=function(t,e){var n,i,o,r,s,l=t.target,a=t.global,h=t.stat;if(n=a?uo:h?uo[l]||po(l,{}):uo[l]&&uo[l].prototype)for(i in e){if(r=e[i],o=t.dontCallGetSet?(s=go(n,i))&&s.value:n[i],!vo(a?i:l+(h?".":"#")+i,t.forced)&&void 0!==o){if(typeof r==typeof o)continue;wo(r,o)}(t.sham||o&&o.sham)&&fo(r,"sham",!0),mo(n,i,r,t)}},bo=x,Co=Function.prototype,So=Co.apply,Ro=Co.call,Eo="object"==typeof Reflect&&Reflect.apply||(bo?Ro.bind(So):function(){return Ro.apply(So,arguments)}),To=B,Mo=Lt,xo=function(t,e,n){try{return To(Mo(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(i){}},Ho=at,ko=function(t){return Ho(t)||null===t},Io=String,Oo=TypeError,Ao=xo,_o=at,Po=et,No=function(t){if(ko(t))return t;throw new Oo("Can't set "+Io(t)+" as a prototype")},Do=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Ao(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch(i){}return function(n,i){return Po(n),No(i),_o(n)?(e?t(n,i):n.__proto__=i,n):n}}():void 0),Lo=Ge.f,Vo=st,Fo=at,Wo=Do,jo={};jo[Ce("toStringTag")]="z";var Bo="[object z]"===String(jo),zo=st,Uo=$,Yo=Ce("toStringTag"),$o=Object,Go="Arguments"===Uo(function(){return arguments}()),Ko=Bo?Uo:function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(n){}}(e=$o(t),Yo))?n:Go?Uo(e):"Object"===(i=Uo(e))&&zo(e.callee)?"Arguments":i},Xo=Ko,qo=String,Zo=function(t){if("Symbol"===Xo(t))throw new TypeError("Cannot convert a Symbol value to a string");return qo(t)},Qo=Zo,Jo=at,tr=gn,er=Error,nr=B("".replace),ir=String(new er("zxcasd").stack),or=/\n\s*at [^:]*:[^\n]*/,rr=or.test(ir),sr=L,lr=!T((function(){var t=new Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",sr(1,7)),7!==t.stack)})),ar=gn,hr=function(t,e){if(rr&&"string"==typeof t&&!er.prepareStackTrace)for(;e--;)t=nr(t,or,"");return t},cr=lr,ur=Error.captureStackTrace,dr=ut,gr=le,fr=gn,mr=dt,pr=Do,wr=eo,vr=function(t,e,n){n in t||Lo(t,n,{configurable:!0,get:function(){return e[n]},set:function(t){e[n]=t}})},yr=function(t,e,n){var i,o;return Wo&&Vo(i=e.constructor)&&i!==n&&Fo(o=i.prototype)&&o!==n.prototype&&Wo(t,o),t},br=function(t,e){return void 0===t?arguments.length<2?"":e:Qo(t)},Cr=function(t,e){Jo(e)&&"cause"in e&&tr(t,"cause",e.cause)},Sr=function(t,e,n,i){cr&&(ur?ur(t,e):ar(t,"stack",hr(n,i)))},Rr=M,Er=yo,Tr=Eo,Mr=function(t,e,n,i){var o="stackTraceLimit",r=i?2:1,s=t.split("."),l=s[s.length-1],a=dr.apply(null,s);if(a){var h=a.prototype;if(gr(h,"cause")&&delete h.cause,!n)return a;var c=dr("Error"),u=e((function(t,e){var n=br(i?e:t,void 0),o=i?new a(t):new a;return void 0!==n&&fr(o,"message",n),Sr(o,u,o.stack,2),this&&mr(h,this)&&yr(o,this,u),arguments.length>r&&Cr(o,arguments[r]),o}));u.prototype=h,"Error"!==l?pr?pr(u,c):wr(u,c,{name:!0}):Rr&&o in a&&(vr(u,a,o),vr(u,a,"prepareStackTrace")),wr(u,a);try{h.name!==l&&fr(h,"name",l),h.constructor=u}catch(d){}return u}},xr="WebAssembly",Hr=R[xr],kr=7!==new Error("e",{cause:7}).cause,Ir=function(t,e){var n={};n[t]=Mr(t,e,kr),Er({global:!0,constructor:!0,arity:1,forced:kr},n)},Or=function(t,e){if(Hr&&Hr[t]){var n={};n[t]=Mr(xr+"."+t,e,kr),Er({target:xr,stat:!0,constructor:!0,arity:1,forced:kr},n)}};Ir("Error",(function(t){return function(e){return Tr(t,this,arguments)}})),Ir("EvalError",(function(t){return function(e){return Tr(t,this,arguments)}})),Ir("RangeError",(function(t){return function(e){return Tr(t,this,arguments)}})),Ir("ReferenceError",(function(t){return function(e){return Tr(t,this,arguments)}})),Ir("SyntaxError",(function(t){return function(e){return Tr(t,this,arguments)}})),Ir("TypeError",(function(t){return function(e){return Tr(t,this,arguments)}})),Ir("URIError",(function(t){return function(e){return Tr(t,this,arguments)}})),Or("CompileError",(function(t){return function(e){return Tr(t,this,arguments)}})),Or("LinkError",(function(t){return function(e){return Tr(t,this,arguments)}})),Or("RuntimeError",(function(t){return function(e){return Tr(t,this,arguments)}}));var Ar=$,_r=Array.isArray||function(t){return"Array"===Ar(t)},Pr=M,Nr=_r,Dr=TypeError,Lr=Object.getOwnPropertyDescriptor,Vr=Pr&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,e){if(Nr(t)&&!Lr(t,"length").writable)throw new Dr("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},Fr=TypeError,Wr=function(t){if(t>9007199254740991)throw Fr("Maximum allowed index exceeded");return t},jr=oe,Br=ki,zr=Vr,Ur=Wr;yo({target:"Array",proto:!0,arity:1,forced:T((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}()},{push:function(t){var e=jr(this),n=Br(e),i=arguments.length;Ur(n+i);for(var o=0;o<i;o++)e[n]=arguments[o],n++;return zr(e,n),n}});var Yr=B,$r=Set.prototype,Gr={Set:Set,add:Yr($r.add),has:Yr($r.has),remove:Yr($r.delete),proto:$r},Kr=Gr.has,Xr=function(t){return Kr(t),t},qr=I,Zr=function(t,e,n){for(var i,o,r=n?t:t.iterator,s=t.next;!(i=qr(s,r)).done;)if(void 0!==(o=e(i.value)))return o},Qr=B,Jr=Zr,ts=Gr.Set,es=Gr.proto,ns=Qr(es.forEach),is=Qr(es.keys),os=is(new ts).next,rs=function(t,e,n){return n?Jr({iterator:is(t),next:os},e):ns(t,e)},ss=rs,ls=Gr.Set,as=Gr.add,hs=function(t){var e=new ls;return ss(t,(function(t){as(e,t)})),e},cs=xo(Gr.proto,"size","get")||function(t){return t.size},us=function(t){return{iterator:t,next:t.next,done:!1}},ds=Lt,gs=Qe,fs=I,ms=Si,ps=us,ws="Invalid size",vs=RangeError,ys=TypeError,bs=Math.max,Cs=function(t,e){this.set=t,this.size=bs(e,0),this.has=ds(t.has),this.keys=ds(t.keys)};Cs.prototype={getIterator:function(){return ps(gs(fs(this.keys,this.set)))},includes:function(t){return fs(this.has,this.set,t)}};var Ss=function(t){gs(t);var e=+t.size;if(e!=e)throw new ys(ws);var n=ms(e);if(n<0)throw new vs(ws);return new Cs(t,n)},Rs=Xr,Es=hs,Ts=cs,Ms=Ss,xs=rs,Hs=Zr,ks=Gr.has,Is=Gr.remove,Os=ut,As=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},_s=function(t){var e=Os("Set");try{(new e)[t](As(0));try{return(new e)[t](As(-1)),!1}catch(n){return!0}}catch(n){return!1}},Ps=function(t){var e=Rs(this),n=Ms(t),i=Es(e);return Ts(e)<=n.size?xs(e,(function(t){n.includes(t)&&Is(i,t)})):Hs(n.getIterator(),(function(t){ks(e,t)&&Is(i,t)})),i};yo({target:"Set",proto:!0,real:!0,forced:!_s("difference")},{difference:Ps});var Ns=Xr,Ds=cs,Ls=Ss,Vs=rs,Fs=Zr,Ws=Gr.Set,js=Gr.add,Bs=Gr.has,zs=T,Us=function(t){var e=Ns(this),n=Ls(t),i=new Ws;return Ds(e)>n.size?Fs(n.getIterator(),(function(t){Bs(e,t)&&js(i,t)})):Vs(e,(function(t){n.includes(t)&&js(i,t)})),i};yo({target:"Set",proto:!0,real:!0,forced:!_s("intersection")||zs((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}))},{intersection:Us});var Ys=I,$s=Qe,Gs=Wt,Ks=function(t,e,n){var i,o;$s(t);try{if(!(i=Gs(t,"return"))){if("throw"===e)throw n;return n}i=Ys(i,t)}catch(r){o=!0,i=r}if("throw"===e)throw n;if(o)throw i;return $s(i),n},Xs=Xr,qs=Gr.has,Zs=cs,Qs=Ss,Js=rs,tl=Zr,el=Ks,nl=function(t){var e=Xs(this),n=Qs(t);if(Zs(e)<=n.size)return!1!==Js(e,(function(t){if(n.includes(t))return!1}),!0);var i=n.getIterator();return!1!==tl(i,(function(t){if(qs(e,t))return el(i,"normal",!1)}))};yo({target:"Set",proto:!0,real:!0,forced:!_s("isDisjointFrom")},{isDisjointFrom:nl});var il=Xr,ol=cs,rl=rs,sl=Ss,ll=function(t){var e=il(this),n=sl(t);return!(ol(e)>n.size)&&!1!==rl(e,(function(t){if(!n.includes(t))return!1}),!0)};yo({target:"Set",proto:!0,real:!0,forced:!_s("isSubsetOf")},{isSubsetOf:ll});var al=Xr,hl=Gr.has,cl=cs,ul=Ss,dl=Zr,gl=Ks,fl=function(t){var e=al(this),n=ul(t);if(cl(e)<n.size)return!1;var i=n.getIterator();return!1!==dl(i,(function(t){if(!hl(e,t))return gl(i,"normal",!1)}))};yo({target:"Set",proto:!0,real:!0,forced:!_s("isSupersetOf")},{isSupersetOf:fl});var ml=Xr,pl=hs,wl=Ss,vl=Zr,yl=Gr.add,bl=Gr.has,Cl=Gr.remove,Sl=function(t){var e=ml(this),n=wl(t).getIterator(),i=pl(e);return vl(n,(function(t){bl(e,t)?Cl(i,t):yl(i,t)})),i};yo({target:"Set",proto:!0,real:!0,forced:!_s("symmetricDifference")},{symmetricDifference:Sl});var Rl=Xr,El=Gr.add,Tl=hs,Ml=Ss,xl=Zr,Hl=function(t){var e=Rl(this),n=Ml(t).getIterator(),i=Tl(e);return xl(n,(function(t){El(i,t)})),i};yo({target:"Set",proto:!0,real:!0,forced:!_s("union")},{union:Hl});var kl=dt,Il=TypeError,Ol=!T((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),Al=le,_l=st,Pl=oe,Nl=Ol,Dl=_n("IE_PROTO"),Ll=Object,Vl=Ll.prototype,Fl=Nl?Ll.getPrototypeOf:function(t){var e=Pl(t);if(Al(e,Dl))return e[Dl];var n=e.constructor;return _l(n)&&e instanceof n?n.prototype:e instanceof Ll?Vl:null},Wl=di,jl=Ge,Bl=M,zl=Ge,Ul=L,Yl=function(t,e,n){Bl?zl.f(t,e,Ul(0,n)):t[e]=n},$l={},Gl=Wi,Kl=ji,Xl=Object.keys||function(t){return Gl(t,Kl)},ql=M,Zl=Ke,Ql=Ge,Jl=Qe,ta=ot,ea=Xl;$l.f=ql&&!Zl?Object.defineProperties:function(t,e){Jl(t);for(var n,i=ta(e),o=ea(e),r=o.length,s=0;r>s;)Ql.f(t,n=o[s++],i[n]);return t};var na,ia=ut("document","documentElement"),oa=Qe,ra=$l,sa=ji,la=Pn,aa=ia,ha=Ne,ca="prototype",ua="script",da=_n("IE_PROTO"),ga=function(){},fa=function(t){return"<"+ua+">"+t+"</"+ua+">"},ma=function(t){t.write(fa("")),t.close();var e=t.parentWindow.Object;return t=null,e},pa=function(){try{na=new ActiveXObject("htmlfile")}catch(o){}var t,e,n;pa="undefined"!=typeof document?document.domain&&na?ma(na):(e=ha("iframe"),n="java"+ua+":",e.style.display="none",aa.appendChild(e),e.src=String(n),(t=e.contentWindow.document).open(),t.write(fa("document.F=Object")),t.close(),t.F):ma(na);for(var i=sa.length;i--;)delete pa[ca][sa[i]];return pa()};la[da]=!0;var wa,va,ya,ba=Object.create||function(t,e){var n;return null!==t?(ga[ca]=oa(t),n=new ga,ga[ca]=null,n[da]=t):n=pa(),void 0===e?n:ra.f(n,e)},Ca=T,Sa=st,Ra=at,Ea=Fl,Ta=wi,Ma=Ce("iterator"),xa=!1;[].keys&&("next"in(ya=[].keys())?(va=Ea(Ea(ya)))!==Object.prototype&&(wa=va):xa=!0),(!Ra(wa)||Ca((function(){var t={};return wa[Ma].call(t)!==t})))&&(wa={}),Sa(wa[Ma])||Ta(wa,Ma,(function(){return this}));var Ha={IteratorPrototype:wa,BUGGY_SAFARI_ITERATORS:xa},ka=yo,Ia=R,Oa=function(t,e){if(kl(e,t))return t;throw new Il("Incorrect invocation")},Aa=Qe,_a=st,Pa=Fl,Na=function(t,e,n){return n.get&&Wl(n.get,e,{getter:!0}),n.set&&Wl(n.set,e,{setter:!0}),jl.f(t,e,n)},Da=Yl,La=T,Va=le,Fa=Ha.IteratorPrototype,Wa=M,ja="constructor",Ba="Iterator",za=Ce("toStringTag"),Ua=TypeError,Ya=Ia[Ba],$a=!_a(Ya)||Ya.prototype!==Fa||!La((function(){Ya({})})),Ga=function(){if(Oa(this,Fa),Pa(this)===Fa)throw new Ua("Abstract class Iterator not directly constructable")},Ka=function(t,e){Wa?Na(Fa,t,{configurable:!0,get:function(){return e},set:function(e){if(Aa(this),this===Fa)throw new Ua("You can't redefine this property");Va(this,t)?this[t]=e:Da(this,t,e)}}):Fa[t]=e};Va(Fa,za)||Ka(za,Ba),!$a&&Va(Fa,ja)&&Fa[ja]!==Object||Ka(ja,Ga),Ga.prototype=Fa,ka({global:!0,constructor:!0,forced:$a},{Iterator:Ga});var Xa=wi,qa=I,Za=ba,Qa=gn,Ja=function(t,e,n){for(var i in e)Xa(t,i,e[i],n);return t},th=Kn,eh=Wt,nh=Ha.IteratorPrototype,ih=function(t,e){return{value:t,done:e}},oh=Ks,rh=Ce("toStringTag"),sh="IteratorHelper",lh="WrapForValidIterator",ah=th.set,hh=function(t){var e=th.getterFor(t?lh:sh);return Ja(Za(nh),{next:function(){var n=e(this);if(t)return n.nextHandler();try{var i=n.done?void 0:n.nextHandler();return ih(i,n.done)}catch(o){throw n.done=!0,o}},return:function(){var n=e(this),i=n.iterator;if(n.done=!0,t){var o=eh(i,"return");return o?qa(o,i):ih(void 0,!0)}if(n.inner)try{oh(n.inner.iterator,"normal")}catch(r){return oh(i,"throw",r)}return i&&oh(i,"normal"),ih(void 0,!0)}})},ch=hh(!0),uh=hh(!1);Qa(uh,rh,"Iterator Helper");var dh=function(t,e){var n=function(n,i){i?(i.iterator=n.iterator,i.next=n.next):i=n,i.type=e?lh:sh,i.nextHandler=t,i.counter=0,i.done=!1,ah(this,i)};return n.prototype=e?ch:uh,n},gh=Qe,fh=Ks,mh=function(t,e,n,i){try{return i?e(gh(n)[0],n[1]):e(n)}catch(o){fh(t,"throw",o)}},ph=yo,wh=I,vh=Lt,yh=Qe,bh=us,Ch=mh,Sh=dh((function(){for(var t,e,n=this.iterator,i=this.predicate,o=this.next;;){if(t=yh(wh(o,n)),this.done=!!t.done)return;if(e=t.value,Ch(n,i,[e,this.counter++],!0))return e}}));ph({target:"Iterator",proto:!0,real:!0,forced:false},{filter:function(t){return yh(this),vh(t),new Sh(bh(this),{predicate:t})}});var Rh=$,Eh=B,Th=function(t){if("Function"===Rh(t))return Eh(t)},Mh=Lt,xh=x,Hh=Th(Th.bind),kh=function(t,e){return Mh(t),void 0===e?t:xh?Hh(t,e):function(){return t.apply(e,arguments)}},Ih={},Oh=Ih,Ah=Ce("iterator"),_h=Array.prototype,Ph=Ko,Nh=Wt,Dh=Q,Lh=Ih,Vh=Ce("iterator"),Fh=function(t){if(!Dh(t))return Nh(t,Vh)||Nh(t,"@@iterator")||Lh[Ph(t)]},Wh=I,jh=Lt,Bh=Qe,zh=_t,Uh=Fh,Yh=TypeError,$h=kh,Gh=I,Kh=Qe,Xh=_t,qh=function(t){return void 0!==t&&(Oh.Array===t||_h[Ah]===t)},Zh=ki,Qh=dt,Jh=function(t,e){var n=arguments.length<2?Uh(t):e;if(jh(n))return Bh(Wh(n,t));throw new Yh(zh(t)+" is not iterable")},tc=Fh,ec=Ks,nc=TypeError,ic=function(t,e){this.stopped=t,this.result=e},oc=ic.prototype,rc=function(t,e,n){var i,o,r,s,l,a,h,c=n&&n.that,u=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_RECORD),g=!(!n||!n.IS_ITERATOR),f=!(!n||!n.INTERRUPTED),m=$h(e,c),p=function(t){return i&&ec(i,"normal",t),new ic(!0,t)},w=function(t){return u?(Kh(t),f?m(t[0],t[1],p):m(t[0],t[1])):f?m(t,p):m(t)};if(d)i=t.iterator;else if(g)i=t;else{if(!(o=tc(t)))throw new nc(Xh(t)+" is not iterable");if(qh(o)){for(r=0,s=Zh(t);s>r;r++)if((l=w(t[r]))&&Qh(oc,l))return l;return new ic(!1)}i=Jh(t,o)}for(a=d?t.next:i.next;!(h=Gh(a,i)).done;){try{l=w(h.value)}catch(v){ec(i,"throw",v)}if("object"==typeof l&&l&&Qh(oc,l))return l}return new ic(!1)},sc=rc,lc=Lt,ac=Qe,hc=us;yo({target:"Iterator",proto:!0,real:!0},{forEach:function(t){ac(this),lc(t);var e=hc(this),n=0;sc(e,(function(e){t(e,n++)}),{IS_RECORD:!0})}});var cc=I,uc=Lt,dc=Qe,gc=us,fc=mh,mc=dh((function(){var t=this.iterator,e=dc(cc(this.next,t));if(!(this.done=!!e.done))return fc(t,this.mapper,[e.value,this.counter++],!0)}));yo({target:"Iterator",proto:!0,real:!0,forced:false},{map:function(t){return dc(this),uc(t),new mc(gc(this),{mapper:t})}});var pc,wc,vc,yc,bc=B([].slice),Cc=TypeError,Sc=function(t,e){if(t<e)throw new Cc("Not enough arguments");return t},Rc=/(?:ipad|iphone|ipod).*applewebkit/i.test(mt),Ec=R,Tc=mt,Mc=$,xc=function(t){return Tc.slice(0,t.length)===t},Hc=xc("Bun/")?"BUN":xc("Cloudflare-Workers")?"CLOUDFLARE":xc("Deno/")?"DENO":xc("Node.js/")?"NODE":Ec.Bun&&"string"==typeof Bun.version?"BUN":Ec.Deno&&"object"==typeof Deno.version?"DENO":"process"===Mc(Ec.process)?"NODE":Ec.window&&Ec.document?"BROWSER":"REST",kc=R,Ic=Eo,Oc=kh,Ac=st,_c=le,Pc=T,Nc=ia,Dc=bc,Lc=Ne,Vc=Sc,Fc=Rc,Wc="NODE"===Hc,jc=kc.setImmediate,Bc=kc.clearImmediate,zc=kc.process,Uc=kc.Dispatch,Yc=kc.Function,$c=kc.MessageChannel,Gc=kc.String,Kc=0,Xc={},qc="onreadystatechange";Pc((function(){pc=kc.location}));var Zc=function(t){if(_c(Xc,t)){var e=Xc[t];delete Xc[t],e()}},Qc=function(t){return function(){Zc(t)}},Jc=function(t){Zc(t.data)},tu=function(t){kc.postMessage(Gc(t),pc.protocol+"//"+pc.host)};jc&&Bc||(jc=function(t){Vc(arguments.length,1);var e=Ac(t)?t:Yc(t),n=Dc(arguments,1);return Xc[++Kc]=function(){Ic(e,void 0,n)},wc(Kc),Kc},Bc=function(t){delete Xc[t]},Wc?wc=function(t){zc.nextTick(Qc(t))}:Uc&&Uc.now?wc=function(t){Uc.now(Qc(t))}:$c&&!Fc?(yc=(vc=new $c).port2,vc.port1.onmessage=Jc,wc=Oc(yc.postMessage,yc)):kc.addEventListener&&Ac(kc.postMessage)&&!kc.importScripts&&pc&&"file:"!==pc.protocol&&!Pc(tu)?(wc=tu,kc.addEventListener("message",Jc,!1)):wc=qc in Lc("script")?function(t){Nc.appendChild(Lc("script"))[qc]=function(){Nc.removeChild(this),Zc(t)}}:function(t){setTimeout(Qc(t),0)});var eu={set:jc,clear:Bc},nu=eu.clear;yo({global:!0,bind:!0,enumerable:!0,forced:R.clearImmediate!==nu},{clearImmediate:nu});var iu,ou=R,ru=Eo,su=st,lu=Hc,au=mt,hu=bc,cu=Sc,uu=ou.Function,du=/MSIE .\./.test(au)||"BUN"===lu&&((iu=ou.Bun.version.split(".")).length<3||"0"===iu[0]&&(iu[1]<3||"3"===iu[1]&&"0"===iu[2])),gu=yo,fu=R,mu=eu.set,pu=function(t,e){var n=e?2:1;return du?function(i,o){var r=cu(arguments.length,1)>n,s=su(i)?i:uu(i),l=r?hu(arguments,n):[],a=r?function(){ru(s,this,l)}:s;return e?t(a,o):t(a)}:t},wu=fu.setImmediate?pu(mu,!1):mu;gu({global:!0,bind:!0,enumerable:!0,forced:fu.setImmediate!==wu},{setImmediate:wu});
/*! @license DOMPurify 3.2.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.3/LICENSE */
const{entries:vu,setPrototypeOf:yu,isFrozen:bu,getPrototypeOf:Cu,getOwnPropertyDescriptor:Su}=Object;let{freeze:Ru,seal:Eu,create:Tu}=Object,{apply:Mu,construct:xu}="undefined"!=typeof Reflect&&Reflect;Ru||(Ru=function(t){return t}),Eu||(Eu=function(t){return t}),Mu||(Mu=function(t,e,n){return t.apply(e,n)}),xu||(xu=function(t,e){return new t(...e)});const Hu=ju(Array.prototype.forEach),ku=ju(Array.prototype.pop),Iu=ju(Array.prototype.push),Ou=ju(String.prototype.toLowerCase),Au=ju(String.prototype.toString),_u=ju(String.prototype.match),Pu=ju(String.prototype.replace),Nu=ju(String.prototype.indexOf),Du=ju(String.prototype.trim),Lu=ju(Object.prototype.hasOwnProperty),Vu=ju(RegExp.prototype.test),Fu=(Wu=TypeError,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return xu(Wu,e)});var Wu;function ju(t){return function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return Mu(t,e,i)}}function Bu(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ou;yu&&yu(t,null);let i=e.length;for(;i--;){let o=e[i];if("string"==typeof o){const t=n(o);t!==o&&(bu(e)||(e[i]=t),o=t)}t[o]=!0}return t}function zu(t){for(let e=0;e<t.length;e++){Lu(t,e)||(t[e]=null)}return t}function Uu(t){const e=Tu(null);for(const[n,i]of vu(t)){Lu(t,n)&&(Array.isArray(i)?e[n]=zu(i):i&&"object"==typeof i&&i.constructor===Object?e[n]=Uu(i):e[n]=i)}return e}function Yu(t,e){for(;null!==t;){const n=Su(t,e);if(n){if(n.get)return ju(n.get);if("function"==typeof n.value)return ju(n.value)}t=Cu(t)}return function(){return null}}const $u=Ru(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Gu=Ru(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ku=Ru(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Xu=Ru(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),qu=Ru(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Zu=Ru(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Qu=Ru(["#text"]),Ju=Ru(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),td=Ru(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ed=Ru(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),nd=Ru(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),id=Eu(/\{\{[\w\W]*|[\w\W]*\}\}/gm),od=Eu(/<%[\w\W]*|[\w\W]*%>/gm),rd=Eu(/\$\{[\w\W]*}/gm),sd=Eu(/^data-[\-\w.\u00B7-\uFFFF]+$/),ld=Eu(/^aria-[\-\w]+$/),ad=Eu(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),hd=Eu(/^(?:\w+script|data):/i),cd=Eu(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ud=Eu(/^html$/i),dd=Eu(/^[a-z][.\w]*(-[.\w]+)+$/i);var gd=Object.freeze({__proto__:null,ARIA_ATTR:ld,ATTR_WHITESPACE:cd,CUSTOM_ELEMENT:dd,DATA_ATTR:sd,DOCTYPE_NAME:ud,ERB_EXPR:od,IS_ALLOWED_URI:ad,IS_SCRIPT_OR_DATA:hd,MUSTACHE_EXPR:id,TMPLIT_EXPR:rd});const fd=1,md=3,pd=7,wd=8,vd=9;var yd,bd,Cd=function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window;const n=e=>t(e);if(n.version="3.2.3",n.removed=[],!e||!e.document||e.document.nodeType!==vd)return n.isSupported=!1,n;let{document:i}=e;const o=i,r=o.currentScript,{DocumentFragment:s,HTMLTemplateElement:l,Node:a,Element:h,NodeFilter:c,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:d,DOMParser:g,trustedTypes:f}=e,m=h.prototype,p=Yu(m,"cloneNode"),w=Yu(m,"remove"),v=Yu(m,"nextSibling"),y=Yu(m,"childNodes"),b=Yu(m,"parentNode");if("function"==typeof l){const t=i.createElement("template");t.content&&t.content.ownerDocument&&(i=t.content.ownerDocument)}let C,S="";const{implementation:R,createNodeIterator:E,createDocumentFragment:T,getElementsByTagName:M}=i,{importNode:x}=o;let H={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"==typeof vu&&"function"==typeof b&&R&&void 0!==R.createHTMLDocument;const{MUSTACHE_EXPR:k,ERB_EXPR:I,TMPLIT_EXPR:O,DATA_ATTR:A,ARIA_ATTR:_,IS_SCRIPT_OR_DATA:P,ATTR_WHITESPACE:N,CUSTOM_ELEMENT:D}=gd;let{IS_ALLOWED_URI:L}=gd,V=null;const F=Bu({},[...$u,...Gu,...Ku,...qu,...Qu]);let W=null;const j=Bu({},[...Ju,...td,...ed,...nd]);let B=Object.seal(Tu(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),z=null,U=null,Y=!0,$=!0,G=!1,K=!0,X=!1,q=!0,Z=!1,Q=!1,J=!1,tt=!1,et=!1,nt=!1,it=!0,ot=!1,rt=!0,st=!1,lt={},at=null;const ht=Bu({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ct=null;const ut=Bu({},["audio","video","img","source","image","track"]);let dt=null;const gt=Bu({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ft="http://www.w3.org/1998/Math/MathML",mt="http://www.w3.org/2000/svg",pt="http://www.w3.org/1999/xhtml";let wt=pt,vt=!1,yt=null;const bt=Bu({},[ft,mt,pt],Au);let Ct=Bu({},["mi","mo","mn","ms","mtext"]),St=Bu({},["annotation-xml"]);const Rt=Bu({},["title","style","font","a","script"]);let Et=null;const Tt=["application/xhtml+xml","text/html"];let Mt=null,xt=null;const Ht=i.createElement("form"),kt=function(t){return t instanceof RegExp||t instanceof Function},It=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!xt||xt!==t){if(t&&"object"==typeof t||(t={}),t=Uu(t),Et=-1===Tt.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE,Mt="application/xhtml+xml"===Et?Au:Ou,V=Lu(t,"ALLOWED_TAGS")?Bu({},t.ALLOWED_TAGS,Mt):F,W=Lu(t,"ALLOWED_ATTR")?Bu({},t.ALLOWED_ATTR,Mt):j,yt=Lu(t,"ALLOWED_NAMESPACES")?Bu({},t.ALLOWED_NAMESPACES,Au):bt,dt=Lu(t,"ADD_URI_SAFE_ATTR")?Bu(Uu(gt),t.ADD_URI_SAFE_ATTR,Mt):gt,ct=Lu(t,"ADD_DATA_URI_TAGS")?Bu(Uu(ut),t.ADD_DATA_URI_TAGS,Mt):ut,at=Lu(t,"FORBID_CONTENTS")?Bu({},t.FORBID_CONTENTS,Mt):ht,z=Lu(t,"FORBID_TAGS")?Bu({},t.FORBID_TAGS,Mt):{},U=Lu(t,"FORBID_ATTR")?Bu({},t.FORBID_ATTR,Mt):{},lt=!!Lu(t,"USE_PROFILES")&&t.USE_PROFILES,Y=!1!==t.ALLOW_ARIA_ATTR,$=!1!==t.ALLOW_DATA_ATTR,G=t.ALLOW_UNKNOWN_PROTOCOLS||!1,K=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,X=t.SAFE_FOR_TEMPLATES||!1,q=!1!==t.SAFE_FOR_XML,Z=t.WHOLE_DOCUMENT||!1,tt=t.RETURN_DOM||!1,et=t.RETURN_DOM_FRAGMENT||!1,nt=t.RETURN_TRUSTED_TYPE||!1,J=t.FORCE_BODY||!1,it=!1!==t.SANITIZE_DOM,ot=t.SANITIZE_NAMED_PROPS||!1,rt=!1!==t.KEEP_CONTENT,st=t.IN_PLACE||!1,L=t.ALLOWED_URI_REGEXP||ad,wt=t.NAMESPACE||pt,Ct=t.MATHML_TEXT_INTEGRATION_POINTS||Ct,St=t.HTML_INTEGRATION_POINTS||St,B=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&kt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(B.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&kt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(B.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(B.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),X&&($=!1),et&&(tt=!0),lt&&(V=Bu({},Qu),W=[],!0===lt.html&&(Bu(V,$u),Bu(W,Ju)),!0===lt.svg&&(Bu(V,Gu),Bu(W,td),Bu(W,nd)),!0===lt.svgFilters&&(Bu(V,Ku),Bu(W,td),Bu(W,nd)),!0===lt.mathMl&&(Bu(V,qu),Bu(W,ed),Bu(W,nd))),t.ADD_TAGS&&(V===F&&(V=Uu(V)),Bu(V,t.ADD_TAGS,Mt)),t.ADD_ATTR&&(W===j&&(W=Uu(W)),Bu(W,t.ADD_ATTR,Mt)),t.ADD_URI_SAFE_ATTR&&Bu(dt,t.ADD_URI_SAFE_ATTR,Mt),t.FORBID_CONTENTS&&(at===ht&&(at=Uu(at)),Bu(at,t.FORBID_CONTENTS,Mt)),rt&&(V["#text"]=!0),Z&&Bu(V,["html","head","body"]),V.table&&(Bu(V,["tbody"]),delete z.tbody),t.TRUSTED_TYPES_POLICY){if("function"!=typeof t.TRUSTED_TYPES_POLICY.createHTML)throw Fu('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof t.TRUSTED_TYPES_POLICY.createScriptURL)throw Fu('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=t.TRUSTED_TYPES_POLICY,S=C.createHTML("")}else void 0===C&&(C=function(t,e){if("object"!=typeof t||"function"!=typeof t.createPolicy)return null;let n=null;const i="data-tt-policy-suffix";e&&e.hasAttribute(i)&&(n=e.getAttribute(i));const o="dompurify"+(n?"#"+n:"");try{return t.createPolicy(o,{createHTML:t=>t,createScriptURL:t=>t})}catch(r){return null}}(f,r)),null!==C&&"string"==typeof S&&(S=C.createHTML(""));Ru&&Ru(t),xt=t}},Ot=Bu({},[...Gu,...Ku,...Xu]),At=Bu({},[...qu,...Zu]),_t=function(t){Iu(n.removed,{element:t});try{b(t).removeChild(t)}catch(e){w(t)}},Pt=function(t,e){try{Iu(n.removed,{attribute:e.getAttributeNode(t),from:e})}catch(i){Iu(n.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t)if(tt||et)try{_t(e)}catch(i){}else try{e.setAttribute(t,"")}catch(i){}},Nt=function(t){let e=null,n=null;if(J)t="<remove></remove>"+t;else{const e=_u(t,/^[\r\n\t ]+/);n=e&&e[0]}"application/xhtml+xml"===Et&&wt===pt&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");const o=C?C.createHTML(t):t;if(wt===pt)try{e=(new g).parseFromString(o,Et)}catch(s){}if(!e||!e.documentElement){e=R.createDocument(wt,"template",null);try{e.documentElement.innerHTML=vt?S:o}catch(s){}}const r=e.body||e.documentElement;return t&&n&&r.insertBefore(i.createTextNode(n),r.childNodes[0]||null),wt===pt?M.call(e,Z?"html":"body")[0]:Z?e.documentElement:r},Dt=function(t){return E.call(t.ownerDocument||t,t,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Lt=function(t){return t instanceof d&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof u)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)},Vt=function(t){return"function"==typeof a&&t instanceof a};function Ft(t,e,i){Hu(t,(t=>{t.call(n,e,i,xt)}))}const Wt=function(t){let e=null;if(Ft(H.beforeSanitizeElements,t,null),Lt(t))return _t(t),!0;const i=Mt(t.nodeName);if(Ft(H.uponSanitizeElement,t,{tagName:i,allowedTags:V}),t.hasChildNodes()&&!Vt(t.firstElementChild)&&Vu(/<[/\w]/g,t.innerHTML)&&Vu(/<[/\w]/g,t.textContent))return _t(t),!0;if(t.nodeType===pd)return _t(t),!0;if(q&&t.nodeType===wd&&Vu(/<[/\w]/g,t.data))return _t(t),!0;if(!V[i]||z[i]){if(!z[i]&&Bt(i)){if(B.tagNameCheck instanceof RegExp&&Vu(B.tagNameCheck,i))return!1;if(B.tagNameCheck instanceof Function&&B.tagNameCheck(i))return!1}if(rt&&!at[i]){const e=b(t)||t.parentNode,n=y(t)||t.childNodes;if(n&&e){for(let i=n.length-1;i>=0;--i){const o=p(n[i],!0);o.__removalCount=(t.__removalCount||0)+1,e.insertBefore(o,v(t))}}}return _t(t),!0}return t instanceof h&&!function(t){let e=b(t);e&&e.tagName||(e={namespaceURI:wt,tagName:"template"});const n=Ou(t.tagName),i=Ou(e.tagName);return!!yt[t.namespaceURI]&&(t.namespaceURI===mt?e.namespaceURI===pt?"svg"===n:e.namespaceURI===ft?"svg"===n&&("annotation-xml"===i||Ct[i]):Boolean(Ot[n]):t.namespaceURI===ft?e.namespaceURI===pt?"math"===n:e.namespaceURI===mt?"math"===n&&St[i]:Boolean(At[n]):t.namespaceURI===pt?!(e.namespaceURI===mt&&!St[i])&&!(e.namespaceURI===ft&&!Ct[i])&&!At[n]&&(Rt[n]||!Ot[n]):!("application/xhtml+xml"!==Et||!yt[t.namespaceURI]))}(t)?(_t(t),!0):"noscript"!==i&&"noembed"!==i&&"noframes"!==i||!Vu(/<\/no(script|embed|frames)/i,t.innerHTML)?(X&&t.nodeType===md&&(e=t.textContent,Hu([k,I,O],(t=>{e=Pu(e,t," ")})),t.textContent!==e&&(Iu(n.removed,{element:t.cloneNode()}),t.textContent=e)),Ft(H.afterSanitizeElements,t,null),!1):(_t(t),!0)},jt=function(t,e,n){if(it&&("id"===e||"name"===e)&&(n in i||n in Ht))return!1;if($&&!U[e]&&Vu(A,e));else if(Y&&Vu(_,e));else if(!W[e]||U[e]){if(!(Bt(t)&&(B.tagNameCheck instanceof RegExp&&Vu(B.tagNameCheck,t)||B.tagNameCheck instanceof Function&&B.tagNameCheck(t))&&(B.attributeNameCheck instanceof RegExp&&Vu(B.attributeNameCheck,e)||B.attributeNameCheck instanceof Function&&B.attributeNameCheck(e))||"is"===e&&B.allowCustomizedBuiltInElements&&(B.tagNameCheck instanceof RegExp&&Vu(B.tagNameCheck,n)||B.tagNameCheck instanceof Function&&B.tagNameCheck(n))))return!1}else if(dt[e]);else if(Vu(L,Pu(n,N,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==Nu(n,"data:")||!ct[t]){if(G&&!Vu(P,Pu(n,N,"")));else if(n)return!1}else;return!0},Bt=function(t){return"annotation-xml"!==t&&_u(t,D)},zt=function(t){Ft(H.beforeSanitizeAttributes,t,null);const{attributes:e}=t;if(!e||Lt(t))return;const i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:W,forceKeepAttr:void 0};let o=e.length;for(;o--;){const s=e[o],{name:l,namespaceURI:a,value:h}=s,c=Mt(l);let u="value"===l?h:Du(h);if(i.attrName=c,i.attrValue=u,i.keepAttr=!0,i.forceKeepAttr=void 0,Ft(H.uponSanitizeAttribute,t,i),u=i.attrValue,!ot||"id"!==c&&"name"!==c||(Pt(l,t),u="user-content-"+u),q&&Vu(/((--!?|])>)|<\/(style|title)/i,u)){Pt(l,t);continue}if(i.forceKeepAttr)continue;if(Pt(l,t),!i.keepAttr)continue;if(!K&&Vu(/\/>/i,u)){Pt(l,t);continue}X&&Hu([k,I,O],(t=>{u=Pu(u,t," ")}));const d=Mt(t.nodeName);if(jt(d,c,u)){if(C&&"object"==typeof f&&"function"==typeof f.getAttributeType)if(a);else switch(f.getAttributeType(d,c)){case"TrustedHTML":u=C.createHTML(u);break;case"TrustedScriptURL":u=C.createScriptURL(u)}try{a?t.setAttributeNS(a,l,u):t.setAttribute(l,u),Lt(t)?_t(t):ku(n.removed)}catch(r){}}}Ft(H.afterSanitizeAttributes,t,null)},Ut=function t(e){let n=null;const i=Dt(e);for(Ft(H.beforeSanitizeShadowDOM,e,null);n=i.nextNode();)Ft(H.uponSanitizeShadowNode,n,null),Wt(n),zt(n),n.content instanceof s&&t(n.content);Ft(H.afterSanitizeShadowDOM,e,null)};return n.sanitize=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=null,r=null,l=null,h=null;if(vt=!t,vt&&(t="\x3c!--\x3e"),"string"!=typeof t&&!Vt(t)){if("function"!=typeof t.toString)throw Fu("toString is not a function");if("string"!=typeof(t=t.toString()))throw Fu("dirty is not a string, aborting")}if(!n.isSupported)return t;if(Q||It(e),n.removed=[],"string"==typeof t&&(st=!1),st){if(t.nodeName){const e=Mt(t.nodeName);if(!V[e]||z[e])throw Fu("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof a)i=Nt("\x3c!----\x3e"),r=i.ownerDocument.importNode(t,!0),r.nodeType===fd&&"BODY"===r.nodeName||"HTML"===r.nodeName?i=r:i.appendChild(r);else{if(!tt&&!X&&!Z&&-1===t.indexOf("<"))return C&&nt?C.createHTML(t):t;if(i=Nt(t),!i)return tt?null:nt?S:""}i&&J&&_t(i.firstChild);const c=Dt(st?t:i);for(;l=c.nextNode();)Wt(l),zt(l),l.content instanceof s&&Ut(l.content);if(st)return t;if(tt){if(et)for(h=T.call(i.ownerDocument);i.firstChild;)h.appendChild(i.firstChild);else h=i;return(W.shadowroot||W.shadowrootmode)&&(h=x.call(o,h,!0)),h}let u=Z?i.outerHTML:i.innerHTML;return Z&&V["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&Vu(ud,i.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+u),X&&Hu([k,I,O],(t=>{u=Pu(u,t," ")})),C&&nt?C.createHTML(u):u},n.setConfig=function(){It(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Q=!0},n.clearConfig=function(){xt=null,Q=!1},n.isValidAttribute=function(t,e,n){xt||It({});const i=Mt(t),o=Mt(e);return jt(i,o,n)},n.addHook=function(t,e){"function"==typeof e&&Iu(H[t],e)},n.removeHook=function(t){return ku(H[t])},n.removeHooks=function(t){H[t]=[]},n.removeAllHooks=function(){H={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}();
//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
function Sd(){return yd.apply(null,arguments)}function Rd(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function Ed(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function Td(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Md(t){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(t).length;var e;for(e in t)if(Td(t,e))return!1;return!0}function xd(t){return void 0===t}function Hd(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function kd(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function Id(t,e){var n,i=[],o=t.length;for(n=0;n<o;++n)i.push(e(t[n],n));return i}function Od(t,e){for(var n in e)Td(e,n)&&(t[n]=e[n]);return Td(e,"toString")&&(t.toString=e.toString),Td(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Ad(t,e,n,i){return Jf(t,e,n,i,!0).utc()}function _d(t){return null==t._pf&&(t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}),t._pf}function Pd(t){var e=null,n=!1,i=t._d&&!isNaN(t._d.getTime());return i&&(e=_d(t),n=bd.call(e.parsedDateParts,(function(t){return null!=t})),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(i=i&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour)),null!=Object.isFrozen&&Object.isFrozen(t)?i:(t._isValid=i,t._isValid)}function Nd(t){var e=Ad(NaN);return null!=t?Od(_d(e),t):_d(e).userInvalidated=!0,e}bd=Array.prototype.some?Array.prototype.some:function(t){var e,n=Object(this),i=n.length>>>0;for(e=0;e<i;e++)if(e in n&&t.call(this,n[e],e,n))return!0;return!1};var Dd=Sd.momentProperties=[],Ld=!1;function Vd(t,e){var n,i,o,r=Dd.length;if(xd(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),xd(e._i)||(t._i=e._i),xd(e._f)||(t._f=e._f),xd(e._l)||(t._l=e._l),xd(e._strict)||(t._strict=e._strict),xd(e._tzm)||(t._tzm=e._tzm),xd(e._isUTC)||(t._isUTC=e._isUTC),xd(e._offset)||(t._offset=e._offset),xd(e._pf)||(t._pf=_d(e)),xd(e._locale)||(t._locale=e._locale),r>0)for(n=0;n<r;n++)xd(o=e[i=Dd[n]])||(t[i]=o);return t}function Fd(t){Vd(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===Ld&&(Ld=!0,Sd.updateOffset(this),Ld=!1)}function Wd(t){return t instanceof Fd||null!=t&&null!=t._isAMomentObject}function jd(t){!1===Sd.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn}function Bd(t,e){var n=!0;return Od((function(){if(null!=Sd.deprecationHandler&&Sd.deprecationHandler(null,t),n){var i,o,r,s=[],l=arguments.length;for(o=0;o<l;o++){if(i="","object"==typeof arguments[o]){for(r in i+="\n["+o+"] ",arguments[0])Td(arguments[0],r)&&(i+=r+": "+arguments[0][r]+", ");i=i.slice(0,-2)}else i=arguments[o];s.push(i)}jd((Array.prototype.slice.call(s).join(""),(new Error).stack)),n=!1}return e.apply(this,arguments)}),e)}var zd,Ud={};function Yd(t,e){null!=Sd.deprecationHandler&&Sd.deprecationHandler(t,e),Ud[t]||(jd(),Ud[t]=!0)}function $d(t){return"undefined"!=typeof Function&&t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function Gd(t,e){var n,i=Od({},t);for(n in e)Td(e,n)&&(Ed(t[n])&&Ed(e[n])?(i[n]={},Od(i[n],t[n]),Od(i[n],e[n])):null!=e[n]?i[n]=e[n]:delete i[n]);for(n in t)Td(t,n)&&!Td(e,n)&&Ed(t[n])&&(i[n]=Od({},i[n]));return i}function Kd(t){null!=t&&this.set(t)}Sd.suppressDeprecationWarnings=!1,Sd.deprecationHandler=null,zd=Object.keys?Object.keys:function(t){var e,n=[];for(e in t)Td(t,e)&&n.push(e);return n};function Xd(t,e,n){var i=""+Math.abs(t),o=e-i.length;return(t>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+i}var qd=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Zd=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Qd={},Jd={};function tg(t,e,n,i){var o=i;"string"==typeof i&&(o=function(){return this[i]()}),t&&(Jd[t]=o),e&&(Jd[e[0]]=function(){return Xd(o.apply(this,arguments),e[1],e[2])}),n&&(Jd[n]=function(){return this.localeData().ordinal(o.apply(this,arguments),t)})}function eg(t,e){return t.isValid()?(e=ng(e,t.localeData()),Qd[e]=Qd[e]||function(t){var e,n,i,o=t.match(qd);for(e=0,n=o.length;e<n;e++)Jd[o[e]]?o[e]=Jd[o[e]]:o[e]=(i=o[e]).match(/\[[\s\S]/)?i.replace(/^\[|\]$/g,""):i.replace(/\\/g,"");return function(e){var i,r="";for(i=0;i<n;i++)r+=$d(o[i])?o[i].call(e,t):o[i];return r}}(e),Qd[e](t)):t.localeData().invalidDate()}function ng(t,e){var n=5;function i(t){return e.longDateFormat(t)||t}for(Zd.lastIndex=0;n>=0&&Zd.test(t);)t=t.replace(Zd,i),Zd.lastIndex=0,n-=1;return t}var ig={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function og(t){return"string"==typeof t?ig[t]||ig[t.toLowerCase()]:void 0}function rg(t){var e,n,i={};for(n in t)Td(t,n)&&(e=og(n))&&(i[e]=t[n]);return i}var sg={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};var lg,ag=/\d/,hg=/\d\d/,cg=/\d{3}/,ug=/\d{4}/,dg=/[+-]?\d{6}/,gg=/\d\d?/,fg=/\d\d\d\d?/,mg=/\d\d\d\d\d\d?/,pg=/\d{1,3}/,wg=/\d{1,4}/,vg=/[+-]?\d{1,6}/,yg=/\d+/,bg=/[+-]?\d+/,Cg=/Z|[+-]\d\d:?\d\d/gi,Sg=/Z|[+-]\d\d(?::?\d\d)?/gi,Rg=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Eg=/^[1-9]\d?/,Tg=/^([1-9]\d|\d)/;function Mg(t,e,n){lg[t]=$d(e)?e:function(t,i){return t&&n?n:e}}function xg(t,e){return Td(lg,t)?lg[t](e._strict,e._locale):new RegExp(Hg(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(t,e,n,i,o){return e||n||i||o}))))}function Hg(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function kg(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Ig(t){var e=+t,n=0;return 0!==e&&isFinite(e)&&(n=kg(e)),n}lg={};var Og={};function Ag(t,e){var n,i,o=e;for("string"==typeof t&&(t=[t]),Hd(e)&&(o=function(t,n){n[e]=Ig(t)}),i=t.length,n=0;n<i;n++)Og[t[n]]=o}function _g(t,e){Ag(t,(function(t,n,i,o){i._w=i._w||{},e(t,i._w,i,o)}))}function Pg(t,e,n){null!=e&&Td(Og,t)&&Og[t](e,n._a,n,t)}function Ng(t){return t%4==0&&t%100!=0||t%400==0}var Dg=0,Lg=1,Vg=2,Fg=3,Wg=4,jg=5,Bg=6,zg=7,Ug=8;function Yg(t){return Ng(t)?366:365}tg("Y",0,0,(function(){var t=this.year();return t<=9999?Xd(t,4):"+"+t})),tg(0,["YY",2],0,(function(){return this.year()%100})),tg(0,["YYYY",4],0,"year"),tg(0,["YYYYY",5],0,"year"),tg(0,["YYYYYY",6,!0],0,"year"),Mg("Y",bg),Mg("YY",gg,hg),Mg("YYYY",wg,ug),Mg("YYYYY",vg,dg),Mg("YYYYYY",vg,dg),Ag(["YYYYY","YYYYYY"],Dg),Ag("YYYY",(function(t,e){e[Dg]=2===t.length?Sd.parseTwoDigitYear(t):Ig(t)})),Ag("YY",(function(t,e){e[Dg]=Sd.parseTwoDigitYear(t)})),Ag("Y",(function(t,e){e[Dg]=parseInt(t,10)})),Sd.parseTwoDigitYear=function(t){return Ig(t)+(Ig(t)>68?1900:2e3)};var $g,Gg=Kg("FullYear",!0);function Kg(t,e){return function(n){return null!=n?(qg(this,t,n),Sd.updateOffset(this,e),this):Xg(this,t)}}function Xg(t,e){if(!t.isValid())return NaN;var n=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return i?n.getUTCSeconds():n.getSeconds();case"Minutes":return i?n.getUTCMinutes():n.getMinutes();case"Hours":return i?n.getUTCHours():n.getHours();case"Date":return i?n.getUTCDate():n.getDate();case"Day":return i?n.getUTCDay():n.getDay();case"Month":return i?n.getUTCMonth():n.getMonth();case"FullYear":return i?n.getUTCFullYear():n.getFullYear();default:return NaN}}function qg(t,e,n){var i,o,r,s,l;if(t.isValid()&&!isNaN(n)){switch(i=t._d,o=t._isUTC,e){case"Milliseconds":return void(o?i.setUTCMilliseconds(n):i.setMilliseconds(n));case"Seconds":return void(o?i.setUTCSeconds(n):i.setSeconds(n));case"Minutes":return void(o?i.setUTCMinutes(n):i.setMinutes(n));case"Hours":return void(o?i.setUTCHours(n):i.setHours(n));case"Date":return void(o?i.setUTCDate(n):i.setDate(n));case"FullYear":break;default:return}r=n,s=t.month(),l=29!==(l=t.date())||1!==s||Ng(r)?l:28,o?i.setUTCFullYear(r,s,l):i.setFullYear(r,s,l)}}function Zg(t,e){if(isNaN(t)||isNaN(e))return NaN;var n,i=(e%(n=12)+n)%n;return t+=(e-i)/12,1===i?Ng(t)?29:28:31-i%7%2}$g=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1},tg("M",["MM",2],"Mo",(function(){return this.month()+1})),tg("MMM",0,0,(function(t){return this.localeData().monthsShort(this,t)})),tg("MMMM",0,0,(function(t){return this.localeData().months(this,t)})),Mg("M",gg,Eg),Mg("MM",gg,hg),Mg("MMM",(function(t,e){return e.monthsShortRegex(t)})),Mg("MMMM",(function(t,e){return e.monthsRegex(t)})),Ag(["M","MM"],(function(t,e){e[Lg]=Ig(t)-1})),Ag(["MMM","MMMM"],(function(t,e,n,i){var o=n._locale.monthsParse(t,i,n._strict);null!=o?e[Lg]=o:_d(n).invalidMonth=t}));var Qg="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Jg="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),tf=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ef=Rg,nf=Rg;function of(t,e,n){var i,o,r,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)r=Ad([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===e?-1!==(o=$g.call(this._shortMonthsParse,s))?o:null:-1!==(o=$g.call(this._longMonthsParse,s))?o:null:"MMM"===e?-1!==(o=$g.call(this._shortMonthsParse,s))||-1!==(o=$g.call(this._longMonthsParse,s))?o:null:-1!==(o=$g.call(this._longMonthsParse,s))||-1!==(o=$g.call(this._shortMonthsParse,s))?o:null}function rf(t,e){if(!t.isValid())return t;if("string"==typeof e)if(/^\d+$/.test(e))e=Ig(e);else if(!Hd(e=t.localeData().monthsParse(e)))return t;var n=e,i=t.date();return i=i<29?i:Math.min(i,Zg(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,i):t._d.setMonth(n,i),t}function sf(t){return null!=t?(rf(this,t),Sd.updateOffset(this,!0),this):Xg(this,"Month")}function lf(){function t(t,e){return e.length-t.length}var e,n,i,o,r=[],s=[],l=[];for(e=0;e<12;e++)n=Ad([2e3,e]),i=Hg(this.monthsShort(n,"")),o=Hg(this.months(n,"")),r.push(i),s.push(o),l.push(o),l.push(i);r.sort(t),s.sort(t),l.sort(t),this._monthsRegex=new RegExp("^("+l.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function af(t,e,n,i,o,r,s){var l;return t<100&&t>=0?(l=new Date(t+400,e,n,i,o,r,s),isFinite(l.getFullYear())&&l.setFullYear(t)):l=new Date(t,e,n,i,o,r,s),l}function hf(t){var e,n;return t<100&&t>=0?((n=Array.prototype.slice.call(arguments))[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function cf(t,e,n){var i=7+e-n;return-((7+hf(t,0,i).getUTCDay()-e)%7)+i-1}function uf(t,e,n,i,o){var r,s,l=1+7*(e-1)+(7+n-i)%7+cf(t,i,o);return l<=0?s=Yg(r=t-1)+l:l>Yg(t)?(r=t+1,s=l-Yg(t)):(r=t,s=l),{year:r,dayOfYear:s}}function df(t,e,n){var i,o,r=cf(t.year(),e,n),s=Math.floor((t.dayOfYear()-r-1)/7)+1;return s<1?i=s+gf(o=t.year()-1,e,n):s>gf(t.year(),e,n)?(i=s-gf(t.year(),e,n),o=t.year()+1):(o=t.year(),i=s),{week:i,year:o}}function gf(t,e,n){var i=cf(t,e,n),o=cf(t+1,e,n);return(Yg(t)-i+o)/7}tg("w",["ww",2],"wo","week"),tg("W",["WW",2],"Wo","isoWeek"),Mg("w",gg,Eg),Mg("ww",gg,hg),Mg("W",gg,Eg),Mg("WW",gg,hg),_g(["w","ww","W","WW"],(function(t,e,n,i){e[i.substr(0,1)]=Ig(t)}));function ff(t,e){return t.slice(e,7).concat(t.slice(0,e))}tg("d",0,"do","day"),tg("dd",0,0,(function(t){return this.localeData().weekdaysMin(this,t)})),tg("ddd",0,0,(function(t){return this.localeData().weekdaysShort(this,t)})),tg("dddd",0,0,(function(t){return this.localeData().weekdays(this,t)})),tg("e",0,0,"weekday"),tg("E",0,0,"isoWeekday"),Mg("d",gg),Mg("e",gg),Mg("E",gg),Mg("dd",(function(t,e){return e.weekdaysMinRegex(t)})),Mg("ddd",(function(t,e){return e.weekdaysShortRegex(t)})),Mg("dddd",(function(t,e){return e.weekdaysRegex(t)})),_g(["dd","ddd","dddd"],(function(t,e,n,i){var o=n._locale.weekdaysParse(t,i,n._strict);null!=o?e.d=o:_d(n).invalidWeekday=t})),_g(["d","e","E"],(function(t,e,n,i){e[i]=Ig(t)}));var mf="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),pf="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),wf="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),vf=Rg,yf=Rg,bf=Rg;function Cf(t,e,n){var i,o,r,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)r=Ad([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===e?-1!==(o=$g.call(this._weekdaysParse,s))?o:null:"ddd"===e?-1!==(o=$g.call(this._shortWeekdaysParse,s))?o:null:-1!==(o=$g.call(this._minWeekdaysParse,s))?o:null:"dddd"===e?-1!==(o=$g.call(this._weekdaysParse,s))||-1!==(o=$g.call(this._shortWeekdaysParse,s))||-1!==(o=$g.call(this._minWeekdaysParse,s))?o:null:"ddd"===e?-1!==(o=$g.call(this._shortWeekdaysParse,s))||-1!==(o=$g.call(this._weekdaysParse,s))||-1!==(o=$g.call(this._minWeekdaysParse,s))?o:null:-1!==(o=$g.call(this._minWeekdaysParse,s))||-1!==(o=$g.call(this._weekdaysParse,s))||-1!==(o=$g.call(this._shortWeekdaysParse,s))?o:null}function Sf(){function t(t,e){return e.length-t.length}var e,n,i,o,r,s=[],l=[],a=[],h=[];for(e=0;e<7;e++)n=Ad([2e3,1]).day(e),i=Hg(this.weekdaysMin(n,"")),o=Hg(this.weekdaysShort(n,"")),r=Hg(this.weekdays(n,"")),s.push(i),l.push(o),a.push(r),h.push(i),h.push(o),h.push(r);s.sort(t),l.sort(t),a.sort(t),h.sort(t),this._weekdaysRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Rf(){return this.hours()%12||12}function Ef(t,e){tg(t,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)}))}function Tf(t,e){return e._meridiemParse}tg("H",["HH",2],0,"hour"),tg("h",["hh",2],0,Rf),tg("k",["kk",2],0,(function(){return this.hours()||24})),tg("hmm",0,0,(function(){return""+Rf.apply(this)+Xd(this.minutes(),2)})),tg("hmmss",0,0,(function(){return""+Rf.apply(this)+Xd(this.minutes(),2)+Xd(this.seconds(),2)})),tg("Hmm",0,0,(function(){return""+this.hours()+Xd(this.minutes(),2)})),tg("Hmmss",0,0,(function(){return""+this.hours()+Xd(this.minutes(),2)+Xd(this.seconds(),2)})),Ef("a",!0),Ef("A",!1),Mg("a",Tf),Mg("A",Tf),Mg("H",gg,Tg),Mg("h",gg,Eg),Mg("k",gg,Eg),Mg("HH",gg,hg),Mg("hh",gg,hg),Mg("kk",gg,hg),Mg("hmm",fg),Mg("hmmss",mg),Mg("Hmm",fg),Mg("Hmmss",mg),Ag(["H","HH"],Fg),Ag(["k","kk"],(function(t,e,n){var i=Ig(t);e[Fg]=24===i?0:i})),Ag(["a","A"],(function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t})),Ag(["h","hh"],(function(t,e,n){e[Fg]=Ig(t),_d(n).bigHour=!0})),Ag("hmm",(function(t,e,n){var i=t.length-2;e[Fg]=Ig(t.substr(0,i)),e[Wg]=Ig(t.substr(i)),_d(n).bigHour=!0})),Ag("hmmss",(function(t,e,n){var i=t.length-4,o=t.length-2;e[Fg]=Ig(t.substr(0,i)),e[Wg]=Ig(t.substr(i,2)),e[jg]=Ig(t.substr(o)),_d(n).bigHour=!0})),Ag("Hmm",(function(t,e,n){var i=t.length-2;e[Fg]=Ig(t.substr(0,i)),e[Wg]=Ig(t.substr(i))})),Ag("Hmmss",(function(t,e,n){var i=t.length-4,o=t.length-2;e[Fg]=Ig(t.substr(0,i)),e[Wg]=Ig(t.substr(i,2)),e[jg]=Ig(t.substr(o))}));var Mf=Kg("Hours",!0);var xf,Hf={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Qg,monthsShort:Jg,week:{dow:0,doy:6},weekdays:mf,weekdaysMin:wf,weekdaysShort:pf,meridiemParse:/[ap]\.?m?\.?/i},kf={},If={};function Of(t,e){var n,i=Math.min(t.length,e.length);for(n=0;n<i;n+=1)if(t[n]!==e[n])return n;return i}function Af(t){return t?t.toLowerCase().replace("_","-"):t}function _f(t){var e=null;if(void 0===kf[t]&&"undefined"!=typeof module&&module&&module.exports&&function(t){return!(!t||!t.match("^[^/\\\\]*$"))}(t))try{e=xf._abbr,require("./locale/"+t),Pf(e)}catch(n){kf[t]=null}return kf[t]}function Pf(t,e){var n;return t&&((n=xd(e)?Df(t):Nf(t,e))?xf=n:"undefined"!=typeof console&&console.warn),xf._abbr}function Nf(t,e){if(null!==e){var n,i=Hf;if(e.abbr=t,null!=kf[t])Yd("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=kf[t]._config;else if(null!=e.parentLocale)if(null!=kf[e.parentLocale])i=kf[e.parentLocale]._config;else{if(null==(n=_f(e.parentLocale)))return If[e.parentLocale]||(If[e.parentLocale]=[]),If[e.parentLocale].push({name:t,config:e}),null;i=n._config}return kf[t]=new Kd(Gd(i,e)),If[t]&&If[t].forEach((function(t){Nf(t.name,t.config)})),Pf(t),kf[t]}return delete kf[t],null}function Df(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return xf;if(!Rd(t)){if(e=_f(t))return e;t=[t]}return function(t){for(var e,n,i,o,r=0;r<t.length;){for(e=(o=Af(t[r]).split("-")).length,n=(n=Af(t[r+1]))?n.split("-"):null;e>0;){if(i=_f(o.slice(0,e).join("-")))return i;if(n&&n.length>=e&&Of(o,n)>=e-1)break;e--}r++}return xf}(t)}function Lf(t){var e,n=t._a;return n&&-2===_d(t).overflow&&(e=n[Lg]<0||n[Lg]>11?Lg:n[Vg]<1||n[Vg]>Zg(n[Dg],n[Lg])?Vg:n[Fg]<0||n[Fg]>24||24===n[Fg]&&(0!==n[Wg]||0!==n[jg]||0!==n[Bg])?Fg:n[Wg]<0||n[Wg]>59?Wg:n[jg]<0||n[jg]>59?jg:n[Bg]<0||n[Bg]>999?Bg:-1,_d(t)._overflowDayOfYear&&(e<Dg||e>Vg)&&(e=Vg),_d(t)._overflowWeeks&&-1===e&&(e=zg),_d(t)._overflowWeekday&&-1===e&&(e=Ug),_d(t).overflow=e),t}var Vf=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ff=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Wf=/Z|[+-]\d\d(?::?\d\d)?/,jf=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Bf=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],zf=/^\/?Date\((-?\d+)/i,Uf=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Yf={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function $f(t){var e,n,i,o,r,s,l=t._i,a=Vf.exec(l)||Ff.exec(l),h=jf.length,c=Bf.length;if(a){for(_d(t).iso=!0,e=0,n=h;e<n;e++)if(jf[e][1].exec(a[1])){o=jf[e][0],i=!1!==jf[e][2];break}if(null==o)return void(t._isValid=!1);if(a[3]){for(e=0,n=c;e<n;e++)if(Bf[e][1].exec(a[3])){r=(a[2]||" ")+Bf[e][0];break}if(null==r)return void(t._isValid=!1)}if(!i&&null!=r)return void(t._isValid=!1);if(a[4]){if(!Wf.exec(a[4]))return void(t._isValid=!1);s="Z"}t._f=o+(r||"")+(s||""),Zf(t)}else t._isValid=!1}function Gf(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function Kf(t){var e,n,i,o,r,s,l,a,h=Uf.exec(t._i.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(h){if(n=h[4],i=h[3],o=h[2],r=h[5],s=h[6],l=h[7],a=[Gf(n),Jg.indexOf(i),parseInt(o,10),parseInt(r,10),parseInt(s,10)],l&&a.push(parseInt(l,10)),e=a,!function(t,e,n){return!t||pf.indexOf(t)===new Date(e[0],e[1],e[2]).getDay()||(_d(n).weekdayMismatch=!0,n._isValid=!1,!1)}(h[1],e,t))return;t._a=e,t._tzm=function(t,e,n){if(t)return Yf[t];if(e)return 0;var i=parseInt(n,10),o=i%100;return(i-o)/100*60+o}(h[8],h[9],h[10]),t._d=hf.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),_d(t).rfc2822=!0}else t._isValid=!1}function Xf(t,e,n){return null!=t?t:null!=e?e:n}function qf(t){var e,n,i,o,r,s=[];if(!t._d){for(i=function(t){var e=new Date(Sd.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}(t),t._w&&null==t._a[Vg]&&null==t._a[Lg]&&function(t){var e,n,i,o,r,s,l,a,h;e=t._w,null!=e.GG||null!=e.W||null!=e.E?(r=1,s=4,n=Xf(e.GG,t._a[Dg],df(tm(),1,4).year),i=Xf(e.W,1),((o=Xf(e.E,1))<1||o>7)&&(a=!0)):(r=t._locale._week.dow,s=t._locale._week.doy,h=df(tm(),r,s),n=Xf(e.gg,t._a[Dg],h.year),i=Xf(e.w,h.week),null!=e.d?((o=e.d)<0||o>6)&&(a=!0):null!=e.e?(o=e.e+r,(e.e<0||e.e>6)&&(a=!0)):o=r);i<1||i>gf(n,r,s)?_d(t)._overflowWeeks=!0:null!=a?_d(t)._overflowWeekday=!0:(l=uf(n,i,o,r,s),t._a[Dg]=l.year,t._dayOfYear=l.dayOfYear)}(t),null!=t._dayOfYear&&(r=Xf(t._a[Dg],i[Dg]),(t._dayOfYear>Yg(r)||0===t._dayOfYear)&&(_d(t)._overflowDayOfYear=!0),n=hf(r,0,t._dayOfYear),t._a[Lg]=n.getUTCMonth(),t._a[Vg]=n.getUTCDate()),e=0;e<3&&null==t._a[e];++e)t._a[e]=s[e]=i[e];for(;e<7;e++)t._a[e]=s[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[Fg]&&0===t._a[Wg]&&0===t._a[jg]&&0===t._a[Bg]&&(t._nextDay=!0,t._a[Fg]=0),t._d=(t._useUTC?hf:af).apply(null,s),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Fg]=24),t._w&&void 0!==t._w.d&&t._w.d!==o&&(_d(t).weekdayMismatch=!0)}}function Zf(t){if(t._f!==Sd.ISO_8601)if(t._f!==Sd.RFC_2822){t._a=[],_d(t).empty=!0;var e,n,i,o,r,s,l,a=""+t._i,h=a.length,c=0;for(l=(i=ng(t._f,t._locale).match(qd)||[]).length,e=0;e<l;e++)o=i[e],(n=(a.match(xg(o,t))||[])[0])&&((r=a.substr(0,a.indexOf(n))).length>0&&_d(t).unusedInput.push(r),a=a.slice(a.indexOf(n)+n.length),c+=n.length),Jd[o]?(n?_d(t).empty=!1:_d(t).unusedTokens.push(o),Pg(o,n,t)):t._strict&&!n&&_d(t).unusedTokens.push(o);_d(t).charsLeftOver=h-c,a.length>0&&_d(t).unusedInput.push(a),t._a[Fg]<=12&&!0===_d(t).bigHour&&t._a[Fg]>0&&(_d(t).bigHour=void 0),_d(t).parsedDateParts=t._a.slice(0),_d(t).meridiem=t._meridiem,t._a[Fg]=function(t,e,n){var i;if(null==n)return e;return null!=t.meridiemHour?t.meridiemHour(e,n):null!=t.isPM?((i=t.isPM(n))&&e<12&&(e+=12),i||12!==e||(e=0),e):e}(t._locale,t._a[Fg],t._meridiem),null!==(s=_d(t).era)&&(t._a[Dg]=t._locale.erasConvertYear(s,t._a[Dg])),qf(t),Lf(t)}else Kf(t);else $f(t)}function Qf(t){var e=t._i,n=t._f;return t._locale=t._locale||Df(t._l),null===e||void 0===n&&""===e?Nd({nullInput:!0}):("string"==typeof e&&(t._i=e=t._locale.preparse(e)),Wd(e)?new Fd(Lf(e)):(kd(e)?t._d=e:Rd(n)?function(t){var e,n,i,o,r,s,l=!1,a=t._f.length;if(0===a)return _d(t).invalidFormat=!0,void(t._d=new Date(NaN));for(o=0;o<a;o++)r=0,s=!1,e=Vd({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[o],Zf(e),Pd(e)&&(s=!0),r+=_d(e).charsLeftOver,r+=10*_d(e).unusedTokens.length,_d(e).score=r,l?r<i&&(i=r,n=e):(null==i||r<i||s)&&(i=r,n=e,s&&(l=!0));Od(t,n||e)}(t):n?Zf(t):function(t){var e=t._i;xd(e)?t._d=new Date(Sd.now()):kd(e)?t._d=new Date(e.valueOf()):"string"==typeof e?function(t){var e=zf.exec(t._i);null===e?($f(t),!1===t._isValid&&(delete t._isValid,Kf(t),!1===t._isValid&&(delete t._isValid,t._strict?t._isValid=!1:Sd.createFromInputFallback(t)))):t._d=new Date(+e[1])}(t):Rd(e)?(t._a=Id(e.slice(0),(function(t){return parseInt(t,10)})),qf(t)):Ed(e)?function(t){if(!t._d){var e=rg(t._i),n=void 0===e.day?e.date:e.day;t._a=Id([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],(function(t){return t&&parseInt(t,10)})),qf(t)}}(t):Hd(e)?t._d=new Date(e):Sd.createFromInputFallback(t)}(t),Pd(t)||(t._d=null),t))}function Jf(t,e,n,i,o){var r,s={};return!0!==e&&!1!==e||(i=e,e=void 0),!0!==n&&!1!==n||(i=n,n=void 0),(Ed(t)&&Md(t)||Rd(t)&&0===t.length)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=o,s._l=n,s._i=t,s._f=e,s._strict=i,(r=new Fd(Lf(Qf(s))))._nextDay&&(r.add(1,"d"),r._nextDay=void 0),r}function tm(t,e,n,i){return Jf(t,e,n,i,!1)}Sd.createFromInputFallback=Bd("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))})),Sd.ISO_8601=function(){},Sd.RFC_2822=function(){};var em=Bd("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=tm.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Nd()})),nm=Bd("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var t=tm.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Nd()}));function im(t,e){var n,i;if(1===e.length&&Rd(e[0])&&(e=e[0]),!e.length)return tm();for(n=e[0],i=1;i<e.length;++i)e[i].isValid()&&!e[i][t](n)||(n=e[i]);return n}var om=["year","quarter","month","week","day","hour","minute","second","millisecond"];function rm(t){var e=rg(t),n=e.year||0,i=e.quarter||0,o=e.month||0,r=e.week||e.isoWeek||0,s=e.day||0,l=e.hour||0,a=e.minute||0,h=e.second||0,c=e.millisecond||0;this._isValid=function(t){var e,n,i=!1,o=om.length;for(e in t)if(Td(t,e)&&(-1===$g.call(om,e)||null!=t[e]&&isNaN(t[e])))return!1;for(n=0;n<o;++n)if(t[om[n]]){if(i)return!1;parseFloat(t[om[n]])!==Ig(t[om[n]])&&(i=!0)}return!0}(e),this._milliseconds=+c+1e3*h+6e4*a+1e3*l*60*60,this._days=+s+7*r,this._months=+o+3*i+12*n,this._data={},this._locale=Df(),this._bubble()}function sm(t){return t instanceof rm}function lm(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function am(t,e){tg(t,0,0,(function(){var t=this.utcOffset(),n="+";return t<0&&(t=-t,n="-"),n+Xd(~~(t/60),2)+e+Xd(~~t%60,2)}))}am("Z",":"),am("ZZ",""),Mg("Z",Sg),Mg("ZZ",Sg),Ag(["Z","ZZ"],(function(t,e,n){n._useUTC=!0,n._tzm=cm(Sg,t)}));var hm=/([\+\-]|\d\d)/gi;function cm(t,e){var n,i,o=(e||"").match(t);return null===o?null:0===(i=60*(n=((o[o.length-1]||[])+"").match(hm)||["-",0,0])[1]+Ig(n[2]))?0:"+"===n[0]?i:-i}function um(t,e){var n,i;return e._isUTC?(n=e.clone(),i=(Wd(t)||kd(t)?t.valueOf():tm(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),Sd.updateOffset(n,!1),n):tm(t).local()}function dm(t){return-Math.round(t._d.getTimezoneOffset())}function gm(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}Sd.updateOffset=function(){};var fm=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,mm=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function pm(t,e){var n,i,o,r=t,s=null;return sm(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:Hd(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(s=fm.exec(t))?(n="-"===s[1]?-1:1,r={y:0,d:Ig(s[Vg])*n,h:Ig(s[Fg])*n,m:Ig(s[Wg])*n,s:Ig(s[jg])*n,ms:Ig(lm(1e3*s[Bg]))*n}):(s=mm.exec(t))?(n="-"===s[1]?-1:1,r={y:wm(s[2],n),M:wm(s[3],n),w:wm(s[4],n),d:wm(s[5],n),h:wm(s[6],n),m:wm(s[7],n),s:wm(s[8],n)}):null==r?r={}:"object"==typeof r&&("from"in r||"to"in r)&&(o=function(t,e){var n;if(!t.isValid()||!e.isValid())return{milliseconds:0,months:0};e=um(e,t),t.isBefore(e)?n=vm(t,e):((n=vm(e,t)).milliseconds=-n.milliseconds,n.months=-n.months);return n}(tm(r.from),tm(r.to)),(r={}).ms=o.milliseconds,r.M=o.months),i=new rm(r),sm(t)&&Td(t,"_locale")&&(i._locale=t._locale),sm(t)&&Td(t,"_isValid")&&(i._isValid=t._isValid),i}function wm(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function vm(t,e){var n={};return n.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function ym(t,e){return function(n,i){var o;return null===i||isNaN(+i)||(Yd(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=i,i=o),bm(this,pm(n,i),t),this}}function bm(t,e,n,i){var o=e._milliseconds,r=lm(e._days),s=lm(e._months);t.isValid()&&(i=null==i||i,s&&rf(t,Xg(t,"Month")+s*n),r&&qg(t,"Date",Xg(t,"Date")+r*n),o&&t._d.setTime(t._d.valueOf()+o*n),i&&Sd.updateOffset(t,r||s))}pm.fn=rm.prototype,pm.invalid=function(){return pm(NaN)};var Cm=ym(1,"add"),Sm=ym(-1,"subtract");function Rm(t){return"string"==typeof t||t instanceof String}function Em(t){return Wd(t)||kd(t)||Rm(t)||Hd(t)||function(t){var e=Rd(t),n=!1;e&&(n=0===t.filter((function(e){return!Hd(e)&&Rm(t)})).length);return e&&n}(t)||function(t){var e,n,i=Ed(t)&&!Md(t),o=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s=r.length;for(e=0;e<s;e+=1)n=r[e],o=o||Td(t,n);return i&&o}(t)||null==t}function Tm(t,e){if(t.date()<e.date())return-Tm(e,t);var n=12*(e.year()-t.year())+(e.month()-t.month()),i=t.clone().add(n,"months");return-(n+(e-i<0?(e-i)/(i-t.clone().add(n-1,"months")):(e-i)/(t.clone().add(n+1,"months")-i)))||0}function Mm(t){var e;return void 0===t?this._locale._abbr:(null!=(e=Df(t))&&(this._locale=e),this)}Sd.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",Sd.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var xm=Bd("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(t){return void 0===t?this.localeData():this.locale(t)}));function Hm(){return this._locale}var km=1e3,Im=6e4,Om=36e5,Am=126227808e5;function _m(t,e){return(t%e+e)%e}function Pm(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-Am:new Date(t,e,n).valueOf()}function Nm(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-Am:Date.UTC(t,e,n)}function Dm(t,e){return e.erasAbbrRegex(t)}function Lm(){var t,e,n,i,o,r=[],s=[],l=[],a=[],h=this.eras();for(t=0,e=h.length;t<e;++t)n=Hg(h[t].name),i=Hg(h[t].abbr),o=Hg(h[t].narrow),s.push(n),r.push(i),l.push(o),a.push(n),a.push(i),a.push(o);this._erasRegex=new RegExp("^("+a.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+s.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+l.join("|")+")","i")}function Vm(t,e){tg(0,[t,t.length],0,e)}function Fm(t,e,n,i,o){var r;return null==t?df(this,i,o).year:(e>(r=gf(t,i,o))&&(e=r),Wm.call(this,t,e,n,i,o))}function Wm(t,e,n,i,o){var r=uf(t,e,n,i,o),s=hf(r.year,0,r.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}tg("N",0,0,"eraAbbr"),tg("NN",0,0,"eraAbbr"),tg("NNN",0,0,"eraAbbr"),tg("NNNN",0,0,"eraName"),tg("NNNNN",0,0,"eraNarrow"),tg("y",["y",1],"yo","eraYear"),tg("y",["yy",2],0,"eraYear"),tg("y",["yyy",3],0,"eraYear"),tg("y",["yyyy",4],0,"eraYear"),Mg("N",Dm),Mg("NN",Dm),Mg("NNN",Dm),Mg("NNNN",(function(t,e){return e.erasNameRegex(t)})),Mg("NNNNN",(function(t,e){return e.erasNarrowRegex(t)})),Ag(["N","NN","NNN","NNNN","NNNNN"],(function(t,e,n,i){var o=n._locale.erasParse(t,i,n._strict);o?_d(n).era=o:_d(n).invalidEra=t})),Mg("y",yg),Mg("yy",yg),Mg("yyy",yg),Mg("yyyy",yg),Mg("yo",(function(t,e){return e._eraYearOrdinalRegex||yg})),Ag(["y","yy","yyy","yyyy"],Dg),Ag(["yo"],(function(t,e,n,i){var o;n._locale._eraYearOrdinalRegex&&(o=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Dg]=n._locale.eraYearOrdinalParse(t,o):e[Dg]=parseInt(t,10)})),tg(0,["gg",2],0,(function(){return this.weekYear()%100})),tg(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),Vm("gggg","weekYear"),Vm("ggggg","weekYear"),Vm("GGGG","isoWeekYear"),Vm("GGGGG","isoWeekYear"),Mg("G",bg),Mg("g",bg),Mg("GG",gg,hg),Mg("gg",gg,hg),Mg("GGGG",wg,ug),Mg("gggg",wg,ug),Mg("GGGGG",vg,dg),Mg("ggggg",vg,dg),_g(["gggg","ggggg","GGGG","GGGGG"],(function(t,e,n,i){e[i.substr(0,2)]=Ig(t)})),_g(["gg","GG"],(function(t,e,n,i){e[i]=Sd.parseTwoDigitYear(t)})),tg("Q",0,"Qo","quarter"),Mg("Q",ag),Ag("Q",(function(t,e){e[Lg]=3*(Ig(t)-1)})),tg("D",["DD",2],"Do","date"),Mg("D",gg,Eg),Mg("DD",gg,hg),Mg("Do",(function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient})),Ag(["D","DD"],Vg),Ag("Do",(function(t,e){e[Vg]=Ig(t.match(gg)[0])}));var jm=Kg("Date",!0);tg("DDD",["DDDD",3],"DDDo","dayOfYear"),Mg("DDD",pg),Mg("DDDD",cg),Ag(["DDD","DDDD"],(function(t,e,n){n._dayOfYear=Ig(t)})),tg("m",["mm",2],0,"minute"),Mg("m",gg,Tg),Mg("mm",gg,hg),Ag(["m","mm"],Wg);var Bm=Kg("Minutes",!1);tg("s",["ss",2],0,"second"),Mg("s",gg,Tg),Mg("ss",gg,hg),Ag(["s","ss"],jg);var zm,Um,Ym=Kg("Seconds",!1);for(tg("S",0,0,(function(){return~~(this.millisecond()/100)})),tg(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),tg(0,["SSS",3],0,"millisecond"),tg(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),tg(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),tg(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),tg(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),tg(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),tg(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),Mg("S",pg,ag),Mg("SS",pg,hg),Mg("SSS",pg,cg),zm="SSSS";zm.length<=9;zm+="S")Mg(zm,yg);function $m(t,e){e[Bg]=Ig(1e3*("0."+t))}for(zm="S";zm.length<=9;zm+="S")Ag(zm,$m);Um=Kg("Milliseconds",!1),tg("z",0,0,"zoneAbbr"),tg("zz",0,0,"zoneName");var Gm=Fd.prototype;function Km(t){return t}Gm.add=Cm,Gm.calendar=function(t,e){1===arguments.length&&(arguments[0]?Em(arguments[0])?(t=arguments[0],e=void 0):function(t){var e,n=Ed(t)&&!Md(t),i=!1,o=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(e=0;e<o.length;e+=1)i=i||Td(t,o[e]);return n&&i}(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||tm(),i=um(n,this).startOf("day"),o=Sd.calendarFormat(this,i)||"sameElse",r=e&&($d(e[o])?e[o].call(this,n):e[o]);return this.format(r||this.localeData().calendar(o,this,tm(n)))},Gm.clone=function(){return new Fd(this)},Gm.diff=function(t,e,n){var i,o,r;if(!this.isValid())return NaN;if(!(i=um(t,this)).isValid())return NaN;switch(o=6e4*(i.utcOffset()-this.utcOffset()),e=og(e)){case"year":r=Tm(this,i)/12;break;case"month":r=Tm(this,i);break;case"quarter":r=Tm(this,i)/3;break;case"second":r=(this-i)/1e3;break;case"minute":r=(this-i)/6e4;break;case"hour":r=(this-i)/36e5;break;case"day":r=(this-i-o)/864e5;break;case"week":r=(this-i-o)/6048e5;break;default:r=this-i}return n?r:kg(r)},Gm.endOf=function(t){var e,n;if(void 0===(t=og(t))||"millisecond"===t||!this.isValid())return this;switch(n=this._isUTC?Nm:Pm,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Om-_m(e+(this._isUTC?0:this.utcOffset()*Im),Om)-1;break;case"minute":e=this._d.valueOf(),e+=Im-_m(e,Im)-1;break;case"second":e=this._d.valueOf(),e+=km-_m(e,km)-1}return this._d.setTime(e),Sd.updateOffset(this,!0),this},Gm.format=function(t){t||(t=this.isUtc()?Sd.defaultFormatUtc:Sd.defaultFormat);var e=eg(this,t);return this.localeData().postformat(e)},Gm.from=function(t,e){return this.isValid()&&(Wd(t)&&t.isValid()||tm(t).isValid())?pm({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},Gm.fromNow=function(t){return this.from(tm(),t)},Gm.to=function(t,e){return this.isValid()&&(Wd(t)&&t.isValid()||tm(t).isValid())?pm({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},Gm.toNow=function(t){return this.to(tm(),t)},Gm.get=function(t){return $d(this[t=og(t)])?this[t]():this},Gm.invalidAt=function(){return _d(this).overflow},Gm.isAfter=function(t,e){var n=Wd(t)?t:tm(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=og(e)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf())},Gm.isBefore=function(t,e){var n=Wd(t)?t:tm(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=og(e)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf())},Gm.isBetween=function(t,e,n,i){var o=Wd(t)?t:tm(t),r=Wd(e)?e:tm(e);return!!(this.isValid()&&o.isValid()&&r.isValid())&&(("("===(i=i||"()")[0]?this.isAfter(o,n):!this.isBefore(o,n))&&(")"===i[1]?this.isBefore(r,n):!this.isAfter(r,n)))},Gm.isSame=function(t,e){var n,i=Wd(t)?t:tm(t);return!(!this.isValid()||!i.isValid())&&("millisecond"===(e=og(e)||"millisecond")?this.valueOf()===i.valueOf():(n=i.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf()))},Gm.isSameOrAfter=function(t,e){return this.isSame(t,e)||this.isAfter(t,e)},Gm.isSameOrBefore=function(t,e){return this.isSame(t,e)||this.isBefore(t,e)},Gm.isValid=function(){return Pd(this)},Gm.lang=xm,Gm.locale=Mm,Gm.localeData=Hm,Gm.max=nm,Gm.min=em,Gm.parsingFlags=function(){return Od({},_d(this))},Gm.set=function(t,e){if("object"==typeof t){var n,i=function(t){var e,n=[];for(e in t)Td(t,e)&&n.push({unit:e,priority:sg[e]});return n.sort((function(t,e){return t.priority-e.priority})),n}(t=rg(t)),o=i.length;for(n=0;n<o;n++)this[i[n].unit](t[i[n].unit])}else if($d(this[t=og(t)]))return this[t](e);return this},Gm.startOf=function(t){var e,n;if(void 0===(t=og(t))||"millisecond"===t||!this.isValid())return this;switch(n=this._isUTC?Nm:Pm,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=_m(e+(this._isUTC?0:this.utcOffset()*Im),Om);break;case"minute":e=this._d.valueOf(),e-=_m(e,Im);break;case"second":e=this._d.valueOf(),e-=_m(e,km)}return this._d.setTime(e),Sd.updateOffset(this,!0),this},Gm.subtract=Sm,Gm.toArray=function(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]},Gm.toObject=function(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}},Gm.toDate=function(){return new Date(this.valueOf())},Gm.toISOString=function(t){if(!this.isValid())return null;var e=!0!==t,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?eg(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):$d(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",eg(n,"Z")):eg(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},Gm.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t,e,n,i="moment",o="";return this.isLocal()||(i=0===this.utcOffset()?"moment.utc":"moment.parseZone",o="Z"),t="["+i+'("]',e=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n=o+'[")]',this.format(t+e+"-MM-DD[T]HH:mm:ss.SSS"+n)},"undefined"!=typeof Symbol&&null!=Symbol.for&&(Gm[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),Gm.toJSON=function(){return this.isValid()?this.toISOString():null},Gm.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},Gm.unix=function(){return Math.floor(this.valueOf()/1e3)},Gm.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},Gm.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},Gm.eraName=function(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t){if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until)return i[t].name;if(i[t].until<=n&&n<=i[t].since)return i[t].name}return""},Gm.eraNarrow=function(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t){if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until)return i[t].narrow;if(i[t].until<=n&&n<=i[t].since)return i[t].narrow}return""},Gm.eraAbbr=function(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t){if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until)return i[t].abbr;if(i[t].until<=n&&n<=i[t].since)return i[t].abbr}return""},Gm.eraYear=function(){var t,e,n,i,o=this.localeData().eras();for(t=0,e=o.length;t<e;++t)if(n=o[t].since<=o[t].until?1:-1,i=this.clone().startOf("day").valueOf(),o[t].since<=i&&i<=o[t].until||o[t].until<=i&&i<=o[t].since)return(this.year()-Sd(o[t].since).year())*n+o[t].offset;return this.year()},Gm.year=Gg,Gm.isLeapYear=function(){return Ng(this.year())},Gm.weekYear=function(t){return Fm.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)},Gm.isoWeekYear=function(t){return Fm.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)},Gm.quarter=Gm.quarters=function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},Gm.month=sf,Gm.daysInMonth=function(){return Zg(this.year(),this.month())},Gm.week=Gm.weeks=function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},Gm.isoWeek=Gm.isoWeeks=function(t){var e=df(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},Gm.weeksInYear=function(){var t=this.localeData()._week;return gf(this.year(),t.dow,t.doy)},Gm.weeksInWeekYear=function(){var t=this.localeData()._week;return gf(this.weekYear(),t.dow,t.doy)},Gm.isoWeeksInYear=function(){return gf(this.year(),1,4)},Gm.isoWeeksInISOWeekYear=function(){return gf(this.isoWeekYear(),1,4)},Gm.date=jm,Gm.day=Gm.days=function(t){if(!this.isValid())return null!=t?this:NaN;var e=Xg(this,"Day");return null!=t?(t=function(t,e){return"string"!=typeof t?t:isNaN(t)?"number"==typeof(t=e.weekdaysParse(t))?t:null:parseInt(t,10)}(t,this.localeData()),this.add(t-e,"d")):e},Gm.weekday=function(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},Gm.isoWeekday=function(t){if(!this.isValid())return null!=t?this:NaN;if(null!=t){var e=function(t,e){return"string"==typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}(t,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7},Gm.dayOfYear=function(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},Gm.hour=Gm.hours=Mf,Gm.minute=Gm.minutes=Bm,Gm.second=Gm.seconds=Ym,Gm.millisecond=Gm.milliseconds=Um,Gm.utcOffset=function(t,e,n){var i,o=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null!=t){if("string"==typeof t){if(null===(t=cm(Sg,t)))return this}else Math.abs(t)<16&&!n&&(t*=60);return!this._isUTC&&e&&(i=dm(this)),this._offset=t,this._isUTC=!0,null!=i&&this.add(i,"m"),o!==t&&(!e||this._changeInProgress?bm(this,pm(t-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Sd.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?o:dm(this)},Gm.utc=function(t){return this.utcOffset(0,t)},Gm.local=function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(dm(this),"m")),this},Gm.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var t=cm(Cg,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this},Gm.hasAlignedHourOffset=function(t){return!!this.isValid()&&(t=t?tm(t).utcOffset():0,(this.utcOffset()-t)%60==0)},Gm.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},Gm.isLocal=function(){return!!this.isValid()&&!this._isUTC},Gm.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},Gm.isUtc=gm,Gm.isUTC=gm,Gm.zoneAbbr=function(){return this._isUTC?"UTC":""},Gm.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},Gm.dates=Bd("dates accessor is deprecated. Use date instead.",jm),Gm.months=Bd("months accessor is deprecated. Use month instead",sf),Gm.years=Bd("years accessor is deprecated. Use year instead",Gg),Gm.zone=Bd("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()})),Gm.isDSTShifted=Bd("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!xd(this._isDSTShifted))return this._isDSTShifted;var t,e={};return Vd(e,this),(e=Qf(e))._a?(t=e._isUTC?Ad(e._a):tm(e._a),this._isDSTShifted=this.isValid()&&function(t,e,n){var i,o=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),s=0;for(i=0;i<o;i++)(n&&t[i]!==e[i]||!n&&Ig(t[i])!==Ig(e[i]))&&s++;return s+r}(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}));var Xm=Kd.prototype;function qm(t,e,n,i){var o=Df(),r=Ad().set(i,e);return o[n](r,t)}function Zm(t,e,n){if(Hd(t)&&(e=t,t=void 0),t=t||"",null!=e)return qm(t,e,n,"month");var i,o=[];for(i=0;i<12;i++)o[i]=qm(t,i,n,"month");return o}function Qm(t,e,n,i){"boolean"==typeof t?(Hd(e)&&(n=e,e=void 0),e=e||""):(n=e=t,t=!1,Hd(e)&&(n=e,e=void 0),e=e||"");var o,r=Df(),s=t?r._week.dow:0,l=[];if(null!=n)return qm(e,(n+s)%7,i,"day");for(o=0;o<7;o++)l[o]=qm(e,(o+s)%7,i,"day");return l}Xm.calendar=function(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return $d(i)?i.call(e,n):i},Xm.longDateFormat=function(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(qd).map((function(t){return"MMMM"===t||"MM"===t||"DD"===t||"dddd"===t?t.slice(1):t})).join(""),this._longDateFormat[t])},Xm.invalidDate=function(){return this._invalidDate},Xm.ordinal=function(t){return this._ordinal.replace("%d",t)},Xm.preparse=Km,Xm.postformat=Km,Xm.relativeTime=function(t,e,n,i){var o=this._relativeTime[n];return $d(o)?o(t,e,n,i):o.replace(/%d/i,t)},Xm.pastFuture=function(t,e){var n=this._relativeTime[t>0?"future":"past"];return $d(n)?n(e):n.replace(/%s/i,e)},Xm.set=function(t){var e,n;for(n in t)Td(t,n)&&($d(e=t[n])?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},Xm.eras=function(t,e){var n,i,o,r=this._eras||Df("en")._eras;for(n=0,i=r.length;n<i;++n){if("string"==typeof r[n].since)o=Sd(r[n].since).startOf("day"),r[n].since=o.valueOf();switch(typeof r[n].until){case"undefined":r[n].until=Infinity;break;case"string":o=Sd(r[n].until).startOf("day").valueOf(),r[n].until=o.valueOf()}}return r},Xm.erasParse=function(t,e,n){var i,o,r,s,l,a=this.eras();for(t=t.toUpperCase(),i=0,o=a.length;i<o;++i)if(r=a[i].name.toUpperCase(),s=a[i].abbr.toUpperCase(),l=a[i].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(s===t)return a[i];break;case"NNNN":if(r===t)return a[i];break;case"NNNNN":if(l===t)return a[i]}else if([r,s,l].indexOf(t)>=0)return a[i]},Xm.erasConvertYear=function(t,e){var n=t.since<=t.until?1:-1;return void 0===e?Sd(t.since).year():Sd(t.since).year()+(e-t.offset)*n},Xm.erasAbbrRegex=function(t){return Td(this,"_erasAbbrRegex")||Lm.call(this),t?this._erasAbbrRegex:this._erasRegex},Xm.erasNameRegex=function(t){return Td(this,"_erasNameRegex")||Lm.call(this),t?this._erasNameRegex:this._erasRegex},Xm.erasNarrowRegex=function(t){return Td(this,"_erasNarrowRegex")||Lm.call(this),t?this._erasNarrowRegex:this._erasRegex},Xm.months=function(t,e){return t?Rd(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||tf).test(e)?"format":"standalone"][t.month()]:Rd(this._months)?this._months:this._months.standalone},Xm.monthsShort=function(t,e){return t?Rd(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[tf.test(e)?"format":"standalone"][t.month()]:Rd(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},Xm.monthsParse=function(t,e,n){var i,o,r;if(this._monthsParseExact)return of.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(o=Ad([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(r="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[i]=new RegExp(r.replace(".",""),"i")),n&&"MMMM"===e&&this._longMonthsParse[i].test(t))return i;if(n&&"MMM"===e&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}},Xm.monthsRegex=function(t){return this._monthsParseExact?(Td(this,"_monthsRegex")||lf.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Td(this,"_monthsRegex")||(this._monthsRegex=nf),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)},Xm.monthsShortRegex=function(t){return this._monthsParseExact?(Td(this,"_monthsRegex")||lf.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Td(this,"_monthsShortRegex")||(this._monthsShortRegex=ef),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)},Xm.week=function(t){return df(t,this._week.dow,this._week.doy).week},Xm.firstDayOfYear=function(){return this._week.doy},Xm.firstDayOfWeek=function(){return this._week.dow},Xm.weekdays=function(t,e){var n=Rd(this._weekdays)?this._weekdays:this._weekdays[t&&!0!==t&&this._weekdays.isFormat.test(e)?"format":"standalone"];return!0===t?ff(n,this._week.dow):t?n[t.day()]:n},Xm.weekdaysMin=function(t){return!0===t?ff(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin},Xm.weekdaysShort=function(t){return!0===t?ff(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort},Xm.weekdaysParse=function(t,e,n){var i,o,r;if(this._weekdaysParseExact)return Cf.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(o=Ad([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(r="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[i]=new RegExp(r.replace(".",""),"i")),n&&"dddd"===e&&this._fullWeekdaysParse[i].test(t))return i;if(n&&"ddd"===e&&this._shortWeekdaysParse[i].test(t))return i;if(n&&"dd"===e&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}},Xm.weekdaysRegex=function(t){return this._weekdaysParseExact?(Td(this,"_weekdaysRegex")||Sf.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Td(this,"_weekdaysRegex")||(this._weekdaysRegex=vf),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)},Xm.weekdaysShortRegex=function(t){return this._weekdaysParseExact?(Td(this,"_weekdaysRegex")||Sf.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Td(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=yf),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},Xm.weekdaysMinRegex=function(t){return this._weekdaysParseExact?(Td(this,"_weekdaysRegex")||Sf.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Td(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=bf),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},Xm.isPM=function(t){return"p"===(t+"").toLowerCase().charAt(0)},Xm.meridiem=function(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"},Pf("en",{eras:[{since:"0001-01-01",until:Infinity,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-Infinity,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10;return t+(1===Ig(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")}}),Sd.lang=Bd("moment.lang is deprecated. Use moment.locale instead.",Pf),Sd.langData=Bd("moment.langData is deprecated. Use moment.localeData instead.",Df);var Jm=Math.abs;function tp(t,e,n,i){var o=pm(e,n);return t._milliseconds+=i*o._milliseconds,t._days+=i*o._days,t._months+=i*o._months,t._bubble()}function ep(t){return t<0?Math.floor(t):Math.ceil(t)}function np(t){return 4800*t/146097}function ip(t){return 146097*t/4800}function op(t){return function(){return this.as(t)}}var rp=op("ms"),sp=op("s"),lp=op("m"),ap=op("h"),hp=op("d"),cp=op("w"),up=op("M"),dp=op("Q"),gp=op("y"),fp=rp;function mp(t){return function(){return this.isValid()?this._data[t]:NaN}}var pp=mp("milliseconds"),wp=mp("seconds"),vp=mp("minutes"),yp=mp("hours"),bp=mp("days"),Cp=mp("months"),Sp=mp("years");var Rp=Math.round,Ep={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Tp(t,e,n,i,o){return o.relativeTime(e||1,!!n,t,i)}var Mp=Math.abs;function xp(t){return(t>0)-(t<0)||+t}function Hp(){if(!this.isValid())return this.localeData().invalidDate();var t,e,n,i,o,r,s,l,a=Mp(this._milliseconds)/1e3,h=Mp(this._days),c=Mp(this._months),u=this.asSeconds();return u?(t=kg(a/60),e=kg(t/60),a%=60,t%=60,n=kg(c/12),c%=12,i=a?a.toFixed(3).replace(/\.?0+$/,""):"",o=u<0?"-":"",r=xp(this._months)!==xp(u)?"-":"",s=xp(this._days)!==xp(u)?"-":"",l=xp(this._milliseconds)!==xp(u)?"-":"",o+"P"+(n?r+n+"Y":"")+(c?r+c+"M":"")+(h?s+h+"D":"")+(e||t||a?"T":"")+(e?l+e+"H":"")+(t?l+t+"M":"")+(a?l+i+"S":"")):"P0D"}var kp=rm.prototype;function Ip(t,e){const n=e.length;let i=0;for(;i<n;)t.push(e[i]),i+=1}function Op(t){const e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;const n=t.length,i=t[0].length;for(let o=0;o<n;o++)for(let n=0;n<i;n++)e[n]||(e[n]=[]),e[n][o]=t[o][n];return e}function Ap(t,e,n,i){let o=-1,r=t,s=n;Array.isArray(t)||(r=Array.from(t));const l=r.length;for(i&&l&&(o+=1,s=r[o]),o+=1;o<l;)s=e(s,r[o],o,r),o+=1;return s}function _p(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const o=i.length,r=[];let s=-1;for(;n<o;){const t=i[n];e(t,n,i)&&(s+=1,r[s]=t),n+=1}return r}function Pp(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const o=i.length,r=[];let s=-1;for(;n<o;){const t=i[n];s+=1,r[s]=e(t,n,i),n+=1}return r}function Np(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const o=i.length;for(;n<o&&!1!==e(i[n],n,i);)n+=1;return t}function Dp(t){const e=[];return Np(t,(t=>{-1===e.indexOf(t)&&e.push(t)})),e}function Lp(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...o]=[...e];let r=i;return Np(o,(t=>{r=r.filter((e=>!t.includes(e)))})),r}function Vp(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}function Fp(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Ap(t,((t,e,i)=>t+e.replace(/\r?\n\s*/g,"")+(n[i]?n[i]:"")),"").trim()}function Wp(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString()}return e}function jp(t){return void 0!==t}function Bp(t){return void 0===t}function zp(t){return null===t||""===t||Bp(t)}kp.isValid=function(){return this._isValid},kp.abs=function(){var t=this._data;return this._milliseconds=Jm(this._milliseconds),this._days=Jm(this._days),this._months=Jm(this._months),t.milliseconds=Jm(t.milliseconds),t.seconds=Jm(t.seconds),t.minutes=Jm(t.minutes),t.hours=Jm(t.hours),t.months=Jm(t.months),t.years=Jm(t.years),this},kp.add=function(t,e){return tp(this,t,e,1)},kp.subtract=function(t,e){return tp(this,t,e,-1)},kp.as=function(t){if(!this.isValid())return NaN;var e,n,i=this._milliseconds;if("month"===(t=og(t))||"quarter"===t||"year"===t)switch(e=this._days+i/864e5,n=this._months+np(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(ip(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return 24*e+i/36e5;case"minute":return 1440*e+i/6e4;case"second":return 86400*e+i/1e3;case"millisecond":return Math.floor(864e5*e)+i;default:throw new Error("Unknown unit "+t)}},kp.asMilliseconds=rp,kp.asSeconds=sp,kp.asMinutes=lp,kp.asHours=ap,kp.asDays=hp,kp.asWeeks=cp,kp.asMonths=up,kp.asQuarters=dp,kp.asYears=gp,kp.valueOf=fp,kp._bubble=function(){var t,e,n,i,o,r=this._milliseconds,s=this._days,l=this._months,a=this._data;return r>=0&&s>=0&&l>=0||r<=0&&s<=0&&l<=0||(r+=864e5*ep(ip(l)+s),s=0,l=0),a.milliseconds=r%1e3,t=kg(r/1e3),a.seconds=t%60,e=kg(t/60),a.minutes=e%60,n=kg(e/60),a.hours=n%24,s+=kg(n/24),l+=o=kg(np(s)),s-=ep(ip(o)),i=kg(l/12),l%=12,a.days=s,a.months=l,a.years=i,this},kp.clone=function(){return pm(this)},kp.get=function(t){return t=og(t),this.isValid()?this[t+"s"]():NaN},kp.milliseconds=pp,kp.seconds=wp,kp.minutes=vp,kp.hours=yp,kp.days=bp,kp.weeks=function(){return kg(this.days()/7)},kp.months=Cp,kp.years=Sp,kp.humanize=function(t,e){if(!this.isValid())return this.localeData().invalidDate();var n,i,o=!1,r=Ep;return"object"==typeof t&&(e=t,t=!1),"boolean"==typeof t&&(o=t),"object"==typeof e&&(r=Object.assign({},Ep,e),null!=e.s&&null==e.ss&&(r.ss=e.s-1)),i=function(t,e,n,i){var o=pm(t).abs(),r=Rp(o.as("s")),s=Rp(o.as("m")),l=Rp(o.as("h")),a=Rp(o.as("d")),h=Rp(o.as("M")),c=Rp(o.as("w")),u=Rp(o.as("y")),d=r<=n.ss&&["s",r]||r<n.s&&["ss",r]||s<=1&&["m"]||s<n.m&&["mm",s]||l<=1&&["h"]||l<n.h&&["hh",l]||a<=1&&["d"]||a<n.d&&["dd",a];return null!=n.w&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),(d=d||h<=1&&["M"]||h<n.M&&["MM",h]||u<=1&&["y"]||["yy",u])[2]=e,d[3]=+t>0,d[4]=i,Tp.apply(null,d)}(this,!o,r,n=this.localeData()),o&&(i=n.pastFuture(+this,i)),n.postformat(i)},kp.toISOString=Hp,kp.toString=Hp,kp.toJSON=Hp,kp.locale=Mm,kp.localeData=Hm,kp.toIsoString=Bd("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Hp),kp.lang=xm,tg("X",0,0,"unix"),tg("x",0,0,"valueOf"),Mg("x",bg),Mg("X",/[+-]?\d+(\.\d{1,3})?/),Ag("X",(function(t,e,n){n._d=new Date(1e3*parseFloat(t))})),Ag("x",(function(t,e,n){n._d=new Date(Ig(t))})),
//! moment.js
Sd.version="2.30.1",yd=tm,Sd.fn=Gm,Sd.min=function(){return im("isBefore",[].slice.call(arguments,0))},Sd.max=function(){return im("isAfter",[].slice.call(arguments,0))},Sd.now=function(){return Date.now?Date.now():+new Date},Sd.utc=Ad,Sd.unix=function(t){return tm(1e3*t)},Sd.months=function(t,e){return Zm(t,e,"months")},Sd.isDate=kd,Sd.locale=Pf,Sd.invalid=Nd,Sd.duration=pm,Sd.isMoment=Wd,Sd.weekdays=function(t,e,n){return Qm(t,e,n,"weekdays")},Sd.parseZone=function(){return tm.apply(null,arguments).parseZone()},Sd.localeData=Df,Sd.isDuration=sm,Sd.monthsShort=function(t,e){return Zm(t,e,"monthsShort")},Sd.weekdaysMin=function(t,e,n){return Qm(t,e,n,"weekdaysMin")},Sd.defineLocale=Nf,Sd.updateLocale=function(t,e){if(null!=e){var n,i,o=Hf;null!=kf[t]&&null!=kf[t].parentLocale?kf[t].set(Gd(kf[t]._config,e)):(null!=(i=_f(t))&&(o=i._config),e=Gd(o,e),null==i&&(e.abbr=t),(n=new Kd(e)).parentLocale=kf[t],kf[t]=n),Pf(t)}else null!=kf[t]&&(null!=kf[t].parentLocale?(kf[t]=kf[t].parentLocale,t===Pf()&&Pf(t)):null!=kf[t]&&delete kf[t]);return kf[t]},Sd.locales=function(){return zd(kf)},Sd.weekdaysShort=function(t,e,n){return Qm(t,e,n,"weekdaysShort")},Sd.normalizeUnits=og,Sd.relativeTimeRounding=function(t){return void 0===t?Rp:"function"==typeof t&&(Rp=t,!0)},Sd.relativeTimeThreshold=function(t,e){return void 0!==Ep[t]&&(void 0===e?Ep[t]:(Ep[t]=e,"s"===t&&(Ep.ss=e-1),!0))},Sd.calendarFormat=function(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},Sd.prototype=Gm,Sd.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Up="length",Yp=t=>parseInt(t,16),$p=t=>parseInt(t,10),Gp=(t,e,n)=>t.substr(e,n),Kp=t=>t.codePointAt(0)-65,Xp=t=>`${t}`.replace(/\-/g,"");let qp=!1;const Zp={invalid:()=>Fp`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return Fp`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Fp`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Qp={invalid:()=>Fp`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return Fp`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Fp`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function Jp(t,e){const n=!zp(t),i="string"==typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),o="15.0.0";let r,s="invalid",l="invalid";const a=function(t){let e=[][Up],n=e;if(t[Up]!==Kp("Z"))return!1;for(let i="",o="B<H4P+".split(""),r=Kp(o.shift());r;r=Kp(o.shift()||"A"))--r<""[Up]?n|=($p(`${$p(Yp(i)+(Yp(Gp(t,Math.abs(r),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=Gp(t,r,r?1===o[Up]?9:8:6);return n===e}(t=Xp(t||""));if(n||i||a)if(a){const e=Sd("16/12/2024","DD/MM/YYYY"),n=Math.floor(e.toDate().getTime()/864e5),i=Yp(Gp(Xp(h=t),Yp("12"),Kp("F")))/(Yp(Gp(Xp(h),Kp("B"),~~![][Up]))||9);r=Sd(864e5*(i+1),"x").format("MMMM DD, YYYY"),n>i?(s="expired",l="expired"):(s="valid",l="valid")}else i?(s="non_commercial",l="valid"):(s="invalid",l="invalid");else s="missing",l="missing";var h;if("undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)&&(s="valid",l="valid"),!qp&&"valid"!==s){Zp[s]({keyValidityDate:r,hotVersion:o});qp=!0}if("valid"!==l&&e.parentNode){if(Qp[l]({keyValidityDate:r,hotVersion:o})){const t=document.createElement("div");t.className="handsontable hot-display-license-info",t.innerHTML=Qp[l]({keyValidityDate:r,hotVersion:o}),e.parentNode.insertBefore(t,e.nextSibling)}}}function tw(t){return t[0].toUpperCase()+t.substr(1)}function ew(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function nw(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function iw(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,((t,n)=>"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[n]?"":e[n]))}function ow(t){return rw(`${t}`,{ALLOWED_TAGS:[]})}function rw(t,e){return Cd.sanitize(t,e)}const sw=t=>["tabindex",t],lw=t=>["aria-label",t],aw=t=>["aria-haspopup",t],hw=t=>["aria-rowcount",t],cw=t=>["aria-colcount",t],uw=t=>["aria-rowindex",t],dw=t=>["aria-colindex",t],gw=t=>["aria-expanded",t],fw=t=>["aria-checked",t],mw=t=>["aria-relevant",t],pw=t=>["aria-posinset",t];function ww(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,i=null,o=t;for(;null!==o;){if(n===e){i=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(n+=1,o=o.parentNode)}return i}function vw(t){return function(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}(t)&&t.parent}function yw(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:o}=Node;let r=t;for(;null!=r&&r!==n;){const{nodeType:t,nodeName:n}=r;if(t===i&&(e.includes(n)||e.includes(r)))return r;const{host:s}=r;r=s&&t===o?s:r.parentNode}return null}function bw(t,e,n){const i=[];let o=t;for(;o&&(o=yw(o,e,n),o&&(!n||n.contains(o)));)i.push(o),o=o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o.parentNode;const r=i.length;return r?i[r-1]:null}function Cw(t,e){let n=t.parentNode,i=[];for("string"==typeof e?i=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);null!==n;){if(i.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Sw(t,e,n){const i=n.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function Rw(t){return t&&t.length?t.filter((t=>!!t)):[]}function Ew(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],i=[];return i.push(...t.filter((t=>{const i=t instanceof RegExp;return i&&e&&n.push(t),!i}))),e?{regexFree:i,regexes:n}:i}function Tw(t,e){return void 0!==t.classList&&"string"==typeof e&&""!==e&&t.classList.contains(e)}function Mw(t,e){"string"==typeof e&&(e=e.split(" ")),(e=Rw(e)).length>0&&t.classList.add(...e)}function xw(t,e){"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:i}=Ew(e,!0);n=Rw(n),n.length>0&&t.classList.remove(...n),i.forEach((e=>{t.classList.forEach((n=>{e.test(n)&&t.classList.remove(n)}))}))}function Hw(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach((e=>{Array.isArray(e)&&""!==e[0]&&t.setAttribute(...e)}))}function kw(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:i}=Ew(e,!0);n.forEach((e=>{""!==e&&t.removeAttribute(e)})),i.forEach((e=>{t.getAttributeNames().forEach((n=>{e.test(n)&&t.removeAttribute(n)}))}))}function Iw(t){if(3===t.nodeType)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let t=e.length-1;t>=0;t--)Iw(e[t])}}function Ow(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const Aw=/(<(.*)>|&(.*);)/;function _w(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Aw.test(e)?t.innerHTML=n?rw(e):e:Pw(t,e)}function Pw(t,e){const n=t.firstChild;n&&3===n.nodeType&&null===n.nextSibling?n.textContent=e:(Ow(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Nw(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let i=t;for(;i!==e;){if(null===i)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(i.host){if(i.host.impl)return Nw(i.host.impl);if(i.host)return Nw(i.host);throw new Error("Lost in Web Components world")}return!1}if("none"===n.getComputedStyle(i).display)return!1;i=i.parentNode}return!0}function Dw(t){const e=t.ownerDocument,n=e.defaultView,i=e.documentElement;let o,r,s,l=t;for(o=l.offsetLeft,r=l.offsetTop,s=l;(l=l.offsetParent)&&l!==e.body&&"offsetLeft"in l;)o+=l.offsetLeft,r+=l.offsetTop,s=l;return s&&"fixed"===s.style.position&&(o+=n.pageXOffset||i.scrollLeft,r+=n.pageYOffset||i.scrollTop),{left:o,top:r}}function Lw(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollY}function Vw(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollX}function Fw(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?Lw(e):t.scrollTop}function Ww(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?Vw(e):t.scrollLeft}function jw(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const i=["auto","scroll"];let o=t.parentNode;for(;o&&o.style&&e.body!==o;){let{overflow:t,overflowX:e,overflowY:r}=o.style;if([t,e,r].includes("scroll"))return o;if(({overflow:t,overflowX:e,overflowY:r}=n.getComputedStyle(o)),i.includes(t)||i.includes(e)||i.includes(r))return o;if(o.clientHeight<=o.scrollHeight+1&&(i.includes(r)||i.includes(t)))return o;if(o.clientWidth<=o.scrollWidth+1&&(i.includes(e)||i.includes(t)))return o;o=o.parentNode}return n}function Bw(t){const e=t.ownerDocument,n=e.defaultView;let i=t.parentNode;for(;i&&i.style&&e.body!==i;){if("visible"!==i.style.overflow&&""!==i.style.overflow)return i;const t=n.getComputedStyle(i),e=["scroll","hidden","auto"],o=t.getPropertyValue("overflow"),r=t.getPropertyValue("overflow-y"),s=t.getPropertyValue("overflow-x");if(e.includes(o)||e.includes(r)||e.includes(s))return i;i=i.parentNode}return n}function zw(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!t)return;if(t===n)return"width"===e?`${n.innerWidth}px`:"height"===e?`${n.innerHeight}px`:void 0;const i=t.style[e];if(""!==i&&void 0!==i)return i;const o=n.getComputedStyle(t);return""!==o[e]&&void 0!==o[e]?o[e]:void 0}function Uw(t){return t.offsetWidth}function Yw(t){return t.offsetHeight}function $w(t){return t.clientHeight||t.innerHeight}function Gw(t){return t.clientWidth||t.innerWidth}function Kw(t){return t.selectionStart?t.selectionStart:0}function Xw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function qw(t,e,n){if(void 0===n&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch(i){const o=t.parentNode,r=o.style.display;o.style.display="block",t.setSelectionRange(e,n),o.style.display=r}}}let Zw;function Qw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===Zw&&(Zw=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const i=e.offsetWidth;n.style.overflow="scroll";let o=e.offsetWidth;return i===o&&(o=n.clientWidth),(t.body||t.documentElement).removeChild(n),i-o}(t)),Zw}function Jw(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function tv(t){t.style.transform&&""!==t.style.transform&&(t.style.transform="")}function ev(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function nv(t){return ev(t)&&!1===t.hasAttribute("data-hot-input")}function iv(t){return!t.parentNode}function ov(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=t.ownerDocument,o=i.createRange(),r=i.defaultView.getSelection();Hw(t,"contenteditable",!0),n&&Hw(t,"aria-hidden","true"),e&&Mw(t,"invisibleSelection"),o.selectNodeContents(t),r.removeAllRanges(),r.addRange(o)}function rv(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&xw(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function sv(t){return"function"==typeof t}function lv(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=null;return function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return i&&clearTimeout(i),i=setTimeout((()=>{e=t.apply(this,r)}),n),e}}function av(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return function(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return t.apply(this,n.concat(i))}}function hv(t,e,n,i,o,r,s,l){return jp(l)?t.call(e,n,i,o,r,s,l):jp(s)?t.call(e,n,i,o,r,s):jp(r)?t.call(e,n,i,o,r):jp(o)?t.call(e,n,i,o):jp(i)?t.call(e,n,i):jp(n)?t.call(e,n):t.call(e)}var cv=_r,uv=st,dv=$,gv=Zo,fv=B([].push),mv=yo,pv=ut,wv=Eo,vv=I,yv=B,bv=T,Cv=st,Sv=Ot,Rv=bc,Ev=function(t){if(uv(t))return t;if(cv(t)){for(var e=t.length,n=[],i=0;i<e;i++){var o=t[i];"string"==typeof o?fv(n,o):"number"!=typeof o&&"Number"!==dv(o)&&"String"!==dv(o)||fv(n,gv(o))}var r=n.length,s=!0;return function(t,e){if(s)return s=!1,e;if(cv(this))return e;for(var i=0;i<r;i++)if(n[i]===t)return e}}},Tv=Tt,Mv=String,xv=pv("JSON","stringify"),Hv=yv(/./.exec),kv=yv("".charAt),Iv=yv("".charCodeAt),Ov=yv("".replace),Av=yv(1..toString),_v=/[\uD800-\uDFFF]/g,Pv=/^[\uD800-\uDBFF]$/,Nv=/^[\uDC00-\uDFFF]$/,Dv=!Tv||bv((function(){var t=pv("Symbol")("stringify detection");return"[null]"!==xv([t])||"{}"!==xv({a:t})||"{}"!==xv(Object(t))})),Lv=bv((function(){return'"\\udf06\\ud834"'!==xv("\udf06\ud834")||'"\\udead"'!==xv("\udead")})),Vv=function(t,e){var n=Rv(arguments),i=Ev(e);if(Cv(i)||void 0!==t&&!Sv(t))return n[1]=function(t,e){if(Cv(i)&&(e=vv(i,this,Mv(t),e)),!Sv(e))return e},wv(xv,null,n)},Fv=function(t,e,n){var i=kv(n,e-1),o=kv(n,e+1);return Hv(Pv,t)&&!Hv(Nv,o)||Hv(Nv,t)&&!Hv(Pv,i)?"\\u"+Av(Iv(t,0),16):t};function Wv(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},qv(t,((t,n)=>{"__children"!==n&&(t&&"object"==typeof t&&!Array.isArray(t)?e[n]=Wv(t):Array.isArray(t)?t.length&&"object"==typeof t[0]&&!Array.isArray(t[0])?e[n]=[Wv(t[0])]:e[n]=[]:e[n]=null)}))),e}function jv(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Bv(t,e,n){const i=Array.isArray(n);return qv(e,((e,o)=>{(!1===i||n.includes(o))&&(t[o]=e)})),t}function zv(t,e){qv(e,((n,i)=>{e[i]&&"object"==typeof e[i]?(t[i]||(Array.isArray(e[i])?t[i]=[]:"[object Date]"===Object.prototype.toString.call(e[i])?t[i]=e[i]:t[i]={}),zv(t[i],e[i])):t[i]=e[i]}))}function Uv(t){return"object"==typeof t?JSON.parse(JSON.stringify(t)):t}function Yv(t){const e={};return qv(t,((t,n)=>{e[n]=t})),e}function $v(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Np(n,(e=>{t.MIXINS.push(e.MIXIN_NAME),qv(e,((e,n)=>{if(void 0!==t.prototype[n])throw new Error(`Mixin conflict. Property '${n}' already exist and cannot be overwritten.`);if("function"==typeof e)t.prototype[n]=e;else{const i=function(t,e){const n=`_${t}`;return function(){return void 0===this[n]&&(this[n]=(t=>{let e=t;return(Array.isArray(e)||Kv(e))&&(e=Uv(e)),e})(e)),this[n]}},o=function(t){const e=`_${t}`;return function(t){this[e]=t}};Object.defineProperty(t.prototype,n,{get:i(n,e),set:o(n),configurable:!0})}}))})),t}function Gv(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Kv(t){return"[object Object]"===Object.prototype.toString.call(t)}function Xv(t,e,n,i){i.value=n,i.writable=!1!==i.writable,i.enumerable=!1!==i.enumerable,i.configurable=!1!==i.configurable,Object.defineProperty(t,e,i)}function qv(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&!1===e(t[n],n,t))break;return t}function Zv(t,e,n){const i=e.split(".");let o=t;i.forEach(((t,e)=>{e!==i.length-1?(ty(o,t)||(o[t]={}),o=o[t]):o[t]=n}))}function Qv(t){if(!Kv(t))return 0;const e=function(t){let n=0;return Kv(t)?qv(t,((t,i)=>{"__children"!==i&&(n+=e(t))})):n+=1,n};return e(t)}function Jv(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const n=`_${e}`,i={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[n]},set(t){this._touched=!0,this[n]=t},enumerable:!0,configurable:!0}),i}function ty(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ey(t){return window.requestAnimationFrame(t)}function ny(t){window.cancelAnimationFrame(t)}function iy(){return"ontouchstart"in window}let oy;xv&&mv({target:"JSON",stat:!0,arity:3,forced:Dv||Lv},{stringify:function(t,e,n){var i=Rv(arguments),o=wv(Dv?Vv:xv,null,i);return Lv&&"string"==typeof o?Ov(o,_v,Fv):o}});const ry=t=>{const e={value:!1,test:(n,i)=>{e.value=t(n,i)}};return e},sy={chrome:ry(((t,e)=>/Chrome/.test(t)&&/Google/.test(e))),chromeWebKit:ry((t=>/CriOS/.test(t))),edge:ry((t=>/Edge/.test(t))),edgeWebKit:ry((t=>/EdgiOS/.test(t))),firefox:ry((t=>/Firefox/.test(t))),firefoxWebKit:ry((t=>/FxiOS/.test(t))),mobile:ry((t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t))),safari:ry(((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e)))},ly={mac:ry((t=>/^Mac/.test(t))),win:ry((t=>/^Win/.test(t))),linux:ry((t=>/^Linux/.test(t))),ios:ry((t=>/iPhone|iPad|iPod/i.test(t)))};function ay(){return sy.chrome.value}function hy(){return sy.firefox.value}function cy(){return sy.safari.value}function uy(){return sy.mobile.value}function dy(){return ly.ios.value}function gy(){let{maxTouchPoints:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return t>2&&ly.mac.value}function fy(){return ly.win.value}function my(){return ly.mac.value}"undefined"!=typeof window&&(function(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};qv(sy,(n=>{let{test:i}=n;i(t,e)}))}(),function(){let{platform:t=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};qv(ly,(e=>{let{test:n}=e;n(t)}))}());const py={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:hy()?182:174,AUDIO_MUTE:hy()?181:173,AUDIO_UP:hy()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},wy=[py.ALT,py.ARROW_DOWN,py.ARROW_LEFT,py.ARROW_RIGHT,py.ARROW_UP,py.AUDIO_DOWN,py.AUDIO_MUTE,py.AUDIO_UP,py.BACKSPACE,py.CAPS_LOCK,py.DELETE,py.END,py.ENTER,py.ESCAPE,py.F1,py.F2,py.F3,py.F4,py.F5,py.F6,py.F7,py.F8,py.F9,py.F10,py.F11,py.F12,py.F13,py.F14,py.F15,py.F16,py.F17,py.F18,py.F19,py.HOME,py.INSERT,py.MEDIA_NEXT,py.MEDIA_PLAY_PAUSE,py.MEDIA_PREV,py.MEDIA_STOP,py.NULL,py.NUM_LOCK,py.PAGE_DOWN,py.PAGE_UP,py.PAUSE,py.SCROLL_LOCK,py.SHIFT,py.TAB];function vy(t){return wy.includes(t)}function yy(t,e){const n=e.split("|");let i=!1;return Np(n,(e=>{if(t===py[e])return i=!0,!1})),i}function by(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Cy(t){return!1===t.isImmediatePropagationEnabled}function Sy(t){return 2===t.button}function Ry(t){return 0===t.button}function Ey(){jp(console)}function Ty(){jp(console)}const My=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],xy=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Hy=new Map([[]]);var ky=ki,Iy=R,Oy=Ce,Ay=ba,_y=Ge.f,Py=Oy("unscopables"),Ny=Array.prototype;void 0===Ny[Py]&&_y(Ny,Py,{configurable:!0,value:Ay(null)});var Dy=function(t){Ny[Py][t]=!0},Ly=yo,Vy=Lt,Fy=ot,Wy=function(t,e,n){for(var i=0,o=arguments.length>2?n:ky(e),r=new t(o);o>i;)r[i]=e[i++];return r},jy=Dy,By=Array,zy=B(function(t,e){var n=Iy[t],i=n&&n.prototype;return i&&i[e]}("Array","sort"));Ly({target:"Array",proto:!0},{toSorted:function(t){void 0!==t&&Vy(t);var e=Fy(this),n=Wy(By,e);return zy(n,t)}}),jy("toSorted");var Uy=rc,Yy=Lt,$y=Qe,Gy=us;function Ky(t,e,n){Xy(t,e),e.set(t,n)}function Xy(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qy(t,e,n){return t.set(Qy(t,e),n),n}function Zy(t,e){return t.get(Qy(t,e))}function Qy(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}yo({target:"Iterator",proto:!0,real:!0},{find:function(t){$y(this),Yy(t);var e=Gy(this),n=0;return Uy(e,(function(e,i){if(t(e,n++))return i(e)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}});var Jy=new WeakMap,tb=new WeakMap,eb=new WeakMap,nb=new WeakSet;class ib{constructor(){var t,e;Xy(t=this,e=nb),e.add(t),Ky(this,Jy,new Map),Ky(this,tb,new Map),Ky(this,eb,new Set),My.forEach((t=>Qy(nb,this,ob).call(this,t)))}getHooks(t){var e;return null!==(e=Zy(Jy,this).get(t))&&void 0!==e?e:[]}add(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Zy(Jy,this).has(t)||(Qy(nb,this,ob).call(this,t),My.push(t));const i=Zy(Jy,this).get(t);if(i.find((t=>t.callback===e)))return;const o=Number.isInteger(n.orderIndex)?n.orderIndex:0,r=!!n.runOnce,s=!!n.initialHook;let l=!1;if(s){const t=i.find((t=>t.initialHook));t&&(t.callback=e,l=!0)}if(!l){i.push({callback:e,orderIndex:o,runOnce:r,initialHook:s,skip:!1});let n=Zy(eb,this).has(t);n||0===o||(n=!0,Zy(eb,this).add(t)),n&&i.length>1&&Zy(Jy,this).set(t,i.toSorted(((t,e)=>t.orderIndex-e.orderIndex)))}}has(t){return Zy(Jy,this).has(t)&&Zy(Jy,this).get(t).length>0}remove(t,e){if(!Zy(Jy,this).has(t))return!1;const n=Zy(Jy,this).get(t),i=n.find((t=>t.callback===e));if(i){let e=Zy(tb,this).get(t);return i.skip=!0,e+=1,e>100&&(Zy(Jy,this).set(t,n.filter((t=>!t.skip))),e=0),Zy(tb,this).set(t,e),!0}return!1}destroy(){Zy(Jy,this).clear(),Zy(tb,this).clear(),qy(Jy,this,null),qy(tb,this,null)}}function ob(t){Zy(Jy,this).set(t,[]),Zy(tb,this).set(t,0)}function rb(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const sb=Fp`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class lb{constructor(){rb(this,"globalBucket",new ib)}static getSingleton(){return ab}getBucket(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=new ib),t.pluginHookBucket):this.globalBucket}add(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(e)?Np(e,(e=>this.add(t,e,n))):(xy.has(t)&&Ey(iw(sb,{hookName:t,removedInVersion:xy.get(t)})),Hy.has(t)&&Ey(Hy.get(t)),this.getBucket(n).add(t,e,{orderIndex:i,runOnce:!1})),this}once(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(e)?Np(e,(e=>this.once(t,e,n))):this.getBucket(n).add(t,e,{orderIndex:i,runOnce:!0}),this}addAsFixed(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.isArray(e)?Np(e,(e=>this.addAsFixed(t,e,n))):this.getBucket(n).add(t,e,{initialHook:!0}),this}remove(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.getBucket(n).remove(t,e)}has(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getBucket(e).has(t)}run(t,e,n,i,o,r,s,l){{const a=this.getBucket().getHooks(e),h=a?a.length:0;let c=0;if(h)for(;c<h;){if(!a[c]||a[c].skip){c+=1;continue}const h=hv(a[c].callback,t,n,i,o,r,s,l);void 0!==h&&(n=h),a[c]&&a[c].runOnce&&this.remove(e,a[c].callback),c+=1}}{const a=this.getBucket(t).getHooks(e),h=a?a.length:0;let c=0;if(h)for(;c<h;){if(!a[c]||a[c].skip){c+=1;continue}const h=hv(a[c].callback,t,n,i,o,r,s,l);void 0!==h&&(n=h),a[c]&&a[c].runOnce&&this.remove(e,a[c].callback,t),c+=1}}return n}destroy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getBucket(t).destroy()}register(t){this.isRegistered(t)||My.push(t)}deregister(t){this.isRegistered(t)&&My.splice(My.indexOf(t),1)}isDeprecated(t){return Hy.has(t)||xy.has(t)}isRegistered(t){return My.indexOf(t)>=0}getRegistered(){return My}}const ab=new lb;const hb=new Map;function cb(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";hb.has(t)||hb.set(t,new Map);const e=hb.get(t);return{register:function(t,n){e.set(t,n)},getItem:function(t){return e.get(t)},hasItem:function(t){return e.has(t)},getNames:function(){return[...e.keys()]},getValues:function(){return[...e.values()]}}}const ub=new WeakMap,{register:db,getItem:gb,hasItem:fb,getNames:mb,getValues:pb}=cb("editors");function wb(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(t){return t.guid in e||(e[t.guid]=new n(t)),e[t.guid]},lb.getSingleton().add("afterDestroy",(function(){e[this.guid]=null}))}function vb(t,e){let n;if("function"==typeof t)ub.get(t)||bb(null,t),n=ub.get(t);else{if("string"!=typeof t)throw Error('Only strings and functions can be passed as "editor" parameter');n=gb(t)}if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function yb(t){if("function"==typeof t)return t;if(!fb(t))throw Error(`No registered editor found under "${t}" name`);return gb(t).getConstructor()}function bb(t,e){t&&"string"!=typeof t&&(t=(e=t).EDITOR_TYPE);const n=new wb(e);"string"==typeof t&&db(t,n),ub.set(e,n)}function Cb(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const Sb=class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Cb(this,"context",void 0),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function o(t){n.call(this,function(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),by(this)},t}(t))}return this.context.eventListeners.push({element:t,event:e,callback:n,callbackProxy:o,options:i,eventManager:this}),t.addEventListener(e,o,i),()=>{this.removeEventListener(t,e,n)}}removeEventListener(t,e,n){let i,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.context.eventListeners.length;for(;r;)if(r-=1,i=this.context.eventListeners[r],i.event===e&&i.element===t){if(n&&n!==i.callback)continue;if(o&&i.eventManager!==this)continue;this.context.eventListeners.splice(r,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options)}}clearEvents(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let e=this.context.eventListeners.length;for(;e;){e-=1;const n=this.context.eventListeners[e];t&&n.eventManager!==this||(this.context.eventListeners.splice(e,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(t,e){let n=t.document,i=t;n||(n=t.ownerDocument?t.ownerDocument:t,i=n.defaultView);const o={bubbles:!0,cancelable:"mousemove"!==e,view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let r;n.createEvent?(r=n.createEvent("MouseEvents"),r.initMouseEvent(e,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,n.body.parentNode)):r=n.createEventObject(),t.dispatchEvent?t.dispatchEvent(r):t.fireEvent(`on${e}`,r)}};function Rb(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function Eb(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tb(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mb=new WeakSet;class xb{constructor(t,e,n){Rb(this,Mb),Eb(this,"hot",void 0),Eb(this,"tableMeta",void 0),Eb(this,"selection",void 0),Eb(this,"eventManager",void 0),Eb(this,"destroyed",!1),Eb(this,"activeEditor",void 0),Eb(this,"cellProperties",void 0),this.hot=t,this.tableMeta=e,this.selection=n,this.eventManager=new Sb(t),this.hot.addHook("afterDocumentKeyDown",(t=>Tb(Mb,this,Hb).call(this,t))),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",(t=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",t)})),this.hot.view._wt.update("onCellDblClick",((t,e,n)=>Tb(Mb,this,kb).call(this,t,e,n)))}getActiveEditor(){return this.activeEditor}prepareEditor(){var t;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,(t=>{t&&this.prepareEditor()}));const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!e||e.isHeader())return;const{row:n,col:i}=e,o=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let r=n,s=i;if(Array.isArray(o)&&([r,s]=o),this.cellProperties=this.hot.getCellMeta(r,s),!this.isCellEditable())return void this.clearActiveEditor();const l=this.hot.getCell(n,i,!0);if(l){const t=this.hot.getCellEditor(this.cellProperties),e=this.hot.colToProp(s),o=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r),s);this.activeEditor=vb(t,this.hot),this.activeEditor.prepare(n,i,e,l,o,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable())return void this.clearActiveEditor();const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,t,e,n);e instanceof MouseEvent&&"boolean"!=typeof o&&(o=0===this.hot.selection.getLayerLevel()&&i.isSingle()),!1!==o?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))):this.clearActiveEditor()}closeEditor(t,e,n){this.activeEditor?this.activeEditor.finishEditing(t,e,n):n&&n(!1)}closeEditorAndSaveChanges(t){this.closeEditor(!1,t)}closeEditorAndRestoreOriginalValue(t){this.closeEditor(!0,t)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const t=this.hot.getSelectedRangeLast();if(!t)return!1;const e=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=t.highlight,{rowIndexMapper:o,columnIndexMapper:r}=this.hot,s=o.isHidden(this.hot.toPhysicalRow(n))||r.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!e||s)}moveSelectionAfterEnter(t){const e=a({},"function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(t):this.tableMeta.enterMoves);t.shiftKey&&(e.row=-e.row,e.col=-e.col),this.hot.selection.isMultiple()?this.selection.transformFocus(e.row,e.col):this.selection.transformStart(e.row,e.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function Hb(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Cy(t))return;const{keyCode:n}=t,i=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&(vy(n)||function(t){return[py.CONTROL,py.COMMAND_LEFT,py.COMMAND_RIGHT,py.COMMAND_FIREFOX].includes(t)}(n)||i||this.isEditorOpened()||this.openEditor("",t))}function kb(t,e){e.isCell()&&this.openEditor(null,t,!0)}const Ib=new WeakMap;xb.getInstance=function(t,e,n){let i=Ib.get(t);return i||(i=new xb(t,e,n),Ib.set(t,i)),i};const Ob=xb;function Ab(t,e,n){_b(t,e),e.set(t,n)}function _b(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pb(t,e){return t.get(Db(t,e))}function Nb(t,e,n){return t.set(Db(t,e),n),n}function Db(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Lb=Object.freeze({CELL:"cell",MIXED:"mixed"});var Vb=new WeakMap,Fb=new WeakMap,Wb=new WeakMap,jb=new WeakMap,Bb=new WeakMap,zb=new WeakSet;class Ub{constructor(t){var e,n,i=this;_b(e=this,n=zb),n.add(e),Ab(this,Vb,void 0),Ab(this,Fb,void 0),Ab(this,Wb,1),Ab(this,jb,null),Ab(this,Bb,new Map);const o=t.getSettings();Nb(Vb,this,t),Nb(Fb,this,o.imeFastEdit?Lb.MIXED:Lb.CELL),Pb(Vb,this).addHook("afterUpdateSettings",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Db(zb,i,Kb).call(i,...e)})),Pb(Vb,this).addHook("afterSelection",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Db(zb,i,$b).call(i,...e)})),Pb(Vb,this).addHook("afterSelectionFocusSet",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Db(zb,i,$b).call(i,...e)})),Pb(Vb,this).addHook("afterSelectionEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Db(zb,i,Gb).call(i,...e)}))}getFocusMode(){return Pb(Fb,this)}setFocusMode(t){Object.values(Lb).includes(t)?Nb(Fb,this,t):Ey(`"${t}" is not a valid focus mode.`)}getRefocusDelay(){return Pb(Wb,this)}setRefocusDelay(t){Nb(Wb,this,t)}setRefocusElementGetter(t){Nb(jb,this,t)}getRefocusElement(){var t;return"function"==typeof Pb(jb,this)?Pb(jb,this).call(this):null===(t=Pb(Vb,this).getActiveEditor())||void 0===t?void 0:t.TEXTAREA}focusOnHighlightedCell(t){const e=t=>{var e,n;const i=null===(e=Pb(Vb,this).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!i)return;let o=Pb(Vb,this).runHooks("modifyFocusedElement",i.row,i.col,t);o instanceof HTMLElement||(o=t),!o||null!==(n=Pb(Vb,this).getActiveEditor())&&void 0!==n&&n.isOpened()||o.focus({preventScroll:!0})};t?e(t):Db(zb,this,Yb).call(this,(t=>e(t)))}refocusToEditorTextarea(){var t;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pb(Wb,this);!Pb(Vb,this).getSettings().imeFastEdit||null!==(t=Pb(Vb,this).getActiveEditor())&&void 0!==t&&t.isOpened()||(Pb(Bb,this).has(e)||Pb(Bb,this).set(e,lv((()=>{var t;null===(t=this.getRefocusElement())||void 0===t||t.select()}),e)),Pb(Bb,this).get(e)())}}function Yb(t){var e;const n=null===(e=Pb(Vb,this).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!n||!Pb(Vb,this).selection.isCellVisible(n))return void t(null);const i=Pb(Vb,this).getCell(n.row,n.col,!0);null===i?Pb(Vb,this).addHookOnce("afterScroll",(()=>{t(Pb(Vb,this).getCell(n.row,n.col,!0))})):t(i)}function $b(){Db(zb,this,Yb).call(this,(t=>{const{activeElement:e}=Pb(Vb,this).rootDocument;e&&nv(e)&&e.blur(),this.focusOnHighlightedCell(t)}))}function Gb(){Db(zb,this,Yb).call(this,(t=>{this.getFocusMode()===Lb.MIXED&&"TD"===t.nodeName&&this.refocusToEditorTextarea()}))}function Kb(t){"boolean"==typeof t.imeFastEdit&&this.setFocusMode(t.imeFastEdit?Lb.MIXED:Lb.CELL)}var Xb=at,qb=$,Zb=Ce("match"),Qb=Qe,Jb=I,tC=le,eC=dt,nC=function(){var t=Qb(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},iC=RegExp.prototype,oC=B,rC=oe,sC=Math.floor,lC=oC("".charAt),aC=oC("".replace),hC=oC("".slice),cC=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,uC=/\$([$&'`]|\d{1,2})/g,dC=yo,gC=I,fC=B,mC=et,pC=st,wC=Q,vC=function(t){var e;return Xb(t)&&(void 0!==(e=t[Zb])?!!e:"RegExp"===qb(t))},yC=Zo,bC=Wt,CC=function(t){var e=t.flags;return void 0!==e||"flags"in iC||tC(t,"flags")||!eC(iC,t)?e:Jb(nC,t)},SC=function(t,e,n,i,o,r){var s=n+t.length,l=i.length,a=uC;return void 0!==o&&(o=rC(o),a=cC),aC(r,a,(function(r,a){var h;switch(lC(a,0)){case"$":return"$";case"&":return t;case"`":return hC(e,0,n);case"'":return hC(e,s);case"<":h=o[hC(a,1,-1)];break;default:var c=+a;if(0===c)return r;if(c>l){var u=sC(c/10);return 0===u?r:u<=l?void 0===i[u-1]?lC(a,1):i[u-1]+lC(a,1):r}h=i[c-1]}return void 0===h?"":h}))},RC=Ce("replace"),EC=TypeError,TC=fC("".indexOf);fC("".replace);var MC=fC("".slice),xC=Math.max;dC({target:"String",proto:!0},{replaceAll:function(t,e){var n,i,o,r,s,l,a,h,c,u=mC(this),d=0,g="";if(!wC(t)){if(vC(t)&&(n=yC(mC(CC(t))),!~TC(n,"g")))throw new EC("`.replaceAll` does not allow non-global regexes");if(i=bC(t,RC))return gC(i,t,u,e)}for(o=yC(u),r=yC(t),(s=pC(e))||(e=yC(e)),l=r.length,a=xC(1,l),h=TC(o,r);-1!==h;)c=s?yC(e(r,h,o)):SC(r,o,h,[],void 0,e),g+=MC(o,d,h)+c,d=h+l,h=h+a>o.length?-1:TC(o,r,h+a);return d<o.length&&(g+=MC(o,d)),g}});var HC=rc,kC=Lt,IC=Qe,OC=us,AC=TypeError;yo({target:"Iterator",proto:!0,real:!0},{reduce:function(t){IC(this),kC(t);var e=OC(this),n=arguments.length<2,i=n?void 0:arguments[1],o=0;if(HC(e,(function(e){n?(n=!1,i=e):i=t(i,e,o),o++}),{IS_RECORD:!0}),n)throw new AC("Reduce of empty iterator with no initial value");return i}});const _C={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},PC=new RegExp(Object.keys(_C).map((t=>`(${t})`)).join("|"),"gi");function NC(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),i=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],o=t.getData(...i),r=o.length,s=r>0?o[0].length:0,l=["<table>","</table>"],a=e?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],c=n?1:0,u=e?1:0;for(let d=0;d<r;d+=1){const i=e&&0===d,r=[];for(let e=0;e<s;e+=1){const s=!i&&n&&0===e;let l="";if(i)l=`<th>${t.getColHeader(e-c)}</th>`;else if(s)l=`<th>${t.getRowHeader(d-u)}</th>`;else{const n=o[d][e],{hidden:i,rowspan:r,colspan:s}=t.getCellMeta(d-u,e-c);if(!i){const t=[];if(r&&t.push(`rowspan="${r}"`),s&&t.push(`colspan="${s}"`),zp(n))l=`<td ${t.join(" ")}></td>`;else{const e=n.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");l=`<td ${t.join(" ")}>${e}</td>`}}}r.push(l)}const l=["<tr>",...r,"</tr>"].join("");i?a.splice(1,0,l):h.splice(-1,0,l)}return l.splice(1,0,a.join(""),h.join("")),l.join("")}function DC(t){const e=t.length,n=["<table>"];for(let i=0;i<e;i+=1){const o=t[i],r=o.length,s=[];0===i&&n.push("<tbody>");for(let t=0;t<r;t+=1){const e=o[t],n=zp(e)?"":e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`)).replace(/\t/gi,"&#9;");s.push(`<td>${n}</td>`)}n.push("<tr>",...s,"</tr>"),i+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function LC(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=typeof t;if("number"===n)return!isNaN(t)&&isFinite(t);if("string"===n){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map((t=>`\\${t}`)).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}return"object"===n&&!(!t||"number"!=typeof t.valueOf()||t instanceof Date)}function VC(t,e,n){let i=-1;for("function"==typeof e?(n=e,e=t):i=t-1;++i<=e&&!1!==n(i););}function FC(t,e,n){let i=t+1;for("function"==typeof e&&(n=e,e=0);--i>=e&&!1!==n(i););}function WC(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function jC(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const BC="asc",zC=new Map([[BC,[-1,1]],["desc",[1,-1]]]),UC=t=>`The priority '${t}' is already declared in a map.`,YC=t=>`The priority '${t}' is not a number.`;const $C=t=>`The id '${t}' is already declared in a map.`;function GC(){let{errorIdExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Map;function n(){return[...e]}function i(t){return e.has(t)}return t=sv(t)?t:$C,{addItem:function(n,o){if(i(n))throw new Error(t(n));e.set(n,o)},clear:function(){e.clear()},getId:function(t){const[e]=n().find((e=>{let[n,i]=e;return t===i&&n}))||[null];return e},getItem:function(t){return e.get(t)},getItems:n,hasItem:i,removeItem:function(t){return e.delete(t)}}}const KC=t=>`'${t}' value is already declared in a unique set.`;const XC=t=>`There is already registered "${t}" plugin.`,qC=function(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=new Map;return t=sv(t)?t:UC,e=sv(e)?e:YC,{addItem:function(i,o){if(!LC(i))throw new Error(e(i));if(n.has(i))throw new Error(t(i));n.set(i,o)},getItems:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:BC;const[e,i]=zC.get(t)||zC.get(BC);return[...n].sort(((t,n)=>t[0]<n[0]?e:i)).map((t=>t[1]))}}}({errorPriorityExists:t=>`There is already registered plugin on priority "${t}".`,errorPriorityNaN:t=>`The priority "${t}" is not a number.`}),ZC=function(){let{errorItemExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=new Set;return t=sv(t)?t:KC,{addItem:function(n){if(e.has(n))throw new Error(t(n));e.add(n)},clear:function(){e.clear()},getItems:function(){return[...e]}}}({errorItemExists:XC}),QC=GC({errorIdExists:XC});function JC(){return[...qC.getItems(),...ZC.getItems()]}function tS(t){const e=tw(t);return QC.getItem(e)}function eS(t,e,n){[t,e,n]=function(t,e,n){"function"==typeof t&&(t=(e=t).PLUGIN_KEY,n=e.PLUGIN_PRIORITY);return[t,e,n]}(t,e,n),void 0===tS(t)&&function(t,e,n){const i=tw(t);if(QC.hasItem(i))throw new Error(XC(i));void 0===n?ZC.addItem(i):qC.addItem(n,i);QC.addItem(i,e)}(t,e,n)}const{register:nS,getItem:iS,hasItem:oS,getNames:rS,getValues:sS}=cb("renderers");function lS(t){if("function"==typeof t)return t;if(!oS(t))throw Error(`No registered renderer found under "${t}" name`);return iS(t)}function aS(t,e){"string"!=typeof t&&(t=(e=t).RENDERER_TYPE),nS(t,e)}const{register:hS,getItem:cS,hasItem:uS,getNames:dS,getValues:gS}=cb("validators");function fS(t,e){"string"!=typeof t&&(t=(e=t).VALIDATOR_TYPE),hS(t,e)}var mS=oe,pS=ki,wS=Si,vS=Dy;yo({target:"Array",proto:!0},{at:function(t){var e=mS(this),n=pS(e),i=wS(t),o=i>=0?i:n+i;return o<0||o>=n?void 0:e[o]}}),vS("at");var yS=yo,bS=et,CS=Si,SS=Zo,RS=T,ES=B("".charAt);function TS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}yS({target:"String",proto:!0,forced:RS((function(){return"\ud842"!=="ð ®·".at(-2)}))},{at:function(t){var e=SS(bS(this)),n=e.length,i=CS(t),o=i>=0?i:n+i;return o<0||o>=n?void 0:ES(e,o)}});class MS{constructor(){TS(this,"count",0),TS(this,"startColumn",null),TS(this,"endColumn",null),TS(this,"startPosition",null),TS(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:r}=e;n>=i&&n+r<=i+(i>0?o+1:o)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=t),this.endColumn=t)}finalize(t){var e;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:r,totalColumns:s,needReverse:l,startPositions:a,columnWidth:h}=t;if(this.endColumn===s-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const t=a[this.endColumn]+h-a[this.startColumn-1];if(t<=i&&(this.startColumn-=1),t>=i)break}this.startPosition=null!==(e=a[this.startColumn])&&void 0!==e?e:null;const c=n+i-(r>0?i+1:i),u=null===this.startColumn?0:t.getColumnWidth(this.startColumn);c<-1*o||n>a.at(-1)||-1*n-i>-1*u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function xS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class HS{constructor(){xS(this,"count",0),xS(this,"startRow",null),xS(this,"endRow",null),xS(this,"startPosition",null),xS(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:r}=e;n>=i&&n+r<=o&&(null===this.startRow&&(this.startRow=t),this.endRow=t)}finalize(t){var e;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:r,needReverse:s,startPositions:l,rowHeight:a}=t;if(this.endRow===r-1&&s)for(this.startRow=this.endRow;this.startRow>0;){const t=l[this.endRow]+a-l[this.startRow-1];if(t<=i-o&&(this.startRow-=1),t>=i-o)break}this.startPosition=null!==(e=l[this.startRow])&&void 0!==e?e:null;n+i-o<(null===this.startRow?0:t.getRowHeight(this.startRow))||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function kS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class IS{constructor(){kS(this,"count",0),kS(this,"startColumn",null),kS(this,"endColumn",null),kS(this,"startPosition",null),kS(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o}=e;n<=i&&(this.startColumn=t);n>=i&&n<=i+(i>0?o+1:o)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=t)),this.endColumn=t}finalize(t){var e;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:r,totalColumns:s,needReverse:l,startPositions:a,columnWidth:h}=t;if(this.endColumn===s-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const t=a[this.endColumn]+h-a[this.startColumn-1];if(this.startColumn-=1,t>i)break}this.startPosition=null!==(e=a[this.startColumn])&&void 0!==e?e:null;n+i-(r>0?i+1:i)<-1*o||n>a.at(-1)+h||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function OS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class AS{constructor(){OS(this,"count",0),OS(this,"startRow",null),OS(this,"endRow",null),OS(this,"startPosition",null),OS(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o}=e;n<=i&&(this.startRow=t),n>=i&&n<=o&&null===this.startRow&&(this.startRow=t),this.endRow=t}finalize(t){var e;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:r,needReverse:s,startPositions:l,rowHeight:a}=t;if(this.endRow===r-1&&s)for(this.startRow=this.endRow;this.startRow>0;){const t=l[this.endRow]+a-l[this.startRow-1];if(this.startRow-=1,t>=i-o)break}this.startPosition=null!==(e=l[this.startRow])&&void 0!==e?e:null;n+i-o<0||n>l.at(-1)+a?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function _S(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class PS{constructor(){_S(this,"count",0),_S(this,"startColumn",0),_S(this,"endColumn",0),_S(this,"startPosition",0),_S(this,"isVisibleInTrimmingContainer",!0)}initialize(t){let{totalColumns:e}=t;this.count=e,this.endColumn=this.count-1}process(){}finalize(){}}function NS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class DS{constructor(){NS(this,"count",0),NS(this,"startRow",0),NS(this,"endRow",0),NS(this,"startPosition",0),NS(this,"isVisibleInTrimmingContainer",!0)}initialize(t){let{totalRows:e}=t;this.count=e,this.endRow=this.count-1}process(){}finalize(){}}function LS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class VS extends IS{constructor(){super(...arguments),LS(this,"columnStartOffset",0),LS(this,"columnEndOffset",0)}finalize(t){var e;super.finalize(t);const{overrideFn:n,totalColumns:i,startPositions:o}=t;if(null!==this.startColumn&&"function"==typeof n){const t=this.startColumn,e=this.endColumn;n(this),this.columnStartOffset=t-this.startColumn,this.columnEndOffset=this.endColumn-e}this.startColumn<0&&(this.startColumn=0),this.startPosition=null!==(e=o[this.startColumn])&&void 0!==e?e:null,i<this.endColumn&&(this.endColumn=i-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function FS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class WS extends AS{constructor(){super(...arguments),FS(this,"rowStartOffset",0),FS(this,"rowEndOffset",0)}finalize(t){var e;super.finalize(t);const{overrideFn:n,totalRows:i,startPositions:o}=t;if(null!==this.startRow&&"function"==typeof n){const t=this.startRow,e=this.endRow;n(this),this.rowStartOffset=t-this.startRow,this.rowEndOffset=this.endRow-e}this.startRow<0&&(this.startRow=0),this.startPosition=null!==(e=o[this.startRow])&&void 0!==e?e:null,i<this.endRow&&(this.endRow=i-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function jS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class BS{constructor(t){jS(this,"calculationTypes",[]),jS(this,"calculationResults",new Map),this.calculationTypes=t}_initialize(t){this.calculationTypes.forEach((e=>{let[n,i]=e;this.calculationResults.set(n,i),i.initialize(t)}))}_process(t,e){this.calculationTypes.forEach((n=>{let[,i]=n;return i.process(t,e)}))}_finalize(t){this.calculationTypes.forEach((e=>{let[,n]=e;return n.finalize(t)}))}getResultsFor(t){return this.calculationResults.get(t)}}function zS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const US=50;class YS extends BS{constructor(t){let{calculationTypes:e,viewportWidth:n,scrollOffset:i,totalColumns:o,columnWidthFn:r,overrideFn:s,inlineStartOffset:l}=t;super(e),zS(this,"viewportWidth",0),zS(this,"scrollOffset",0),zS(this,"zeroBasedScrollOffset",0),zS(this,"totalColumns",0),zS(this,"columnWidthFn",null),zS(this,"columnWidth",0),zS(this,"overrideFn",null),zS(this,"inlineStartOffset",0),zS(this,"totalCalculatedWidth",0),zS(this,"startPositions",[]),zS(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=r,this.overrideFn=s,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let t=0;t<this.totalColumns;t++)if(this.columnWidth=this.getColumnWidth(t),this._process(t,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(t){const e=this.columnWidthFn(t);return isNaN(e)?US:e}}function $S(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class GS extends BS{constructor(t){let{calculationTypes:e,viewportHeight:n,scrollOffset:i,totalRows:o,defaultRowHeight:r,rowHeightFn:s,overrideFn:l,horizontalScrollbarHeight:a}=t;super(e),$S(this,"viewportHeight",0),$S(this,"scrollOffset",0),$S(this,"zeroBasedScrollOffset",0),$S(this,"totalRows",0),$S(this,"rowHeightFn",null),$S(this,"rowHeight",0),$S(this,"overrideFn",null),$S(this,"horizontalScrollbarHeight",0),$S(this,"innerViewportHeight",0),$S(this,"totalCalculatedHeight",0),$S(this,"startPositions",[]),$S(this,"needReverse",!0),this.defaultHeight=r,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=s,this.overrideFn=l,this.horizontalScrollbarHeight=null!=a?a:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let t=0;t<this.totalRows;t++)if(this.rowHeight=this.getRowHeight(t),this._process(t,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(t){const e=this.rowHeightFn(t);return isNaN(e)?this.defaultHeight:e}}function KS(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function XS(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qS(t,e){return t.get(QS(t,e))}function ZS(t,e,n){return t.set(QS(t,e),n),n}function QS(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var JS=new WeakMap;class tR{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];XS(this,"row",null),XS(this,"col",null),KS(this,JS,!1),ZS(JS,this,n),void 0!==t&&void 0!==e&&(this.row=t,this.col=e)}isValid(t){const{countRows:e,countCols:n,countRowHeaders:i,countColHeaders:o}=a({countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0},t);return!(!Number.isInteger(this.row)||!Number.isInteger(this.col))&&(!(this.row<-o||this.col<-i)&&!(this.row>=e||this.col>=n))}isEqual(t){return t===this||this.row===t.row&&this.col===t.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return qS(JS,this)}isSouthEastOf(t){return this.row>=t.row&&(qS(JS,this)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&(qS(JS,this)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&(qS(JS,this)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&(qS(JS,this)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(t){return Number.isInteger(null==t?void 0:t.row)&&(this.row=t.row),Number.isInteger(null==t?void 0:t.col)&&(this.col=t.col),t instanceof tR&&ZS(JS,this,t.isRtl()),this}clone(){return new tR(this.row,this.col,qS(JS,this))}toObject(){return{row:this.row,col:this.col}}}const eR=tR;function nR(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function iR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oR(t,e){return t.get(rR(t,e))}function rR(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sR=new WeakMap;class lR{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];var o,r,s;iR(this,"highlight",null),iR(this,"from",null),iR(this,"to",null),nR(this,sR,!1),this.highlight=t.clone(),this.from=e.clone(),this.to=n.clone(),r=this,s=i,(o=sR).set(rR(o,r),s)}setHighlight(t){return this.highlight=t.clone(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!(!this.from.isHeader()||!this.to.isHeader())||(this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0)}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){const{row:e,col:n}=t,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=e&&o.row>=e&&i.col<=n&&o.col>=n}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopEndCorner().col>=t.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=t.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=t.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=t.getOuterTopStartCorner().col}isOverlappingVertically(t){return this.getOuterBottomStartCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=t.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=t.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=t.getOuterTopRightCorner().row}expand(t){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>n.row||t.col>n.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(n.row,t.row),Math.max(n.col,t.col)),!0)}expandByRange(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.includesRange(t)||!this.overlaps(t))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),r=t.getOuterTopStartCorner(),s=t.getOuterBottomEndCorner(),l=Math.min(n.row,r.row),a=Math.min(n.col,r.col),h=Math.max(i.row,s.row),c=Math.max(i.col,s.col),u=this._createCellCoords(l,a),d=this._createCellCoords(h,c);return this.from=u,this.to=d,this.setDirection(o),e&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return oR(sR,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return oR(sR,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return oR(sR,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return oR(sR,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return oR(sR,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return oR(sR,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return oR(sR,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return oR(sR,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t){return t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(t){return t instanceof eR&&(t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(t){if(!this.includesRange(t))return[];const e=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),i=Math.min(this.from.col,this.to.col),o=Math.max(this.from.col,this.to.col),r=Math.min(t.from.row,t.to.row),s=Math.max(t.from.row,t.to.row),l=Math.min(t.from.col,t.to.col),a=Math.max(t.from.col,t.to.col),h=[];return e===r&&h.push("top"),o===a&&h.push(oR(sR,this)?"left":"right"),n===s&&h.push("bottom"),i===l&&h.push(oR(sR,this)?"right":"left"),h}getInner(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[];for(let i=t.row;i<=e.row;i++)for(let o=t.col;o<=e.col;o++)this.from.row===i&&this.from.col===o||this.to.row===i&&this.to.col===o||n.push(this._createCellCoords(i,o));return n}getAll(){const t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),n=[];for(let i=t.row;i<=e.row;i++)for(let o=t.col;o<=e.col;o++)t.row===i&&t.col===o?n.push(t):e.row===i&&e.col===o?n.push(e):n.push(this._createCellCoords(i,o));return n}forAll(t){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++){if(!1===t(i,o))return}}clone(){return new lR(this.highlight,this.from,this.to,oR(sR,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,e){return new eR(t,e,oR(sR,this))}}const aR=lR;function hR(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function cR(t,e){return t.get(dR(t,e))}function uR(t,e,n){return t.set(dR(t,e),n),n}function dR(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gR=new WeakMap,fR=new WeakMap,mR=new WeakMap,pR=new WeakMap,wR=new WeakMap,vR=new WeakMap,yR=new WeakMap,bR=new WeakMap,CR=new WeakMap,SR=new WeakMap;const RR=class{constructor(t,e,n,i,o,r){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;hR(this,gR,void 0),hR(this,fR,void 0),hR(this,mR,void 0),hR(this,pR,void 0),hR(this,wR,void 0),hR(this,vR,void 0),hR(this,yR,void 0),hR(this,bR,void 0),hR(this,CR,[null,null]),hR(this,SR,[null,null]),uR(gR,this,n),uR(fR,this,e),uR(mR,this,o),uR(pR,this,r),uR(wR,this,s),uR(vR,this,i),uR(yR,this,t),this.registerEvents()}registerEvents(){cR(vR,this).addEventListener(cR(mR,this).holder,"contextmenu",(t=>this.onContextMenu(t))),cR(vR,this).addEventListener(cR(mR,this).TABLE,"mouseover",(t=>this.onMouseOver(t))),cR(vR,this).addEventListener(cR(mR,this).TABLE,"mouseout",(t=>this.onMouseOut(t)));const t=()=>{cR(vR,this).addEventListener(cR(mR,this).holder,"touchstart",(t=>this.onTouchStart(t))),cR(vR,this).addEventListener(cR(mR,this).holder,"touchend",(t=>this.onTouchEnd(t))),this.momentumScrolling||(this.momentumScrolling={}),cR(vR,this).addEventListener(cR(mR,this).holder,"scroll",(()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||cR(gR,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout((()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,cR(gR,this).getSetting("onAfterMomentumScroll"))}),200)}))},e=()=>{cR(vR,this).addEventListener(cR(mR,this).holder,"mouseup",(t=>this.onMouseUp(t))),cR(vR,this).addEventListener(cR(mR,this).holder,"mousedown",(t=>this.onMouseDown(t)))};uy()?t():(iy()&&t(),e())}selectedCellWasTouched(t){const e=this.parentCell(t).coords;if(cR(bR,this)&&e){const[t,n]=[e.row,cR(bR,this).from.row],[i,o]=[e.col,cR(bR,this).from.col];return t===n&&i===o}return!1}parentCell(t){const e={},n=bw(t,["TD","TH"],cR(mR,this).TABLE);return n?(e.coords=cR(mR,this).getCoords(n),e.TD=n):Tw(t,"wtBorder")&&Tw(t,"current")?(e.coords=cR(pR,this).getFocusSelection().cellRange.highlight,e.TD=cR(mR,this).getCell(e.coords)):Tw(t,"wtBorder")&&Tw(t,"area")&&cR(pR,this).getAreaSelection().cellRange&&(e.coords=cR(pR,this).getAreaSelection().cellRange.to,e.TD=cR(mR,this).getCell(e.coords)),e}onMouseDown(t){const e=cR(fR,this).rootDocument.activeElement,n=av(ww,t.target),i=t.target;if(!["TD","TH"].includes(e.nodeName)&&(i===e||n(0)===e||n(1)===e))return;const o=this.parentCell(i);Tw(i,"corner")?cR(gR,this).getSetting("onCellCornerMouseDown",t,i):o.TD&&cR(gR,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,o.coords,o.TD),(0===t.button||this.touchApplied)&&o.TD&&(cR(SR,this)[0]=o.TD,clearTimeout(cR(CR,this)[0]),cR(CR,this)[0]=setTimeout((()=>{cR(SR,this)[0]=null}),1e3))}onContextMenu(t){if(cR(gR,this).has("onCellContextMenu")){const e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}onMouseOver(t){if(!cR(gR,this).has("onCellMouseOver"))return;const e=cR(mR,this).TABLE,n=bw(t.target,["TD","TH"],e),i=cR(wR,this)||this;n&&n!==i.lastMouseOver&&Cw(n,e)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",t,cR(mR,this).getCoords(n),n))}onMouseOut(t){if(!cR(gR,this).has("onCellMouseOut"))return;const e=cR(mR,this).TABLE,n=bw(t.target,["TD","TH"],e),i=bw(t.relatedTarget,["TD","TH"],e),o=cR(wR,this)||this;n&&n!==i&&Cw(n,e)&&(this.callListener("onCellMouseOut",t,cR(mR,this).getCoords(n),n),null===i&&(o.lastMouseOver=null))}onMouseUp(t){const e=this.parentCell(t.target);e.TD&&cR(gR,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,e.coords,e.TD),(0===t.button||this.touchApplied)&&(e.TD===cR(SR,this)[0]&&e.TD===cR(SR,this)[1]?(Tw(t.target,"corner")?this.callListener("onCellCornerDblClick",t,e.coords,e.TD):this.callListener("onCellDblClick",t,e.coords,e.TD),cR(SR,this)[0]=null,cR(SR,this)[1]=null):e.TD===cR(SR,this)[0]&&(cR(SR,this)[1]=e.TD,clearTimeout(cR(CR,this)[1]),cR(CR,this)[1]=setTimeout((()=>{cR(SR,this)[1]=null}),500)))}onTouchStart(t){uR(bR,this,cR(pR,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(t)}onTouchEnd(t){var e;const n=t.target,i=null===(e=this.parentCell(n))||void 0===e?void 0:e.coords,o=jp(i)&&i.row>=0&&i.col>=0;if(t.cancelable&&o&&cR(gR,this).getSetting("isDataViewInstance")){const e=["A","BUTTON","INPUT"];dy()&&(sy.chromeWebKit.value||sy.firefoxWebKit.value)&&this.selectedCellWasTouched(n)&&!e.includes(n.tagName)?t.preventDefault():this.selectedCellWasTouched(n)||t.preventDefault()}this.onMouseUp(t),this.touchApplied=!1}callListener(t,e,n,i){const o=cR(gR,this).getSettingPure(t);o&&o(e,n,i,cR(yR,this).call(this))}destroy(){clearTimeout(cR(CR,this)[0]),clearTimeout(cR(CR,this)[1]),cR(vR,this).destroy()}};function ER(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const TR=class{constructor(t,e,n){ER(this,"offset",void 0),ER(this,"total",void 0),ER(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=n}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleRowHeadedColumnToSourceColumn(t){return this.renderedToSource(this.offsettedTH(t))}sourceColumnToVisibleRowHeadedColumn(t){return this.unOffsettedTH(this.sourceToRendered(t))}};function MR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const xR=class{constructor(t,e,n){MR(this,"offset",void 0),MR(this,"total",void 0),MR(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=n}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleColHeadedRowToSourceRow(t){return this.renderedToSource(this.offsettedTH(t))}sourceRowToVisibleColHeadedRow(t){return this.unOffsettedTH(this.sourceToRendered(t))}};function HR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class kR{constructor(){HR(this,"currentSize",0),HR(this,"nextSize",0),HR(this,"currentOffset",0),HR(this,"nextOffset",0)}setSize(t){this.currentSize=this.nextSize,this.nextSize=t}setOffset(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}function IR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class OR{constructor(){IR(this,"size",new kR),IR(this,"workingSpace",0),IR(this,"sharedSize",null)}setSize(t){this.size.setSize(t)}setOffset(t){this.size.setOffset(t)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof kR}isPlaceOn(t){return this.workingSpace===t}append(t){this.workingSpace=1,t.workingSpace=2,this.sharedSize=t.getViewSize()}prepend(t){this.workingSpace=2,t.workingSpace=1,this.sharedSize=t.getViewSize()}}function AR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class _R{constructor(t,e,n){AR(this,"rootNode",void 0),AR(this,"nodesPool",void 0),AR(this,"sizeSet",new OR),AR(this,"childNodeType",void 0),AR(this,"visualIndex",0),AR(this,"collectedNodes",[]),this.rootNode=t,this.nodesPool=e,this.childNodeType=n.toUpperCase()}setSize(t){return this.sizeSet.setSize(t),this}setOffset(t){return this.sizeSet.setOffset(t),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}getCurrentNode(){const t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}getRenderedChildCount(){const{rootNode:t,sizeSet:e}=this;let n=0;if(this.isSharedViewSet()){let i=t.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)n+=1;else if(e.isPlaceOn(1))break;i=i.nextElementSibling}}else n=t.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:t,sizeSet:e}=this,n=this.isSharedViewSet(),{nextSize:i}=e.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const i=this.nodesPool();!n||n&&e.isPlaceOn(2)?t.appendChild(i):t.insertBefore(i,t.firstChild),o+=1}const r=n&&e.isPlaceOn(1);for(;o>i;)t.removeChild(r?t.firstChild:t.lastChild),o-=1}render(){const{rootNode:t,sizeSet:e}=this;let n=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(2)&&(n+=e.sharedSize.nextSize);let i=t.childNodes[n];if(i.tagName!==this.childNodeType){const e=this.nodesPool();t.replaceChild(e,i),i=e}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class PR extends _R{prependView(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}appendView(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}function NR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class DR{constructor(t){NR(this,"nodeType",void 0),this.nodeType=t.toUpperCase()}setRootDocument(t){this.rootDocument=t}obtain(){return this.rootDocument.createElement(this.nodeType)}}function LR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class VR{constructor(t,e){LR(this,"nodesPool",null),LR(this,"nodeType",void 0),LR(this,"rootNode",void 0),LR(this,"table",null),LR(this,"renderedNodes",0),this.nodesPool="string"==typeof t?new DR(t):null,this.nodeType=t,this.rootNode=e}setTable(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}adjust(){}render(){}}function FR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class WR extends VR{constructor(){super("TH"),FR(this,"orderViews",new WeakMap),FR(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new PR(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,rowHeaderFunctions:e,rowHeadersCount:n,rows:i,cells:o}=this.table;for(let r=0;r<t;r++){const t=this.table.renderedRowToSource(r),s=i.getRenderedNode(r);this.sourceRowIndex=t;const l=this.obtainOrderView(s),a=o.obtainOrderView(s);l.appendView(a).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let i=0;i<n;i++){l.render();const n=l.getCurrentNode();n.className="",n.removeAttribute("style"),kw(n,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Hw(n,[["role","rowheader"],["scope","row"],dw(i+1),sw(-1)]),e[i](t,n,i)}l.end()}}}class jR extends VR{constructor(t){super(null,t)}adjust(){const{columnHeadersCount:t,rowHeadersCount:e}=this.table;let n=this.rootNode.firstChild;if(t){const{columnsToRender:i}=this.table,o=i+e;for(let e=0,s=t;e<s;e++){for(n=this.rootNode.childNodes[e],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}const r=this.rootNode.childNodes.length;if(r>t)for(let e=t;e<r;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Ow(n)}render(){const{columnHeadersCount:t}=this.table;this.table.isAriaEnabled()&&Hw(this.rootNode,[["role","rowgroup"]]);for(let e=0;e<t;e+=1){const{columnHeaderFunctions:t,columnsToRender:n,rowHeadersCount:i}=this.table,o=this.rootNode.childNodes[e];this.table.isAriaEnabled()&&Hw(o,[["role","row"],uw(e+1)]);for(let r=-1*i;r<n;r+=1){const n=this.table.renderedColumnToSource(r),s=o.childNodes[r+i];s.className="",s.removeAttribute("style"),kw(s,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Hw(s,[dw(r+1+this.table.rowHeadersCount),sw(-1),["role","columnheader"],...r>=0?[["scope","col"]]:[["role","row"]]]),t[e](n,s,e)}}}}let BR=!1;class zR extends VR{constructor(t){super(null,t)}adjust(){const{columnsToRender:t,rowHeadersCount:e}=this.table,n=t+e;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:t,rowHeadersCount:e}=this.table;!BR&&t>1e3&&(BR=!0,Ey(Fp`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<e;i++){const t=this.table.renderedColumnToSource(i),e=this.table.columnUtils.getHeaderWidth(t);this.rootNode.childNodes[i].style.width=`${e}px`}for(let i=0;i<t;i++){const t=this.table.renderedColumnToSource(i),n=this.table.columnUtils.getWidth(t);this.rootNode.childNodes[i+e].style.width=`${n}px`}const n=this.rootNode.firstChild;n&&Mw(n,"rowHeader")}}function UR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const YR="ht__row_even",$R="ht__row_odd";let GR=!1;class KR extends VR{constructor(t){super("TR",t),UR(this,"orderView",void 0),this.orderView=new _R(t,(t=>this.nodesPool.obtain(t)),this.nodeType)}getRenderedNode(t){return this.orderView.getNode(t)}render(){const{rowsToRender:t}=this.table;!GR&&t>1e3&&(GR=!0,Ey(Fp`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Hw(this.rootNode,[["role","rowgroup"]]),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<t;i++){this.orderView.render();const t=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(i);var e,n;if(this.table.isAriaEnabled())Hw(t,[["role","row"],uw(o+(null!==(e=null===(n=this.table.rowUtils)||void 0===n||null===(n=n.dataAccessObject)||void 0===n?void 0:n.columnHeaders.length)&&void 0!==e?e:0)+1)]);xw(t,[YR,$R]),Mw(t,(o+1)%2==0?YR:$R)}this.orderView.end()}}function XR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class qR extends VR{constructor(){super("TD"),XR(this,"orderViews",new WeakMap),XR(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new PR(t,(t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.nodeType),this.orderViews.set(t,e)),e}render(){const{rowsToRender:t,columnsToRender:e,rows:n,rowHeaders:i}=this.table;for(let s=0;s<t;s++){const t=this.table.renderedRowToSource(s),l=n.getRenderedNode(s);this.sourceRowIndex=t;const a=this.obtainOrderView(l),h=i.obtainOrderView(l);a.prependView(h).setSize(e).setOffset(this.table.renderedColumnToSource(0)).start();for(let n=0;n<e;n++){a.render();const e=a.getCurrentNode(),i=this.table.renderedColumnToSource(n);var o,r;if(Tw(e,"hide")||(e.className=""),e.removeAttribute("style"),e.removeAttribute("dir"),kw(e,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(t,i,e),this.table.isAriaEnabled())Hw(e,[...e.hasAttribute("role")?[]:[["role","gridcell"]],sw(-1),dw(i+(null!==(o=null===(r=this.table.rowUtils)||void 0===r||null===(r=r.dataAccessObject)||void 0===r?void 0:r.rowHeaders.length)&&void 0!==o?o:0)+1)])}a.end()}}}function ZR(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class QR{constructor(t){let{cellRenderer:e,stylesHandler:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ZR(this,"rootNode",void 0),ZR(this,"rootDocument",void 0),ZR(this,"rowHeaders",null),ZR(this,"columnHeaders",null),ZR(this,"colGroup",null),ZR(this,"rows",null),ZR(this,"cells",null),ZR(this,"rowFilter",null),ZR(this,"columnFilter",null),ZR(this,"rowUtils",null),ZR(this,"columnUtils",null),ZR(this,"rowsToRender",0),ZR(this,"columnsToRender",0),ZR(this,"rowHeaderFunctions",[]),ZR(this,"rowHeadersCount",0),ZR(this,"columnHeaderFunctions",[]),ZR(this,"columnHeadersCount",0),ZR(this,"cellRenderer",void 0),ZR(this,"activeOverlayName",void 0),ZR(this,"stylesHandler",void 0),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=e,this.stylesHandler=n}setActiveOverlayName(t){this.activeOverlayName=t}setAxisUtils(t,e){this.rowUtils=t,this.columnUtils=e}setViewportSize(t,e){this.rowsToRender=t,this.columnsToRender=e}setFilters(t,e){this.rowFilter=t,this.columnFilter=e}setHeaderContentRenderers(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}setRenderers(){let{rowHeaders:t,columnHeaders:e,colGroup:n,rows:i,cells:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setTable(this),e.setTable(this),n.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=t,this.columnHeaders=e,this.colGroup=n,this.rows=i,this.cells=o}renderedRowToSource(t){return this.rowFilter.renderedToSource(t)}renderedColumnToSource(t){return this.columnFilter.renderedToSource(t)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:t,rows:e}=this;for(let n=0;n<t;n++){const t=e.getRenderedNode(n),i=this.rowUtils;if(t.firstChild){const e=this.renderedRowToSource(n),o=i.getHeightByOverlayName(e,this.activeOverlayName),r=this.stylesHandler.areCellsBorderBox()?0:1;t.firstChild.style.height=o?o-r+"px":""}}}}class JR{constructor(){let{TABLE:t,THEAD:e,COLGROUP:n,TBODY:i,rowUtils:o,columnUtils:r,cellRenderer:s,stylesHandler:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new QR(t,{cellRenderer:s,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new WR,columnHeaders:new jR(e),colGroup:new zR(n),rows:new KR(i),cells:new qR}),this.renderer.setAxisUtils(o,r)}setActiveOverlayName(t){return this.renderer.setActiveOverlayName(t),this}setFilters(t,e){return this.renderer.setFilters(t,e),this}setViewportSize(t,e){return this.renderer.setViewportSize(t,e),this}setHeaderContentRenderers(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function tE(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class eE{constructor(t,e){tE(this,"dataAccessObject",void 0),tE(this,"wtSettings",void 0),tE(this,"headerWidths",new Map),this.dataAccessObject=t,this.wtSettings=e}getWidth(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(t){let e=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==n&&(e=e?Math.max(e,n):n),e}getHeaderWidth(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}calculateWidths(){const{wtSettings:t}=this;let e=t.getSetting("rowHeaderWidth");if(e=t.getSetting("onModifyRowHeaderWidth",e),null!=e){const n=t.getSetting("rowHeaders").length,i=t.getSetting("defaultColumnWidth");for(let t=0;t<n;t++){let n=Array.isArray(e)?e[t]:e;n=null==n?i:n,this.headerWidths.set(t,n)}}}}function nE(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class iE{constructor(t,e){nE(this,"dataAccessObject",void 0),nE(this,"wtSettings",void 0),this.dataAccessObject=t,this.wtSettings=e}getHeight(t){let e=this.wtSettings.getSetting("rowHeight",t);const n=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==n&&(e=void 0===e?n:Math.max(e,n)),e}getHeightByOverlayName(t,e){let n=this.wtSettings.getSetting("rowHeightByOverlayName",t,e);const i=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==i&&(n=void 0===n?i:Math.max(n,i)),n}}function oE(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const rE=class{constructor(t,e,n,i,o){oE(this,"wtSettings",null),oE(this,"domBindings",void 0),oE(this,"TBODY",null),oE(this,"THEAD",null),oE(this,"COLGROUP",null),oE(this,"hasTableHeight",!0),oE(this,"hasTableWidth",!0),oE(this,"isTableVisible",!1),oE(this,"tableOffset",0),oE(this,"holderOffset",0),this.domBindings=n,this.isMaster="master"===o,this.name=o,this.dataAccessObject=t,this.facadeGetter=e,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,Iw(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const r=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(()=>this._modifyRowHeaderWidth(r))),this.rowUtils=new iE(this.dataAccessObject,this.wtSettings),this.columnUtils=new eE(this.dataAccessObject,this.wtSettings),this.tableRenderer=new JR({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(t){return this.name===t}fixTableDomTree(){const t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(t){const e=t.parentNode;let n;return e&&e.nodeType===Node.ELEMENT_NODE&&Tw(e,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",e&&e.insertBefore(n,t),n.appendChild(t)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Hw(n,[["role","presentation"]]),n}createHider(t){const e=t.parentNode;let n;return e&&e.nodeType===Node.ELEMENT_NODE&&Tw(e,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",e&&e.insertBefore(n,t),n.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&Hw(n,[["role","presentation"]]),n}createHolder(t){const e=t.parentNode;let n;return e&&e.nodeType===Node.ELEMENT_NODE&&Tw(e,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",e&&e.insertBefore(n,t),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Hw(n.parentNode,[["role","presentation"]])),n.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&Hw(n,[["role","presentation"]]),n}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:e}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,o=e.getSetting("totalRows"),r=e.getSetting("totalColumns"),s=e.getSetting("rowHeaders"),l=s.length,a=e.getSetting("columnHeaders"),h=a.length;let c=t;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Dw(this.holder),c=i.createCalculators(c),l&&!e.getSetting("fixedColumnsStart"))){const t=n.inlineStartOverlay.getScrollPosition(),e=this.correctHeaderWidth;this.correctHeaderWidth=0!==t,e!==this.correctHeaderWidth&&(c=!1)}if(c)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Dw(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const t=o>0?this.getFirstRenderedRow():0,e=r>0?this.getFirstRenderedColumn():0;this.rowFilter=new xR(t,o,h),this.columnFilter=new TR(e,r,l);let c=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const t={};this.wtSettings.getSetting("beforeDraw",!0,t),c=!0!==t.skipRender}c&&(this.tableRenderer.setHeaderContentRenderers(s,a),(this.is(gE)||this.is(pE))&&this.tableRenderer.setHeaderContentRenderers(s,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(gE))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(gE)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let u=!1;return this.isMaster&&(u=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(u=n.bottomOverlay.resetFixedPosition()||u),u=n.inlineStartOverlay.resetFixedPosition()||u,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),u?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(c),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(t){const e=this.columnFilter.renderedToSource(t);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,r,s;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,o=this.getColumnHeaderHeight(n),r=this.getColumnHeader(e,n),r&&(s=$w(r),(!o&&i<s||o<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=s),Array.isArray(l)?null!==l[n]&&void 0!==l[n]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:t}=this,e=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders;for(let i=0,o=t.getSetting("columnHeaders").length;i<o;i++)if(n[i]){if(!e[i]||0===e[i].childNodes.length)return;e[i].childNodes[0].style.height=`${n[i]}px`}}resetOversizedRows(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject;if((this.isMaster||this.is(gE))&&!t.getSetting("externalRowCalculator")){const t=this.getRenderedRowsCount();for(let n=0;n<t;n++){const t=this.rowFilter.renderedToSource(n);e.oversizedRows&&e.oversizedRows[t]&&(e.oversizedRows[t]=void 0)}}}getCell(t){let e=t.row,n=t.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",e,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([e,n]=i),this.isRowBeforeRenderedRows(e))return-1;if(this.isRowAfterRenderedRows(e))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const o=this.getRow(e);if(!o&&e>=0)throw new Error("TR was expected to be rendered but is not");const r=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!r&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return r}getRow(t){let e=null,n=null;var i,o;t<0?(e=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceRowToVisibleColHeadedRow(t),n=this.THEAD):(e=null===(o=this.rowFilter)||void 0===o?void 0:o.sourceToRendered(t),n=this.TBODY);return void 0!==e&&void 0!==n&&(!(n.childNodes.length<e+1)&&n.childNodes[e])}getColumnHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.THEAD.childNodes[e];return null==n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}getColumnHeaders(t){const e=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach((t=>{const i=t.childNodes[n];i&&e.push(i)})),e}getRowHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e>=this.wtSettings.getSetting("rowHeaders").length)return;const n=this.rowFilter.sourceToRendered(t),i=n<0?this.rowFilter.sourceRowToVisibleColHeadedRow(t):n,o=(n<0?this.THEAD:this.TBODY).childNodes[i];return null==o?void 0:o.childNodes[e]}getRowHeaders(t){const e=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],o=null==n?void 0:n.childNodes[i];o&&e.push(o)}return e}getCoords(t){let e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=yw(e,["TD","TH"])),null===e)return null;const n=e.parentNode,i=n.parentNode;let o=function(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}(n),r=e.cellIndex;if(Sw(mE,e,this.wtRootElement)||Sw(dE,e,this.wtRootElement))"THEAD"===i.nodeName&&(o-=i.childNodes.length);else if(Sw(pE,e,this.wtRootElement)||Sw(gE,e,this.wtRootElement)){o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o}else o=i===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o);r=Sw(mE,e,this.wtRootElement)||Sw(fE,e,this.wtRootElement)||Sw(pE,e,this.wtRootElement)?this.columnFilter.offsettedTH(r):this.columnFilter.visibleRowHeadedColumnToSourceColumn(r);const s=this.wtSettings.getSetting("onModifyGetCoordsElement",o,r);return s&&Array.isArray(s)&&([o,r]=s),this.wot.createCellCoords(o,r)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let t=this.TBODY.childNodes.length;const e=t*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),n=$w(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),o=i?Yw:$w,r=i?0:1,s=i?1:0;let l,a,h,c,u;if(e!==n||this.wtSettings.getSetting("fixedRowsBottom"))for(;t;){t-=1,h=this.rowFilter.renderedToSource(t),l=this.getRowHeight(h),c=this.getTrForRow(h),u=c.querySelector("th");const e=0===h?s:0;a=u?o(u):o(c)-r,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<a-e||l<a)&&(i||(a+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=a)}}getTrForRow(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}isColumnHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(t)<=e}isRowHeaderRendered(t){if(t>=0)return!1;const e=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(t)<=e}isRowBeforeRenderedRows(t){const e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}isRowAfterRenderedRows(t){return t>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(t){const e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}isColumnAfterRenderedColumns(t){return this.columnFilter&&t>this.getLastRenderedColumn()}isColumnAfterViewport(t){return this.columnFilter&&t>this.getLastVisibleColumn()}isRowAfterViewport(t){return this.rowFilter&&t>this.getLastVisibleRow()}isColumnBeforeViewport(t){return this.columnFilter&&this.columnFilter.sourceToRendered(t)<0&&t>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(t){return this.rowUtils.getHeight(t)}getColumnHeaderHeight(t){return this.columnUtils.getHeaderHeight(t)}getColumnWidth(t){return this.columnUtils.getWidth(t)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Uw(this.TABLE)}getHeight(){return Yw(this.TABLE)}getTotalWidth(){const t=Uw(this.hider);return 0!==t?t:this.getWidth()}getTotalHeight(){const t=Yw(this.hider);return 0!==t?t:this.getHeight()}isVisible(){return Nw(this.TABLE)}_modifyRowHeaderWidth(t){let e=sv(t)?t():null;return Array.isArray(e)?(e=[...e],e[e.length-1]=this._correctRowHeaderWidth(e[e.length-1])):e=this._correctRowHeaderWidth(e),e}_correctRowHeaderWidth(t){let e=t;return"number"!=typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}},sE={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return 0===t||0===e?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};Xv(sE,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});const lE=sE,aE={getFirstRenderedColumn(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Xv(aE,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});const hE=aE;class cE extends rE{constructor(t,e,n,i){super(t,e,n,i,pE)}}$v(cE,lE),$v(cE,hE);const uE=cE,dE="top",gE="bottom",fE="inline_start",mE="top_inline_start_corner",pE="bottom_inline_start_corner",wE=[dE,gE,fE,mE,pE],vE=new Map([[dE,`ht_clone_${dE}`],[gE,`ht_clone_${gE}`],[fE,`ht_clone_${fE} ht_clone_left`],[mE,`ht_clone_${mE} ht_clone_top_left_corner`],[pE,`ht_clone_${pE} ht_clone_bottom_left_corner`]]);function yE(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function bE(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CE(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var SE=new WeakSet;function RE(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:i,wtViewport:o,totalColumns:r,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){let l=null;if(e.getSetting("rtlMode")){const t=i.TABLE.getBoundingClientRect(),e=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(t.right-e)}else{l=Dw(i.wtRootElement).left}const a=Math.abs(Ww(s,s));if(l>a){const e=Gw(s);let i=o.getRowHeaderWidth();for(let o=1;o<=r;o++)if(i+=n.sumCellSizes(o-1,o),l+i-a>=e){t=o-2;break}}}return t}function EE(t){const{topOverlay:e,wtTable:n,wtViewport:i,totalRows:o,rootWindow:r}=this.dataAccessObject;if(e.mainTableScrollableElement===r){const s=Dw(n.wtRootElement),l=Fw(r,r);if(s.top>l){const n=$w(r);let a=i.getColumnHeaderHeight();for(let i=1;i<=o;i++)if(a+=e.sumCellSizes(i-1,i),s.top+a-l>=n){t=i-2;break}}}return t}const TE=class{constructor(t){yE(this,SE),bE(this,"dataAccessObject",void 0),this.dataAccessObject=t}scrollViewport(t,e,n){if(t.col<0||t.row<0)return!1;const i=this.scrollViewportHorizontally(t.col,e),o=this.scrollViewportVertically(t.row,n);return i||o}scrollViewportHorizontally(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const o=Jv(e);if(t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",t,o),!Number.isInteger(t)||t<0||t>i)return!1;e=o.value;const{fixedColumnsStart:r,inlineStartOverlay:s}=this.dataAccessObject,l="auto"===e;if(l&&t<r)return!1;const a=this.getFirstVisibleColumn(),h=this.getLastVisibleColumn();let c=!1;return(l&&(t<a||t>h)||!l)&&(c=s.scrollTo(t,l?t>=this.getLastPartiallyVisibleColumn():"end"===e)),c}scrollViewportVertically(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const o=Jv(e);if(t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",t,o),!Number.isInteger(t)||t<0||t>i)return!1;e=o.value;const{fixedRowsBottom:r,fixedRowsTop:s,topOverlay:l}=this.dataAccessObject,a="auto"===e;if(a&&(t<s||t>i-r-1))return!1;const h=this.getFirstVisibleRow(),c=this.getLastVisibleRow();let u=!1;return(a&&(t<h||t>c)||!a)&&(u=l.scrollTo(t,a?t>=this.getLastPartiallyVisibleRow():"bottom"===e)),u}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return CE(SE,this,EE).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return CE(SE,this,EE).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return CE(SE,this,RE).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return CE(SE,this,RE).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function ME(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class xE{get eventManager(){return new Sb(this)}constructor(t,e){ME(this,"wtTable",void 0),ME(this,"wtScroll",void 0),ME(this,"wtViewport",void 0),ME(this,"wtOverlays",void 0),ME(this,"selectionManager",void 0),ME(this,"wtEvent",void 0),ME(this,"guid",`wt_${ew()}`),ME(this,"drawInterrupted",!1),ME(this,"drawn",!1),ME(this,"activeOverlayName","master"),ME(this,"domBindings",void 0),ME(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new TE(this.createScrollDao())}findOriginalHeaders(){const t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;e<n;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,n){Pw(n,t[e])}])}}createCellCoords(t,e){return new eR(t,e,this.wtSettings.getSetting("rtlMode"))}createCellRange(t,e,n){return new aR(t,e,n,this.wtSettings.getSetting("rtlMode"))}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}getCell(t){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(t);const e=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<n&&t.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<o&&t.row>=e-i){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else{if(t.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);if(t.row<e&&t.row>=e-i&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t)}return this.wtTable.getCell(t)}scrollViewport(t,e,n){return this.wtScroll.scrollViewport(t,e,n)}scrollViewportHorizontally(t,e){return this.wtScroll.scrollViewportHorizontally(t,e)}scrollViewportVertically(t,e){return this.wtScroll.scrollViewportVertically(t,e)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selectionManager(){return t.selectionManager},get stylesHandler(){return t.stylesHandler},get drawn(){return t.drawn},set drawn(e){t.drawn=e},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return t.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return t.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return t.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return t.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return t.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return t.wtSettings.getSetting("rowHeaders")}}}}function HE(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class kE extends xE{constructor(t,e,n){super(t,e),HE(this,"cloneSource",void 0),HE(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.stylesHandler=n.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new RR(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function IE(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class OE{constructor(t,e,n,i,o){IE(this,"wtSettings",null),Xv(this,"wot",t,{writable:!1}),this.domBindings=o,this.facadeGetter=e,this.wtSettings=i;const{TABLE:r,hider:s,spreader:l,holder:a,wtRootElement:h}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=r,this.hider=s,this.spreader=l,this.holder=a,this.wtRootElement=h,this.trimmingContainer=Bw(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(t){"before"===t&&this.shouldBeRendered()?this.needFullRender=!0:"after"!==t||this.shouldBeRendered()||(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Bw(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:t}=this.wot,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=jw(t.TABLE)}getRelativeCellPosition(t,e,n){if(!1===this.clone.wtTable.holder.contains(t))return void Ey(`The provided element is not a child of the ${this.type} overlay`);const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),r=e<this.wtSettings.getSetting("fixedRowsTop"),s=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,a={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(t),top:t.offsetTop};let c=null;return c=i?this.getRelativeCellPositionWithinWindow(r,o,h,a):this.getRelativeCellPositionWithinHolder(r,s,o,h,a),c}getRelativeStartPosition(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}getRelativeCellPositionWithinWindow(t,e,n,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let r=0,s=0;if(e){let t=o.left;this.isRtl()&&(t=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Qw())),r=t<=0?-1*t:0}else r=i.start;if(t){s=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top}else s=i.top;return{start:n.start+r,top:n.top+s}}getRelativeCellPositionWithinHolder(t,e,n,i,o){const r=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),s=this.wot.wtOverlays.topOverlay.getScrollPosition();let l=0,a=0;if(n||(l=r-o.start),e){const t=this.wot.wtTable.wtRootElement.getBoundingClientRect();a=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+t.top}else t||(a=s-o.top);return{start:i.start-l,top:i.top-a}}makeClone(){if(-1===wE.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:t,wtSettings:e}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=n.createElement("div"),r=n.createElement("table"),s=t.wtRootElement.parentNode;o.className=`${vE.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,e.getSetting("ariaTags")&&Hw(o,[["role","presentation"]]),r.className=t.TABLE.className;t.TABLE.getAttribute("role")&&r.setAttribute("role",t.TABLE.getAttribute("role")),o.appendChild(r),s.appendChild(o);const l=this.wtSettings.getSetting("preventOverflow");return!0===l||"horizontal"===l&&this.type===dE||"vertical"===l&&this.type===fE?this.mainTableScrollableElement=i:"hidden"===i.getComputedStyle(s).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=jw(t.TABLE),new kE(r,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needFullRender){const e=this.clone.cloneSource;e.activeOverlayName=this.clone.wtTable.name,this.clone.draw(t),e.activeOverlayName="master"}}reset(){const t=this.clone.wtTable.holder,e=this.clone.wtTable.hider;[t.style,e.style,t.parentNode.style].forEach((t=>{t.width="",t.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class AE extends OE{constructor(t,e,n,i,o,r){super(t,e,pE,n,i),this.bottomOverlay=o,this.inlineStartOverlay=r}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new uE(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:t}=this;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const t=this.inlineStartOverlay.getOverlayOffset(),n=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]=`${t}px`,e.style.bottom=`${n}px`}else tv(e),this.repositionOverlay();let n=Yw(this.clone.wtTable.TABLE);const i=Uw(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;e.hasVerticalScroll()||(o+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(o+=Qw(n)),i.style.bottom=`${o}px`}}const _E={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return null===t?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return null===t?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Xv(_E,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});const PE=_E;class NE extends rE{constructor(t,e,n,i){super(t,e,n,i,gE)}}$v(NE,lE),$v(NE,PE);const DE=NE;function LE(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class VE extends OE{constructor(t,e,n,i){super(t,e,gE,n,i),LE(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new DE(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,e=this.clone.wtTable.holder.parentNode;e.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||i&&"vertical"===i?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),e.style.bottom=`${n}px`);const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;e.hasVerticalScroll()||(o+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(o+=Qw(n)),i.style.bottom=`${o}px`}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let n=!1;return this.mainTableScrollableElement===e?(e.scrollTo(Vw(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const{wtTable:n,stylesHandler:i}=this.wot,o=i.getDefaultRowHeight();let r=t,s=0;for(;r<e;){const t=n.getRowHeight(r);s+=void 0===t?o:t,r+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,r=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||"horizontal"===r){let i=e.getWorkspaceWidth();e.hasVerticalScroll()&&(i-=Qw(n)),i=Math.min(i,t.wtRootElement.scrollWidth),o.width=`${i}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let s=Yw(this.clone.wtTable.TABLE);t.hasDefinedSize()||(s=0),o.height=`${s}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let n=this.getTableParentOffset();const i=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;e&&i.offsetHeight!==i.clientHeight&&(o=Qw(this.domBindings.rootDocument)),e?(n+=this.sumCellSizes(0,t+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),n+=o,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Fw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight(),e=t-this.clone.wtTable.getTotalHeight(),i=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-i+t,0),n>e&&(n=0)}return n}adjustHeaderBordersPosition(t){const e=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==e,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((n||0===e)&&i.length>0){const e=this.wot.wtTable.holder.parentNode,n=Tw(e,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?(Mw(e,"innerBorderBottom"),o=!n):(xw(e,"innerBorderBottom"),o=n)}return o}}const FE={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return null===t?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return null===t?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Xv(FE,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});const WE=FE;class jE extends rE{constructor(t,e,n,i){super(t,e,n,i,fE)}}$v(jE,WE),$v(jE,hE);const BE=jE,zE={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,i,o,r,s){if(this._localHooks[t]){const l=this._localHooks[t].length;for(let a=0;a<l;a++)hv(this._localHooks[t][a],this,e,n,i,o,r,s)}},clearLocalHooks(){return this._localHooks={},this}};Xv(zE,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});const UE=zE;let YE=class{constructor(t,e){this.settings=t,this.cellRange=e||null}isEmpty(){return null===this.cellRange}add(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}replace(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}destroy(){this.runLocalHooks("destroy")}};$v(YE,UE);const $E=YE,GE="active-header",KE="header",XE="area",qE="focus",ZE=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),i=e.getCSSVariableValue("cell-autofill-border-width"),o=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:i,borderStyle:"solid",borderColor:o})};function QE(t,e,n){JE(t,e),e.set(t,n)}function JE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tT(t,e){return t.get(nT(t,e))}function eT(t,e,n){return t.set(nT(t,e),n),n}function nT(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}Dy("flat");var iT=new WeakMap,oT=new WeakMap,rT=new WeakSet;class sT{constructor(){var t,e;JE(t=this,e=rT),e.add(t),QE(this,iT,void 0),QE(this,oT,void 0)}setActiveOverlay(t){return eT(oT,this,t),this}setActiveSelection(t){return eT(iT,this,t),this}scan(){const t=tT(iT,this).settings.selectionType,e=new Set;return"active-header"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t)))):"area"===t?this.scanCellsRange((t=>e.add(t))):"focus"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t))),this.scanCellsRange((t=>e.add(t)))):"fill"===t?this.scanCellsRange((t=>e.add(t))):"header"===t?(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanRowsInHeadersRange((t=>e.add(t)))):"row"===t?(this.scanRowsInHeadersRange((t=>e.add(t))),this.scanRowsInCellsRange((t=>e.add(t)))):"column"===t&&(this.scanColumnsInHeadersRange((t=>e.add(t))),this.scanColumnsInCellsRange((t=>e.add(t)))),e}scanColumnsInHeadersRange(t){const[e,n,i,o]=tT(iT,this).getCorners(),{wtTable:r}=tT(oT,this),s=r.getRenderedColumnsCount(),l=r.getColumnHeadersCount();let a=0;for(let h=-r.getRowHeadersCount();h<s;h++){const s=r.columnFilter.renderedToSource(h);if(!(s<n||s>o)){for(let h=-l;h<0;h++){if(h<e||h>i)continue;const c=h+l;let u=r.getColumnHeader(s,c);const d=tT(oT,this).getSetting("onBeforeHighlightingColumnHeader",s,c,{selectionType:tT(iT,this).settings.selectionType,columnCursor:a,selectionWidth:o-n+1});null!==d&&(d!==s&&(u=r.getColumnHeader(d,c)),t(u))}a+=1}}}scanRowsInHeadersRange(t){const[e,n,i,o]=tT(iT,this).getCorners(),{wtTable:r}=tT(oT,this),s=r.getRenderedRowsCount(),l=r.getRowHeadersCount();let a=0;for(let h=-r.getColumnHeadersCount();h<s;h++){const s=r.rowFilter.renderedToSource(h);if(!(s<e||s>i)){for(let h=-l;h<0;h++){if(h<n||h>o)continue;const c=h+l;let u=r.getRowHeader(s,c);const d=tT(oT,this).getSetting("onBeforeHighlightingRowHeader",s,c,{selectionType:tT(iT,this).settings.selectionType,rowCursor:a,selectionHeight:i-e+1});null!==d&&(d!==s&&(u=r.getRowHeader(d,c)),t(u))}a+=1}}}scanCellsRange(t){const{wtTable:e}=tT(oT,this);nT(rT,this,lT).call(this,((n,i)=>{const o=e.getCell(tT(oT,this).createCellCoords(n,i)),r=tT(oT,this).getSetting("onAfterDrawSelection",n,i,tT(iT,this).settings.layerLevel);"string"==typeof r&&Mw(o,r),t(o)}))}scanRowsInCellsRange(t){const[e,,n]=tT(iT,this).getCorners(),{wtTable:i}=tT(oT,this);nT(rT,this,aT).call(this,((o,r)=>{if(o>=e&&o<=n){const e=i.getCell(tT(oT,this).createCellCoords(o,r));t(e)}}))}scanColumnsInCellsRange(t){const[,e,,n]=tT(iT,this).getCorners(),{wtTable:i}=tT(oT,this);nT(rT,this,aT).call(this,((o,r)=>{if(r>=e&&r<=n){const e=i.getCell(tT(oT,this).createCellCoords(o,r));t(e)}}))}}function lT(t){let[e,n,i,o]=tT(iT,this).getCorners();if(e<0&&i<0||n<0&&o<0)return;const{wtTable:r}=tT(oT,this),s=e!==i||n!==o;if(n=Math.max(n,0),o=Math.max(o,0),e=Math.max(e,0),i=Math.max(i,0),s){if(n=Math.max(n,r.getFirstRenderedColumn()),o=Math.min(o,r.getLastRenderedColumn()),e=Math.max(e,r.getFirstRenderedRow()),i=Math.min(i,r.getLastRenderedRow()),o<n||i<e)return}else{if(!(r.getCell(tT(oT,this).createCellCoords(e,n))instanceof HTMLElement))return}for(let l=e;l<=i;l+=1)for(let e=n;e<=o;e+=1)t(l,e)}function aT(t){const{wtTable:e}=tT(oT,this),n=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let o=0;o<n;o+=1){const n=e.rowFilter.renderedToSource(o);for(let o=0;o<i;o+=1)t(n,e.columnFilter.renderedToSource(o))}}const hT=class{constructor(t,e){e&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=ZE(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners())}registerListeners(){const t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(()=>this.onMouseDown())),this.eventManager.addEventListener(t,"mouseup",(()=>this.onMouseUp()));for(let e=0,n=this.main.childNodes.length;e<n;e++){const t=this.main.childNodes[e];this.eventManager.addEventListener(t,"mouseenter",(t=>this.onMouseEnter(t,this.main.childNodes[e])))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(t,e){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),by(t);const n=this,i=this.wot.rootDocument.body,o=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(i,"mousemove",(function t(r){var s;((s=r).clientY<Math.floor(o.top)||s.clientY>Math.ceil(o.top+o.height)||s.clientX<Math.floor(o.left)||s.clientX>Math.ceil(o.left+o.width))&&(n.eventManager.removeEventListener(i,"mousemove",t),e.style.display="block")}))}createBorders(t){const{rootDocument:e}=this.wot;this.main=e.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let s=0;s<5;s++){const o=n[s],r=e.createElement("div");r.className=`wtBorder ${this.settings.className||""}`,this.settings[o]&&this.settings[o].hide&&(r.className+=" hidden"),i=r.style,i.backgroundColor=this.settings[o]&&this.settings[o].color?this.settings[o].color:t.border.color,i.height=this.settings[o]&&this.settings[o].width?`${this.settings[o].width}px`:`${t.border.width}px`,i.width=this.settings[o]&&this.settings[o].width?`${this.settings[o].width}px`:`${t.border.width}px`,this.main.appendChild(r)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),uy()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let r=o.bordersHolder;r||(r=e.createElement("div"),r.className="htBorders",o.bordersHolder=r,o.spreader.appendChild(r)),r.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:t}=this.wot;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")};this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};qv({position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`},((t,e)=>{this.selectionHandles.styles.bottomHitArea[e]=t,this.selectionHandles.styles.topHitArea[e]=t}));qv({position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"},((t,e)=>{this.selectionHandles.styles.bottom[e]=t,this.selectionHandles.styles.top[e]=t})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(t,e){const n=this.wot.selectionManager.getAreaSelection();return!(!n.cellRange||t===n.cellRange.to.row&&e===n.cellRange.to.col)}updateMultipleSelectionHandlesPosition(t,e,n,i,o,r){const s=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:l,topHitArea:a,bottom:h,bottomHitArea:c}=this.selectionHandles.styles,u=parseInt(l.borderWidth,10),d=parseInt(l.width,10),g=parseInt(a.width,10),f=this.wot.wtTable.getWidth(),m=this.wot.wtTable.getHeight();l.top=`${parseInt(n-d-1,10)}px`,l[s]=`${parseInt(i-d-1,10)}px`,a.top=`${parseInt(n-g/4*3,10)}px`,a[s]=`${parseInt(i-g/4*3,10)}px`;const p=Math.min(parseInt(i+o,10),f-d-2*u),w=Math.min(parseInt(i+o-g/4,10),f-g-2*u);h[s]=`${p}px`,c[s]=`${w}px`;const v=Math.min(parseInt(n+r,10),m-d-2*u),y=Math.min(parseInt(n+r-g/4,10),m-g-2*u);h.top=`${v}px`,c.top=`${y}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(l.display="block",a.display="block",this.isPartRange(t,e)?(h.display="none",c.display="none"):(h.display="block",c.display="block")):(l.display="none",h.display="none",a.display="none",c.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(l.zIndex="9999",a.zIndex="9999"):(l.zIndex="",a.zIndex="")}appear(t){if(this.disabled)return;let[e,n,i,o]=t;if(e<0&&i<0||n<0&&o<0)return void this.disappear();const{wtTable:r,rootDocument:s,rootWindow:l}=this.wot,a=e!==i||n!==o,h=r.getFirstRenderedRow(),c=r.getLastRenderedRow(),u=r.getFirstRenderedColumn(),d=r.getLastRenderedColumn();let g;if(a){if(n=Math.max(n,u),o=Math.min(o,d),e=Math.max(e,h),i=Math.min(i,c),o<n||i<e)return void this.disappear();g=r.getCell(this.wot.createCellCoords(e,n))}else if(g=r.getCell(this.wot.createCellCoords(e,n)),!(g instanceof HTMLElement))return void this.disappear();const f=a?r.getCell(this.wot.createCellCoords(i,o)):g,m=Dw(g),p=a?Dw(f):m,w=Dw(r.TABLE),v=m.top,y=m.left,b=this.wot.wtSettings.getSetting("rtlMode");let C=0,S=0;if(b){const t=Uw(r.TABLE),e=Uw(g),n=l.innerWidth-w.left-t;S=y+e-p.left,C=l.innerWidth-y-e-n-1}else S=p.left+Uw(f)-y,C=y-w.left-1;if(this.isEntireColumnSelected(e,i)){const t=e,i=this.getDimensionsFromHeader("columns",n,o,t,w);let r=null;i&&([r,C,S]=i),r&&(g=r)}let R=v-w.top-1,E=p.top+Yw(f)-v;if(this.isEntireRowSelected(n,o)){const t=n,o=this.getDimensionsFromHeader("rows",e,i,t,w);let r=null;o&&([r,R,E]=o),r&&(g=r)}const T=l.getComputedStyle(g);parseInt(T.borderTopWidth,10)>0&&(R+=1,E=E>0?E-1:0),parseInt(T[b?"borderRightWidth":"borderLeftWidth"],10)>0&&(C+=1,S=S>0?S-1:0);const M=b?"right":"left";this.topStyle.top=`${R}px`,this.topStyle[M]=`${C}px`,this.topStyle.width=`${S}px`,this.topStyle.display="block",this.startStyle.top=`${R}px`,this.startStyle[M]=`${C}px`,this.startStyle.height=`${E}px`,this.startStyle.display="block";const x=Math.floor(this.settings.border.width/2);this.bottomStyle.top=R+E-x+"px",this.bottomStyle[M]=`${C}px`,this.bottomStyle.width=`${S}px`,this.bottomStyle.display="block",this.endStyle.top=`${R}px`,this.endStyle[M]=C+S-x+"px",this.endStyle.height=`${E+1}px`,this.endStyle.display="block";let H=this.settings.border.cornerVisible;H="function"==typeof H?H(this.settings.layerLevel):H;const k=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[I,O]=[i,o];if(k&&Array.isArray(k)&&([,,I,O]=k),uy()||!H||this.isPartRange(I,O))this.cornerStyle.display="none";else{this.cornerStyle.top=R+E+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth+"px",this.cornerStyle[M]=C+S+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth+"px",this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let t=Bw(r.TABLE);const e=t===l;e&&(t=s.documentElement);const n=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,a=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),h=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const i=e?f.getBoundingClientRect().left:f.offsetLeft;let o=!1,r=0;b?(r=i-parseInt(this.cornerDefaultStyle.width,10)/2,o=r<0):(r=i+Uw(f)+parseInt(this.cornerDefaultStyle.width,10)/2,o=r>=Gw(t)),o&&(this.cornerStyle[M]=`${Math.floor(C+S+this.cornerCenterPointOffset-a-n)}px`,this.cornerStyle[b?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){(e?f.getBoundingClientRect().top:f.offsetTop)+Yw(f)+parseInt(this.cornerDefaultStyle.height,10)/2>=$w(t)&&(this.cornerStyle.top=`${Math.floor(R+E+this.cornerCenterPointOffset-h-n)}px`,this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}uy()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,R,C,S,E)}isEntireColumnSelected(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(t,e,n,i,o){const{wtTable:r}=this.wot,s=r.wtRootElement.parentNode;let l=null,a=null,h=null,c=null,u=null,d=null,g=null,f=null;switch(t){case"rows":l=function(){return r.getRowHeader(...arguments)},a=function(){return Yw(...arguments)},h="ht__selection--rows",d="top";break;case"columns":l=function(){return r.getColumnHeader(...arguments)},a=function(){return Uw(...arguments)},h="ht__selection--columns",d="left"}if(s.classList.contains(h)){const t=this.wot.getSetting("columnHeaders").length;if(g=l(e,t-i),f=l(n,t-i),!g||!f)return!1;const r=Dw(g),s=Dw(f);return g&&f&&(c=r[d]-o[d]-1,u=s[d]+a(f)-r[d]),[g,c,u]}return!1}changeBorderStyle(t,e){const n=this[t].style,i=e[t];!i||i.hide?Mw(this[t],"hidden"):(Tw(this[t],"hidden")&&xw(this[t],"hidden"),n.backgroundColor=i.color,"top"!==t&&"bottom"!==t||(n.height=`${i.width}px`),"start"!==t&&"end"!==t||(n.width=`${i.width}px`))}changeBorderToDefaultStyle(t){const e=1,n="#000",i=this[t].style;i.backgroundColor=n,i.width=`${e}px`,i.height=`${e}px`}toggleHiddenClass(t,e){this.changeBorderToDefaultStyle(t),e?Mw(this[t],"hidden"):xw(this[t],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",uy()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};function cT(t,e,n){uT(t,e),e.set(t,n)}function uT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dT(t,e){return t.get(fT(t,e))}function gT(t,e,n){return t.set(fT(t,e),n),n}function fT(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mT=new WeakMap,pT=new WeakMap,wT=new WeakMap,vT=new WeakMap,yT=new WeakMap,bT=new WeakMap,CT=new WeakSet;class ST{constructor(t){var e,n;uT(e=this,n=CT),n.add(e),cT(this,mT,void 0),cT(this,pT,void 0),cT(this,wT,new sT),cT(this,vT,new WeakMap),cT(this,yT,new WeakSet),cT(this,bT,new Map),gT(pT,this,t)}setActiveOverlay(t){return gT(mT,this,t),dT(wT,this).setActiveOverlay(dT(mT,this)),dT(vT,this).has(dT(mT,this))||dT(vT,this).set(dT(mT,this),new Set),this}getFocusSelection(){return null!==dT(pT,this)?dT(pT,this).getFocus():null}getAreaSelection(){return null!==dT(pT,this)?dT(pT,this).createLayeredArea():null}getBorderInstance(t){if(!t.settings.border)return null;if(dT(bT,this).has(t)){const e=dT(bT,this).get(t);if(e.has(dT(mT,this)))return e.get(dT(mT,this));const n=new hT(dT(mT,this),t.settings);return e.set(dT(mT,this),n),n}const e=new hT(dT(mT,this),t.settings);return dT(bT,this).set(t,new Map([[dT(mT,this),e]])),e}getBorderInstances(t){var e,n;return Array.from(null!==(e=null===(n=dT(bT,this).get(t))||void 0===n?void 0:n.values())&&void 0!==e?e:[])}destroyBorders(t){dT(bT,this).get(t).forEach((t=>t.destroy())),dT(bT,this).delete(t)}render(t){if(null===dT(pT,this))return;t&&fT(CT,this,RT).call(this);const e=Array.from(dT(pT,this)),n=new Map,i=new Map;for(let o=0;o<e.length;o++){const t=e[o],{className:r,headerAttributes:s,createLayers:l,selectionType:a}=t.settings;dT(yT,this).has(t)||(dT(yT,this).add(t),t.addLocalHook("destroy",(()=>this.destroyBorders(t))));const h=this.getBorderInstance(t);if(t.isEmpty()){null==h||h.disappear();continue}if(r){dT(wT,this).setActiveSelection(t).scan().forEach((t=>{if(n.has(t)){const e=n.get(t);e.has(r)&&!0===l?e.set(r,e.get(r)+1):e.set(r,1)}else n.set(t,new Map([[r,1]]));s&&(i.has(t)||i.set(t,[]),"TH"===t.nodeName&&i.get(t).push(...s))}))}const c=t.getCorners();dT(mT,this).getSetting("onBeforeDrawBorders",c,a),null==h||h.appear(c)}n.forEach(((t,e)=>{var n;const i=Array.from(t).map((t=>{let[e,n]=t;return 1===n?e:[e,...Array.from({length:n-1},((t,n)=>`${e}-${n+1}`))]})).flat();i.forEach((t=>dT(vT,this).get(dT(mT,this)).add(t))),Mw(e,i),"TD"===e.nodeName&&Array.isArray(null===(n=dT(pT,this).options)||void 0===n?void 0:n.cellAttributes)&&Hw(e,dT(pT,this).options.cellAttributes)})),Array.from(i.keys()).forEach((t=>{Hw(t,[...i.get(t)])}))}}function RT(){const t=dT(vT,this).get(dT(mT,this)),e=dT(mT,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach((t=>{var e,n;const i=dT(mT,this).wtTable.TABLE.querySelectorAll(`.${t}`);let o=[];Array.isArray(null===(e=dT(pT,this).options)||void 0===e?void 0:e.cellAttributes)&&(o=dT(pT,this).options.cellAttributes.map((t=>t[0]))),Array.isArray(null===(n=dT(pT,this).options)||void 0===n?void 0:n.headerAttributes)&&(o=[...o,...dT(pT,this).options.headerAttributes.map((t=>t[0]))]);for(let r=0,s=i.length;r<s;r++)xw(i[r],t),kw(i[r],o)})),t.clear()}class ET extends OE{constructor(t,e,n,i){super(t,e,fE,n,i)}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new BE(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:t}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!t.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer!==e||i&&"horizontal"===i?(o=this.getScrollPosition(),tv(n)):(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Jw(n,`${o}px`,"0px"));const r=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),r}setScrollPosition(t){const{rootWindow:e}=this.domBindings;let n=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,Lw(e)),n=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(t,e){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=t,o=0;for(;i<e;)o+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,r=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||"vertical"===r){let i=e.getWorkspaceHeight();e.hasHorizontalScroll()&&(i-=Qw(n)),i=Math.min(i,t.wtRootElement.scrollHeight),o.height=`${i}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const s=Uw(this.clone.wtTable.TABLE);o.width=`${s}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=ZE(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(e.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+n}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[e]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(t,e){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,s=0===o&&i.length>0&&!Tw(r.parentNode,"innerBorderInlineStart")?1:0;let l=this.getTableParentOffset(),a=0;if(e){this.wot.wtTable.getColumnWidth(t)>this.wot.wtViewport.getViewportWidth()&&(e=!1)}var h;return e&&r.offsetWidth!==r.clientWidth&&(a=Qw(this.domBindings.rootDocument)),e?(l+=this.sumCellSizes(0,t+1),l-=this.wot.wtViewport.getViewportWidth(),l+=s):l+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),l+=a,(h=this.mainTableScrollableElement).scrollWidth-h.clientWidth==l-s&&s>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(s),this.setScrollPosition(l)}getTableParentOffset(){let t=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(Ww(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===t&&(!e||"horizontal"!==e)){n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);n>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(n=0)}return n}adjustHeaderBordersPosition(t){const{wtSettings:e}=this,n=this.wot.wtTable.holder.parentNode,i=e.getSetting("rowHeaders"),o=e.getSetting("fixedColumnsStart"),r=e.getSetting("totalRows"),s="vertical"===e.getSetting("preventOverflow");r?xw(n,"emptyRows"):Mw(n,"emptyRows");let l=!1;if(!s)if(o&&!i.length)Mw(n,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const e=Tw(n,"innerBorderInlineStart");t?(Mw(n,"innerBorderLeft innerBorderInlineStart"),l=!e):(xw(n,"innerBorderLeft innerBorderInlineStart"),l=e)}return l}}const TT={getFirstRenderedRow(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Xv(TT,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});const MT=TT;class xT extends rE{constructor(t,e,n,i){super(t,e,n,i,mE)}}$v(xT,MT),$v(xT,hE);const HT=xT;function kT(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class IT extends OE{constructor(t,e,n,i,o,r){super(t,e,mE,n,i),kT(this,"topOverlay",void 0),kT(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=r}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new HT(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){Jw(t,`${this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1)}px`,`${this.topOverlay.getOverlayOffset()}px`)}else tv(t);let e=Yw(this.clone.wtTable.TABLE);const n=Uw(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=`${e}px`,t.style.width=`${n}px`,!1}}class OT extends rE{constructor(t,e,n,i){super(t,e,n,i,dE)}}$v(OT,MT),$v(OT,PE);const AT=OT;function _T(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class PT extends OE{constructor(t,e,n,i){super(t,e,dE,n,i),_T(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new AT(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode,{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer!==e||n&&"vertical"===n)i=this.getScrollPosition(),tv(t);else{const{wtTable:e}=this.wot,n=e.hider.getBoundingClientRect();o=Math.ceil(n.bottom)===t.offsetHeight,i=this.getOverlayOffset(),Jw(t,"0px",`${i}px`)}const r=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),r}setScrollPosition(t){const e=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo(Vw(e),t),n=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){const n=this.wot.stylesHandler.getDefaultRowHeight();let i=t,o=0;for(;i<e;){const t=this.wot.wtTable.getRowHeight(i);o+=void 0===t?n:t,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:t,wtViewport:e}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,r=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||"horizontal"===r){let i=e.getWorkspaceWidth();e.hasVerticalScroll()&&(i-=Qw(n)),i=Math.min(i,t.wtRootElement.scrollWidth),o.width=`${i}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let s=Yw(this.clone.wtTable.TABLE);t.hasDefinedSize()||(s=0),o.height=`${s}px`}adjustRootChildrenSize(){const{holder:t}=this.clone.wtTable,e=ZE(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(e.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+n}px`}applyToDOM(){const t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){const{wot:n,wtSettings:i}=this,o=(n.cloneSource?n.cloneSource:n).wtTable.holder,r=i.getSetting("columnHeaders"),s=0===i.getSetting("fixedRowsTop")&&r.length>0&&!Tw(o.parentNode,"innerBorderTop")?1:0;let l=this.getTableParentOffset(),a=0;if(e){this.wot.wtTable.getRowHeight(t)>this.wot.wtViewport.getViewportHeight()&&(e=!1)}if(e&&o.offsetHeight!==o.clientHeight&&(a=Qw(this.domBindings.rootDocument)),e){const e=i.getSetting("fixedRowsBottom"),o=i.getSetting("totalRows");l+=this.sumCellSizes(0,t+1),l-=n.wtViewport.getViewportHeight()-this.sumCellSizes(o-e,o),l+=1,l+=s}else l+=this.sumCellSizes(i.getSetting("fixedRowsTop"),t);var h;return l+=a,(h=this.mainTableScrollableElement).scrollHeight-h.clientHeight==l-s&&s>0&&this.wot.wtOverlays.expandHiderVerticallyBy(s),this.setScrollPosition(l)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Fw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){const t=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>t&&(n=0)}return n}adjustHeaderBordersPosition(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,o=n.getSetting("totalColumns"),r="horizontal"===n.getSetting("preventOverflow");o?xw(i,"emptyColumns"):Mw(i,"emptyColumns");let s=!1;if(!e&&!r){const e=n.getSetting("fixedRowsTop"),o=this.cachedFixedRowsTop!==e,r=n.getSetting("columnHeaders");if((o||0===e)&&r.length>0){const e=Tw(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),t||0===n.getSetting("totalRows")?(Mw(i,"innerBorderTop"),s=!e):(xw(i,"innerBorderTop"),s=e)}}return s}}function NT(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function DT(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LT(t,e,n){return t.set(FT(t,e),n),n}function VT(t,e){return t.get(FT(t,e))}function FT(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var WT=new WeakMap,jT=new WeakMap,BT=new WeakMap,zT=new WeakMap;const UT=class{constructor(t,e,n,i,o,r){DT(this,"wot",null),NT(this,WT,[]),DT(this,"topOverlay",null),DT(this,"bottomOverlay",null),DT(this,"inlineStartOverlay",null),DT(this,"topInlineStartCornerOverlay",null),DT(this,"bottomInlineStartCornerOverlay",null),DT(this,"browserLineHeight",void 0),DT(this,"wtSettings",null),NT(this,jT,!1),NT(this,BT,0),NT(this,zT,null),DT(this,"resizeObserver",new ResizeObserver((t=>{ey((()=>{Array.isArray(t)&&t.length&&(LT(BT,this,VT(BT,this)+1),100===VT(BT,this)&&(Ey("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),null!==VT(zT,this)&&clearTimeout(VT(zT,this)),LT(zT,this,setTimeout((()=>{LT(BT,this,0)}),100)),this.wtSettings.getSetting("onContainerElementResize"))}))}))),this.wot=t,this.wtSettings=i,this.domBindings=n,this.facadeGetter=e,this.wtTable=r;const{rootDocument:s,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Qw(s);const a="hidden"===l.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=a?r.holder:jw(r.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=[...VT(WT,this)];return t&&e.push(this.wtTable),e}initBrowserLineHeight(){const{rootWindow:t,rootDocument:e}=this.domBindings,n=t.getComputedStyle(e.body),i=parseInt(n.lineHeight,10),o=1.2*parseInt(n.fontSize,10);this.browserLineHeight=i||o}initOverlays(){const t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new PT(...t),this.bottomOverlay=new VE(...t),this.inlineStartOverlay=new ET(...t),this.topInlineStartCornerOverlay=new IT(...t,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new AE(...t,this.bottomOverlay,this.inlineStartOverlay),LT(WT,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){LT(jT,this,VT(WT,this).reduce(((t,e)=>e.hasRenderingStateChanged()||t),!1)),VT(WT,this).forEach((t=>t.updateStateOfRendering("before")))}afterDraw(){this.syncScrollWithMaster(),VT(WT,this).forEach((t=>{const e=t.hasRenderingStateChanged();t.updateStateOfRendering("after"),e&&!t.needFullRender&&t.reset()}))}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:t,rootWindow:e}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(t.documentElement,"keydown",(t=>this.onKeyDown(t))),this.eventManager.addEventListener(t.documentElement,"keyup",(()=>this.onKeyUp())),this.eventManager.addEventListener(t,"visibilitychange",(()=>this.onKeyUp())),this.eventManager.addEventListener(n,"scroll",(t=>this.onTableScroll(t)),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",(t=>this.onTableScroll(t)),{passive:!0});const o=e.devicePixelRatio&&e.devicePixelRatio>1,r=this.scrollableElement===e,s=this.wtSettings.getSetting("preventWheel"),l={passive:r};(s||o||!ay())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(t=>this.onCloneWheel(t,s)),l);let a;[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((t=>{if(t&&t.needFullRender){const{holder:e}=t.clone.wtTable;this.eventManager.addEventListener(e,"wheel",(t=>this.onCloneWheel(t,s)),l)}})),this.eventManager.addEventListener(e,"resize",(()=>{ey((()=>{clearTimeout(a),this.wtSettings.getSetting("onWindowResize"),a=setTimeout((()=>{LT(BT,this,0)}),200)}))})),r||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(t){const e=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=t.target;this.keyPressed&&(i!==e&&o!==e&&!t.target.contains(i)||n!==e&&o!==e&&!t.target.contains(n))||this.syncScrollPositions(t)}onCloneWheel(t,e){const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,r=t.target,s=o!==n&&r!==n&&!r.contains(o),l=i!==n&&r!==n&&!r.contains(i);if(this.keyPressed&&(s||l)||this.scrollableElement===n)return;const a=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==n&&a)&&t.preventDefault()}onKeyDown(t){this.keyPressed=yy(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(t){let e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,n=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(n+=n*this.browserLineHeight,e+=e*this.browserLineHeight);const i=this.scrollVertically(e),o=this.scrollHorizontally(n);return i||o}scrollVertically(t){const e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}scrollHorizontally(t){const e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:t}=this.domBindings,e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=e.scrollLeft!==i||this.lastScrollX!==t.scrollX,this.verticalScrolling=n.scrollTop!==o||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=i;const t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){if(!VT(jT,this))return;const t=this.topOverlay.mainTableScrollableElement,{scrollLeft:e,scrollTop:n}=t;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),LT(jT,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:t}=this,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=jw(t.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}updateLastSpreaderSize(){const t=this.wtTable.spreader,e=t.clientWidth,n=t.clientHeight,i=e!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:t}=this.wot,{wtTable:e}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,o=this.wtSettings.getSetting("totalColumns"),r=this.wtSettings.getSetting("totalRows"),s=t.getRowHeaderWidth(),l=t.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,r)+1,a=s+this.inlineStartOverlay.sumCellSizes(0,o),h=e.hider.style,c=(()=>!i&&this.scrollableElement.scrollTop>Math.max(0,l-e.holder.clientHeight))()?1:0,u=(()=>!i&&this.scrollableElement.scrollLeft>Math.max(0,a-e.holder.clientWidth))()?1:0;h.width=`${a+u}px`,h.height=`${l+c}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(t){const{wtTable:e}=this;e.hider.style.height=`${parseInt(e.hider.style.height,10)+t}px`}expandHiderHorizontallyBy(t){const{wtTable:e}=this;e.hider.style.width=`${parseInt(e.hider.style.width,10)+t}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;const e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return Np(e,(e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(n=e.clone)})),n}syncOverlayTableClassNames(){const t=this.wtTable.TABLE;Np([this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],(e=>{e&&(e.clone.wtTable.TABLE.className=t.className)}))}};function YT(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class $T{constructor(t){YT(this,"settings",{}),YT(this,"defaults",Object.freeze(this.getDefaults())),qv(this.defaults,((e,n)=>{if(void 0!==t[n])this.settings[n]=t[n];else{if(void 0===e)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=e}}))}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(t,e,n)=>{const i=this.getSetting("data",t,e);Pw(n,null==i?"":i)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:t=>t,onBeforeViewportScrollVertically:t=>t,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:t=>t,onBeforeHighlightingColumnHeader:t=>t,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(t,e){return void 0===e?qv(t,((t,e)=>{this.settings[e]=t})):this.settings[t]=e,this}getSetting(t,e,n,i,o){return"function"==typeof this.settings[t]?this.settings[t](e,n,i,o):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}getSettingPure(t){return this.settings[t]}has(t){return!!this.settings[t]}}class GT extends rE{constructor(t,e,n,i){super(t,e,n,i,"master")}alignOverlaysWithTrimmingContainer(){const t=Bw(this.wtRootElement),{rootWindow:e}=this.domBindings;if(t===e){this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const n=t.parentElement,i=zw(t,"height",e),o=zw(t,"overflow",e),r=this.holder.style,{scrollWidth:s,scrollHeight:l}=t;let a=t.offsetWidth,h=t.offsetHeight;if(n&&["auto","hidden","scroll"].includes(o)){const i=t.cloneNode(!1);i.style.overflow="auto",i.style.position="absolute",t.nextElementSibling?n.insertBefore(i,t.nextElementSibling):n.appendChild(i);const o=parseInt(e.getComputedStyle(i).height,10);n.removeChild(i),0===o&&(h=0)}h=Math.min(h,l),r.height="auto"===i?"auto":`${h}px`,a=Math.min(a,s),r.width=`${a}px`,r.overflow="",this.hasTableHeight="auto"===r.height||h>0,this.hasTableWidth=a>0}this.isTableVisible=Nw(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject,n="master",i=t.getSetting("columnHeaders").length;if(i&&!e.hasOversizedColumnHeadersMarked[n]){const o=t.getSetting("rowHeaders").length,r=this.getRenderedColumnsCount();for(let t=0;t<i;t++)for(let e=-1*o;e<r;e++)this.markIfOversizedColumnHeader(e);e.hasOversizedColumnHeadersMarked[n]=!0}}}$v(GT,WE),$v(GT,PE);const KT=GT;const XT=class{constructor(t,e,n,i,o){this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=e,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new DS:new WS],["fullyVisible",()=>new HS],["partiallyVisible",()=>new AS]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new PS:new VS],["fullyVisible",()=>new MS],["partiallyVisible",()=>new IS]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(()=>{this.clientHeight=this.getWorkspaceHeight()}))}getWorkspaceHeight(){const t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;if(e===this.domBindings.rootWindow)n=t.documentElement.clientHeight;else{n=Yw(e)>0&&e.clientHeight>0?e.clientHeight:Infinity}return n}getViewportHeight(){let t=this.getWorkspaceHeight();if(Infinity===t)return t;const e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}getWorkspaceWidth(){const{rootDocument:t,rootWindow:e}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===e){const e=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,e)>i&&(i=t.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const t=this.getWorkspaceWidth();if(Infinity===t)return t;const e=this.getRowHeaderWidth();return e>0?t-e:t}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(t,e){let n=0,i=t;for(;i<e;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return Dw(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Yw(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(let n=0,i=e.length;n<i;n++)this.rowHeaderWidth+=t[n]||t}if(isNaN(this.rowHeaderWidth))if(e.length){let t=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let n=0,i=e.length;n<i;n++)t?(this.rowHeaderWidth+=Uw(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:e,wtTable:n}=this;let i,o,r=this.getViewportHeight();this.rowHeaderWidth=NaN;let s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=e.getSetting("fixedRowsTop"),a=e.getSetting("fixedRowsBottom"),h=e.getSetting("totalRows");return l&&s>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),s+=o,r-=o),a&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(h-a,h),r-=o),i=n.holder.clientHeight===n.holder.offsetHeight?0:Qw(this.domBindings.rootDocument),new GS({calculationTypes:t.map((t=>[t,this.rowsCalculatorTypes.get(t)()])),viewportHeight:r,scrollOffset:s,totalRows:e.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:t=>n.getRowHeight(t),overrideFn:e.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:i})}createColumnsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:e,wtTable:n}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const r=e.getSetting("fixedColumnsStart");if(r&&o>=0){const t=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,r);o+=t,i-=t}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=Qw(this.domBindings.rootDocument)),new YS({calculationTypes:t.map((t=>[t,this.columnsCalculatorTypes.get(t)()])),viewportWidth:i,scrollOffset:o,totalColumns:e.getSetting("totalColumns"),columnWidthFn:t=>n.getColumnWidth(t),overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:e}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(t&&!e.getSetting("renderAllRows")){const e=n.getResultsFor("fullyVisible");t=this.areAllProposedVisibleRowsAlreadyRendered(e)}if(t&&!e.getSetting("renderAllColumns")){const e=i.getResultsFor("fullyVisible");t=this.areAllProposedVisibleColumnsAlreadyRendered(e)}return t||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),t}createVisibleCalculators(){const t=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),e=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=t.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=e.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(t){if(!this.rowsVisibleCalculator)return!1;let{startRow:e,endRow:n}=t;if(null===e&&null===n){if(!t.isVisibleInTrimmingContainer)return!0;e=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:r,rowEndOffset:s}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,a=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(a)&&a>0?(e=Math.max(0,e-Math.min(r,a)),n=Math.min(l,n+Math.min(s,a))):"auto"===a&&(e=Math.max(0,e-Math.ceil(r/2)),n=Math.min(l,n+Math.ceil(s/2))),!(e<i||e===i&&e>0)&&!(n>o||n===o&&n<l)}areAllProposedVisibleColumnsAlreadyRendered(t){if(!this.columnsVisibleCalculator)return!1;let{startColumn:e,endColumn:n}=t;if(null===e&&null===n){if(!t.isVisibleInTrimmingContainer)return!0;e=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:r,columnEndOffset:s}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,a=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(a)&&a>0?(e=Math.max(0,e-Math.min(r,a)),n=Math.min(l,n+Math.min(s,a))):"auto"===a&&(e=Math.max(0,e-Math.ceil(r/2)),n=Math.min(l,n+Math.ceil(s/2))),!(e<i||e===i&&e>0)&&!(n>o||n===o&&n<l)}resetHasOversizedColumnHeadersMarked(){qv(this.hasOversizedColumnHeadersMarked,((t,e,n)=>{n[e]=void 0}))}};function qT(t,e,n){ZT(t,e),e.set(t,n)}function ZT(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QT(t,e){return t.get(tM(t,e))}function JT(t,e,n){return t.set(tM(t,e),n),n}function tM(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var eM=new WeakMap,nM=new WeakMap,iM=new WeakMap,oM=new WeakMap,rM=new WeakMap,sM=new WeakMap,lM=new WeakMap,aM=new WeakSet;class hM{constructor(t){var e,n;ZT(e=this,n=aM),n.add(e),qT(this,eM,void 0),qT(this,nM,void 0),qT(this,iM,void 0),qT(this,oM,void 0),qT(this,rM,!0),qT(this,sM,{}),qT(this,lM,{}),JT(nM,this,t.rootTable.parentElement.parentElement),JT(oM,this,t.rootDocument)}isClassicTheme(){return QT(rM,this)}getCSSVariableValue(t){var e;if(QT(rM,this))return null;if(QT(sM,this)[`--ht-${t}`])return QT(sM,this)[`--ht-${t}`];const n=null!==(e=tM(aM,this,fM).call(this,`--ht-${t}`))&&void 0!==e?e:tM(aM,this,mM).call(this,`--ht-${t}`);return null!==n?(QT(sM,this)[`--ht-${t}`]=n,n):void 0}getStyleForTD(t){var e;return null===(e=QT(lM,this))||void 0===e?void 0:e.td[t]}getDefaultRowHeight(){if(QT(rM,this))return 23;const t=tM(aM,this,cM).call(this);return!t&&Tw(QT(nM,this),"ht-wrapper")?(Ey(`The "${QT(eM,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),JT(rM,this,!0),this.useTheme(),23):t}areCellsBorderBox(){return"border-box"===this.getStyleForTD("box-sizing")}useTheme(t){if(!t)return tM(aM,this,dM).call(this),JT(rM,this,!0),void JT(eM,this,t||void 0);t&&t!==QT(eM,this)&&(QT(eM,this)&&tM(aM,this,pM).call(this),JT(eM,this,t),JT(rM,this,!1),tM(aM,this,uM).call(this),tM(aM,this,dM).call(this))}getThemeName(){return QT(eM,this)}removeClassNames(){Tw(QT(nM,this),QT(eM,this))&&xw(QT(nM,this),QT(eM,this))}}function cM(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return null===t||null===e||isNaN(n)?null:t+2*e+n}function uM(){xw(QT(nM,this),/ht-theme-.*/g),Mw(QT(nM,this),QT(eM,this))}function dM(){this.isClassicTheme()||JT(iM,this,getComputedStyle(QT(nM,this)));const t=tM(aM,this,gM).call(this,["box-sizing","border-bottom-width"]);QT(lM,this).td=a(a({},QT(lM,this).td),{"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]})}function gM(t){const e=QT(oM,this),n=QT(nM,this),i=e.createElement("table"),o=e.createElement("tbody"),r=e.createElement("tr"),s=e.createElement("tr"),l=e.createElement("td");s.appendChild(l),o.appendChild(r),o.appendChild(s),i.appendChild(o),n.appendChild(i);const a=getComputedStyle(l),h={};return t.forEach((t=>{h[t]=a.getPropertyValue(t)})),n.removeChild(i),h}function fM(t){const e=Math.ceil(parseFloat(tM(aM,this,mM).call(this,t)));return Number.isNaN(e)?null:e}function mM(t){const e=QT(iM,this).getPropertyValue(t);return""===e?null:e}function pM(){JT(lM,this,{}),JT(sM,this,{}),JT(rM,this,!0)}class wM extends xE{constructor(t,e){super(t,new $T(e)),this.stylesHandler=new hM(this.domBindings);const n=this.wtSettings.getSetting("facade",this);this.wtTable=new KT(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new XT(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new ST(this.wtSettings.getSetting("selections")),this.wtEvent=new RR(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new UT(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const t=[],e=[];qv({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},((n,i)=>{this.wtSettings.getSetting(i).length&&e.push(n),t.push(n)})),xw(this.wtTable.wtRootElement.parentNode,t),Mw(this.wtTable.wtRootElement.parentNode,e)}getOverlayByName(t){var e;if(!wE.includes(t))return null;const n=t.replace(/_([a-z])/g,(t=>t[1].toUpperCase()));return null!==(e=this.wtOverlays[`${n}Overlay`])&&void 0!==e?e:null}getViewportDao(){const t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}class vM{constructor(t){t instanceof xE?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=t=>{const e=new vM(t);return()=>e},this._wot=new wM(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(t,e){return this._wot.createCellCoords(t,e)}createCellRange(t,e,n){return this._wot.createCellRange(t,e,n)}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}scrollViewport(t,e,n){return this._wot.scrollViewport(t,e,n)}scrollViewportHorizontally(t,e){return this._wot.scrollViewportHorizontally(t,e)}scrollViewportVertically(t,e){return this._wot.scrollViewportVertically(t,e)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(t){return this._wot.getOverlayByName(t)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,e){return this._wot.wtSettings.update(t,e),this}getSetting(t,e,n,i,o){return this._wot.wtSettings.getSetting(t,e,n,i,o)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}}function yM(t){let{isShiftKey:e,isLeftClick:n,isRightClick:i,coords:o,selection:r,controller:s,cellCoordsFactory:l}=t;const a=r.isSelected()?r.getSelectedRange().current():null,h=r.isSelectedByCorner(),c=r.isSelectedByRowHeader();if(r.markSource("mouse"),e&&a)o.row>=0&&o.col>=0&&!s.cell?r.setRangeEnd(o):(h||c)&&o.row>=0&&o.col>=0&&!s.cell?r.setRangeEnd(l(o.row,o.col)):h&&o.row<0&&!s.column?r.setRangeEnd(l(a.to.row,o.col)):c&&o.col<0&&!s.row?r.setRangeEnd(l(o.row,a.to.col)):(!h&&!c&&o.col<0||h&&o.col<0)&&!s.row?r.selectRows(Math.max(a.from.row,0),o.row,o.col):(!h&&!c&&o.row<0||c&&o.row<0)&&!s.column&&r.selectColumns(Math.max(a.from.col,0),o.col,o.row);else{const t=!r.inInSelection(o),e=n||i&&t;o.row<0&&o.col>=0&&!s.column?e&&r.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!s.row?e&&r.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!s.cell?e&&r.setRangeStart(o):o.col<0&&o.row<0&&r.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}r.markEndSource()}const bM=new Map([["mousedown",yM],["mouseover",function(t){let{isLeftClick:e,coords:n,selection:i,controller:o,cellCoordsFactory:r}=t;if(!e)return;const s=i.isSelectedByRowHeader(),l=i.isSelectedByColumnHeader(),a=i.tableProps.countCols(),h=i.tableProps.countRows();i.markSource("mouse"),l&&!o.column?i.setRangeEnd(r(h-1,n.col)):s&&!o.row?i.setRangeEnd(r(n.row,a-1)):o.cell||i.setRangeEnd(n),i.markEndSource()}],["touchstart",yM]]);function CM(t,e){let{coords:n,selection:i,controller:o,cellCoordsFactory:r}=e;bM.get(t.type)({coords:n,selection:i,controller:o,cellCoordsFactory:r,isShiftKey:t.shiftKey,isLeftClick:Ry(t)||"touchstart"===t.type,isRightClick:Sy(t)})}const SM=new WeakMap,RM=Symbol("rootInstance");function EM(t){return SM.has(t)}function TM(t,e,n){MM(t,e),e.set(t,n)}function MM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xM(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HM(t,e){return t.get(IM(t,e))}function kM(t,e,n){return t.set(IM(t,e),n),n}function IM(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var OM=new WeakMap,AM=new WeakMap,_M=new WeakMap,PM=new WeakMap,NM=new WeakMap,DM=new WeakMap,LM=new WeakMap,VM=new WeakSet;function FM(){return parseInt(this.hot.rootElement.getAttribute(cw()[0]),10)}function WM(t){const e=IM(VM,this,FM).call(this)+t;Hw(this.hot.rootElement,...cw(e))}function jM(){const t=this.hot.rootElement;this.hasVerticalScroll()?Mw(t,"htHasScrollY"):xw(t,"htHasScrollY"),this.hasHorizontalScroll()?Mw(t,"htHasScrollX"):xw(t,"htHasScrollX")}const BM=class{constructor(t){var e,n;MM(e=this,n=VM),n.add(e),xM(this,"hot",void 0),xM(this,"eventManager",void 0),xM(this,"settings",void 0),xM(this,"THEAD",void 0),xM(this,"TBODY",void 0),xM(this,"_wt",void 0),xM(this,"activeWt",void 0),TM(this,OM,0),TM(this,AM,0),xM(this,"postponedAdjustElementsSize",!1),TM(this,_M,!1),TM(this,PM,void 0),TM(this,NM,void 0),TM(this,DM,0),TM(this,LM,0),this.hot=t,this.eventManager=new Sb(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),IM(VM,this,jM).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(t,e){const n=this._wt.getCell(t,e);return n<0?null:n}scrollViewport(t,e,n){return this._wt.scrollViewport(t,e,n)}scrollViewportHorizontally(t,e){return this._wt.scrollViewportHorizontally(t,e)}scrollViewportVertically(t,e){return this._wt.scrollViewportVertically(t,e)}createElements(){const{rootElement:t,rootDocument:e}=this.hot,n=t.getAttribute("style");n&&t.setAttribute("data-originalstyle",n),Mw(t,"handsontable"),kM(NM,this,e.createElement("TABLE")),Mw(HM(NM,this),"htCore"),this.hot.getSettings().tableClassName&&Mw(HM(NM,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Hw(HM(NM,this),[["role","presentation"]]),Hw(t,[["role","treegrid"],hw(-1),cw(this.hot.countCols()),["aria-multiselectable","true"]])),this.THEAD=e.createElement("THEAD"),HM(NM,this).appendChild(this.THEAD),this.TBODY=e.createElement("TBODY"),HM(NM,this).appendChild(this.TBODY),this.hot.table=HM(NM,this),this.hot.container.insertBefore(HM(NM,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:t,rootDocument:e,selection:n,rootWindow:i}=this.hot,o=e.documentElement;this.eventManager.addEventListener(t,"mousedown",(t=>{kM(_M,this,!0),this.isTextSelectionAllowed(t.target)||(Xw(i),t.preventDefault(),i.focus())})),this.eventManager.addEventListener(t,"mouseup",(()=>{kM(_M,this,!1)})),this.eventManager.addEventListener(t,"mousemove",(t=>{HM(_M,this)&&!this.isTextSelectionAllowed(t.target)&&(this.settings.fragmentSelection&&Xw(i),t.preventDefault())})),this.eventManager.addEventListener(o,"keyup",(t=>{n.isInProgress()&&!t.shiftKey&&n.finish()})),this.eventManager.addEventListener(o,"mouseup",(i=>{n.isInProgress()&&Ry(i)&&n.finish(),kM(PM,this,!1);const o=nv(e.activeElement);ev(e.activeElement)&&!o||!o&&(n.isSelected()||n.isSelectedByAnyHeader()||t.contains(i.target)||Sy(i))||this.hot.unlisten()})),this.eventManager.addEventListener(o,"contextmenu",(t=>{n.isInProgress()&&Sy(t)&&(n.finish(),kM(PM,this,!1))})),this.eventManager.addEventListener(o,"touchend",(()=>{n.isInProgress()&&n.finish(),kM(PM,this,!1)})),this.eventManager.addEventListener(o,"mousedown",(n=>{const i=n.target,r=n.x||n.clientX,s=n.y||n.clientY;let l=n.target;if(HM(PM,this)||!t||!this.hot.view)return;const{holder:a}=this._wt.wtTable;if(l===a){const t=Qw(e);if(e.elementFromPoint(r+t,s)!==a||e.elementFromPoint(r,s+t)!==a)return}else for(;l!==o;){if(null===l){if(n.isTargetWebComponent)break;return}if(l===t)return;l=l.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(i):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}));let r=vw(i);for(;null!==r;)this.eventManager.addEventListener(r.document.documentElement,"click",(()=>{this.hot.unlisten()})),r=vw(r);this.eventManager.addEventListener(HM(NM,this),"selectstart",(t=>{this.settings.fragmentSelection||ev(t.target)||t.preventDefault()}))}translateFromRenderableToVisualCoords(t){let{row:e,col:n}=t;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(e,n))}translateFromRenderableToVisualIndex(t,e){let n=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t,i=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===n&&(n=t),null===i&&(i=e),[n,i]}countRenderableIndexes(t,e){const n=Math.min(t.getNotTrimmedIndexesLength(),e),i=t.getNearestNotHiddenIndex(n-1,-1);return null===i?0:t.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(t,e,n,i){if(isNaN(t)||t<0)return 0;const o=n.getNearestNotHiddenIndex(t,e),r=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(r))return 0;let s=0;return e<0?s=r+1:e>0&&(s=i-r),s}countNotHiddenFixedColumnsStart(){const t=this.hot.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){const t=this.hot.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){const t=this.hot.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}countRenderableColumnsInRange(t,e){let n=0;for(let i=t;i<=e;i++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)&&(n+=1);return n}countRenderableRowsInRange(t,e){let n=0;for(let i=t;i<=e;i++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)&&(n+=1);return n}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(t){var e;const n=null===(e=this.hot.rootElement.parentNode)||void 0===e?void 0:e.querySelector(".hot-display-license-info");n&&Mw(n,t)}removeClassNameFromLicenseElement(t){var e;const n=null===(e=this.hot.rootElement.parentNode)||void 0===e?void 0:e.querySelector(".hot-display-license-info");n&&xw(n,t)}isMainTableNotFullyCoveredByOverlays(){const t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>t&&this.hot.countRenderedCols()>e}initializeWalkontable(){const t={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:HM(NM,this),isDataViewInstance:()=>EM(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(t,e)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(t,e)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const t=[];return this.hot.hasRowHeaders()&&t.push(((t,e)=>{const n=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t;this.appendRowHeader(n,e)})),this.hot.runHooks("afterGetRowHeaderRenderers",t),kM(AM,this,t.length),this.hot.getSettings().ariaTags&&IM(VM,this,FM).call(this)===this.hot.countCols()&&IM(VM,this,WM).call(this,HM(AM,this)),t},columnHeaders:()=>{const t=[];return this.hot.hasColHeaders()&&t.push(((t,e)=>{const n=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;this.appendColHeader(n,e)})),this.hot.runHooks("afterGetColumnHeaderRenderers",t),kM(OM,this,t.length),t},columnWidth:t=>{const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getColWidth(null===e?t:e)},rowHeight:t=>{const e=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getRowHeight(null===e?t:e)},rowHeightByOverlayName:(t,e)=>{const n=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t),i=null===n?t:n;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(i),i,e)},cellRenderer:(t,e,n)=>{const[i,o]=this.translateFromRenderableToVisualIndex(t,e),r=this.hot.runHooks("modifyGetCellCoords",i,o,!1,"meta");let s=i,l=o;Array.isArray(r)&&([s,l]=r);const a=this.hot.getCellMeta(s,l),h=this.hot.colToProp(l);let c=this.hot.getDataAtRowProp(s,h);this.hot.hasHook("beforeValueRender")&&(c=this.hot.runHooks("beforeValueRender",c,a)),this.hot.runHooks("beforeRenderer",n,i,o,h,c,a),this.hot.getCellRenderer(a)(this.hot,n,i,o,h,c,a),this.hot.runHooks("afterRenderer",n,i,o,h,c,a)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Nw(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(t,e,n,i)=>{const o=this.translateFromRenderableToVisualCoords(e),r={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=i,kM(PM,this,!0),this.hot.runHooks("beforeOnCellMouseDown",t,o,n,r),Cy(t)||(CM(t,{coords:o,selection:this.hot.selection,controller:r,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseDown",t,o,n),this.activeWt=this._wt)},onCellContextMenu:(t,e,n,i)=>{const o=this.translateFromRenderableToVisualCoords(e);this.activeWt=i,kM(PM,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",t,o,n),Cy(t)||(this.hot.runHooks("afterOnCellContextMenu",t,o,n),this.activeWt=this._wt)},onCellMouseOut:(t,e,n,i)=>{const o=this.translateFromRenderableToVisualCoords(e);this.activeWt=i,this.hot.runHooks("beforeOnCellMouseOut",t,o,n),Cy(t)||(this.hot.runHooks("afterOnCellMouseOut",t,o,n),this.activeWt=this._wt)},onCellMouseOver:(t,e,n,i)=>{const o=this.translateFromRenderableToVisualCoords(e),r={row:!1,column:!1,cell:!1};this.activeWt=i,this.hot.runHooks("beforeOnCellMouseOver",t,o,n,r),Cy(t)||(HM(PM,this)&&CM(t,{coords:o,selection:this.hot.selection,controller:r,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseOver",t,o,n),this.activeWt=this._wt)},onCellMouseUp:(t,e,n,i)=>{const o=this.translateFromRenderableToVisualCoords(e);this.activeWt=i,this.hot.runHooks("beforeOnCellMouseUp",t,o,n),Cy(t)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",t,o,n),this.activeWt=this._wt)},onCellCornerMouseDown:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:(t,e)=>this.beforeRender(t,e),onDraw:t=>this.afterRender(t),onBeforeViewportScrollVertically:(t,e)=>{const n=this.hot.rowIndexMapper,i=t<0;let o=t;return i||(o=n.getVisualFromRenderableIndex(t),null!==o)?(o=this.hot.runHooks("beforeViewportScrollVertically",o,e),this.hot.runHooks("beforeViewportScroll"),i?o:n.getRenderableFromVisualIndex(o)):t},onBeforeViewportScrollHorizontally:(t,e)=>{const n=this.hot.columnIndexMapper,i=t<0;let o=t;return i||(o=n.getVisualFromRenderableIndex(t),null!==o)?(o=this.hot.runHooks("beforeViewportScrollHorizontally",o,e),this.hot.runHooks("beforeViewportScroll"),i?o:n.getRenderableFromVisualIndex(o)):t},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(t,e,n)=>{const i=this.hot.rowIndexMapper,o=t<0;let r=t;o||(r=i.getVisualFromRenderableIndex(t));const s=this.hot.runHooks("beforeHighlightingRowHeader",r,e,n);return o?s:i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(t,e,n)=>{const i=this.hot.columnIndexMapper,o=t<0;let r=t;o||(r=i.getVisualFromRenderableIndex(t));const s=this.hot.runHooks("beforeHighlightingColumnHeader",r,e,n);return o?s:i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(t,e,n)=>{let i;const[o,r]=this.translateFromRenderableToVisualIndex(t,e),s=this.hot.selection.getSelectedRange();if(s.size()>0){const t=s.peekByIndex(null!=n?n:0);i=[t.from.row,t.from.col,t.to.row,t.to.col]}return this.hot.runHooks("afterDrawSelection",o,r,i,n)},onBeforeDrawBorders:(t,e)=>{const[n,i,o,r]=t,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)];return this.hot.runHooks("beforeDrawBorders",s,e)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:t=>this.hot.runHooks("modifyRowHeaderWidth",t),onModifyGetCellCoords:(t,e,n,i)=>{const o=this.hot.rowIndexMapper,r=this.hot.columnIndexMapper,s=e>=0?r.getVisualFromRenderableIndex(e):e,l=t>=0?o.getVisualFromRenderableIndex(t):t,a=this.hot.runHooks("modifyGetCellCoords",l,s,n,i);if(Array.isArray(a)){const[t,e,n,i]=a;return[t>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(t,1)):t,e>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(e,1)):e,n>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(n,-1)):n,i>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(i,-1)):i]}},onModifyGetCoordsElement:(t,e)=>{const n=this.hot.rowIndexMapper,i=this.hot.columnIndexMapper,o=e>=0?i.getVisualFromRenderableIndex(e):e,r=t>=0?n.getVisualFromRenderableIndex(t):t,s=this.hot.runHooks("modifyGetCoordsElement",r,o);if(Array.isArray(s)){const[t,e]=s;return[t>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(t,1)):t,e>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,1)):e]}},viewportRowCalculatorOverride:t=>{let e=this.settings.viewportRowRenderingOffset;if("auto"===e&&this.settings.fixedRowsTop&&(e=10),e>0||"auto"===e){const n=this.countRenderableRows(),i=t.startRow,o=t.endRow;if("number"==typeof e)t.startRow=Math.max(i-e,0),t.endRow=Math.min(o+e,n-1);else if("auto"===e){const e=Math.max(1,Math.ceil(o/n*12));t.startRow=Math.max(i-e,0),t.endRow=Math.min(o+e,n-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:t=>{let e=this.settings.viewportColumnRenderingOffset;if("auto"===e&&this.settings.fixedColumnsStart&&(e=10),e>0||"auto"===e){const n=this.countRenderableColumns(),i=t.startColumn,o=t.endColumn;if("number"==typeof e&&(t.startColumn=Math.max(i-e,0),t.endColumn=Math.min(o+e,n-1)),"auto"===e){const e=Math.max(1,Math.ceil(o/n*6));t.startColumn=Math.max(i-e,0),t.endColumn=Math.min(o+e,n-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const t=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||t}};this.hot.runHooks("beforeInitWalkontable",t),this._wt=new vM(t),this.activeWt=this._wt;const e=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(e,"mousedown",(t=>{t.target===e&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(e,"contextmenu",(t=>{t.target===e&&3===t.which&&t.stopPropagation()})),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",(()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())}))}isTextSelectionAllowed(t){if(ev(t))return!0;const e=Cw(t,this._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!e)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!e)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return HM(PM,this)}isSelectedOnlyCell(){var t,e;return null!==(t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingleCell())&&void 0!==t&&t}isCellEdited(){const t=this.hot.getActiveEditor();return t&&t.isOpened()}beforeRender(t,e){t&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,e)}afterRender(t){t&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(t,e){if(e.firstChild){const n=e.firstChild;if(!Tw(n,"relative"))return Ow(e),void this.appendRowHeader(t,e);this.updateCellHeader(n.querySelector(".rowHeader"),t,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,o=n.createElement("div"),r=n.createElement("span");o.className="relative",r.className="rowHeader",this.updateCellHeader(r,t,i),o.appendChild(r),e.appendChild(o)}this.hot.runHooks("afterGetRowHeader",t,e)}appendColHeader(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const o=()=>{const e=t>=0?this.hot.getColumnMeta(t).headerClassName:null;return e?e.split(" "):[]};if(e.firstChild){const r=e.firstChild;Tw(r,"relative")?(this.updateCellHeader(r.querySelector(".colHeader"),t,n,i),r.className="",Mw(r,["relative",...o()])):(Ow(e),this.appendColHeader(t,e,n,i))}else{const{rootDocument:r}=this.hot,s=r.createElement("div"),l=r.createElement("span"),a=o();s.classList.add("relative",...a),l.className="colHeader",this.settings.ariaTags&&(Hw(s,"role","presentation"),Hw(l,"role","presentation")),this.updateCellHeader(l,t,n,i),s.appendChild(l),e.appendChild(s)}this.hot.runHooks("afterGetColHeader",t,e,i)}updateCellHeader(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e;const r=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&(Tw(t,"colHeader")?o=r.wtTable.columnFilter.sourceToRendered(e):Tw(t,"rowHeader")&&(o=r.wtTable.rowFilter.sourceToRendered(e))),o>-1?_w(t,n(e,i)):(Pw(t,String.fromCharCode(160)),Mw(t,"cornerHeader"))}maximumVisibleElementWidth(t){const e=this._wt.wtViewport.getWorkspaceWidth()-t;return e>0?e:0}maximumVisibleElementHeight(t){const e=this._wt.wtViewport.getWorkspaceHeight()-t;return e>0?e:0}setLastSize(t,e){kM(DM,this,t),kM(LM,this,e)}getLastSize(){return{width:HM(DM,this),height:HM(LM,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const t=this.hot.rowIndexMapper,e=t.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return t.getNearestNotHiddenIndex(null!=e?e:0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const t=this.hot.rowIndexMapper,e=t.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return t.getNearestNotHiddenIndex(null!=e?e:this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const t=this.hot.columnIndexMapper,e=t.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return t.getNearestNotHiddenIndex(null!=e?e:0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const t=this.hot.columnIndexMapper,e=t.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return t.getNearestNotHiddenIndex(null!=e?e:this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return HM(OM,this)}getRowHeadersCount(){return HM(AM,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(t){var e;return(null!==(e=this._wt.wtOverlays.getParentOverlay(t))&&void 0!==e?e:this._wt).wtTable.name}getOverlayByName(t){return this._wt.getOverlayByName(t)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}};var zM=rc,UM=Lt,YM=Qe,$M=us;yo({target:"Iterator",proto:!0,real:!0},{every:function(t){YM(this),UM(t);var e=$M(this),n=0;return!zM(e,(function(e,i){if(!t(e,n++))return i()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function GM(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t;const i=[];return Array.isArray(t)&&Array.isArray(t[0])||(n=[t]),n.forEach(((t,n)=>{Array.isArray(t)?t.forEach(((t,o)=>{i.push([n+e,o,t])})):Object.keys(t).forEach((o=>{i.push([n+e,o,t[o]])}))})),i}function KM(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Kv(t[0])&&(e=Qv(t[0]))),e}function XM(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const qM=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];XM(this,"hot",void 0),XM(this,"data",void 0),XM(this,"dataType","array"),XM(this,"colToProp",(()=>{})),XM(this,"propToCol",(()=>{})),this.hot=t,this.data=e}modifyRowData(t){let e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}getData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}setData(t){this.data=t}getAtColumn(t){const e=[];return Np(this.data,((n,i)=>{const o=this.getAtCell(i,t);e.push(o)})),e}getAtRow(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=void 0===e&&void 0===n,{dataDotNotation:r}=this.hot.getSettings();let s=null,l=null;if(s=this.modifyRowData(t),Array.isArray(s))l=[],o?s.forEach(((e,n)=>{l[n]=this.getAtPhysicalCell(t,n,s)})):VC(e,n,(n=>{l[n-e]=this.getAtPhysicalCell(t,n,s)}));else if(Kv(s)||sv(s))if(l=i?[]:{},!o||i){const o=0,a=this.countFirstRowKeys()-1;VC(o,a,(h=>{const c=this.colToProp(h);if(h>=(e||o)&&h<=(n||a)&&!Number.isInteger(c)){const e=this.getAtPhysicalCell(t,c,s);i?l.push(e):r?Zv(l,c,e):l[c]=e}}))}else qv(s,((e,n)=>{const i=this.getAtPhysicalCell(t,n,s);r?Zv(l,n,i):l[n]=i}));return l}setAtCell(t,e,n){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Jv(n);this.hot.runHooks("modifySourceData",t,e,i,"set"),i.isTouched()&&(n=i.value)}Number.isInteger(e)?this.data[t][e]=n:Zv(this.data[t],e,n)}}getAtPhysicalCell(t,e,n){let i=null;if(n)if("string"==typeof e){const{dataDotNotation:t}=this.hot.getSettings();i=t?function(t,e){const n=e.split(".");let i=t;return qv(n,(t=>{if(i=i[t],void 0===i)return i=void 0,!1})),i}(n,e):n[e]}else i="function"==typeof e?e(n):n[e];if(this.hot.hasHook("modifySourceData")){const n=Jv(i);this.hot.runHooks("modifySourceData",t,e,n,"get"),n.isTouched()&&(i=n.value)}return i}getAtCell(t,e){const n=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),n)}getByRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!1,o=null,r=null,s=null,l=null;null===t||null===e?(i=!0,o=0,s=this.countRows()-1):(o=Math.min(t.row,e.row),r=Math.min(t.col,e.col),s=Math.max(t.row,e.row),l=Math.max(t.col,e.col));const a=[];return VC(o,s,(t=>{a.push(i?this.getAtRow(t,void 0,void 0,n):this.getAtRow(t,r,l,n))})),a}countRows(){if(this.hot.hasHook("modifySourceLength")){const t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}countFirstRowKeys(){return KM(this.data)}destroy(){this.data=null,this.hot=null}};var ZM=rc,QM=Lt,JM=Qe,tx=us;function ex(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}yo({target:"Iterator",proto:!0,real:!0},{some:function(t){JM(this),QM(t);var e=tx(this),n=0;return ZM(e,(function(e,i){if(t(e,n++))return i()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});class nx{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;ex(this,"indexedValues",[]),ex(this,"initValueOrFn",void 0),this.initValueOrFn=t}getValues(){return this.indexedValues}getValueAtIndex(t){const e=this.indexedValues;if(t<e.length)return e[t]}setValues(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}setValueAtIndex(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,sv(this.initValueOrFn)?VC(t-1,(t=>this.indexedValues.push(this.initValueOrFn(t)))):VC(t-1,(()=>this.indexedValues.push(this.initValueOrFn))),this.runLocalHooks("change")}init(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function ix(t,e,n,i){const o=n.length?n[0]:void 0;return[...t.slice(0,o),...n.map(((t,e)=>sv(i)?i(t,e):i)),...void 0===o?[]:t.slice(o)]}function ox(t,e){return _p(t,((t,n)=>!1===e.includes(n)))}$v(nx,UE);class rx extends nx{insert(t,e){this.indexedValues=ix(this.indexedValues,0,e,this.initValueOrFn),super.insert(t,e)}remove(t){this.indexedValues=ox(this.indexedValues,t),super.remove(t)}}class sx extends rx{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getHiddenIndexes(){return Ap(this.getValues(),((t,e,n)=>(e&&t.push(n),t)),[])}}function lx(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function ax(t,e){return _p(t,(t=>!1===e.includes(t)))}function hx(t,e){return Pp(t,(t=>t-e.filter((e=>e<t)).length))}function cx(t,e){const n=e[0],i=e.length;return Pp(t,(t=>t>=n?t+i:t))}function ux(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class dx extends nx{constructor(){super(...arguments),ux(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map((t=>this.indexedValues[t]))}setValues(t){this.orderOfIndexes=[...Array(t.length).keys()],super.setValues(t)}setValueAtIndex(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(n,0,t),this.runLocalHooks("change"),!0)}clearValue(t){this.orderOfIndexes=ax(this.orderOfIndexes,[t]),sv(this.initValueOrFn)?super.setValueAtIndex(t,this.initValueOrFn(t)):super.setValueAtIndex(t,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(t)}insert(t,e){this.indexedValues=ix(this.indexedValues,0,e,this.initValueOrFn),this.orderOfIndexes=cx(this.orderOfIndexes,e),super.insert(t,e)}remove(t){this.indexedValues=ox(this.indexedValues,t),this.orderOfIndexes=ax(this.orderOfIndexes,t),this.orderOfIndexes=hx(this.orderOfIndexes,t),super.remove(t)}getEntries(){return this.orderOfIndexes.map((t=>[t,this.getValueAtIndex(t)]))}}class gx extends rx{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getTrimmedIndexes(){return Ap(this.getValues(),((t,e,n)=>(e&&t.push(n),t)),[])}}const fx=new Map([["indexesSequence",{getListWithInsertedItems:lx,getListWithRemovedItems:ax}],["physicallyIndexed",{getListWithInsertedItems:ix,getListWithRemovedItems:ox}]]),mx=t=>{if(!1===fx.has(t))throw new Error(`Alter strategy with ID '${t}' does not exist.`);return fx.get(t)};class px extends nx{constructor(){super((t=>t))}insert(t,e){const n=cx(this.indexedValues,e);this.indexedValues=lx(n,t,e),super.insert(t,e)}remove(t){const e=ax(this.indexedValues,t);this.indexedValues=hx(e,t),super.remove(t)}}const wx=new Map([["hiding",sx],["index",nx],["linkedPhysicalIndexToValue",dx],["physicalIndexToValue",rx],["trimming",gx]]);function vx(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class yx{constructor(){vx(this,"collection",new Map)}register(t,e){!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",(()=>this.runLocalHooks("change",e))))}unregister(t){const e=this.collection.get(t);jp(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e))}unregisterAll(){this.collection.forEach(((t,e)=>this.unregister(e))),this.collection.clear()}get(t){return Bp(t)?Array.from(this.collection.values()):this.collection.get(t)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach((e=>{e.remove(t)}))}insertToEvery(t,e){this.collection.forEach((n=>{n.insert(t,e)}))}initEvery(t){this.collection.forEach((e=>{e.init(t)}))}}function bx(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}$v(yx,UE);class Cx extends yx{constructor(t,e){super(),bx(this,"mergedValuesCache",[]),bx(this,"aggregationFunction",void 0),bx(this,"fallbackValue",void 0),this.aggregationFunction=t,this.fallbackValue=e}getMergedValues(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];const t=Pp(this.get(),(t=>t.getValues())),e=[],n=jp(t[0])&&t[0].length||0;for(let i=0;i<n;i+=1){const n=[];for(let e=0;e<this.getLength();e+=1)n.push(t[e][i]);e.push(n)}return Pp(e,this.aggregationFunction)}getMergedValueAtIndex(t,e){const n=this.getMergedValues(e)[t];return jp(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Sx(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Rx(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ex=new WeakMap;class Tx{constructor(){Sx(this,Ex,[])}subscribe(t){var e,n;return this.addLocalHook("change",t),this._write((n=this,(e=Ex).get(Rx(e,n)))),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(t){return t.length>0&&this.runLocalHooks("change",t),this}_writeInitialChanges(t){var e,n,i;n=this,i=t,(e=Ex).set(Rx(e,n),i)}}function Mx(t,e){const n=[];let i=0,o=0;for(;i<t.length&&o<e.length;i++,o++)t[i]!==e[o]&&n.push({op:"replace",index:o,oldValue:t[i],newValue:e[o]});for(;i<e.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;o<t.length;o++)n.push({op:"remove",index:o,oldValue:t[o],newValue:void 0});return n}function xx(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Hx(t,e){return t.get(Ix(t,e))}function kx(t,e,n){return t.set(Ix(t,e),n),n}function Ix(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}$v(Tx,UE);var Ox=new WeakMap,Ax=new WeakMap,_x=new WeakMap,Px=new WeakMap,Nx=new WeakMap;class Dx{constructor(){let{initialIndexValue:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};xx(this,Ox,new Set),xx(this,Ax,[]),xx(this,_x,[]),xx(this,Px,!1),xx(this,Nx,!1),kx(Nx,this,null!=t&&t)}createObserver(){const t=new Tx;return Hx(Ox,this).add(t),t.addLocalHook("unsubscribe",(()=>{Hx(Ox,this).delete(t)})),t._writeInitialChanges(Mx(Hx(Ax,this),Hx(_x,this))),t}emit(t){let e=Hx(_x,this);Hx(Px,this)&&Hx(Ax,this).length===t.length||(0===t.length?t=new Array(e.length).fill(Hx(Nx,this)):kx(Ax,this,new Array(t.length).fill(Hx(Nx,this))),Hx(Px,this)||(kx(Px,this,!0),e=Hx(Ax,this)));const n=Mx(e,t);Hx(Ox,this).forEach((t=>t._write(n))),kx(_x,this,t)}}function Lx(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Vx{constructor(){Lx(this,"indexesSequence",new px),Lx(this,"trimmingMapsCollection",new Cx((t=>t.some((t=>!0===t))),!1)),Lx(this,"hidingMapsCollection",new Cx((t=>t.some((t=>!0===t))),!1)),Lx(this,"variousMapsCollection",new yx),Lx(this,"hidingChangesObservable",new Dx({initialIndexValue:!1})),Lx(this,"notTrimmedIndexesCache",[]),Lx(this,"notHiddenIndexesCache",[]),Lx(this,"isBatched",!1),Lx(this,"indexesSequenceChanged",!1),Lx(this,"indexesChangeSource",void 0),Lx(this,"trimmedIndexesChanged",!1),Lx(this,"hiddenIndexesChanged",!1),Lx(this,"renderablePhysicalIndexesCache",[]),Lx(this,"fromPhysicalToVisualIndexesCache",new Map),Lx(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",(()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(t=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(t=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(t=>{this.runLocalHooks("change",t,this.variousMapsCollection)}))}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(t){if("hiding"!==t)throw new Error(`Unsupported index map type "${t}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(t,e,n){return this.registerMap(t,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!wx.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(wx.get(t))(e)}(e,n))}registerMap(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error(`Map with name "${t}" has been already registered.`);e instanceof gx?this.trimmingMapsCollection.register(t,e):e instanceof sx?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);const n=this.getNumberOfIndexes();return n>0&&e.init(n),e}unregisterMap(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(t){const e=this.notTrimmedIndexesCache[t];return jp(e)?e:null}getPhysicalFromRenderableIndex(t){const e=this.renderablePhysicalIndexesCache[t];return jp(e)?e:null}getVisualFromPhysicalIndex(t){const e=this.fromPhysicalToVisualIndexesCache.get(t);return jp(e)?e:null}getVisualFromRenderableIndex(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}getRenderableFromVisualIndex(t){const e=this.fromVisualToRenderableIndexesCache.get(t);return jp(e)?e:null}getNearestNotHiddenIndex(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(t))return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;const i=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return o=e>0?i.findIndex((e=>e>t)):i.reverse().findIndex((e=>e<t)),-1===o?n?this.getNearestNotHiddenIndex(t,-e,!1):null:i[o]}initToLength(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(t).keys()],this.notHiddenIndexesCache=[...new Array(t).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){const e=this.getNumberOfIndexes();if(t<e){const e=[...Array(this.getNumberOfIndexes()-t).keys()].map((e=>e+t));this.removeIndexes(e)}else this.insertIndexes(e,t-e)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notTrimmedIndexesCache;return this.getIndexesSequence().filter((t=>!1===this.isTrimmed(t)))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notHiddenIndexesCache;return this.getIndexesSequence().filter((t=>!1===this.isHidden(t)))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.renderablePhysicalIndexesCache;return this.getNotTrimmedIndexes().filter((t=>!1===this.isHidden(t)))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(t,e){"number"==typeof t&&(t=[t]);const n=Pp(t,(t=>this.getPhysicalFromVisualIndex(t))),i=this.getNotTrimmedIndexesLength(),o=t.length,r=ax(this.getIndexesSequence(),n),s=r.filter((t=>!1===this.isTrimmed(t)));let l=r.indexOf(s[s.length-1])+1;if(e+o<i){const t=s[e];l=r.indexOf(t)}this.indexesChangeSource="move",this.setIndexesSequence(lx(r,l,n)),this.indexesChangeSource=void 0}isTrimmed(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}isHidden(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}insertIndexes(t,e){const n=this.getNotTrimmedIndexes()[t],i=jp(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),r=Pp(new Array(e).fill(i),((t,e)=>t+e));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,r),this.hidingMapsCollection.insertToEvery(o,r),this.variousMapsCollection.insertToEvery(o,r),this.resumeOperations()}removeIndexes(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}updateCache(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(t,e)}}cacheFromVisualToRenderableIndexes(){const t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){const t=this.getPhysicalFromRenderableIndex(e),n=this.getVisualFromPhysicalIndex(t);this.fromVisualToRenderableIndexesCache.set(n,e)}}}function Fx(t){const e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return e?`${e[1].toLowerCase()}-${e[2].toUpperCase()}`:t}function Wx(t){jp(t)&&Ty(Fp`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}$v(Vx,UE);const{register:jx,getValues:Bx}=cb("phraseFormatters");jx("pluralize",(function(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}));const zx="ContextMenu:items",Ux=`${zx}.noItems`,Yx=`${zx}.insertRowAbove`,$x=`${zx}.insertRowBelow`,Gx=`${zx}.insertColumnOnTheLeft`,Kx=`${zx}.insertColumnOnTheRight`,Xx=`${zx}.removeRow`,qx=`${zx}.removeColumn`,Zx=`${zx}.undo`,Qx=`${zx}.redo`,Jx=`${zx}.readOnly`,tH=`${zx}.clearColumn`,eH=`${zx}.copy`,nH=`${zx}.copyWithHeaders`,iH=`${zx}.copyWithGroupHeaders`,oH=`${zx}.copyHeadersOnly`,rH=`${zx}.cut`,sH=`${zx}.freezeColumn`,lH=`${zx}.unfreezeColumn`,aH=`${zx}.mergeCells`,hH=`${zx}.unmergeCells`,cH=`${zx}.addComment`,uH=`${zx}.editComment`,dH=`${zx}.removeComment`,gH=`${zx}.readOnlyComment`,fH=`${zx}.align`,mH=`${zx}.align.left`,pH=`${zx}.align.center`,wH=`${zx}.align.right`,vH=`${zx}.align.justify`,yH=`${zx}.align.top`,bH=`${zx}.align.middle`,CH=`${zx}.align.bottom`,SH=`${zx}.borders`,RH=`${zx}.borders.top`,EH=`${zx}.borders.right`,TH=`${zx}.borders.bottom`,MH=`${zx}.borders.left`,xH=`${zx}.borders.remove`,HH=`${zx}.nestedHeaders.insertChildRow`,kH=`${zx}.nestedHeaders.detachFromParent`,IH=`${zx}.hideColumn`,OH=`${zx}.showColumn`,AH=`${zx}.hideRow`,_H=`${zx}.showRow`,PH="Filters:",NH=`${PH}conditions`,DH=`${NH}.none`,LH=`${NH}.isEmpty`,VH=`${NH}.isNotEmpty`,FH=`${NH}.isEqualTo`,WH=`${NH}.isNotEqualTo`,jH=`${NH}.beginsWith`,BH=`${NH}.endsWith`,zH=`${NH}.contains`,UH=`${NH}.doesNotContain`,YH=`${NH}.byValue`,$H=`${NH}.greaterThan`,GH=`${NH}.greaterThanOrEqualTo`,KH=`${NH}.lessThan`,XH=`${NH}.lessThanOrEqualTo`,qH=`${NH}.isBetween`,ZH=`${NH}.isNotBetween`,QH=`${NH}.after`,JH=`${NH}.before`,tk=`${NH}.today`,ek=`${NH}.tomorrow`,nk=`${NH}.yesterday`,ik=`${PH}labels.filterByCondition`,ok=`${PH}labels.filterByValue`,rk=`${PH}labels.conjunction`,sk=`${PH}labels.disjunction`,lk=`${PH}values.blankCells`,ak=`${PH}buttons.selectAll`,hk=`${PH}buttons.clear`,ck=`${PH}buttons.ok`,uk=`${PH}buttons.cancel`,dk=`${PH}buttons.placeholder.search`,gk=`${PH}buttons.placeholder.value`,fk=`${PH}buttons.placeholder.secondValue`,mk="CheckboxRenderer:",pk=`${mk}checked`,wk=`${mk}unchecked`,vk=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:pk,CHECKBOX_RENDERER_NAMESPACE:mk,CHECKBOX_UNCHECKED:wk,CONTEXTMENU_ITEMS_ADD_COMMENT:cH,CONTEXTMENU_ITEMS_ALIGNMENT:fH,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:CH,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:pH,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:vH,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:mH,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:bH,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:wH,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:yH,CONTEXTMENU_ITEMS_BORDERS:SH,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:TH,CONTEXTMENU_ITEMS_BORDERS_LEFT:MH,CONTEXTMENU_ITEMS_BORDERS_RIGHT:EH,CONTEXTMENU_ITEMS_BORDERS_TOP:RH,CONTEXTMENU_ITEMS_CLEAR_COLUMN:tH,CONTEXTMENU_ITEMS_COPY:eH,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:oH,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:iH,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:nH,CONTEXTMENU_ITEMS_CUT:rH,CONTEXTMENU_ITEMS_EDIT_COMMENT:uH,CONTEXTMENU_ITEMS_FREEZE_COLUMN:sH,CONTEXTMENU_ITEMS_HIDE_COLUMN:IH,CONTEXTMENU_ITEMS_HIDE_ROW:AH,CONTEXTMENU_ITEMS_INSERT_LEFT:Gx,CONTEXTMENU_ITEMS_INSERT_RIGHT:Kx,CONTEXTMENU_ITEMS_MERGE_CELLS:aH,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:kH,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:HH,CONTEXTMENU_ITEMS_NO_ITEMS:Ux,CONTEXTMENU_ITEMS_READ_ONLY:Jx,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:gH,CONTEXTMENU_ITEMS_REDO:Qx,CONTEXTMENU_ITEMS_REMOVE_BORDERS:xH,CONTEXTMENU_ITEMS_REMOVE_COLUMN:qx,CONTEXTMENU_ITEMS_REMOVE_COMMENT:dH,CONTEXTMENU_ITEMS_REMOVE_ROW:Xx,CONTEXTMENU_ITEMS_ROW_ABOVE:Yx,CONTEXTMENU_ITEMS_ROW_BELOW:$x,CONTEXTMENU_ITEMS_SHOW_COLUMN:OH,CONTEXTMENU_ITEMS_SHOW_ROW:_H,CONTEXTMENU_ITEMS_UNDO:Zx,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:lH,CONTEXTMENU_ITEMS_UNMERGE_CELLS:hH,CONTEXT_MENU_ITEMS_NAMESPACE:zx,FILTERS_BUTTONS_CANCEL:uk,FILTERS_BUTTONS_CLEAR:hk,FILTERS_BUTTONS_OK:ck,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:dk,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:fk,FILTERS_BUTTONS_PLACEHOLDER_VALUE:gk,FILTERS_BUTTONS_SELECT_ALL:ak,FILTERS_CONDITIONS_AFTER:QH,FILTERS_CONDITIONS_BEFORE:JH,FILTERS_CONDITIONS_BEGINS_WITH:jH,FILTERS_CONDITIONS_BETWEEN:qH,FILTERS_CONDITIONS_BY_VALUE:YH,FILTERS_CONDITIONS_CONTAINS:zH,FILTERS_CONDITIONS_EMPTY:LH,FILTERS_CONDITIONS_ENDS_WITH:BH,FILTERS_CONDITIONS_EQUAL:FH,FILTERS_CONDITIONS_GREATER_THAN:$H,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:GH,FILTERS_CONDITIONS_LESS_THAN:KH,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:XH,FILTERS_CONDITIONS_NAMESPACE:NH,FILTERS_CONDITIONS_NONE:DH,FILTERS_CONDITIONS_NOT_BETWEEN:ZH,FILTERS_CONDITIONS_NOT_CONTAIN:UH,FILTERS_CONDITIONS_NOT_EMPTY:VH,FILTERS_CONDITIONS_NOT_EQUAL:WH,FILTERS_CONDITIONS_TODAY:tk,FILTERS_CONDITIONS_TOMORROW:ek,FILTERS_CONDITIONS_YESTERDAY:nk,FILTERS_DIVS_FILTER_BY_CONDITION:ik,FILTERS_DIVS_FILTER_BY_VALUE:ok,FILTERS_LABELS_CONJUNCTION:rk,FILTERS_LABELS_DISJUNCTION:sk,FILTERS_NAMESPACE:PH,FILTERS_VALUES_BLANK_CELLS:lk},Symbol.toStringTag,{value:"Module"})),yk={languageCode:"en-US",[Ux]:"No available options",[Yx]:"Insert row above",[$x]:"Insert row below",[Gx]:"Insert column left",[Kx]:"Insert column right",[Xx]:["Remove row","Remove rows"],[qx]:["Remove column","Remove columns"],[Zx]:"Undo",[Qx]:"Redo",[Jx]:"Read only",[tH]:"Clear column",[fH]:"Alignment",[mH]:"Left",[pH]:"Center",[wH]:"Right",[vH]:"Justify",[yH]:"Top",[bH]:"Middle",[CH]:"Bottom",[sH]:"Freeze column",[lH]:"Unfreeze column",[SH]:"Borders",[RH]:"Top",[EH]:"Right",[TH]:"Bottom",[MH]:"Left",[xH]:"Remove border(s)",[cH]:"Add comment",[uH]:"Edit comment",[dH]:"Delete comment",[gH]:"Read-only comment",[aH]:"Merge cells",[hH]:"Unmerge cells",[eH]:"Copy",[nH]:["Copy with header","Copy with headers"],[iH]:["Copy with group header","Copy with group headers"],[oH]:["Copy header only","Copy headers only"],[rH]:"Cut",[HH]:"Insert child row",[kH]:"Detach from parent",[IH]:["Hide column","Hide columns"],[OH]:["Show column","Show columns"],[AH]:["Hide row","Hide rows"],[_H]:["Show row","Show rows"],[DH]:"None",[LH]:"Is empty",[VH]:"Is not empty",[FH]:"Is equal to",[WH]:"Is not equal to",[jH]:"Begins with",[BH]:"Ends with",[zH]:"Contains",[UH]:"Does not contain",[$H]:"Greater than",[GH]:"Greater than or equal to",[KH]:"Less than",[XH]:"Less than or equal to",[qH]:"Is between",[ZH]:"Is not between",[QH]:"After",[JH]:"Before",[tk]:"Today",[ek]:"Tomorrow",[nk]:"Yesterday",[lk]:"Blank cells",[ik]:"Filter by condition",[ok]:"Filter by value",[rk]:"And",[sk]:"Or",[ak]:"Select all",[hk]:"Clear",[ck]:"OK",[uk]:"Cancel",[dk]:"Search",[gk]:"Value",[fk]:"Second value",[pk]:"Checked",[wk]:"Unchecked"},bk=vk,Ck=yk.languageCode,{register:Sk,getItem:Rk,hasItem:Ek,getValues:Tk}=cb("languagesDictionaries");function Mk(t,e){let n=t,i=e;return Kv(t)&&(i=t,n=i.languageCode),function(t,e){t!==Ck&&(n=e,qv(Rk(Ck),((t,e)=>{Bp(n[e])&&(n[e]=t)})));var n}(n,i),Sk(n,Uv(i)),Uv(i)}function xk(t){return Hk(t)?Uv(Rk(t)):null}function Hk(t){return Ek(t)}function kk(t,e,n){const i=xk(t);if(null===i)return null;const o=i[e];if(Bp(o))return null;const r=function(t,e){let n=t;return Np(function(){return Bx()}(),(i=>{n=i(t,e)})),n}(o,n);return Array.isArray(r)?r[0]:r}function Ik(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Mk(yk);const Ok=class extends $E{constructor(t,e){super(t,null),Ik(this,"visualCellRange",null),this.visualCellRange=e||null,this.commit()}add(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(t){let{from:e,to:n}=t,i=this.getNearestNotHiddenCoords(e,1),o=this.getNearestNotHiddenCoords(n,-1);return null===i||null===o?null:((i.row>o.row||i.col>o.col)&&(i=e,o=n),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,t.row,e);if(null===i)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,t.col,n);return null===o?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}commit(){if(null===this.visualCellRange)return this;const t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===t?null:this.createRenderableCellRange(t.from,t.to),this}syncWith(t){const e=t.from.clone().normalize(),n="N-S"===t.getVerticalDirection()?1:-1,i="W-E"===t.getHorizontalDirection()?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let r=null;if(null!==o&&null!==o.col&&null!==o.row||(r=this.getNearestNotHiddenCoords(e,n,i)),null!==r&&t.overlaps(r)){const e=t.highlight.clone();if(e.row>=0&&(e.row=r.row),e.col>=0&&(e.col=r.col),null===this.cellRange){const t=this.settings.visualToRenderableCoords(e);this.cellRange=this.settings.createCellRange(t)}t.setHighlight(e)}return"focus"===this.settings.selectionType&&null!==o&&null===r&&t.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:t,to:e}=this.cellRange;return[Math.min(t.row,e.row),Math.min(t.col,e.col),Math.max(t.row,e.row),Math.max(t.col,e.col)]}getVisualCorners(){const t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}createRenderableCellRange(t,e){const n=this.settings.visualToRenderableCoords(t),i=this.settings.visualToRenderableCoords(e);return null===n.row||null===n.col||null===i.row||null===i.col?null:this.settings.createCellRange(n,n,i)}};function Ak(t){let e=t,{activeHeaderClassName:n}=e,i=c(e,["activeHeaderClassName"]);return new Ok(h(a({className:n},i),{selectionType:GE}))}function _k(t){let e=t,{areaCornerVisible:n}=e,i=c(e,["areaCornerVisible"]);return new Ok(h(a({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:n}},i),{selectionType:XE}))}function Pk(t){let e=c(t,[]);return new Ok(h(a({className:"highlight"},e),{selectionType:XE}))}function Nk(t){let e=t,{columnClassName:n}=e,i=c(e,["columnClassName"]);return new Ok(h(a({className:n},i),{selectionType:"column"}))}function Dk(t){let e=t,{headerClassName:n}=e,i=c(e,["headerClassName"]);return new Ok(h(a({className:n},i),{selectionType:KE}))}function Lk(t){let e=t,{rowClassName:n}=e,i=c(e,["rowClassName"]);return new Ok(h(a({className:n},i),{selectionType:"row"}))}function Vk(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function Fk(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wk(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jk=new WeakSet;class Bk{constructor(t){Vk(this,jk),Fk(this,"options",void 0),Fk(this,"layerLevel",0),Fk(this,"focus",void 0),Fk(this,"fill",void 0),Fk(this,"layeredAreas",new Map),Fk(this,"areas",new Map),Fk(this,"rowHeaders",new Map),Fk(this,"columnHeaders",new Map),Fk(this,"activeRowHeaders",new Map),Fk(this,"activeColumnHeaders",new Map),Fk(this,"activeCornerHeaders",new Map),Fk(this,"rowHighlights",new Map),Fk(this,"columnHighlights",new Map),Fk(this,"customSelections",[]),this.options=t,this.focus=function(t){let e=t,{cellCornerVisible:n}=e,i=c(e,["cellCornerVisible"]);return new Ok(h(a({className:"current",headerAttributes:[["aria-selected","true"]],border:{width:2,color:"#4b89ff",cornerVisible:n}},i),{selectionType:qE}))}(t),this.fill=function(t){let e=c(t,[]);return new Ok(h(a({className:"fill",border:{width:1,color:"#ff0000"}},e),{selectionType:"fill"}))}(t)}isEnabledFor(t,e){let n=t;t===qE&&(n="current");let i=this.options.disabledCellSelection(e.row,e.col);return"string"==typeof i&&(i=[i]),!1===i||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Wk(jk,this,zk).call(this,this.layeredAreas,_k)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Wk(jk,this,zk).call(this,this.areas,Pk)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Wk(jk,this,zk).call(this,this.rowHeaders,Dk)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Wk(jk,this,zk).call(this,this.columnHeaders,Dk)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Wk(jk,this,zk).call(this,this.activeRowHeaders,Ak)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Wk(jk,this,zk).call(this,this.activeColumnHeaders,Ak)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Wk(jk,this,zk).call(this,this.activeCornerHeaders,Ak)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Wk(jk,this,zk).call(this,this.rowHighlights,Lk)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Wk(jk,this,zk).call(this,this.columnHighlights,Nk)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(t){this.customSelections.push(function(t){let e=t,{border:n,visualCellRange:i}=e,o=c(e,["border","visualCellRange"]);return new Ok(h(a(a({},n),o),{selectionType:"custom-selection"}),i)}(a(a({},this.options),t)))}clear(){this.focus.clear(),this.fill.clear(),Np(this.areas.values(),(t=>{t.clear()})),Np(this.layeredAreas.values(),(t=>{t.clear()})),Np(this.rowHeaders.values(),(t=>{t.clear()})),Np(this.columnHeaders.values(),(t=>{t.clear()})),Np(this.activeRowHeaders.values(),(t=>{t.clear()})),Np(this.activeColumnHeaders.values(),(t=>{t.clear()})),Np(this.activeCornerHeaders.values(),(t=>{t.clear()})),Np(this.rowHighlights.values(),(t=>{t.clear()})),Np(this.columnHighlights.values(),(t=>{t.clear()}))}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function zk(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const i=e(a({layerLevel:n},this.options));return t.set(n,i),i}const Uk=Bk;function Yk(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class $k{constructor(t){Yk(this,"ranges",[]),Yk(this,"createCellRange",void 0),this.createCellRange=t}isEmpty(){return 0===this.size()}set(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}add(t){return this.ranges.push(this.createCellRange(t)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(t){return this.ranges.some((e=>e.includes(t)))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const Gk=$k;function Kk(t,e,n){Xk(t,e),e.set(t,n)}function Xk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qk(t,e){return t.get(Qk(t,e))}function Zk(t,e,n){return t.set(Qk(t,e),n),n}function Qk(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jk=new WeakMap,tI=new WeakMap,eI=new WeakMap,nI=new WeakSet;class iI{constructor(t,e){var n,i;Xk(n=this,i=nI),i.add(n),Kk(this,Jk,void 0),Kk(this,tI,void 0),Kk(this,eI,{x:0,y:0}),Zk(Jk,this,t),Zk(tI,this,e)}transformStart(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=qk(tI,this).createCellCoords(t,e);let o=qk(Jk,this).current().highlight;const r=qk(tI,this).visualToRenderableCoords(o);let s=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),null!==r.row&&null!==r.col){const{width:t,height:e}=Qk(nI,this,rI).call(this),{row:r,col:a}=Qk(nI,this,aI).call(this,o),h=qk(tI,this).fixedRowsBottom(),c=qk(tI,this).minSpareRows(),u=qk(tI,this).minSpareCols(),d=qk(tI,this).autoWrapRow(),g=qk(tI,this).autoWrapCol(),f=qk(tI,this).createCellCoords(r+i.row,a+i.col);if(f.row>=e){const i=Jv(n&&c>0&&0===h),o=f.col+1,r=qk(tI,this).createCellCoords(f.row-e,o>=t?o-t:o);this.runLocalHooks("beforeColumnWrap",i,Qk(nI,this,hI).call(this,r),o>=t),i.value?this.runLocalHooks("insertRowRequire",qk(tI,this).countRenderableRows()):g&&f.assign(r)}else if(f.row<0){const n=Jv(g),i=f.col-1,o=qk(tI,this).createCellCoords(e+f.row,i<0?t+i:i);this.runLocalHooks("beforeColumnWrap",n,Qk(nI,this,hI).call(this,o),i<0),g&&f.assign(o)}if(f.col>=t){const i=Jv(n&&u>0),o=f.row+1,r=qk(tI,this).createCellCoords(o>=e?o-e:o,f.col-t);this.runLocalHooks("beforeRowWrap",i,Qk(nI,this,hI).call(this,r),o>=e),i.value?this.runLocalHooks("insertColRequire",qk(tI,this).countRenderableColumns()):d&&f.assign(r)}else if(f.col<0){const n=Jv(d),i=f.row-1,o=qk(tI,this).createCellCoords(i<0?e+i:i,t+f.col);this.runLocalHooks("beforeRowWrap",n,Qk(nI,this,hI).call(this,o),i<0),d&&f.assign(o)}const{rowDir:m,colDir:p}=Qk(nI,this,oI).call(this,f);s=m,l=p,o=Qk(nI,this,hI).call(this,f)}return this.runLocalHooks("afterTransformStart",o,s,l),o}transformEnd(t,e){const n=qk(tI,this).createCellCoords(t,e),i=qk(Jk,this).current(),o=qk(tI,this).visualToRenderableCoords(i.highlight),r=Qk(nI,this,sI).call(this,i.to.row,i.from.row),s=Qk(nI,this,lI).call(this,i.to.col,i.from.col),l=i.to.clone();let a=0,h=0;if(this.runLocalHooks("beforeTransformEnd",n),null!==o.row&&null!==o.col&&null!==r&&null!==s){const{row:t,col:e}=Qk(nI,this,aI).call(this,i.highlight),o=qk(tI,this).createCellCoords(r+n.row,s+n.col),c=i.getTopStartCorner(),u=i.getTopEndCorner(),d=i.getBottomEndCorner();if(n.col<0&&s>=e&&o.col<e){const t=o.col-e;o.col=Qk(nI,this,lI).call(this,c.col,u.col)+t}else if(n.col>0&&s<=e&&o.col>e){const t=Qk(nI,this,lI).call(this,u.col,c.col),e=Math.max(o.col-t,1);o.col=t+e}if(n.row<0&&r>=t&&o.row<t){const e=o.row-t;o.row=Qk(nI,this,sI).call(this,c.row,d.row)+e}else if(n.row>0&&r<=t&&o.row>t){const t=Qk(nI,this,sI).call(this,d.row,c.row),e=Math.max(o.row-t,1);o.row=t+e}const{rowDir:g,colDir:f}=Qk(nI,this,oI).call(this,o);a=g,h=f;const m=Qk(nI,this,hI).call(this,o);0===n.row&&0!==n.col?l.col=m.col:0!==n.row&&0===n.col?l.row=m.row:(l.row=m.row,l.col=m.col)}return this.runLocalHooks("afterTransformEnd",l,a,h),l}setOffsetSize(t){let{x:e,y:n}=t;Zk(eI,this,{x:e,y:n})}resetOffsetSize(){Zk(eI,this,{x:0,y:0})}}function oI(t){const{width:e,height:n}=Qk(nI,this,rI).call(this);let i=0,o=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=n&&(i=1,t.row=n-1),t.col<0?(o=-1,t.col=0):t.col>0&&t.col>=e&&(o=1,t.col=e-1),{rowDir:i,colDir:o}}function rI(){return{width:qk(eI,this).x+qk(tI,this).countRenderableColumns(),height:qk(eI,this).y+qk(tI,this).countRenderableRows()}}function sI(t,e){const n=qk(tI,this).findFirstNonHiddenRenderableRow(t,e);return null===n?null:qk(eI,this).y+n}function lI(t,e){const n=qk(tI,this).findFirstNonHiddenRenderableColumn(t,e);return null===n?null:qk(eI,this).x+n}function aI(t){const{row:e,col:n}=qk(tI,this).visualToRenderableCoords(t);if(null===e||null===n)throw new Error("Renderable coords are not visible.");return qk(tI,this).createCellCoords(qk(eI,this).y+e,qk(eI,this).x+n)}function hI(t){const e=t.clone();return e.col=t.col-qk(eI,this).x,e.row=t.row-qk(eI,this).y,qk(tI,this).renderableToVisualCoords(e)}$v(iI,UE);const cI=iI,uI=[3,2],dI=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],gI=Symbol("root"),fI=Symbol("child");function mI(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gI;if(e!==gI&&e!==fI)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),i=e===gI;let o=0;if(n){const e=t[0];if(0===t.length)o=1;else if(i&&e instanceof aR)o=3;else if(i&&Array.isArray(e))o=mI(e,fI);else if(t.length>=2&&t.length<=4){!t.some(((t,e)=>!dI[e].includes(typeof t)))&&(o=2)}}return o}function pI(t){let{createCellCoords:e,createCellRange:n,keepDirection:i=!1,propToCol:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!uI.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(r){const s=3===t;let l=s?r.from.row:r[0],a=s?r.from.col:r[1],h=s?r.to.row:r[2],c=s?r.to.col:r[3];if("function"==typeof o&&("string"==typeof a&&(a=o(a)),"string"==typeof c&&(c=o(c))),Bp(h)&&(h=l),Bp(c)&&(c=a),!i){const t=l,e=a,n=h,i=c;l=Math.min(t,n),a=Math.min(e,i),h=Math.max(t,n),c=Math.max(e,i)}const u=e(l,a),d=e(h,c);return n(u,u,d)}}function wI(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function vI(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yI(t,e){return t.get(CI(t,e))}function bI(t,e,n){return t.set(CI(t,e),n),n}function CI(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var SI=new WeakMap,RI=new WeakMap,EI=new WeakMap,TI=new WeakMap,MI=new WeakMap,xI=new WeakMap;class HI{constructor(t,e){var n=this;vI(this,"settings",void 0),vI(this,"tableProps",void 0),vI(this,"inProgress",!1),vI(this,"selectedRange",new Gk(((t,e,n)=>this.tableProps.createCellRange(t,e,n)))),vI(this,"highlight",void 0),wI(this,SI,void 0),wI(this,RI,void 0),vI(this,"selectedByRowHeader",new Set),vI(this,"selectedByColumnHeader",new Set),wI(this,EI,!1),wI(this,TI,!1),wI(this,MI,"unknown"),wI(this,xI,-1),this.settings=t,this.tableProps=e,this.highlight=new Uk({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,cellAttributes:[["aria-selected","true"]],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(t,e)=>this.tableProps.isDisabledCellSelection(t,e),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),createCellRange:(t,e,n)=>this.tableProps.createCellRange(t,e,n)}),bI(SI,this,new cI(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),fixedRowsBottom:()=>t.fixedRowsBottom,minSpareRows:()=>t.minSpareRows,minSpareCols:()=>t.minSpareCols,autoWrapRow:()=>t.autoWrapRow,autoWrapCol:()=>t.autoWrapCol})),bI(RI,this,new cI(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const t=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,t.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const t=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,t.getOuterBottomEndCorner().col)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),yI(SI,this).addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n.runLocalHooks("beforeModifyTransformStart",...e)})),yI(SI,this).addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n.runLocalHooks("afterModifyTransformStart",...e)})),yI(SI,this).addLocalHook("beforeTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n.runLocalHooks("beforeModifyTransformEnd",...e)})),yI(SI,this).addLocalHook("afterTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n.runLocalHooks("afterModifyTransformEnd",...e)})),yI(SI,this).addLocalHook("insertRowRequire",(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n.runLocalHooks("insertRowRequire",...e)})),yI(SI,this).addLocalHook("insertColRequire",(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n.runLocalHooks("insertColRequire",...e)})),yI(SI,this).addLocalHook("beforeRowWrap",(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n.runLocalHooks("beforeRowWrap",...e)})),yI(SI,this).addLocalHook("beforeColumnWrap",(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n.runLocalHooks("beforeColumnWrap",...e)})),yI(RI,this).addLocalHook("beforeTransformStart",(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n.runLocalHooks("beforeModifyTransformFocus",...e)})),yI(RI,this).addLocalHook("afterTransformStart",(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n.runLocalHooks("afterModifyTransformFocus",...e)}))}getSelectedRange(){return this.selectedRange}markSource(t){bI(MI,this,t)}markEndSource(){bI(MI,this,"unknown")}getSelectionSource(){return yI(MI,this)}setExpectedLayers(t){bI(xI,this,t)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,bI(xI,this,-1)}isInProgress(){return this.inProgress}setRangeStart(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;const o="multiple"===this.settings.selectionMode,r=Bp(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,s=t.clone();bI(EI,this,!1),this.runLocalHooks("beforeSetRangeStart"+(n?"Only":""),s),(!o||o&&!r&&Bp(e))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(i.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(t)}setRangeStartOnly(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;this.setRangeStart(t,e,!0,n)}setRangeEnd(t){if(this.selectedRange.isEmpty())return;const e=t.clone(),n=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(t).isSingleHeader();if((n>0||i>0)&&(0===n&&e.col<0&&!o||0===i&&e.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",e),this.begin();const r=this.selectedRange.current();if(this.settings.navigableHeaders||r.highlight.normalize(),"single"===this.settings.selectionMode)r.setFrom(r.highlight),r.setTo(r.highlight);else{const t=r.getHorizontalDirection(),n=r.getVerticalDirection(),i=this.isMultiple();r.setTo(e),i&&(t!==r.getHorizontalDirection()||1===r.getWidth()&&!r.includes(r.highlight))&&r.from.assign({col:r.highlight.col}),i&&(n!==r.getVerticalDirection()||1===r.getHeight()&&!r.includes(r.highlight))&&r.from.assign({row:r.highlight.row})}n>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!r.isSingleHeader())&&r.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const s=-1===yI(xI,this)||this.selectedRange.size()===yI(xI,this);this.runLocalHooks("afterSetRangeEnd",t,s)}applyAndCommit(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedRange.current(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();e<this.highlight.layerLevel&&(Np(this.highlight.getAreas(),(t=>{t.clear()})),Np(this.highlight.getLayeredAreas(),(t=>{t.clear()})),Np(this.highlight.getRowHeaders(),(t=>{t.clear()})),Np(this.highlight.getColumnHeaders(),(t=>{t.clear()})),Np(this.highlight.getActiveRowHeaders(),(t=>{t.clear()})),Np(this.highlight.getActiveColumnHeaders(),(t=>{t.clear()})),Np(this.highlight.getActiveCornerHeaders(),(t=>{t.clear()})),Np(this.highlight.getRowHighlights(),(t=>{t.clear()})),Np(this.highlight.getColumnHighlights(),(t=>{t.clear()}))),this.highlight.useLayerLevel(e);const o=this.highlight.createArea(),r=this.highlight.createLayeredArea(),s=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),a=this.highlight.createActiveRowHeader(),h=this.highlight.createActiveColumnHeader(),c=this.highlight.createActiveCornerHeader(),u=this.highlight.createRowHighlight(),d=this.highlight.createColumnHighlight();if(o.clear(),r.clear(),s.clear(),l.clear(),a.clear(),h.clear(),c.clear(),u.clear(),d.clear(),this.highlight.isEnabledFor(XE,t.highlight)&&(this.isMultiple()||e>=1)&&(o.add(t.from).add(t.to).commit(),r.add(t.from).add(t.to).commit(),1===e)){const t=this.selectedRange.previous();this.highlight.useLayerLevel(e-1),this.highlight.createArea().add(t.from).commit().syncWith(t),this.highlight.createLayeredArea().add(t.from).commit().syncWith(t),this.highlight.useLayerLevel(e)}if(this.highlight.isEnabledFor(KE,t.highlight)){if(!t.isSingleHeader()){const e=this.tableProps.createCellCoords(Math.max(t.from.row,0),-1),n=this.tableProps.createCellCoords(t.to.row,-1),i=this.tableProps.createCellCoords(-1,Math.max(t.from.col,0)),o=this.tableProps.createCellCoords(-1,t.to.col);"single"===this.settings.selectionMode?(s.add(e).commit(),l.add(i).commit(),u.add(e).commit(),d.add(i).commit()):(s.add(e).add(n).commit(),l.add(i).add(o).commit(),u.add(e).add(n).commit(),d.add(i).add(o).commit())}const e=!yI(TI,this)&&this.isEntireRowSelected()&&(i>0&&i===t.getWidth()||0===i&&this.isSelectedByRowHeader()),o=!yI(TI,this)&&this.isEntireColumnSelected()&&(n>0&&n===t.getHeight()||0===n&&this.isSelectedByColumnHeader());e&&a.add(this.tableProps.createCellCoords(Math.max(t.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(t.to.row,0),-1)).commit(),o&&h.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(t.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(t.to.col,0))).commit(),e&&o&&c.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(t){if(this.selectedRange.isEmpty())return;const e=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",t);const n=this.highlight.getFocus();n.clear(),e.setHighlight(t),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(qE,e.highlight)&&n.add(e.highlight).commit().syncWith(e),this.inProgress||(bI(EI,this,!0),this.runLocalHooks("afterSetFocus",e.highlight))}transformStart(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders?yI(SI,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):yI(SI,this).resetOffsetSize(),this.setRangeStart(yI(SI,this).transformStart(t,e,n))}transformEnd(t,e){this.settings.navigableHeaders?yI(SI,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):yI(SI,this).resetOffsetSize(),this.setRangeEnd(yI(SI,this).transformEnd(t,e))}transformFocus(t,e){const n=this.selectedRange.current(),{row:i,col:o}=n.getOuterTopStartCorner(),r=this.tableProps.countRenderableColumnsInRange(0,o-1),s=this.tableProps.countRenderableRowsInRange(0,i-1);n.highlight.isHeader()?yI(RI,this).setOffsetSize({x:o<0?Math.abs(o):-r,y:i<0?Math.abs(i):-s}):yI(RI,this).setOffsetSize({x:o<0?0:-r,y:i<0?0:-s});const l=yI(RI,this).transformStart(t,e);this.setRangeFocus(l.normalize())}shiftRows(t,e){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=t){const{from:i,to:o,highlight:r}=n,s=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),a=this.isSelectedByColumnHeader(),h=a?-1:0,c=a?0:e;this.getSelectedRange().pop();const u=this.tableProps.createCellCoords(jC(i.row+c,h,s-1),i.col),d=this.tableProps.createCellCoords(jC(o.row+e,h,s-1),o.col);this.markSource("shift"),r.row>=t?this.setRangeStartOnly(u,!0,this.tableProps.createCellCoords(jC(r.row+e,0,s-1),r.col)):this.setRangeStartOnly(u,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),a&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}shiftColumns(t,e){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=t){const{from:i,to:o,highlight:r}=n,s=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),a=this.isSelectedByColumnHeader(),h=l?-1:0,c=l?0:e;this.getSelectedRange().pop();const u=this.tableProps.createCellCoords(i.row,jC(i.col+c,h,s-1)),d=this.tableProps.createCellCoords(o.row,jC(o.col+e,h,s-1));this.markSource("shift"),r.col>=t?this.setRangeStartOnly(u,!0,this.tableProps.createCellCoords(r.row,jC(r.col+e,0,s-1))):this.setRangeStartOnly(u,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),a&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const t=Jv(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}isFocusSelectionChanged(){return this.isSelected()&&yI(EI,this)}isSelectedByRowHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&(-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t))}isEntireRowSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{col:e}=t.getOuterTopStartCorner(),n=this.tableProps.countRowHeaders(),i=this.tableProps.countCols();return(n>0&&e<0||0===n)&&t.getWidth()===i};if(-1===t)return Array.from(this.selectedRange).some((t=>e(t)));const n=this.selectedRange.peekByIndex(t);return!!n&&e(n)}isSelectedByColumnHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t))}isEntireColumnSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const e=t=>{const{row:e}=t.getOuterTopStartCorner(),n=this.tableProps.countColHeaders(),i=this.tableProps.countRows();return(n>0&&e<0||0===n)&&t.getHeight()===i};if(-1===t)return Array.from(this.selectedRange).some((t=>e(t)));const n=this.selectedRange.peekByIndex(t);return!!n&&e(n)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(t){return this.selectedRange.includes(t)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(t){const e=this.tableProps.visualToRenderableCoords(t);return null!==e.row&&null!==e.col}isAreaCornerVisible(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var t;let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),r=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),a=n?-l:0,h=e?-s:0;if(0===a&&0===h&&(0===o||0===r))return;let c=null===(t=this.getSelectedRange().current())||void 0===t?void 0:t.highlight;const{focusPosition:u,disableHeadersHighlight:d}=i;bI(TI,this,d),u&&Number.isInteger(null==u?void 0:u.row)&&Number.isInteger(null==u?void 0:u.col)&&(c=this.tableProps.createCellCoords(jC(u.row,a,o-1),jC(u.col,h,r-1)));const g=this.tableProps.createCellCoords(a,h),f=this.tableProps.createCellCoords(o-1,r-1);this.clear(),this.setRangeStartOnly(g,void 0,c),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),a<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.finish(),bI(TI,this,!1)}selectCells(t){var e=this;const n=mI(t);if(1===n)return!1;if(0===n)throw new Error(Fp`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=pI(n,{createCellCoords:function(){return e.tableProps.createCellCoords(...arguments)},createCellRange:function(){return e.tableProps.createCellRange(...arguments)},propToCol:t=>this.tableProps.propToCol(t),keepDirection:!0}),o=this.settings.navigableHeaders,r={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},s=!t.some((t=>{const e=i(t),n=e.isValid(r);return!(n&&!e.containsHeaders()||n&&e.containsHeaders()&&e.isSingleHeader())}));return s&&(this.clear(),this.setExpectedLayers(t.length),Np(t,(t=>{const{from:e,to:n}=i(t);this.setRangeStartOnly(e.clone(),!1),this.setRangeEnd(n.clone())})),this.finish()),s}selectColumns(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i="string"==typeof t?this.tableProps.propToCol(t):t,o="string"==typeof e?this.tableProps.propToCol(e):e,r=this.tableProps.countRows(),s=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),a=0===l?0:-l,h=this.tableProps.createCellCoords(a,i),c=this.tableProps.createCellCoords(r-1,o),u=this.tableProps.createCellRange(h,h,c).isValid({countRows:r,countCols:s,countRowHeaders:0,countColHeaders:l});if(u){let t=0,e=0;Number.isInteger(null==n?void 0:n.row)&&Number.isInteger(null==n?void 0:n.col)?(t=jC(n.row,a,r-1),e=jC(n.col,Math.min(i,o),Math.max(i,o))):(t=jC(n,a,r-1),e=i);const s=this.tableProps.createCellCoords(t,e),h=0===l?0:jC(s.row,a,-1),c=r-1,u=this.tableProps.createCellCoords(h,i),d=this.tableProps.createCellCoords(c,o);this.runLocalHooks("beforeSelectColumns",u,d,s),u.row=h,d.row=c,this.setRangeStartOnly(u,void 0,s),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectColumns",u,d,s),this.finish()}return u}selectRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),r=this.tableProps.countRowHeaders(),s=0===r?0:-r,l=this.tableProps.createCellCoords(t,s),a=this.tableProps.createCellCoords(e,o-1),h=this.tableProps.createCellRange(l,l,a).isValid({countRows:i,countCols:o,countRowHeaders:r,countColHeaders:0});if(h){let i=0,l=0;Number.isInteger(null==n?void 0:n.row)&&Number.isInteger(null==n?void 0:n.col)?(i=jC(n.row,Math.min(t,e),Math.max(t,e)),l=jC(n.col,s,o-1)):(i=t,l=jC(n,s,o-1));const a=this.tableProps.createCellCoords(i,l),h=0===r?0:jC(a.col,s,-1),c=o-1,u=this.tableProps.createCellCoords(t,h),d=this.tableProps.createCellCoords(e,c);this.runLocalHooks("beforeSelectRows",u,d,a),u.col=h,d.col=c,this.setRangeStartOnly(u,void 0,a),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectRows",u,d,a),this.finish()}return h}refresh(){if(!this.isSelected())return;const t=this.tableProps.countRows(),e=this.tableProps.countCols();if(0===t||0===e)return void this.deselect();const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:r}=n;this.clear(),r.assign({row:jC(r.row,-Infinity,t-1),col:jC(r.col,-Infinity,e-1)}),i.assign({row:jC(i.row,-Infinity,t-1),col:jC(i.col,-Infinity,e-1)}),o.assign({row:jC(o.row,0,t-1),col:jC(o.col,0,e-1)}),this.selectedRange.ranges.push(n),this.highlight.getFocus().add(r).commit().syncWith(n),this.applyAndCommit(n)}commit(){if(this.highlight.getCustomSelections().forEach((t=>{t.commit()})),!this.isSelected())return;const t=this.getLayerLevel(),e=this.selectedRange.current();this.highlight.isEnabledFor(qE,e.highlight)&&this.highlight.getFocus().commit().syncWith(e);for(let n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);const t=this.highlight.createArea(),e=this.highlight.createLayeredArea(),i=this.highlight.createRowHeader(),o=this.highlight.createColumnHeader(),r=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),l=this.highlight.createActiveCornerHeader(),a=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();t.commit(),e.commit(),i.commit(),o.commit(),r.commit(),s.commit(),l.commit(),a.commit(),h.commit()}this.highlight.useLayerLevel(t)}}$v(HI,UE);const kI=HI,II=/^(\r\n|\n\r|\r|\n)/,OI=/^[^\t\r\n]+/,AI=/^\t/;function _I(t){let e,n,i,o,r,s="";for(e=0,n=t.length;e<n;e+=1){for(o=t[e].length,i=0;i<o;i+=1)i>0&&(s+="\t"),r=t[e][i],"string"==typeof r?r.indexOf("\n")>-1?s+=`"${r.replace(/"/g,'""')}"`:s+=r:s+=null==r?"":r;e!==n-1&&(s+="\n")}return s}function PI(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class NI{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,e,n){PI(this,"hot",void 0),PI(this,"metaManager",void 0),PI(this,"tableMeta",void 0),PI(this,"dataSource",void 0),PI(this,"duckSchema",void 0),PI(this,"colToPropCache",void 0),PI(this,"propToColCache",void 0),this.hot=t,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=e,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const t=this.getSchema();if(void 0===t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const e=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,e){let i=0,o=0,r=!1;if("function"==typeof e){const e=Qv(t);i=e>0?e:this.countFirstRowKeys(),r=!0}else{const t=this.tableMeta.maxCols;i=Math.min(t,e.length)}for(n=0;n<i;n++){const t=r?e(n):e[n];if(Kv(t)){if(void 0!==t.data){const e=r?o:n;this.colToPropCache[e]=t.data,this.propToColCache.set(t.data,e)}o+=1}}}else this.recursiveDuckColumns(t)}countFirstRowKeys(){return KM(this.dataSource)}recursiveDuckColumns(t,e,n){let i,o=e,r=n;return void 0===o&&(o=0,r=""),"object"!=typeof t||Array.isArray(t)||qv(t,((t,e)=>{null===t?(i=r+e,this.colToPropCache.push(i),this.propToColCache.set(i,o),o+=1):o=this.recursiveDuckColumns(t,o,`${e}.`)})),o}colToProp(t){if(!1===Number.isInteger(t))return t;const e=this.hot.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&jp(this.colToPropCache[e])?this.colToPropCache[e]:e}propToCol(t){const e=this.propToColCache.get(t);if(jp(e))return this.hot.toVisualColumn(e);const n=this.hot.toVisualColumn(t);return null===n?t:n}getSchema(){const t=this.tableMeta.dataSchema;return t?"function"==typeof t?t():t:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Wv(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=this.hot.countSourceRows();let r=o,s=0,l=t;("number"!=typeof l||l>=o)&&(l=o),l<this.hot.countRows()&&(r=this.hot.toPhysicalRow(l));if(!1===this.hot.runHooks("beforeCreateRow",l,e,n)||null===r)return{delta:0};const a=this.tableMeta.maxRows,h=this.getSchema().length,c=[];for(;s<e&&o+s<a;){let t=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?t=Uv(this.getSchema()):(t=[],VC(h-1,(()=>t.push(null)))):"function"===this.hot.dataType?t=this.tableMeta.dataSchema(l+s):(t={},zv(t,this.getSchema())),c.push(t),s+=1}this.hot.rowIndexMapper.insertIndexes(l,s),"below"===i&&(r=Math.min(r+1,o)),this.spliceData(r,0,c);const u=this.hot.toVisualRow(r);return this.hot.countSourceRows()===c.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(null==t?this.metaManager.createRow(null,s):"auto"!==n&&this.metaManager.createRow(r,e)),this.hot.runHooks("afterCreateRow",u,s,n),this.hot.forceFullRender=!0,{delta:s,startPhysicalIndex:r}}createCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,r=this.tableMeta.maxCols,s=this.hot.countSourceCols();let l=t;("number"!=typeof l||l>=s)&&(l=s);if(!1===this.hot.runHooks("beforeCreateCol",l,e,n))return{delta:0};let a=s;l<this.hot.countCols()&&(a=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let c=this.hot.countCols(),u=0,d=a;"end"===i&&(d=Math.min(d+1,s));const g=d;for(;u<e&&c<r;){if("number"!=typeof l||l>=c)if(h>0)for(let t=0;t<h;t+=1)void 0===o[t]&&(o[t]=[]),o[t].push(null);else o.push([null]);else for(let t=0;t<h;t++)o[t].splice(d,0,null);u+=1,d+=1,c+=1}this.hot.columnIndexMapper.insertIndexes(l,u),u>0&&(null==t?this.metaManager.createColumn(null,u):"auto"!==n&&this.metaManager.createColumn(g,e));const f=this.hot.toVisualColumn(g);return this.hot.runHooks("afterCreateCol",f,u,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:u,startPhysicalIndex:g}}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(t)?t:-e;const o=this.visualRowsToPhysical(i,e),r=this.hot.countSourceRows();i=(r+i)%r;if(!1===this.hot.runHooks("beforeRemoveRow",i,o.length,o,n))return!1;const s=o.length;if(this.filterData(i,s,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const t=jp(this.tableMeta.columns)||jp(this.tableMeta.dataSchema);0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===t&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort(((t,e)=>e-t)).forEach((t=>{this.metaManager.removeRow(t,1)})),this.hot.runHooks("afterRemoveRow",i,s,o,n),this.hot.forceFullRender=!0,!0}removeCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i="number"!=typeof t?-e:t;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,e),r=o.slice(0).sort(((t,e)=>e-t));if(!1===this.hot.runHooks("beforeRemoveCol",i,e,o,n))return!1;let s=!0;const l=r.length,a=this.dataSource;for(let h=0;h<l;h++)s&&o[0]!==o[h]-h&&(s=!1);if(s)for(let h=0,c=this.hot.countSourceRows();h<c;h++)a[h].splice(o[0],e),0===h&&this.metaManager.removeColumn(o[0],e);else for(let h=0,c=this.hot.countSourceRows();h<c;h++)for(let t=0;t<l;t++)a[h].splice(r[t],1),0===h&&this.metaManager.removeColumn(r[t],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength()&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,e,o,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(t,e,n){const i=this.hot.getDataAtCol(t),o=i.slice(e,e+n),r=i.slice(e+n);for(var s=arguments.length,l=new Array(s>3?s-3:0),a=3;a<s;a++)l[a-3]=arguments[a];Ip(l,r);let h=0;for(;h<n;)l.push(null),h+=1;return function(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}(l),this.hot.populateFromArray(e,t,l,null,null,"spliceCol"),o}spliceRow(t,e,n){const i=this.hot.getSourceDataAtRow(t),o=i.slice(e,e+n),r=i.slice(e+n);for(var s=arguments.length,l=new Array(s>3?s-3:0),a=3;a<s;a++)l[a-3]=arguments[a];Ip(l,r);let h=0;for(;h<n;)l.push(null),h+=1;return this.hot.populateFromArray(t,e,[l],null,null,"spliceRow"),o}spliceData(t,e,n){if(!1!==this.hot.runHooks("beforeDataSplice",t,e,n)){const e=[...this.dataSource.slice(0,t),...n,...this.dataSource.slice(t)];this.dataSource.length=0,e.forEach((t=>this.dataSource.push(t)))}}filterData(t,e,n){let i=this.hot.runHooks("filterData",t,e,n);!1===Array.isArray(i)&&(i=this.dataSource.filter(((t,e)=>-1===n.indexOf(e)))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(t,e){const n=this.hot.toPhysicalRow(t);let i=this.dataSource[n];const o=this.hot.runHooks("modifyRowData",n);i=isNaN(o)?o:i;const{dataDotNotation:r}=this.hot.getSettings();let s=null;if(i&&i.hasOwnProperty&&ty(i,e))s=i[e];else if(r&&"string"==typeof e&&e.indexOf(".")>-1){let t=i;if(!t)return null;const n=e.split(".");for(let e=0,i=n.length;e<i;e++)if(t=t[n[e]],void 0===t)return null;s=t}else"function"==typeof e&&(s=e(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const t=Jv(s);this.hot.runHooks("modifyData",n,this.propToCol(e),t,"get"),t.isTouched()&&(s=t.value)}return s}getCopyable(t,e){return this.hot.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}set(t,e,n){const i=this.hot.toPhysicalRow(t);let o=n,r=this.dataSource[i];const s=this.hot.runHooks("modifyRowData",i);if(r=isNaN(s)?s:r,this.hot.hasHook("modifyData")){const t=Jv(o);this.hot.runHooks("modifyData",i,this.propToCol(e),t,"set"),t.isTouched()&&(o=t.value)}const{dataDotNotation:l}=this.hot.getSettings();if(r&&r.hasOwnProperty&&ty(r,e))r[e]=o;else if(l&&"string"==typeof e&&e.indexOf(".")>-1){let t,n=r,i=0;const s=e.split(".");for(i=0,t=s.length-1;i<t;i++)void 0===n[s[i]]&&(n[s[i]]={}),n=n[s[i]];n[s[i]]=o}else"function"==typeof e?e(this.dataSource.slice(i,i+1)[0],o):r[e]=o}visualRowsToPhysical(t,e){const n=this.hot.countSourceRows(),i=[];let o,r=(n+t)%n,s=e;for(;r<n&&s;)o=this.hot.toPhysicalRow(r),i.push(o),s-=1,r+=1;return i}visualColumnsToPhysical(t,e){const n=this.hot.countCols(),i=[];let o=(n+t)%n,r=e;for(;o<n&&r;){const t=this.hot.toPhysicalColumn(o);i.push(t),r-=1,o+=1}return i}clear(){for(let t=0;t<this.hot.countSourceRows();t++)for(let e=0;e<this.hot.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){const t=this.tableMeta.maxRows;let e;e=t<0||0===t?0:t||Infinity;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,e)}getAll(){const t={row:0,col:0},e={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return t.row-e.row!=0||this.hot.countSourceRows()?this.getRange(t,e,NI.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(t,e,n){const i=[];let o,r,s;const l=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===l||0===a)return[];const h=n===NI.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,c=Math.min(Math.max(l-1,0),Math.max(t.row,e.row)),u=Math.min(Math.max(a-1,0),Math.max(t.col,e.col));for(o=Math.min(t.row,e.row);o<=c;o++){s=[];const n=o>=0?this.hot.toPhysicalRow(o):o;for(r=Math.min(t.col,e.col);r<=u&&null!==n;r++)s.push(h.call(this,o,this.colToProp(r)));null!==n&&i.push(s)}return i}getText(t,e){return _I(this.getRange(t,e,NI.DESTINATION_RENDERER))}getCopyableText(t,e){return _I(this.getRange(t,e,NI.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const DI=NI,{register:LI,getItem:VI,hasItem:FI,getNames:WI,getValues:jI}=cb("cellTypes");function BI(t,e){"string"!=typeof t&&(t=(e=t).CELL_TYPE);const{editor:n,renderer:i,validator:o}=e;n&&bb(t,n),i&&aS(t,i),o&&fS(t,o),LI(t,e)}function zI(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const i="string"==typeof e.type?function(t){if(!FI(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return VI(t)}(e.type):e.type;if(t._automaticallyAssignedMetaProps&&qv(e,((e,n)=>{t._automaticallyAssignedMetaProps.delete(n)})),!Kv(i))return;n!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);const o={};qv(i,((e,i)=>{var r;(function(t,e){var n;return"CELL_TYPE"!==t&&((null===(n=e._automaticallyAssignedMetaProps)||void 0===n?void 0:n.has(t))||!ty(e,t))})(i,n)&&(o[i]=e,null===(r=t._automaticallyAssignedMetaProps)||void 0===r||r.add(i))})),Bv(t,o)}function UI(t){return Number.isInteger(t)&&t>=0}function YI(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function $I(t){return null==t}const GI=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,i;for(e=0,n=this.countRows();e<n;e++)if(i=this.getDataAtCell(e,t),!1===zp(i))return!1;return!0},isEmptyRow(t){let e,n,i,o;for(e=0,n=this.countCols();e<n;e++)if(i=this.getDataAtCell(t,e),!1===zp(i))return"object"==typeof i&&(o=this.getCellMeta(t,e),Gv(this.getSchema()[o.prop],i));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:Infinity,maxRows:Infinity,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function KI(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class XI{constructor(t){KI(this,"metaCtor",class{}),KI(this,"meta",void 0),this.meta=this.metaCtor.prototype,Bv(this.meta,GI()),this.meta.instance=t}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(t){var e;Bv(this.meta,t),zI(this.meta,h(a({},t),{type:null!==(e=t.type)&&void 0!==e?e:this.meta.type}),t)}}function qI(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class ZI{constructor(t){qI(this,"meta",void 0);const e=t.getMetaConstructor();this.meta=new e}getMeta(){return this.meta}updateMeta(t){Bv(this.meta,t),zI(this.meta,t,t)}}function QI(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class JI{constructor(t){QI(this,"valueFactory",void 0),QI(this,"data",[]),QI(this,"index",[]),QI(this,"holes",new Set),this.valueFactory=t}obtain(t){YI((()=>UI(t)),"Expecting an unsigned number.");const e=this._getStorageIndexByKey(t);let n;if(e>=0)n=this.data[e],void 0===n&&(n=this.valueFactory(t),this.data[e]=n);else if(n=this.valueFactory(t),this.holes.size>0){const e=this.holes.values().next().value;this.holes.delete(e),this.data[e]=n,this.index[t]=e}else this.data.push(n),this.index[t]=this.data.length-1;return n}insert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;YI((()=>UI(t)||$I(t)),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let r=0;r<e;r++)n.push(i+r),this.data.push(void 0);const o=$I(t)?this.index.length:t;this.index=[...this.index.slice(0,o),...n,...this.index.slice(o)]}remove(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;YI((()=>UI(t)||$I(t)),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice($I(t)?this.index.length-e:t,e);for(let i=0;i<n.length;i++){const t=n[i];"number"==typeof t&&this.holes.add(t)}}size(){return this.data.length-this.holes.size}values(){return _p(this.data,((t,e)=>!this.holes.has(e)))[Symbol.iterator]()}entries(){const t=[];for(let n=0;n<this.data.length;n++){const e=this._getKeyByStorageIndex(n);-1!==e&&t.push([e,this.data[n]])}let e=0;return{next:()=>{if(e<t.length){const n=t[e];return e+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(t){return this.index.length>t?this.index[t]:-1}_getKeyByStorageIndex(t){return this.index.indexOf(t)}[Symbol.iterator](){return this.entries()}}function tO(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const eO=["data","width"];class nO{constructor(t){tO(this,"globalMeta",void 0),tO(this,"metas",new JI((()=>this._createMeta()))),this.globalMeta=t,this.metas=new JI((()=>this._createMeta()))}updateMeta(t,e){const n=this.getMeta(t);Bv(n,e),zI(n,e)}createColumn(t,e){this.metas.insert(t,e)}removeColumn(t,e){this.metas.remove(t,e)}getMeta(t){return this.metas.obtain(t)}getMetaConstructor(t){return this.metas.obtain(t).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}jv(n,t);for(let i=0;i<e.length;i++)n.prototype[e[i]]=void 0;return n}(this.globalMeta.getMetaConstructor(),eO).prototype}}function iO(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class oO{constructor(t){iO(this,"columnMeta",void 0),iO(this,"metas",new JI((()=>this._createRow()))),this.columnMeta=t}updateMeta(t,e,n){const i=this.getMeta(t,e);Bv(i,n),zI(i,n)}createRow(t,e){this.metas.insert(t,e)}createColumn(t,e){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(t,e)}removeRow(t,e){this.metas.remove(t,e)}removeColumn(t,e){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(t,e)}getMeta(t,e,n){const i=this.metas.obtain(t).obtain(e);return void 0===n?i:i[n]}setMeta(t,e,n,i){var o;const r=this.metas.obtain(t).obtain(e);null===(o=r._automaticallyAssignedMetaProps)||void 0===o||o.delete(n),r[n]=i}removeMeta(t,e,n){delete this.metas.obtain(t).obtain(e)[n]}getMetas(){const t=[],e=Array.from(this.metas.values());for(let n=0;n<e.length;n++)jp(e[n])&&t.push(...e[n].values());return t}getMetasAtRow(t){YI((()=>UI(t)),"Expecting an unsigned number.");const e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new JI((t=>this._createMeta(t)))}_createMeta(t){return new(this.columnMeta.getMetaConstructor(t))}}class rO{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=t,this.globalMeta=new XI(t),this.tableMeta=new ZI(this.globalMeta),this.columnMeta=new nO(this.globalMeta),this.cellMeta=new oO(this.columnMeta),n.forEach((t=>new t(this))),this.globalMeta.updateMeta(e)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(t){this.globalMeta.updateMeta(t)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(t){this.tableMeta.updateMeta(t)}getColumnMeta(t){return this.columnMeta.getMeta(t)}updateColumnMeta(t,e){this.columnMeta.updateMeta(t,e)}getCellMeta(t,e,n){let{visualRow:i,visualColumn:o}=n;const r=this.cellMeta.getMeta(t,e);return r.visualRow=i,r.visualCol=o,r.row=t,r.col=e,this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(t,e,n){if("string"!=typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,n)}setCellMeta(t,e,n,i){this.cellMeta.setMeta(t,e,n,i)}updateCellMeta(t,e,n){this.cellMeta.updateMeta(t,e,n)}removeCellMeta(t,e,n){this.cellMeta.removeMeta(t,e,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(t){return this.cellMeta.getMetasAtRow(t)}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}createColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}removeColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function sO(t,e,n,i){const{hotInstance:o,dataMap:r,dataSource:s,internalSource:l,source:a,metaManager:h,firstRun:c}=i,u=tw(l),d=o.getSettings();Array.isArray(d.dataSchema)?o.dataType="array":sv(d.dataSchema)?o.dataType="function":o.dataType="object",r&&r.destroy(),t=o.runHooks(`before${u}`,t,c,a);const g=new DI(o,t,h);if(e(g),"object"==typeof t&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error(`${l} only accepts array of objects or array of arrays (${typeof t} given)`);{const e=g.getSchema();let n;t=[];let i=0,r=0;for(i=0,r=d.startRows;i<r;i++)if("object"!==o.dataType&&"function"!==o.dataType||!d.dataSchema)if("array"===o.dataType)n=Uv(e[0]),t.push(n);else{n=[];for(let t=0,e=d.startCols;t<e;t++)n.push(null);t.push(n)}else n=Uv(e),t.push(n)}}Array.isArray(t[0])&&(o.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=o.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),n(g),o.runHooks(`after${u}`,t,c,a),c||(o.runHooks("afterChange",null,l),o.render()),o.getSettings().ariaTags&&Hw(o.rootElement,[hw(-1),cw(o.countCols()+(o.view?o.countRowHeaders():0))])}function lO(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}$v(rO,UE);class aO{constructor(t){lO(this,"metaManager",void 0),lO(this,"metaSyncMemo",new Map),this.metaManager=t,t.addLocalHook("afterGetCellMeta",(t=>this.extendCellMeta(t))),lb.getSingleton().add("beforeRender",(t=>{t&&this.metaSyncMemo.clear()}),this.metaManager.hot)}extendCellMeta(t){var e;const{row:n,col:i}=t;if(null!==(e=this.metaSyncMemo.get(n))&&void 0!==e&&e.has(i))return;const{visualRow:o,visualCol:r}=t,s=this.metaManager.hot,l=s.colToProp(r);t.prop=l,s.runHooks("beforeGetCellMeta",o,r,t);const a=ty(t,"type")?t.type:null;let h=sv(t.cells)?t.cells(n,i,l):null;var c;a&&(h?h.type=null!==(c=h.type)&&void 0!==c?c:a:h={type:a});h&&this.metaManager.updateCellMeta(n,i,h),s.runHooks("afterGetCellMeta",o,r,t),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function hO(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function cO(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uO(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var dO=new WeakMap;class gO{constructor(t){cO(this,"metaManager",void 0),cO(this,"usageTracker",new Set),cO(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===t)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),hO(this,dO,((t,e,n)=>{if(!n)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)})),this.metaManager=t,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach(((t,e)=>{const{initOnly:n,target:i,onChange:o}=t,r="string"==typeof i,s=r?i:e,l=`_${s}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[s],o?(this.installPropWatcher(e,l,o),r&&this.installPropWatcher(i,l,o)):n&&(this.installPropWatcher(e,l,uO(dO,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(e))}))}installPropWatcher(t,e,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get(){return this[e]},set(o){const r=!i.usageTracker.has(t);i.usageTracker.add(t),n.call(i,t,o,r),this[e]=o},enumerable:!0,configurable:!0})}}const fO="gridDefault",mO="editorManager.handlingEditor",pO={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},wO={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){Np(this._hooksStorage[t]||[],(e=>{this.hot.removeHook(t,e)}))},clearHooks(){qv(this._hooksStorage,((t,e)=>this.removeHooksByKey(e))),this._hooksStorage={}}};Xv(wO,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});const vO=wO;function yO(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const bO=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class CO{static get EDITOR_TYPE(){return"base"}constructor(t){yO(this,"hot",void 0),yO(this,"state",bO.VIRGIN),yO(this,"_opened",!1),yO(this,"_fullEditMode",!1),yO(this,"_closeCallback",null),yO(this,"TD",null),yO(this,"row",null),yO(this,"col",null),yO(this,"prop",null),yO(this,"originalValue",null),yO(this,"cellProperties",null),this.hot=t,this.init()}_fireCallbacks(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(t,e,n,i,o,r){this.TD=i,this.row=t,this.col=e,this.prop=n,this.originalValue=o,this.cellProperties=r,this.state=this.isOpened()?this.state:bO.VIRGIN}extend(){return class extends this.constructor{}}saveValue(t,e){let n,i,o,r;if(e){const t=this.hot.getSelectedLast();n=Math.max(Math.min(t[0],t[2]),0),i=Math.max(Math.min(t[1],t[3]),0),o=Math.max(t[0],t[2]),r=Math.max(t[1],t[3])}else[n,i,o,r]=[this.row,this.col,null,null];const s=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(s)&&([n,i]=s),this.hot.populateFromArray(n,i,t,o,r,"edit")}beginEditing(t,e){if(this.state!==bO.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),r=()=>{if(this.state=bO.EDITING,this.isInFullEditMode()){const e="string"==typeof t?t:Wp(this.originalValue);this.setValue(e)}this.open(e),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",r);n.view.scrollViewport(n._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",r),r())}finishEditing(t,e,n){let i;if(n){const t=this._closeCallback;this._closeCallback=e=>{t&&t(e),n(e),this.hot.view.render()}}if(!this.isWaiting())if(this.state!==bO.VIRGIN){if(this.state===bO.EDITING){if(t)return this.cancelChanges(),void this.hot.view.render();const n=this.getValue();i=this.cellProperties.trimWhitespace?[["string"==typeof n?String.prototype.trim.call(n||""):n]]:[[n]],this.state=bO.WAITING,this.saveValue(i,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(t=>{this.state=bO.FINISHED,this.discardEditor(t)})):(this.state=bO.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((()=>{this._fireCallbacks(!0)}))}cancelChanges(){this.state=bO.FINISHED,this.discardEditor()}discardEditor(t){if(this.state===bO.FINISHED)if(!1===t&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=bO.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=bO.VIRGIN,this._fireCallbacks(!0);this.hot.getShortcutManager().setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===bO.WAITING}getEditedCellRect(){var t;const e=this.getEditedCell();if(!e)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,r=Dw(e),s=Uw(e),l=Dw(this.hot.rootElement),a=Uw(this.hot.rootElement),h=n.topOverlay.holder,c=n.inlineStartOverlay.holder,u=h!==o?h.scrollTop:0,d=c!==o?c.scrollLeft:0,g=o.innerWidth-l.left-a,{wtTable:f}=null!==(t=n.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,m=f.name,p=["master","inline_start"].includes(m)?u:0,w=["master","top","bottom"].includes(m)?d:0,v=r.top===l.top?0:1;let y=r.top-l.top-v-p,b=0;b=this.hot.isRtl()?o.innerWidth-r.left-s-g-1+w:r.left-l.left-1-w,["top","top_inline_start_corner"].includes(m)&&(y+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(b+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const C=this.hot.hasColHeaders(),S=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),E=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(C&&S<=0||S===E)&&(y+=1),R<=0&&(b+=1);const T=i.rowsRenderCalculator.startPosition,M=i.columnsRenderCalculator.startPosition,x=Math.abs(n.inlineStartOverlay.getScrollPosition()),H=n.topOverlay.getScrollPosition(),k=Qw(this.hot.rootDocument);let I=e.offsetTop;if(["inline_start","master"].includes(m)&&(I+=T-H),["bottom","bottom_inline_start_corner"].includes(m)){const{wtViewport:t,wtTable:e}=n.bottomOverlay.clone;I+=t.getWorkspaceHeight()-e.getHeight()-k}let O=e.offsetLeft;this.hot.isRtl()?(O=O>=0?f.getWidth()-e.offsetLeft:Math.abs(O),O+=M-x-s):["top","master","bottom"].includes(m)&&(O+=M-x);const A=o.getComputedStyle(this.TD),_=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",P=parseInt(A[_],10)>0?0:1,N=parseInt(A.borderTopWidth,10)>0?0:1,D=Uw(e)+P,L=Yw(e)+N,V=(F=h).offsetWidth!==F.clientWidth?k:0;var F;const W=function(t){return t.offsetHeight!==t.clientHeight}(c)?k:0,j=this.hot.view.maximumVisibleElementWidth(O)-V+P;return{top:y,start:b,height:L,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(I)-W+N,this.hot.view.getDefaultRowHeight()),width:D,maxWidth:j}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const t=this.hot.countRows();let e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}$v(CO,vO);const SO=[pO,{name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const i=t._getEditorManager(),o=i.getActiveEditor();o.isInFullEditMode()&&o.state===bO.EDITING||(i.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},{name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},{name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},{name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},{name:"editorOpen",callback(t,e,n){const i=t._getEditorManager(),o=t.getSelectedRangeLast(),{highlight:r}=o;if(t.selection.isMultiple()&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const i=t.getSettings(),o="function"==typeof i.enterMoves?i.enterMoves(e):i.enterMoves;n.includes("shift")?t.selection.transformFocus(-o.row,-o.col):t.selection.transformFocus(o.row,o.col)}else r.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),by(e))}},{name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())||t.selection.transformEnd(1,0)}},{name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),i=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(null!==i){const n=t._createCellCoords(i,e.col),o=e.row-t.getFirstFullyVisibleRow(),r=Math.min(n.row-o,t.countRows()-1);t.selection.setRangeEnd(n),t.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())||t.selection.transformEnd(0,-1*t.getDirectionFactor())}},{name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())||t.selection.transformEnd(0,t.getDirectionFactor())}},{name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,i.col,e)}},{name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:o,to:r}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||s){const l=n.getNearestNotHiddenIndex(t.countRows()-1,-1),a=o.clone();a.row=i.row,e.setRangeStart(a,void 0,!1,i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,r.col))}}},{name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:o,to:r}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&i.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),l=o.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(r.row,s))}}},{name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:o,to:r}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&i.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),l=n.getNearestNotHiddenIndex(s,1),a=o.clone();a.col=i.col,e.setRangeStart(a,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(r.row,l))}}},{name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:o,to:r}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||s){const l=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),a=o.clone();a.col=i.col,e.setRangeStart(a,void 0,!1,i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r.row,l))}}},{name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:o,to:r}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||s){const l=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),a=o.clone();a.col=i.col,e.setRangeStart(a,void 0,!1,i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r.row,l))}}},{name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:o,to:r}=t.getSelectedRangeLast(),s=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||s){const l=n.getNearestNotHiddenIndex(0,1),a=o.clone();a.row=i.row,e.setRangeStart(a,void 0,!1,i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,r.col))}}},{name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,i.row,e)}},{name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()||t.selection.isSelectedByCorner()||!(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())||t.selection.transformEnd(-1,0)}},{name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),i=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(null!==i){const n=t._createCellCoords(i,e.col),o=e.row-t.getFirstFullyVisibleRow(),r=Math.max(n.row-o,0);t.selection.setRangeEnd(n),t.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},{name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+n;i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),t.selection.transformStart(o,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},{name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),i=t.getSelectedRangeLast(),o="function"==typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-o.row,-o.col):t.selection.transformStart(-o.row,-o.col)}},{name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),i=t.getSelectedRangeLast(),o="function"==typeof n.tabMoves?n.tabMoves(e):n.tabMoves;t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(o.row,o.col):t.selection.transformStart(o.row,o.col)}},{name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},{name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},{name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);null===n&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},{name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,o=parseInt(t.getSettings().fixedRowsBottom,10),r=n.getNearestNotHiddenIndex(t.countRows()-o-1,-1),s=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(r,s))}},{name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},{name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),o=t.getSelectedRangeLast().highlight.row,r=n.getNearestNotHiddenIndex(i,1);e.setRangeStart(t._createCellCoords(o,r))}},{name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,i=t.getSelectedRangeLast().highlight.row;let o=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);null===o&&(o=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(i,o))}},{name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:i}=t.getSelectedRangeLast().highlight;let o=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);null===o&&(o=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(i,o))}},{name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===n&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},{name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,o=parseInt(t.getSettings().fixedRowsTop,10),r=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(o,1),l=i.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(s,l))}},{name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},{name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=-(t.countVisibleRows()+n);i===-n?o=-1:i+o<n&&(o=-(i+n)),t.selection.transformStart(o,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},{name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},{name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,i=t.getFirstFullyVisibleColumn()-1,o=t.getLastFullyVisibleRow()+1,r=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,i),l=t._createCellCoords(o,r);if(!t._createCellRange(s,s,l).includes(e)&&(e.row>=0||e.col>=0)){const n={};if(e.col>=0){const i=Math.floor(t.countVisibleCols()/2);n.col=Math.max(e.col-i,0)}if(e.row>=0){const i=Math.floor(t.countVisibleRows()/2);n.row=Math.max(e.row-i,0)}t.scrollViewportTo(h(a({},n),{verticalSnap:"top",horizontalSnap:"start"}))}}},{name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},{name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},{name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:i}=e[e.length-1].highlight.normalize(),o=t.getDataAtCell(n,i),r=new Map;for(let s=0;s<e.length;s++)e[s].forAll(((e,s)=>{if(e>=0&&s>=0&&(e!==n||s!==i)){const{readOnly:n}=t.getCellMeta(e,s);n||r.set(`${e}x${s}`,[e,s,o])}}));t.setDataAtCell(Array.from(r.values()))}}];function RO(t){const e={};return SO.forEach((n=>{let{name:i,callback:o}=n;e[i]=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return o(t,...n)}})),e}function EO(t){const e=t.getShortcutManager().addContext("editor"),n=RO(t),i={group:mO};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>n.editorCloseAndSaveByEnter(t,e)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(t,e)=>n.editorCloseAndSaveByEnter(t,e)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(t,e)=>n.editorCloseAndSave(t,e)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(t,e)=>n.editorCloseAndSaveByArrowKeys(t,e)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],i)}function TO(t){const e=t.getShortcutManager().addContext("grid"),n=RO(t),i={runOnlyIf:()=>{const{navigableHeaders:e}=t.getSettings();return jp(t.getSelected())&&(e||!e&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:fO};e.addShortcuts([{keys:[["F2"]],callback:t=>n.editorFastOpen(t)},{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>n.editorOpen(t,e)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:mO,runOnlyIf:()=>jp(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var e;return!(null!==(e=t.getSelectedRangeLast())&&void 0!==e&&e.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var e;return null===(e=t.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var e,n;return!(null!==(e=t.getSelectedRangeLast())&&void 0!==e&&e.highlight.isHeader())&&(null===(n=t.getSelectedRangeLast())||void 0===n?void 0:n.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:t=>n.moveCellSelectionInlineStart(t)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:t=>n.moveCellSelectionInlineEnd(t)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],i)}function MO(t){const e=t.rootDocument.createElement("input");return e.type="text",e.name="__htFocusCatcher",e.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Hw(e,[["role","presentation"],["aria-hidden","true"]]),e}function xO(t){const e=function(t){return e=>{if(!e)return null;const n=HO(t),i=kO(t);return e.col<n.col&&(e.col=n.col),e.col>i.col&&(e.col=i.col),e.row<n.row&&(e.row=n.row),e.row>i.row&&(e.row=i.row),e}}(t);let n;const{activate:i,deactivate:o}=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.rootElement,i=MO(t),o=MO(t);return i.addEventListener("focus",(()=>null==e?void 0:e.onFocusFromTop())),o.addEventListener("focus",(()=>null==e?void 0:e.onFocusFromBottom())),n.firstChild.before(i),n.lastChild.after(o),{activate(){t._registerTimeout((()=>{i.tabIndex=0,o.tabIndex=0}),10)},deactivate(){t._registerTimeout((()=>{i.tabIndex=-1,o.tabIndex=-1}),10)}}}(t,{onFocusFromTop(){var i;const o=null!==(i=e(n))&&void 0!==i?i:HO(t);o&&(t.runHooks("modifyFocusOnTabNavigation","from_above",o),t.selectCell(o.row,o.col)),t.listen()},onFocusFromBottom(){var i;const o=null!==(i=e(n))&&void 0!==i?i:kO(t);o&&(t.runHooks("modifyFocusOnTabNavigation","from_below",o),t.selectCell(o.row,o.col)),t.listen()}}),r={wrapped:!1,flipped:!1};let s=!0,l=!1,c=!1;t.addHook("afterListen",(()=>o())),t.addHook("afterUnlisten",(()=>i())),t.addHook("afterSelection",((e,i,o,a,h)=>{var u;(l&&(r.wrapped&&r.flipped||c)&&(c=!1,h.value=!0),s)&&(n=null===(u=t.getSelectedRangeLast())||void 0===u?void 0:u.highlight)})),t.addHook("beforeRowWrap",((t,e,n)=>{r.wrapped=!0,r.flipped=n}));const u={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:fO,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([h(a({},u),{callback:()=>{const{tabNavigation:e}=t.getSettings();l=!0,t.getSelectedRangeLast()&&!e&&(s=!1),e||(c=!0)},position:"before"}),h(a({},u),{callback:e=>{const{tabNavigation:i,autoWrapRow:o}=t.getSettings();if(l=!1,s=!0,!i||!t.selection.isSelected()||o&&r.wrapped&&r.flipped||!o&&r.wrapped)return o&&r.wrapped&&r.flipped&&(n=e.shiftKey?HO(t):kO(t)),r.wrapped=!1,r.flipped=!1,t.deselectCell(),t.unlisten(),!1;e.preventDefault()},position:"after"})])}function HO(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:i}=t.getSettings();let o=i&&t.countColHeaders()>0?-t.countColHeaders():0,r=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return 0===o&&(o=e.getVisualFromRenderableIndex(o)),0===r&&(r=n.getVisualFromRenderableIndex(r)),null===o||null===r?null:t._createCellCoords(o,r)}function kO(t){var e,n;const{rowIndexMapper:i,columnIndexMapper:o}=t,{navigableHeaders:r}=t.getSettings();let s=i.getRenderableIndexesLength()-1,l=o.getRenderableIndexesLength()-1;if(s<0){if(!r||0===t.countColHeaders())return null;s=-1}if(l<0){if(!r||0===t.countColHeaders())return null;l=-1}return t._createCellCoords(null!==(e=i.getVisualFromRenderableIndex(s))&&void 0!==e?e:s,null!==(n=o.getVisualFromRenderableIndex(l))&&void 0!==n?n:l)}const IO=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),OO=t=>t.map((t=>{const e=t.toLowerCase();return IO.has(e)?IO.get(e):e})).sort().join("+"),AO=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),_O=t=>{let{which:e,key:n}=t;if(AO.has(e))return AO.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:n.toLowerCase()},PO=Symbol("shortcut-context");function NO(t){return Kv(t)&&t.__kindOf===PO}const DO=["meta","alt","shift","control"],LO=function(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed:e=>t.has(e)}}(),VO=[];let FO=0;const WO=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:i,afterKeyDown:o}=t;const r=GC({errorIdExists:t=>`The "${t}" context name is already registered.`});let s="grid";const l=()=>s,a=t=>r.getItem(t);let h=!1;const c=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();const i=NO(n)?n:a(n);let o=!1;if(!i.hasShortcut(e))return o;const r=i.getShortcuts(e);for(let s=0;s<r.length;s++){const{callback:n,runOnlyIf:i,preventDefault:l,stopPropagation:a,captureCtrl:u,forwardToContext:d}=r[s];if(!0===i(t)){if(h=u,o=!1===n(t,e),h=!1,l&&t.preventDefault(),a&&(by(t),t.stopPropagation()),o)break;d&&c(t,e,d)}}return o},u=function(t,e,n,i,o){const r=t=>DO.includes(t),s=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[];return t.altKey&&n.push("alt"),e&&(t.ctrlKey||t.metaKey)?n.push("control/meta"):(t.ctrlKey&&n.push("control"),t.metaKey&&n.push("meta")),t.shiftKey&&n.push("shift"),n},l=t=>{if(!1===e(t))return;if(!1===n(t)||229===t.keyCode||"string"!=typeof t.key||Cy(t))return;const l=_O(t);let a=[];r(l)||(a=s(t));const h=[l].concat(a);!o(t,h)&&(my()&&a.includes("meta")||!my()&&a.includes("control"))&&o(t,[l].concat(s(t,!0))),i(t)},a=t=>{if("string"==typeof t.key){const e=_O(t);r(e)&&LO.press(e)}},h=t=>{if("string"==typeof t.key){const e=_O(t);r(e)&&LO.release(e)}},c=()=>{LO.releaseAll()};return{mount:()=>{let e=t;for(FO+=1;e;)1===FO&&(e.document.documentElement.addEventListener("keydown",a),VO.push({event:"keydown",listener:a}),e.document.documentElement.addEventListener("keyup",h),VO.push({event:"keyup",listener:h})),e.document.documentElement.addEventListener("keydown",l),e.document.documentElement.addEventListener("blur",c),e=vw(e)},unmount:()=>{let e=t;for(FO-=1;e;){if(0===FO){for(let t=0;t<VO.length;t++){const{event:n,listener:i}=VO[t];e.document.documentElement.removeEventListener(n,i)}VO.length=0}e.document.documentElement.removeEventListener("keydown",l),e.document.documentElement.removeEventListener("blur",c),e=vw(e)}},isPressed:t=>LO.isPressed(t),releasePressedKeys:()=>LO.releaseAll()}}(e,n,i,o,c);return u.mount(),{addContext:t=>{const e=(t=>{const e=GC({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:t,callback:n,group:i,runOnlyIf:o=()=>!0,captureCtrl:r=!1,preventDefault:s=!0,stopPropagation:l=!1,relativeToGroup:a,position:h,forwardToContext:c}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Bp(i))throw new Error("You need to define the shortcut's group.");if(!1===sv(n))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(t))throw new Error(Fp`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const u={callback:n,group:i,runOnlyIf:o,captureCtrl:r,preventDefault:s,stopPropagation:l};jp(a)&&(u.relativeToGroup=a,u.position=h),NO(c)&&(u.forwardToContext=c),t.forEach((t=>{const n=OO(t);if(e.hasItem(n)){const t=e.getItem(n);let i=t.findIndex((t=>t.group===a));-1!==i?"before"===h?i-=1:i+=1:i=t.length,t.splice(i,0,u)}else e.addItem(n,[u])}))},i=t=>{const n=OO(t);e.removeItem(n)};return{__kindOf:PO,addShortcut:n,addShortcuts:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach((t=>{qv(e,((n,i)=>{!1===Object.prototype.hasOwnProperty.call(t,i)&&(t[i]=e[i])})),n(t)}))},getShortcuts:t=>{const n=OO(t),i=e.getItem(n);return jp(i)?i.slice():[]},hasShortcut:t=>{const n=OO(t);return e.hasItem(n)},removeShortcutsByKeys:i,removeShortcutsByGroup:t=>{e.getItems().forEach((e=>{let[n,o]=e;const r=o.filter((e=>e.group!==t));0===r.length?i((t=>t.split("+"))(n)):(o.length=0,o.push(...r))}))}}})(t);return r.addItem(t,e),e},getActiveContextName:l,getContext:a,setActiveContextName:t=>{if(!r.hasItem(t))throw new Error(Fp`You've tried to activate the "${t}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=t},isCtrlPressed:()=>!h&&(u.isPressed("control")||u.isPressed("meta")),releasePressedKeys:()=>u.releasePressedKeys(),destroy:()=>u.unmount()}};function jO(t){const{classNames:e}=function(t,e){const n={element:void 0,classNames:[]};let i=t;for(;null!==i&&i!==t.ownerDocument.documentElement&&!n.element;){if("string"==typeof e&&i.classList.contains(e))n.element=i,n.classNames.push(e);else if(e instanceof RegExp){const t=Array.from(i.classList).filter((t=>e.test(t)));t.length&&(n.element=i,n.classNames.push(...t))}i=i.parentElement}return n}(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let BO=null;const zO=new Map;function UO(t,e){var n,i=this;let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;const s=new Sb(r);let l,h,c,u,d,g,f=!0;var m;o===RM&&(m=this,SM.set(m,!0)),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=null!==(n=null==e?void 0:e.layoutDirection)&&void 0!==n?n:"inherit",w=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",w),this.isRtl=function(){return"rtl"===w},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1},e.language=function(t){let e=Fx(t);return Hk(e)||(e=Ck,Wx(t)),e}(e.language);const v=new rO(r,e,[aO,gO]),y=v.getTableMeta(),b=v.getGlobalMeta(),C=GC();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),EM(this)&&(Jp(e.licenseKey,t),Mw(t,"ht-wrapper")),this.guid=`ht_${ew()}`,zO.set(this.guid,this),this.columnIndexMapper=new Vx,this.rowIndexMapper=new Vx,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(t=>{r.runHooks("afterColumnSequenceChange",t)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(t=>{r.runHooks("afterRowSequenceChange",t)})),h=new qM(r),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let S=new kI(y,{rowIndexMapper:r.rowIndexMapper,columnIndexMapper:r.columnIndexMapper,countCols:()=>r.countCols(),countRows:()=>r.countRows(),propToCol:t=>l.propToCol(t),isEditorOpened:()=>!!r.getActiveEditor()&&r.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>r.getShortcutManager(),createCellCoords:(t,e)=>r._createCellCoords(t,e),createCellRange:(t,e,n)=>r._createCellRange(t,e,n),visualToRenderableCoords:t=>{const{row:e,col:n}=t;return r._createCellCoords(e>=0?r.rowIndexMapper.getRenderableFromVisualIndex(e):e,n>=0?r.columnIndexMapper.getRenderableFromVisualIndex(n):n)},renderableToVisualCoords:t=>{const{row:e,col:n}=t;return r._createCellCoords(e>=0?r.rowIndexMapper.getVisualFromRenderableIndex(e):e,n>=0?r.columnIndexMapper.getVisualFromRenderableIndex(n):n)},findFirstNonHiddenRenderableRow:(t,e)=>{const n=e>t?1:-1,i=Math.min(t,e),o=Math.max(t,e),s=r.rowIndexMapper.getNearestNotHiddenIndex(t,n);return null===s||1===n&&s>o||-1===n&&s<i?null:s>=0?r.rowIndexMapper.getRenderableFromVisualIndex(s):s},findFirstNonHiddenRenderableColumn:(t,e)=>{const n=e>t?1:-1,i=Math.min(t,e),o=Math.max(t,e),s=r.columnIndexMapper.getNearestNotHiddenIndex(t,n);return null===s||1===n&&s>o||-1===n&&s<i?null:s>=0?r.columnIndexMapper.getRenderableFromVisualIndex(s):s},isDisabledCellSelection:(t,e)=>t<0||e<0?r.getSettings().disableVisualSelection:r.getCellMeta(t,e).disableVisualSelection});this.selection=S;const R=t=>{let{hiddenIndexesChanged:e}=t;e&&this.selection.commit()};function E(t){const e=Fx(t);Hk(e)?(r.runHooks("beforeLanguageChange",e),b.language=e,r.runHooks("afterLanguageChange",e)):Wx(t)}function T(t,e){const n="className"===t?r.rootElement:r.table;if(f)Mw(n,e);else{let i=[],o=[];b[t]&&(i=Array.isArray(b[t])?b[t]:Vp(b[t])),e&&(o=Array.isArray(e)?e:Vp(e));const r=Lp(i,o),s=Lp(o,i);r.length&&xw(n,r),s.length&&Mw(n,s)}b[t]=e}function M(){let t=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,t=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===t&&(t=!0,this.onQueueEmpty(this.valid))}}}function x(t){const e=t.replace(",",".");return!1===isNaN(parseFloat(e))?parseFloat(e):t}function H(t,e,n){if(!t.length)return void n();const i=r.getActiveEditor(),o=new M;let s=!0;o.onQueueEmpty=()=>{i&&s&&i.cancelChanges(),n()};for(let h=t.length-1;h>=0;h--){const[n,i,,c]=t[h],u=l.propToCol(i);let d;d=Number.isInteger(u)?r.getCellMeta(n,u):a(a({},Object.getPrototypeOf(y)),y),"numeric"===d.type&&"string"==typeof c&&LC(c,[","])&&(t[h][3]=x(c)),r.getCellValidator(d)&&(o.addValidatorToQueue(),r.validateCell(t[h][3],d,function(e,n){return function(i){if("boolean"!=typeof i)throw new Error("Validation error: result is not boolean");!1===i&&!1===n.allowInvalid&&(s=!1,t.splice(e,1),n.valid=!0),o.removeValidatorFormQueue()}}(h,d),e))}o.checkIfQueueIsEmpty()}function k(t,e){for(let i=t.length-1;i>=0;i--){let n=!1;if(null!==t[i]){if(null!==t[i][2]&&void 0!==t[i][2]||null!==t[i][3]&&void 0!==t[i][3]){if(y.allowInsertRow)for(;t[i][0]>r.countRows()-1;){const{delta:t}=l.createRow(void 0,void 0,{source:e});if(0===t){n=!0;break}}if("array"===r.dataType&&(!y.columns||0===y.columns.length)&&y.allowInsertColumn)for(;l.propToCol(t[i][1])>r.countCols()-1;){const{delta:t}=l.createCol(void 0,void 0,{source:e});if(0===t){n=!0;break}}n||l.set(t[i][0],t[i][1],t[i][3])}}else t.splice(i,1)}const n=t.length>0;if(r.forceFullRender=!0,n){c.adjustRowsAndCols(),r.runHooks("beforeChangeRender",t,e),u.closeEditor(),r.view.render(),u.prepareEditor(),r.view.adjustElementsSize(),r.runHooks("afterChange",t,e||"edit");const n=r.getActiveEditor();n&&jp(n.refreshValue)&&n.refreshValue()}else r.view.render()}function I(t,e,n){return Array.isArray(t)?t:[[t,e,n]]}function O(t,e){const n=r.getActiveEditor(),i=r.runHooks("beforeChange",t,e||"edit"),o=t.filter((t=>null!==t));return!1===i||0===o.length?(n&&n.cancelChanges(),[]):o}this.columnIndexMapper.addLocalHook("cacheUpdated",R),this.rowIndexMapper.addLocalHook("cacheUpdated",R),this.selection.addLocalHook("afterSetRangeEnd",((t,e)=>{const n=Jv(!1),i=this.selection.getSelectedRange(),{from:o,to:s}=i.current(),l=i.size()-1;this.runHooks("afterSelection",o.row,o.col,s.row,s.col,n,l),this.runHooks("afterSelectionByProp",o.row,r.colToProp(o.col),s.row,r.colToProp(s.col),n,l),e&&(!n.isTouched()||n.isTouched()&&!n.value)&&g.scrollTo(t);const a=S.isSelectedByRowHeader(),h=S.isSelectedByColumnHeader();a&&h?Mw(this.rootElement,["ht__selection--rows","ht__selection--columns"]):a?(xw(this.rootElement,"ht__selection--columns"),Mw(this.rootElement,"ht__selection--rows")):h?(xw(this.rootElement,"ht__selection--rows"),Mw(this.rootElement,"ht__selection--columns")):xw(this.rootElement,["ht__selection--rows","ht__selection--columns"]),"shift"!==S.getSelectionSource()&&u.closeEditor(null),r.view.render(),u.prepareEditor()})),this.selection.addLocalHook("beforeSetFocus",(t=>{this.runHooks("beforeSelectionFocusSet",t.row,t.col)})),this.selection.addLocalHook("afterSetFocus",(t=>{const e=Jv(!1);this.runHooks("afterSelectionFocusSet",t.row,t.col,e),(!e.isTouched()||e.isTouched()&&!e.value)&&g.scrollTo(t),u.closeEditor(),r.view.render(),u.prepareEditor()})),this.selection.addLocalHook("afterSelectionFinished",(t=>{const e=t.length-1,{from:n,to:i}=t[e];this.runHooks("afterSelectionEnd",n.row,n.col,i.row,i.col,e),this.runHooks("afterSelectionEndByProp",n.row,r.colToProp(n.col),i.row,r.colToProp(i.col),e)})),this.selection.addLocalHook("afterIsMultipleSelection",(t=>{const e=this.runHooks("afterIsMultipleSelection",t.value);t.value&&(t.value=e)})),this.selection.addLocalHook("afterDeselect",(()=>{u.closeEditor(),r.view.render(),xw(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")})),this.selection.addLocalHook("beforeHighlightSet",(()=>this.runHooks("beforeSelectionHighlightSet"))).addLocalHook("beforeSetRangeStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.runHooks("beforeSetRangeStart",...e)})).addLocalHook("beforeSetRangeStartOnly",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.runHooks("beforeSetRangeStartOnly",...e)})).addLocalHook("beforeSetRangeEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.runHooks("beforeSetRangeEnd",...e)})).addLocalHook("beforeSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.runHooks("beforeSelectColumns",...e)})).addLocalHook("afterSelectColumns",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.runHooks("afterSelectColumns",...e)})).addLocalHook("beforeSelectRows",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.runHooks("beforeSelectRows",...e)})).addLocalHook("afterSelectRows",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.runHooks("afterSelectRows",...e)})).addLocalHook("beforeModifyTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.runHooks("modifyTransformStart",...e)})).addLocalHook("afterModifyTransformStart",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.runHooks("afterModifyTransformStart",...e)})).addLocalHook("beforeModifyTransformFocus",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.runHooks("modifyTransformFocus",...e)})).addLocalHook("afterModifyTransformFocus",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.runHooks("afterModifyTransformFocus",...e)})).addLocalHook("beforeModifyTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.runHooks("modifyTransformEnd",...e)})).addLocalHook("afterModifyTransformEnd",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.runHooks("afterModifyTransformEnd",...e)})).addLocalHook("beforeRowWrap",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.runHooks("beforeRowWrap",...e)})).addLocalHook("beforeColumnWrap",(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return i.runHooks("beforeColumnWrap",...e)})).addLocalHook("insertRowRequire",(t=>this.alter("insert_row_above",t,1,"auto"))).addLocalHook("insertColRequire",(t=>this.alter("insert_col_start",t,1,"auto"))),c={alter(t,e){var n,i;let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;const h=t=>{if(0===t.length)return[];const e=[...t];e.sort(((t,e)=>{let[n]=t,[i]=e;return n===i?0:n>i?1:-1}));return Ap(e,((t,e)=>{let[n,i]=e;const o=t[t.length-1],[r,s]=o,l=r+s;if(n<=l){const t=Math.max(i-(l-n),0);o[1]+=t}else t.push([n,i]);return t}),[e[0]])};switch(t){case"insert_row_below":case"insert_row_above":const a=r.countSourceRows();if(y.maxRows===a)return;const c="insert_row_below"===t?"below":"above";e=null!==(n=e)&&void 0!==n?n:"below"===c?a:0;const{delta:d,startPhysicalIndex:g}=l.createRow(e,o,{source:s,mode:c});S.shiftRows(r.toVisualRow(g),d);break;case"insert_col_start":case"insert_col_end":const f="insert_col_end"===t?"end":"start";e=null!==(i=e)&&void 0!==i?i:"end"===f?r.countSourceCols():0;const{delta:m,startPhysicalIndex:p}=l.createCol(e,o,{source:s,mode:f});if(m){if(Array.isArray(y.colHeaders)){const t=[r.toVisualColumn(p),0];t.length+=m,Array.prototype.splice.apply(y.colHeaders,t)}S.shiftColumns(r.toVisualColumn(p),m)}break;case"remove_row":const w=t=>{let e=0;Np(t,(t=>{let[n,i]=t;const o=zp(n)?r.countRows()-1:Math.max(n-e,0);Number.isInteger(n)&&(n=Math.max(n-e,0));if(!l.removeRow(n,i,s))return;if(S.isSelected()){const{row:t}=r.getSelectedRangeLast().highlight;t>=n&&t<=n+i-1&&u.closeEditor(!0)}const a=r.countRows();0===a?S.deselect():"ContextMenu.removeRow"===s?S.refresh():S.shiftRows(n,-i);const h=y.fixedRowsTop;h>=o+1&&(y.fixedRowsTop-=Math.min(i,h-o));const c=y.fixedRowsBottom;c&&o>=a-c&&(y.fixedRowsBottom-=Math.min(i,c)),e+=i}))};Array.isArray(e)?w(h(e)):w([[e,o]]);break;case"remove_col":const v=t=>{let e=0;Np(t,(t=>{let[n,i]=t;const o=zp(n)?r.countCols()-1:Math.max(n-e,0);let a=r.toPhysicalColumn(o);Number.isInteger(n)&&(n=Math.max(n-e,0));if(!l.removeCol(n,i,s))return;if(S.isSelected()){const{col:t}=r.getSelectedRangeLast().highlight;t>=n&&t<=n+i-1&&u.closeEditor(!0)}0===r.countCols()?S.deselect():"ContextMenu.removeColumn"===s?S.refresh():S.shiftColumns(n,-i);const h=y.fixedColumnsStart;h>=o+1&&(y.fixedColumnsStart-=Math.min(i,h-o)),Array.isArray(y.colHeaders)&&(void 0===a&&(a=-1),y.colHeaders.splice(a,i)),e+=i}))};Array.isArray(e)?v(h(e)):v([[e,o]]);break;default:throw new Error(`There is no such action "${t}"`)}r.view.render(),a||c.adjustRowsAndCols()},adjustRowsAndCols(){const t=y.minRows,e=y.minSpareRows,n=y.minCols,i=y.minSpareCols;if(t){const e=r.countRows();e<t&&l.createRow(e,t-e,{source:"auto"})}if(e){const t=r.countEmptyRows(!0);if(t<e){const n=e-t,i=Math.min(n,y.maxRows-r.countSourceRows());l.createRow(r.countRows(),i,{source:"auto"})}}{let t;(n||i)&&(t=r.countEmptyCols(!0));let e=r.countCols();if(n&&!y.columns&&e<n){const i=n-e;t+=i,l.createCol(e,i,{source:"auto"})}if(i&&!y.columns&&"array"===r.dataType&&t<i){e=r.countCols();const n=i-t,o=Math.min(n,y.maxCols-e);l.createCol(e,o,{source:"auto"})}}r.view&&r.view.adjustElementsSize()},populateFromArray(t,e,n,i,o){let s,l,a,h;const c=[],u={},d=[],g=t.row,f=t.col;if(l=e.length,0===l)return!1;let m=0,p=0;switch(Kv(n)&&(m=n.col-f+1,p=n.row-g+1),o){case"shift_down":const o=Op(e),w=o.length,v=Math.max(w,m),b=r.getData().slice(g),C=Op(b).slice(f,f+v);for(a=0;a<v;a+=1)if(a<w){for(s=0,l=o[a].length;s<p-l;s+=1)o[a].push(o[a][s%l]);a<C.length?d.push(o[a].concat(C[a])):d.push(o[a].concat(new Array(b.length).fill(null)))}else d.push(o[a%w].concat(C[a]));r.populateFromArray(g,f,Op(d));break;case"shift_right":const S=e.length,R=Math.max(S,p),E=r.getData().slice(g).map((t=>t.slice(f)));for(s=0;s<R;s+=1)if(s<S){for(a=0,h=e[s].length;a<m-h;a+=1)e[s].push(e[s][a%h]);if(s<E.length)for(let t=0;t<E[s].length;t+=1)e[s].push(E[s][t]);else e[s].push(...new Array(E[0].length).fill(null))}else e.push(e[s%l].slice(0,R).concat(E[s]));r.populateFromArray(g,f,e);break;default:u.row=t.row,u.col=t.col;let T,M=0,x=0,H=!0;const k=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i=e[t%e.length];return null!==n?i[n%i.length]:i},I=e.length,O=n?n.row-t.row+1:0;for(l=n?O:Math.max(I,O),s=0;s<l&&!(n&&u.row>n.row&&O>I||!y.allowInsertRow&&u.row>r.countRows()-1||u.row>=y.maxRows);s++){const e=s-M,o=k(e).length,d=n?n.col-t.col+1:0;if(h=n?d:Math.max(o,d),u.col=t.col,T=r.getCellMeta(u.row,u.col),"CopyPaste.paste"!==i&&"Autofill.fill"!==i||!T.skipRowOnPaste){for(x=0,a=0;a<h&&!(n&&u.col>n.col&&d>o||!y.allowInsertColumn&&u.col>r.countCols()-1||u.col>=y.maxCols);a++){if(T=r.getCellMeta(u.row,u.col),("CopyPaste.paste"===i||"Autofill.fill"===i)&&T.skipColumnOnPaste){x+=1,u.col+=1,h+=1;continue}if(T.readOnly&&"UndoRedo.undo"!==i){u.col+=1;continue}let t=k(e,a-x),n=r.getDataAtCell(u.row,u.col);if(null!==t&&"object"==typeof t)if(Array.isArray(t)&&null===n&&(n=[]),null===n||"object"!=typeof n)H=!1;else{const e=Wv(Array.isArray(n)?n:n[0]||n),i=Wv(Array.isArray(t)?t:t[0]||t);Gv(e,i)||Array.isArray(e)&&Array.isArray(i)?t=Uv(t):H=!1}else null!==n&&"object"==typeof n&&(H=!1);H&&c.push([u.row,u.col,t]),H=!0,u.col+=1}u.row+=1}else M+=1,u.row+=1,l+=1}r.setDataAtCell(c,null,null,i||"populateFromArray")}}},this.init=function(){h.setData(y.data),r.runHooks("beforeInit"),(uy()||gy())&&Mw(r.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new BM(this);const t=y.themeName||jO(r.rootElement);r.useTheme(t),r.view.addClassNameToLicenseElement(r.getCurrentThemeName()),u=Ob.getInstance(r,y,S),g=function(t){const{selection:e}=t;let n=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){n=!0},scrollTo(o){var r;if(n||i)return void(n=!1);let s;e.isFocusSelectionChanged()?s=function(t){return e=>{t.scrollViewportTo(e.toObject())}}(t):e.isSelectedByCorner()?s=()=>{}:e.isSelectedByRowHeader()?s=function(t){return e=>{let{row:n}=e;t.scrollViewportTo({row:n})}}(t):e.isSelectedByColumnHeader()?s=function(t){return e=>{let{col:n}=e;t.scrollViewportTo({col:n})}}(t):1===e.getSelectedRange().size()&&e.isMultiple()?s=function(t){return e=>{t.scrollViewportTo(e.toObject())}}(t):1!==e.getSelectedRange().size()||e.isMultiple()?e.getSelectedRange().size()>1&&(s=function(t){return e=>{t.scrollViewportTo(e.toObject())}}(t)):s=function(t){return e=>{const n=t.selection.getSelectionSource(),{row:i,col:o}=e;if(i<0&&o>=0)t.scrollViewportTo({col:o});else if(o<0&&i>=0)t.scrollViewportTo({row:i});else{if("mouse"===n&&(o===t.view.getLastPartiallyVisibleColumn()||i===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:i,col:o})}}}(t),null===(r=s)||void 0===r||r(o)}}}(r),d=new Ub(r),EM(this)&&xO(r),r.runHooks("init"),this.forceFullRender=!0,this.view.render(),f&&null===r.rootElement.offsetParent&&function(t,e){new IntersectionObserver(((n,i)=>{n.forEach((n=>{n.isIntersecting&&null!==t.offsetParent&&(e(),i.unobserve(t))}))}),{root:t.ownerDocument.body}).observe(t)}(r.rootElement,(()=>{r.view._wt.wtOverlays.updateLastSpreaderSize(),r.render(),r.view.adjustElementsSize()})),"object"==typeof f&&(r.runHooks("afterChange",f[0],f[1]),f=!1),r.runHooks("afterInit")},this._createCellCoords=function(t,e){return r.view._wt.createCellCoords(t,e)},this._createCellRange=function(t,e,n){return r.view._wt.createCellRange(t,e,n)},this.validateCell=function(t,e,n,i){let o=r.getCellValidator(e);function s(t){if(!(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])||!0===e.hidden)return void n(t);const i=e.visualCol,o=e.visualRow,s=r.getCell(o,i,!0);if(s&&"TH"!==s.nodeName){const t=r.rowIndexMapper.getRenderableFromVisualIndex(o),e=r.columnIndexMapper.getRenderableFromVisualIndex(i);r.view._wt.getSetting("cellRenderer",t,e,s)}n(t)}var l,a;a=o,"[object RegExp]"===Object.prototype.toString.call(a)&&(l=o,o=function(t,e){e(l.test(t))}),sv(o)?(t=r.runHooks("beforeValidate",t,e.visualRow,e.prop,i),r._registerImmediate((()=>{o.call(e,t,(n=>{r&&(n=r.runHooks("afterValidate",n,t,e.visualRow,e.prop,i),e.valid=n,s(n),r.runHooks("postAfterValidate",n,t,e.visualRow,e.prop,i))}))}))):r._registerImmediate((()=>{e.valid=!0,s(e.valid,!1)}))},this.setDataAtCell=function(t,e,n,i){const o=I(t,e,n),s=[];let a,c,u,d=i;for(a=0,c=o.length;a<c;a++){if("object"!=typeof o[a])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof o[a][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");u=o[a][1]>=this.countCols()?o[a][1]:l.colToProp(o[a][1]),s.push([o[a][0],u,h.getAtCell(this.toPhysicalRow(o[a][0]),o[a][1]),o[a][2]])}d||"object"!=typeof t||(d=e);const g=O(s,d);r.runHooks("afterSetDataAtCell",g,d),H(g,d,(()=>{k(g,d)}))},this.setDataAtRowProp=function(t,e,n,i){const o=I(t,e,n),s=[];let l,a,c=i;for(l=0,a=o.length;l<a;l++)s.push([o[l][0],o[l][1],h.getAtCell(this.toPhysicalRow(o[l][0]),o[l][1]),o[l][2]]);c||"object"!=typeof t||(c=e);const u=O(s,i);r.runHooks("afterSetDataAtRowProp",u,c),H(u,c,(()=>{k(u,c)}))},this.listen=function(){r&&!r.isListening()&&(zO.forEach((t=>{r!==t&&t.unlisten()})),BO=r.guid,r.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(BO=null,r.runHooks("afterUnlisten"))},this.isListening=function(){return BO===r.guid},this.destroyEditor=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];u.closeEditor(t),r.view.render(),e&&S.isSelected()&&u.prepareEditor()},this.populateFromArray=function(t,e,n,i,o,s,l){if("object"!=typeof n||"object"!=typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const a="number"==typeof i?r._createCellCoords(i,o):null;return c.populateFromArray(r._createCellCoords(t,e),n,a,s,l)},this.spliceCol=function(t,e,n){for(var i=arguments.length,o=new Array(i>3?i-3:0),r=3;r<i;r++)o[r-3]=arguments[r];return l.spliceCol(t,e,n,...o)},this.spliceRow=function(t,e,n){for(var i=arguments.length,o=new Array(i>3?i-3:0),r=3;r<i;r++)o[r-3]=arguments[r];return l.spliceRow(t,e,n,...o)},this.getSelected=function(){if(S.isSelected())return Pp(S.getSelectedRange(),(t=>{let{from:e,to:n}=t;return[e.row,e.col,n.row,n.col]}))},this.getSelectedLast=function(){const t=this.getSelected();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(S.isSelected())return Array.from(S.getSelectedRange())},this.getSelectedRangeLast=function(){const t=this.getSelectedRange();let e;return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(t){if(!S.isSelected()||0===this.countRows()||0===this.countCols())return;const e=[];Np(S.getSelectedRange(),(t=>{if(t.isSingleHeader())return;const n=t.getTopStartCorner(),i=t.getBottomEndCorner();VC(n.row,i.row,(t=>{VC(n.col,i.col,(n=>{this.getCellMeta(t,n).readOnly||e.push([t,n,null])}))}))})),e.length>0&&this.setDataAtCell(e,t)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const t=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(t,0),this.isRenderSuspended()||t!==this.renderSuspendedCounter||(this.renderCall?this.render():r.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||r.view.render())},this.batchRender=function(t){this.suspendRender();const e=t();return this.resumeRender(),e},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(e,0),(!this.isExecutionSuspended()&&e===this.executionSuspendedCounter||t)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const n=t();return this.resumeExecution(e),n},this.batch=function(t){this.suspendRender(),this.suspendExecution();const e=t();return this.resumeExecution(),this.resumeRender(),e},this.refreshDimensions=function(){if(!r.view)return;const{width:t,height:e}=r.view.getLastSize(),{width:n,height:i}=r.rootElement.getBoundingClientRect(),o=n!==t||i!==e;!1===r.runHooks("beforeRefreshDimensions",{width:t,height:e},{width:n,height:i},o)||((o||r.view._wt.wtOverlays.scrollableElement===r.rootWindow)&&(r.view.setLastSize(n,i),r.render()),r.runHooks("afterRefreshDimensions",{width:t,height:e},{width:n,height:i},o))},this.updateData=function(t,e){sO(t,(t=>{l=t}),(t=>{l=t,r.columnIndexMapper.fitToLength(this.getInitialColumnCount()),r.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),S.refresh()}),{hotInstance:r,dataMap:l,dataSource:h,internalSource:"updateData",source:e,metaManager:v,firstRun:f})},this.loadData=function(t,e){sO(t,(t=>{l=t}),(()=>{v.clearCellsCache(),r.initIndexMappers(),c.adjustRowsAndCols(),S.refresh(),f&&(f=[null,"loadData"])}),{hotInstance:r,dataMap:l,dataSource:h,internalSource:"loadData",source:e,metaManager:v,firstRun:f})},this.getInitialColumnCount=function(){const t=y.columns;let e=0;if(Array.isArray(t))e=t.length;else if(sv(t))if("array"===r.dataType){const n=this.countSourceCols();for(let i=0;i<n;i+=1)t(i)&&(e+=1)}else"object"!==r.dataType&&"function"!==r.dataType||(e=l.colToPropCache.length);else if(jp(y.dataSchema)){const t=l.getSchema();e=Array.isArray(t)?t.length:Qv(t)}else e=this.countSourceCols();return e},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(t,e,n,i){return Bp(t)?l.getAll():l.getRange(r._createCellCoords(t,e),r._createCellCoords(n,i),l.DESTINATION_RENDERER)},this.getCopyableText=function(t,e,n,i){return l.getCopyableText(r._createCellCoords(t,e),r._createCellCoords(n,i))},this.getCopyableData=function(t,e){return l.getCopyable(t,l.colToProp(e))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(f?r.loadData:r.updateData).bind(this);let i,o,s=!1;if(jp(t.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(jp(t.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(jp(t.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(i in t)"data"===i||("language"===i?E(t.language):"className"===i?T("className",t.className):"tableClassName"===i&&r.table?(T("tableClassName",t.tableClassName),r.view._wt.wtOverlays.syncOverlayTableClassNames()):lb.getSingleton().isRegistered(i)||lb.getSingleton().isDeprecated(i)?sv(t[i])?lb.getSingleton().addAsFixed(i,t[i],r):Array.isArray(t[i])&&lb.getSingleton().add(i,t[i],r):!e&&ty(t,i)&&(b[i]=t[i]));void 0===t.data&&void 0===y.data?n(null,"updateSettings"):void 0!==t.data?n(t.data,"updateSettings"):void 0!==t.columns&&(l.createMap(),r.initIndexMappers());const a=r.countCols(),h=y.columns;if(h&&sv(h)&&(s=!0),void 0===t.cell&&void 0===t.cells&&void 0===t.columns||v.clearCache(),a>0)for(i=0,o=0;i<a;i++){if(h){const t=s?h(i):h[o];t&&v.updateColumnMeta(o,t)}o+=1}jp(t.cell)&&qv(t.cell,(t=>{r.setCellMetaObject(t.row,t.col,t)})),r.runHooks("afterCellMetaReset");let u=r.rootElement.style.height;""!==u&&(u=parseInt(r.rootElement.style.height,10));let d=t.height;if(sv(d)&&(d=d()),e){r.rootElement.getAttribute("style")&&r.rootElement.setAttribute("data-initialstyle",r.rootElement.getAttribute("style"))}if(null===d){const t=r.rootElement.getAttribute("data-initialstyle");t&&(t.indexOf("height")>-1||t.indexOf("overflow")>-1)?r.rootElement.setAttribute("style",t):(r.rootElement.style.height="",r.rootElement.style.overflow="")}else void 0!==d&&(r.rootElement.style.height=isNaN(d)?`${d}`:`${d}px`,r.rootElement.style.overflow="hidden");if(void 0!==t.width){let e=t.width;sv(e)&&(e=e()),r.rootElement.style.width=isNaN(e)?`${e}`:`${e}px`}if(!e){if(r.view){r.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),r.view._wt.exportSettingsAsClassNames();const e=r.getCurrentThemeName(),n=ty(t,"themeName");e&&n&&(r.view.getStylesHandler().removeClassNames(),r.view.removeClassNameFromLicenseElement(e));const i=n&&t.themeName||jO(r.rootElement);r.useTheme(i),r.view.addClassNameToLicenseElement(r.getCurrentThemeName())}r.runHooks("afterUpdateSettings",t)}c.adjustRowsAndCols(),r.view&&!f&&(r.forceFullRender=!0,r.view.render(),r.view._wt.wtOverlays.adjustElementsSize()),e||!r.view||""!==u&&""!==d&&void 0!==d||u===d||r.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const t=r.getSelectedLast();if(y.getValue){if(sv(y.getValue))return y.getValue.call(r);if(t)return r.getData()[t[0][0]][y.getValue]}else if(t)return r.getDataAtCell(t[0],t[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(t,e,n,i,o){c.alter(t,e,n,i,o)},this.getCell=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e,o=t;if(e>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(e)))return null;i=this.columnIndexMapper.getRenderableFromVisualIndex(e)}if(t>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(t)))return null;o=this.rowIndexMapper.getRenderableFromVisualIndex(t)}return null===o||null===i||void 0===o||void 0===i?null:r.view.getCellAtCoords(r._createCellCoords(o,i),n)},this.getCoords=function(t){const e=this.view._wt.wtTable.getCoords(t);if(null===e)return null;const{row:n,col:i}=e;let o=n,s=i;return n>=0&&(o=this.rowIndexMapper.getVisualFromRenderableIndex(n)),i>=0&&(s=this.columnIndexMapper.getVisualFromRenderableIndex(i)),r._createCellCoords(o,s)},this.colToProp=function(t){return l.colToProp(t)},this.propToCol=function(t){return l.propToCol(t)},this.toVisualRow=t=>this.rowIndexMapper.getVisualFromPhysicalIndex(t),this.toVisualColumn=t=>this.columnIndexMapper.getVisualFromPhysicalIndex(t),this.toPhysicalRow=t=>this.rowIndexMapper.getPhysicalFromVisualIndex(t),this.toPhysicalColumn=t=>this.columnIndexMapper.getPhysicalFromVisualIndex(t),this.getDataAtCell=function(t,e){return l.get(t,l.colToProp(e))},this.getDataAtRowProp=function(t,e){return l.get(t,e)},this.getDataAtCol=function(t){const e=[],n=l.getRange(r._createCellCoords(0,t),r._createCellCoords(y.data.length-1,t),l.DESTINATION_RENDERER);for(let i=0;i<n.length;i+=1)for(let t=0;t<n[i].length;t+=1)e.push(n[i][t]);return e},this.getDataAtProp=function(t){const e=[],n=l.getRange(r._createCellCoords(0,l.propToCol(t)),r._createCellCoords(y.data.length-1,l.propToCol(t)),l.DESTINATION_RENDERER);for(let i=0;i<n.length;i+=1)for(let t=0;t<n[i].length;t+=1)e.push(n[i][t]);return e},this.getSourceData=function(t,e,n,i){let o;return o=void 0===t?h.getData():h.getByRange(r._createCellCoords(t,e),r._createCellCoords(n,i)),o},this.getSourceDataArray=function(t,e,n,i){let o;return o=void 0===t?h.getData(!0):h.getByRange(r._createCellCoords(t,e),r._createCellCoords(n,i),!0),o},this.getSourceDataAtCol=function(t){return h.getAtColumn(t)},this.setSourceDataAtCell=function(t,e,n,i){const o=I(t,e,n),s=this.hasHook("afterSetSourceDataAtCell"),l=[];s&&Np(o,(t=>{let[e,n,i]=t;l.push([e,n,h.getAtCell(e,n),i])})),Np(o,(t=>{let[e,n,i]=t;h.setAtCell(e,n,i)})),s&&this.runHooks("afterSetSourceDataAtCell",l,i),this.render();const a=r.getActiveEditor();a&&jp(a.refreshValue)&&a.refreshValue()},this.getSourceDataAtRow=function(t){return h.getAtRow(t)},this.getSourceDataAtCell=function(t,e){return h.getAtCell(t,e)},this.getDataAtRow=function(t){return l.getRange(r._createCellCoords(t,0),r._createCellCoords(t,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(t,e,n,i){const o=void 0===t?[0,0,this.countRows(),this.countCols()]:[t,e,n,i],[r,s]=o;let[,,l,a]=o,h=null,c=null;void 0===l&&(l=r),void 0===a&&(a=s);let u="mixed";return VC(Math.max(Math.min(r,l),0),Math.max(r,l),(t=>{let e=!0;return VC(Math.max(Math.min(s,a),0),Math.max(s,a),(n=>{const i=this.getCellMeta(t,n);return c=i.type,h?e=h===c:h=c,e})),u=e?c:"mixed",e})),u},this.removeCellMeta=function(t,e,n){const[i,o]=[this.toPhysicalRow(t),this.toPhysicalColumn(e)];let s=v.getCellMetaKeyValue(i,o,n);!1!==r.runHooks("beforeRemoveCellMeta",t,e,n,s)&&(v.removeCellMeta(i,o,n),r.runHooks("afterRemoveCellMeta",t,e,n,s)),s=null},this.spliceCellsMeta=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];if(i.length>0&&!Array.isArray(i[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");e>0&&v.removeRow(this.toPhysicalRow(t),e),i.length>0&&Np(i.reverse(),(e=>{v.createRow(this.toPhysicalRow(t)),Np(e,((e,n)=>this.setCellMetaObject(t,n,e)))})),r.render()},this.setCellMetaObject=function(t,e,n){"object"==typeof n&&qv(n,((n,i)=>{this.setCellMeta(t,e,i,n)}))},this.setCellMeta=function(t,e,n,i){if(!1===r.runHooks("beforeSetCellMeta",t,e,n,i))return;let o=t,s=e;t<this.countRows()&&(o=this.toPhysicalRow(t)),e<this.countCols()&&(s=this.toPhysicalColumn(e)),v.setCellMeta(o,s,n,i),r.runHooks("afterSetCellMeta",t,e,n,i)},this.getCellsMeta=function(){return v.getCellsMeta()},this.getCellMeta=function(t,e){let n=this.toPhysicalRow(t),i=this.toPhysicalColumn(e);return null===n&&(n=t),null===i&&(i=e),v.getCellMeta(n,i,{visualRow:t,visualColumn:e})},this.getColumnMeta=function(t){return v.getColumnMeta(this.toPhysicalColumn(t))},this.getCellMetaAtRow=function(t){return v.getCellsMetaAtRow(t)},this.isColumnModificationAllowed=function(){return!("object"===r.dataType||y.columns)},this.getCellRenderer=function(t,e){const n="number"==typeof t?r.getCellMeta(t,e).renderer:t.renderer;return"string"==typeof n?lS(n):Bp(n)?lS("text"):n},this.getCellEditor=function(t,e){const n="number"==typeof t?r.getCellMeta(t,e).editor:t.editor;return"string"==typeof n?yb(n):Bp(n)?yb("text"):n},this.getCellValidator=function(t,e){const n="number"==typeof t?r.getCellMeta(t,e).validator:t.validator;return"string"==typeof n?function(t){if("function"==typeof t)return t;if(!uS(t))throw Error(`No registered validator found under "${t}" name`);return cS(t)}(n):n},this.validateCells=function(t){this._validateCells(t)},this.validateRows=function(t,e){if(!Array.isArray(t))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(e,t)},this.validateColumns=function(t,e){if(!Array.isArray(t))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(e,void 0,t)},this._validateCells=function(t,e,n){const i=new M;t&&(i.onQueueEmpty=t);let o=r.countRows()-1;for(;o>=0;){if(void 0!==e&&-1===e.indexOf(o)){o-=1;continue}let t=r.countCols()-1;for(;t>=0;)void 0===n||-1!==n.indexOf(t)?(i.addValidatorToQueue(),r.validateCell(r.getDataAtCell(o,t),r.getCellMeta(o,t),(t=>{if("boolean"!=typeof t)throw new Error("Validation error: result is not boolean");!1===t&&(i.valid=!1),i.removeValidatorFormQueue()}),"validateCells"),t-=1):t-=1;o-=1}i.checkIfQueueIsEmpty()},this.getRowHeader=function(t){let e=y.rowHeaders,n=t;return void 0!==n&&(n=r.runHooks("modifyRowHeader",n)),void 0===n?(e=[],VC(r.countRows()-1,(t=>{e.push(r.getRowHeader(t))}))):Array.isArray(e)&&void 0!==e[n]?e=e[n]:sv(e)?e=e(n):e&&"string"!=typeof e&&"number"!=typeof e&&(e=n+1),e},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(void 0!==y.colHeaders&&null!==y.colHeaders)return!!y.colHeaders;for(let t=0,e=r.countCols();t<e;t++)if(r.getColHeader(t))return!0;return!1},this.getColHeader=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=r.runHooks("modifyColHeader",t);if(void 0===n){const t=[],e=r.countCols();for(let n=0;n<e;n++)t.push(r.getColHeader(n));return t}let i=y.colHeaders;const o=r.toPhysicalColumn(n),s=function(t){const e=[],n=r.countCols();let i=0;for(;i<n;i++)sv(y.columns)&&y.columns(i)&&e.push(i);return e[t]}(o);return!1===y.colHeaders?i=null:y.columns&&sv(y.columns)&&y.columns(s)&&y.columns(s).title?i=y.columns(s).title:y.columns&&y.columns[o]&&y.columns[o].title?i=y.columns[o].title:Array.isArray(y.colHeaders)&&void 0!==y.colHeaders[o]?i=y.colHeaders[o]:sv(y.colHeaders)?i=y.colHeaders(o):y.colHeaders&&"string"!=typeof y.colHeaders&&"number"!=typeof y.colHeaders&&(i=function(t){let e,n=t+1,i="";for(;n>0;)e=(n-1)%26,i=String.fromCharCode(65+e)+i,n=parseInt((n-e)/26,10);return i}(n)),i=r.runHooks("modifyColumnHeaderValue",i,t,e),i},this._getColWidthFromSettings=function(t){let e;if(t>=0){e=r.getCellMeta(0,t).width}if(void 0!==e&&e!==y.width||(e=y.colWidths),null!=e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getColWidth=function(t,e){let n=r._getColWidthFromSettings(t);return n=r.runHooks("modifyColWidth",n,t,e),void 0===n&&(n=US),n},this._getRowHeightFromSettings=function(t){let e=y.rowHeights;if(null!=e){switch(typeof e){case"object":e=e[t];break;case"function":e=e(t)}"string"==typeof e&&(e=parseInt(e,10))}return e},this.getRowHeight=function(t,e){let n=r._getRowHeightFromSettings(t);return n=r.runHooks("modifyRowHeight",n,t,e),n},this.countSourceRows=function(){return h.countRows()},this.countSourceCols=function(){return h.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const t=y.maxCols,e=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(t,e)},this.countRenderedRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return FC(r.countRows()-1,(n=>{if(r.isEmptyRow(n))e+=1;else if(!0===t)return!1})),e},this.countEmptyCols=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;return FC(r.countCols()-1,(n=>{if(r.isEmptyCol(n))e+=1;else if(!0===t)return!1})),e},this.isEmptyRow=function(t){return y.isEmptyRow.call(r,t)},this.isEmptyCol=function(t){return y.isEmptyCol.call(r,t)},this.selectCell=function(t,e,n,i){let o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Bp(t)&&!Bp(e)&&this.selectCells([[t,e,n,i]],o,r)},this.selectCells=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&g.suspend();const n=S.selectCells(t);return n&&e&&r.listen(),g.resume(),n},this.selectColumns=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2?arguments[2]:void 0;return S.selectColumns(t,e,n)},this.selectRows=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2?arguments[2]:void 0;return S.selectRows(t,e,n)},this.deselectCell=function(){S.deselect()},this.selectAll=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2?arguments[2]:void 0;g.skipNextScrollCycle(),S.selectAll(t,e,n)};const A=(t,e)=>t.getNearestNotHiddenIndex(e,1,!0);this.scrollViewportTo=function(t){var e,n;"number"==typeof t&&(t={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(n=arguments[4])||void 0===n||n});const{row:i,col:o,considerHiddenIndexes:s}=null!==(e=t)&&void 0!==e?e:{};let l=i,a=o;if(void 0===s||s){const t=Number.isInteger(i)&&i>=0,e=Number.isInteger(o)&&o>=0,n=t?A(this.rowIndexMapper,i):void 0,s=e?A(this.columnIndexMapper,o):void 0;if(null===n||null===s)return!1;l=t?r.rowIndexMapper.getRenderableFromVisualIndex(n):i,a=e?r.columnIndexMapper.getRenderableFromVisualIndex(s):o}const h=Number.isInteger(l),c=Number.isInteger(a);return h&&l>=0&&c&&a>=0?r.view.scrollViewport(r._createCellCoords(l,a),t.horizontalSnap,t.verticalSnap):h&&l>=0&&(c&&a<0||!c)?r.view.scrollViewportVertically(l,t.verticalSnap):!!(c&&a>=0&&(h&&l<0||!h))&&r.view.scrollViewportHorizontally(a,t.horizontalSnap)},this.scrollToFocusedCell=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",t);const{highlight:e}=this.getSelectedRangeLast();this.scrollViewportTo(e.toObject())?this.view.render():(this.removeHook("afterScroll",t),this._registerImmediate((()=>t())))},this.destroy=function(){if(r._clearTimeouts(),r._clearImmediates(),r.view&&r.view.destroy(),h&&h.destroy(),h=null,this.getShortcutManager().destroy(),v.clearCache(),zO.delete(this.guid),EM(r)){const t=this.rootDocument.querySelector(".hot-display-license-info");t&&t.parentNode.removeChild(t)}Ow(r.rootElement),s.destroy(),u&&u.destroy(),r.batchExecution((()=>{r.rowIndexMapper.unregisterAll(),r.columnIndexMapper.unregisterAll(),C.getItems().forEach((t=>{let[,e]=t;e.destroy()})),C.clear(),r.runHooks("afterDestroy")}),!0),lb.getSingleton().destroy(r),qv(r,((t,e,n)=>{var i;sv(t)?n[e]=(i=e,()=>{throw new Error(`The "${i}" method cannot be called because this Handsontable instance has been destroyed`)}):"guid"!==e&&(n[e]=null)})),r.isDestroyed=!0,l&&l.destroy(),l=null,c=null,S=null,u=null,r=null},this.getActiveEditor=function(){return u.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return r.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return r.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return r.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return r.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return r.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return r.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return r.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return r.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return r.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return r.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return r.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return r.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(t){const e=tw(t);return"UndoRedo"===e?this.undoRedo:C.getItem(e)},this.getPluginName=function(t){return t===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:C.getId(t)},this.getInstance=function(){return r},this.addHook=function(t,e,n){lb.getSingleton().add(t,e,r,n)},this.hasHook=function(t){return lb.getSingleton().has(t,r)||lb.getSingleton().has(t)},this.addHookOnce=function(t,e,n){lb.getSingleton().once(t,e,r,n)},this.removeHook=function(t,e){lb.getSingleton().remove(t,e,r)},this.runHooks=function(t,e,n,i,o,s,l){return lb.getSingleton().run(r,t,e,n,i,o,s,l)},this.getTranslatedPhrase=function(t,e){return kk(y.language,t,e)},this.toHTML=()=>NC(this),this.toTableElement=()=>{const t=this.rootDocument.createElement("div");return t.insertAdjacentHTML("afterbegin",NC(this)),t.firstElementChild},this.timeouts=[],this.useTheme=t=>{this.view.getStylesHandler().useTheme(t),this.runHooks("afterSetTheme",t,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(t){let e=t;"function"==typeof e&&(e=setTimeout(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(e)},this._clearTimeouts=function(){Np(this.timeouts,(t=>{clearTimeout(t)}))},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(setImmediate(t))},this._clearImmediates=function(){Np(this.immediates,(t=>{clearImmediate(t)}))},this._getEditorManager=function(){return u},this.isRtl=function(){return"rtl"===r.rootWindow.getComputedStyle(r.rootElement).direction},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1};const _=WO({handleEvent:()=>r.isListening(),beforeKeyDown:t=>this.runHooks("beforeKeyDown",t),afterKeyDown:t=>{this.isDestroyed||r.runHooks("afterDocumentKeyDown",t)},ownerWindow:this.rootWindow});var P;this.addHook("beforeOnCellMouseDown",(t=>{!1===t.ctrlKey&&!1===t.metaKey&&_.releasePressedKeys()})),this.getShortcutManager=function(){return _},this.getFocusManager=function(){return d},JC().forEach((t=>{const e=tS(t);C.addItem(t,new e(this))})),P=r,[TO,EO].forEach((t=>t(P))),_.setActiveContextName("grid"),lb.getSingleton().run(r,"construct")}function YO(t,e,n){t.addEventListener(e,n,!1)}function $O(t,e,n){t.removeEventListener(e,n,!1)}function GO(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function KO(t){const e=a({minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:t=>t.value},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),n=t.body,i=t.createTextNode(""),o=t.createElement("span");let r;function s(){var t,s;i.textContent=e.textContent(r),o.style.position="absolute",o.style.fontSize=GO(r).fontSize,o.style.fontFamily=GO(r).fontFamily,o.style.whiteSpace="pre",n.appendChild(o);const l=parseInt((null===(t=GO(r))||void 0===t?void 0:t.paddingInlineStart)||0,10),a=parseInt((null===(s=GO(r))||void 0===s?void 0:s.paddingInlineEnd)||0,10),h=o.clientWidth+2+l+a;n.removeChild(o);const c=r.style;c.height=`${e.minHeight}px`,e.minWidth>h?c.width=`${e.minWidth}px`:h>e.maxWidth?c.width=`${e.maxWidth}px`:c.width=`${h}px`;const u=r.scrollHeight?r.scrollHeight-1:0;e.minHeight>u?c.height=`${e.minHeight}px`:e.maxHeight<u?(c.height=`${e.maxHeight}px`,c.overflowY="visible"):c.height=`${u}px`}function l(){t.defaultView.setTimeout(s,0)}return{init:function(t,n){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r=t,function(t){if(t&&t.minHeight)if("inherit"===t.minHeight)e.minHeight=r.clientHeight;else{const n=parseInt(t.minHeight,10);isNaN(n)||(e.minHeight=n)}if(t&&t.maxHeight)if("inherit"===t.maxHeight)e.maxHeight=r.clientHeight;else{const n=parseInt(t.maxHeight,10);isNaN(n)||(e.maxHeight=n)}if(t&&t.minWidth)if("inherit"===t.minWidth)e.minWidth=r.clientWidth;else{const n=parseInt(t.minWidth,10);isNaN(n)||(e.minWidth=n)}if(t&&t.maxWidth)if("inherit"===t.maxWidth)e.maxWidth=r.clientWidth;else{const n=parseInt(t.maxWidth,10);isNaN(n)||(e.maxWidth=n)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}(n),"TEXTAREA"===r.nodeName&&(r.style.resize="none",r.style.height=`${e.minHeight}px`,r.style.minWidth=`${e.minWidth}px`,r.style.maxWidth=`${e.maxWidth}px`,r.style.overflowY="hidden"),a&&(YO(r,"input",s),YO(r,"keydown",l)),s()},resize:s,unObserve(){$O(r,"input",s),$O(r,"keydown",l)}}}function XO(t,e){const n=Kw(e),i=e.value.split("\n");let o=n,r=0;for(let s=0;s<i.length;s++){const e=i[s];0!==s&&(r+=i[s-1].length+1);const l=r+e.length;if("home"===t?o=r:"end"===t&&(o=l),n<=l)break}qw(e,o)}function qO(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const ZO="ht_editor_hidden",QO="textEditor";class JO extends CO{static get EDITOR_TYPE(){return"text"}constructor(t){super(t),qO(this,"eventManager",new Sb(this)),qO(this,"autoResize",KO(this.hot.rootDocument)),qO(this,"TEXTAREA",void 0),qO(this,"textareaStyle",void 0),qO(this,"TEXTAREA_PARENT",void 0),qO(this,"textareaParentStyle",void 0),qO(this,"layerClass",void 0),this.eventManager=new Sb(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",(()=>this.destroy()))}getValue(){return this.TEXTAREA.value}setValue(t){this.TEXTAREA.value=t}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),function(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(t,e,n,i,o,r){const s=this.state;if(super.prepare(t,e,n,i,o,r),!r.readOnly){this.refreshDimensions(!0);const{allowInvalid:t}=r;t&&!this.isOpened()&&(this.TEXTAREA.value=""),s===bO.FINISHED||this.isOpened()||this.hideEditableElement()}}beginEditing(t,e){this.state===bO.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(t,e))}focus(){this.TEXTAREA.select(),qw(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:t}=this.hot;this.TEXTAREA=t.createElement("TEXTAREA"),Hw(this.TEXTAREA,[["data-hot-input",""],sw(-1)]),Mw(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),Mw(this.TEXTAREA_PARENT,"handsontableInputHolder"),Tw(this.TEXTAREA_PARENT,this.layerClass)&&xw(this.TEXTAREA_PARENT,this.layerClass),Mw(this.TEXTAREA_PARENT,ZO),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){sy.edge.value&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",xw(this.TEXTAREA_PARENT,this.layerClass),Mw(this.TEXTAREA_PARENT,ZO)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const t=this.TEXTAREA_PARENT.childNodes;let e=!1;VC(t.length-1,(n=>{if(Tw(t[n],"handsontableEditor"))return e=!0,!1})),Tw(this.TEXTAREA_PARENT,ZO)&&xw(this.TEXTAREA_PARENT,ZO),e?(this.layerClass="ht_editor_visible",Mw(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Mw(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==bO.EDITING&&!t)return;if(this.TD=this.getEditedCell(),!this.TD)return void(t||this.close());const{top:e,start:n,width:i,maxWidth:o,height:r,maxHeight:s}=this.getEditedCellRect();this.textareaParentStyle.top=`${e}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(r,s),maxWidth:o,maxHeight:s},!0)}bindEvents(){dy()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(()=>this.finishEditing(!1))),this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>{this.refreshDimensions(),this.state===bO.EDITING&&this.focus()})),this.addHook("afterRowResize",(()=>{this.refreshDimensions(),this.state===bO.EDITING&&this.focus()}))}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),e={runOnlyIf:()=>jp(this.hot.getSelected()),group:QO},n=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};t.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(n(),!1),runOnlyIf:t=>!this.hot.selection.isMultiple()&&!t.altKey},{keys:[["Meta","Enter"]],callback:()=>(n(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(n(),!1)},{keys:[["Home"]],callback:(t,e)=>{let[n]=e;XO(n,this.TEXTAREA)}},{keys:[["End"]],callback:(t,e)=>{let[n]=e;XO(n,this.TEXTAREA)}}],e)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(QO)}}function tA(t,e,n,i,o,r,s){const l=s.ariaTags,a=[],h=[],c=[],u=[];s.className&&Mw(e,s.className),s.readOnly?(a.push(s.readOnlyCellClassName),l&&u.push(["aria-readonly","true"])):l&&c.push("aria-readonly"),!1===s.valid&&s.invalidCellClassName?(a.push(s.invalidCellClassName),l&&u.push(["aria-invalid","true"])):(h.push(s.invalidCellClassName),l&&c.push("aria-invalid")),!1===s.wordWrap&&s.noWordWrapClassName&&a.push(s.noWordWrapClassName),!r&&s.placeholder&&a.push(s.placeholderCellClassName),xw(e,h),Mw(e,a),kw(e,c),Hw(e,u)}tA.RENDERER_TYPE="base";function eA(t,e,n,i,o,r,s){tA.apply(this,[t,e,n,i,o,r,s]);let l=r;if(!l&&s.placeholder&&(l=s.placeholder),l=Wp(l),s.trimWhitespace&&(l=l.trim()),s.rendererTemplate){Ow(e);const i=t.rootDocument.createElement("TEMPLATE");i.setAttribute("bind","{{}}"),i.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(i),i.model=t.getSourceDataAtRow(n),e.appendChild(i)}else Pw(e,l)}eA.RENDERER_TYPE="text";const nA={CELL_TYPE:"text",editor:JO,renderer:eA};function iA(t,e){const n=new UO(t,e||{},RM);return n.init(),n}BI(nA),iA.editors={BaseEditor:CO},iA.Core=function(t){return new UO(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},RM)},iA.DefaultSettings=GI(),iA.hooks=lb.getSingleton(),iA.CellCoords=eR,iA.CellRange=aR,iA.packageName="handsontable",iA.buildDate="16/12/2024 13:19:38",iA.version="15.0.0",iA.languages={dictionaryKeys:bk,getLanguageDictionary:xk,getLanguagesDictionaries:function(){return Tk()},registerLanguageDictionary:Mk,getTranslatedPhrase:kk};var oA=null;function rA(){var t;"undefined"!=typeof console&&(t=console).warn.apply(t,arguments)}function sA(t){return lA(t,"hot-renderer")?(rA("Providing a component-based renderer using `hot-renderer`-annotated component is no longer supported. Pass your component using `renderer` prop of the `HotTable` or `HotColumn` component instead."),!0):!!lA(t,"hot-editor")&&(rA("Providing a component-based editor using `hot-editor`-annotated component is no longer supported. Pass your component using `editor` prop of the `HotTable` or `HotColumn` component instead."),!0)}function lA(t,e){return g.Children.toArray(t).some((function(t){return void 0!==t.props[e]}))}function aA(t,e){if(!t||!e)return null;var n=g.createElement(e,null),i=hA({},!1);return i.className="".concat("hot-wrapper-editor-container"," ").concat(i.className),f.createPortal(g.createElement("div",Object.assign({},i),n),t.body)}function hA(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function cA(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function uA(t,e,n){return e=mA(e),function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,pA()?Reflect.construct(e,n||[],mA(t).constructor):e.apply(t,n))}function dA(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gA(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,bA(i.key),i)}}function fA(t,e,n){return e&&gA(t.prototype,e),n&&gA(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function mA(t){return(mA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pA(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(pA=function(){return!!t})()}function wA(t,e){return(wA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function vA(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,o,r,s,l=[],a=!0,h=!1;try{if(r=(n=n.call(t)).next,0===e);else for(;!(a=(i=r.call(n)).done)&&(l.push(i.value),l.length!==e);a=!0);}catch(c){h=!0,o=c}finally{try{if(!a&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(h)throw o}}return l}}(t,e)||CA(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yA(t){return function(t){if(Array.isArray(t))return cA(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||CA(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bA(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}function CA(t,e){if(t){if("string"==typeof t)return cA(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cA(t,e):void 0}}var SA=function(){return fA((function t(){dA(this,t)}),null,[{key:"getSettings",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.prevProps,o=void 0===i?{}:i,r=n.isInit,s=void 0!==r&&r,l=n.initOnlySettingKeys,a=void 0===l?[]:l,h={};for(var c in t)"children"!==c&&(e=c,s||!a.includes(e)||o[e]!==t[e])&&t.hasOwnProperty(c)&&(h[c]=t[c]);return h}}])}(),RA=d.createContext(void 0),EA=function(t){var e=t.children,n=d.useRef([]),i=d.useCallback((function(t,e){n.current[e]=t}),[]),o=d.useRef(new Map),r=d.useRef(new Map),s=d.useCallback((function(){return r.current.clear()}),[]),l=d.useRef(new Map),a=d.useCallback((function(){return l.current.clear()}),[]),h=d.useRef(new Map),c=d.useCallback((function(t){return function(e,n,i,o,s,a,c){var u="".concat(i,"-").concat(o),d=e.guid,m="".concat(d,"-").concat(u),p="".concat(u,"-").concat(d);if(r.current.has(u)&&(n.innerHTML=r.current.get(u).innerHTML),n&&!n.getAttribute("ghost-table")){for(var w=l.current.get(p),v=h.current.get(m);n.firstChild;)n.removeChild(n.firstChild);if(w&&v)n.appendChild(v);else{var y=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;e||(e=document),oA||(oA=e.createDocumentFragment());var o=null!=i?i:e.createElement("DIV");return oA.appendChild(o),{portal:f.createPortal(t,o,n),portalContainer:o}}(g.createElement(t,{instance:e,TD:n,row:i,col:o,prop:s,value:a,cellProperties:c}),n.ownerDocument,p,v),b=y.portal,C=y.portalContainer;h.current.set(m,C),n.appendChild(C),l.current.set(p,b)}}return r.current.set("".concat(i,"-").concat(o),n),n}}),[]),u=d.useRef((function(){})),m=d.useCallback((function(t){u.current=t}),[]),p=d.useCallback((function(){u.current(yA(l.current.values()))}),[]),w=d.useMemo((function(){return{componentRendererColumns:o.current,columnsSettings:n.current,emitColumnSettings:i,getRendererWrapper:c,clearPortalCache:a,clearRenderedCellCache:s,setRenderersPortalManagerRef:m,pushCellPortalsIntoPortalManager:p}}),[i,c,s,m,p]);return g.createElement(RA.Provider,{value:w},e)};function TA(){return d.useContext(RA)}var MA=d.createContext(void 0),xA=function(t){var e=t.columnIndex,n=t.getOwnerDocument,i=t.children,o=d.useMemo((function(){return{columnIndex:e,getOwnerDocument:n}}),[e,n]);return g.createElement(MA.Provider,{value:o},i)},HA=["close","focus","open"],kA=["getValue","setValue"],IA={open:"onOpen",close:"onClose",prepare:"onPrepare",focus:"onFocus"};function OA(t,e){return function(){function n(i){var o;return dA(this,n),o=uA(this,n,[i]),e.current=o,Object.getOwnPropertyNames(iA.editors.BaseEditor.prototype).forEach((function(e){if("constructor"!==e&&!kA.includes(e)){var i=iA.editors.BaseEditor.prototype[e];n.prototype[e]=function(){for(var n,o,r,s=arguments.length,l=new Array(s),a=0;a<s;a++)l[a]=arguments[a];(HA.includes(e)||(o=i.call.apply(i,[this].concat(l))),IA[e]&&null!==(n=t.current)&&void 0!==n&&n[IA[e]])&&(o=(r=t.current[IA[e]]).call.apply(r,[this].concat(l)));return o}.bind(o)}})),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wA(t,e)}(n,iA.editors.BaseEditor),fA(n,[{key:"focus",value:function(){}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(t){this.value=t}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}()}var AA=d.createContext(void 0),_A=function(t){var e=t.hooksRef,n=t.hotCustomEditorInstanceRef,i=t.children;return g.createElement(AA.Provider,{value:{hooksRef:e,hotCustomEditorInstanceRef:n}},i)},PA=function(t){return t.type===DA},NA=["_columnIndex","_getOwnerDocument","children"],DA=function(t){var e=TA(),n=e.componentRendererColumns,i=e.emitColumnSettings,o=e.getRendererWrapper,r=d.useContext(MA),s=r.columnIndex,l=r.getOwnerDocument,a=d.useRef(null),h=d.useRef(null);d.useEffect((function(){var e,r,l=(e=SA.getSettings(Object.keys(t).filter((function(t){return!NA.includes(t)})).reduce((function(e,n){return e[n]=t[n],e}),{})),t.renderer?(e.renderer=o(t.renderer),n.set(s,!0)):t.hotRenderer&&(e.renderer=t.hotRenderer),t.editor?e.editor=OA(a,h):t.hotEditor&&(e.editor=t.hotEditor),e);i(l,s),sA(t.children)||(r=t.children,g.Children.toArray(r).length&&rA("Unexpected children nodes found in HotColumn component. HotColumn components do not support any children."))}));var c=aA(l(),t.editor);return g.createElement(_A,{hooksRef:a,hotCustomEditorInstanceRef:h},c)},LA=d.forwardRef((function(t,e){var n=vA(d.useState([]),2),i=n[0],o=n[1];return d.useImperativeHandle(e,(function(){return o})),g.createElement(d.Fragment,null,i)}));function VA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var FA,WA,jA,BA,zA={exports:{}};zA.exports=function(){if(BA)return jA;BA=1;var t=WA?FA:(WA=1,FA="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");function e(){}function n(){}return n.resetWarningCache=e,jA=function(){function i(e,n,i,o,r,s){if(s!==t){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function o(){return i}i.isRequired=i;var r={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:o,element:i,elementType:i,instanceOf:o,node:i,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:n,resetWarningCache:e};return r.PropTypes=r,r}}()();var UA=VA(zA.exports),YA=d.forwardRef((function(t,e){var n,i,o,r=d.useRef(null),s=d.useRef(null),l=d.useRef(null),a=d.useRef(null),h=d.useRef(),c=TA(),u=d.useCallback((function(){return r.current&&r.current.isDestroyed?null:r.current}),[r]),f=d.useCallback((function(){return!r.current||r.current.isDestroyed}),[r]),m=d.useCallback((function(){c.clearRenderedCellCache(),c.componentRendererColumns.clear()}),[c]),p=d.useCallback((function(){return"undefined"!=typeof window?s.current?s.current.ownerDocument:document:null}),[s]),w=function(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=f()?[]:(null===(e=u())||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e._initOnlySettings)||[],r=SA.getSettings(t,{prevProps:i,isInit:n,initOnlySettingKeys:o});return r.columns=c.columnsSettings.length?c.columnsSettings:r.columns,t.renderer?(r.renderer=c.getRendererWrapper(t.renderer),c.componentRendererColumns.set("global",!0)):r.renderer=t.hotRenderer||lS("text"),t.editor?r.editor=OA(l,a):r.editor=t.hotEditor||yb("text"),r},v=function(t){var e,n;t&&(null!==(e=t.getPlugin("autoRowSize"))&&void 0!==e&&e.enabled||null!==(n=t.getPlugin("autoColumnSize"))&&void 0!==n&&n.enabled)&&c.componentRendererColumns.size>0&&rA("Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.")};d.useEffect((function(){var e,n,i=w(!0);return h.current=t,r.current=new iA.Core(s.current,i),r.current.addHook("beforeViewRender",(function(){c.clearPortalCache(),c.clearRenderedCellCache()})),r.current.addHook("afterViewRender",(function(){c.pushCellPortalsIntoPortalManager()})),r.current.init(),v(r.current),sA(t.children)||(e=t.children,n=DA,g.Children.toArray(e).some((function(t){return t.type!==n}))&&rA("Unexpected children nodes found in HotTable component. Only HotColumn components are allowed.")),function(){var t;m(),null===(t=u())||void 0===t||t.destroy()}}),[]),n=function(){m();var e=u(),n=w(!1,h.current);h.current=t,null==e||e.updateSettings(n,!1),v(e),sA(t.children)},o=g.useRef(!1),d.useEffect((function(){if(o.current)return n();o.current=!0}),i),d.useImperativeHandle(e,(function(){return{get hotElementRef(){return s.current},get hotInstance(){return u()}}}));var y=d.Children.toArray(t.children).filter(PA).map((function(t,e){return g.createElement(xA,{columnIndex:e,getOwnerDocument:p,key:e},t)})),b=hA(t),C=aA(p(),t.editor);return g.createElement(d.Fragment,null,g.createElement("div",Object.assign({ref:s},b),y),g.createElement(LA,{ref:c.setRenderersPortalManagerRef}),g.createElement(_A,{hooksRef:l,hotCustomEditorInstanceRef:a},C))}));YA.propTypes={style:UA.object,id:UA.string,className:UA.string};var $A=["children"],GA=d.forwardRef((function(t,e){var n,i=t.children,o=function(t,e){if(null==t)return{};var n,i,o=function(t,e){if(null==t)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.includes(i))continue;n[i]=t[i]}return n}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(i=0;i<r.length;i++)n=r[i],e.includes(n)||{}.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}(t,$A),r=null!==(n=o.id)&&void 0!==n?n:d.useId();return g.createElement(EA,null,g.createElement(YA,Object.assign({id:r},o,{ref:e}),i))}));GA.version="15.0.0";const KA="_handsontable-page_fvviw_1",XA="_handsontable-tools_fvviw_7",qA="_handsontable-body_fvviw_13",ZA={languageCode:"zh-CN",[Yx]:"ä¸æ¹æå¥è¡",[$x]:"ä¸æ¹æå¥è¡",[Gx]:"å·¦æ¹æå¥å",[Kx]:"å³æ¹æå¥å",[Xx]:["ç§»é¤è¯¥è¡","ç§»é¤å¤è¡"],[qx]:["ç§»é¤è¯¥å","ç§»é¤å¤å"],[Zx]:"æ¤é",[Qx]:"æ¢å¤",[Jx]:"åªè¯»",[tH]:"æ¸ç©ºè¯¥å",[fH]:"å¯¹é½",[mH]:"å·¦å¯¹é½",[pH]:"æ°´å¹³å±ä¸­",[wH]:"å³å¯¹é½",[vH]:"ä¸¤ç«¯å¯¹é½",[yH]:"é¡¶ç«¯å¯¹é½",[bH]:"åç´å±ä¸­",[CH]:"åºç«¯å¯¹é½",[sH]:"å»ç»è¯¥å",[lH]:"åæ¶å»ç»",[SH]:"è¾¹æ¡",[RH]:"ä¸",[EH]:"å³",[TH]:"ä¸",[MH]:"å·¦",[xH]:"ç§»é¤è¾¹æ¡",[cH]:"æå¥æ¹æ³¨",[uH]:"ç¼è¾æ¹æ³¨",[dH]:"å é¤æ¹æ³¨",[gH]:"åªè¯»æ¹æ³¨",[aH]:"åå¹¶",[hH]:"åæ¶åå¹¶",[eH]:"å¤å¶",[nH]:"å¸¦æ é¢çå¤å¶",[iH]:"å¸¦æ é¢ç»çå¤å¶",[oH]:"ä»å¤å¶æ é¢",[rH]:"åªå",[HH]:"æå¥å­è¡",[kH]:"ä¸æ¯è¡åç¦»",[IH]:["éèè¯¥å","éèå¤å"],[OH]:["æ¾ç¤ºè¯¥å","æ¾ç¤ºå¤å"],[AH]:["éèè¯¥è¡","éèå¤è¡"],[_H]:["æ¾ç¤ºè¯¥è¡","æ¾ç¤ºå¤è¡"],[DH]:"æ ",[LH]:"ä¸ºç©º",[VH]:"ä¸ä¸ºç©º",[FH]:"ç­äº",[WH]:"ä¸ç­äº",[jH]:"å¼å¤´æ¯",[BH]:"ç»å°¾æ¯",[zH]:"åå«",[UH]:"ä¸åå«",[$H]:"å¤§äº",[GH]:"å¤§äºæç­äº",[KH]:"å°äº",[XH]:"å°äºæç­äº",[qH]:"å¨æ­¤èå´",[ZH]:"ä¸å¨æ­¤èå´",[QH]:"ä¹å",[JH]:"ä¹å",[tk]:"ä»å¤©",[ek]:"æå¤©",[nk]:"æ¨å¤©",[lk]:"ç©ºç½ååæ ¼",[ik]:"ææ¡ä»¶è¿æ»¤",[ok]:"æå¼è¿æ»¤",[rk]:"ä¸",[sk]:"æ",[ak]:"å¨é",[hk]:"æ¸é¤",[ck]:"ç¡®è®¤",[uk]:"åæ¶",[dk]:"æç´¢",[gk]:"å¼",[fk]:"ç¬¬äºå¼"},QA="handsontableEditor";
/**
 * @preserve
 * Authors: soakit, HChenZi
 * Last updated: Mar 09, 2023
 *
 * Description: Definition file for Chinese - China language-country.
 */class JA extends JO{static get EDITOR_TYPE(){return"handsontable"}open(){super.open();const t=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),t.width="",t.height="",t.overflow=""),"none"===t.display&&(t.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),qw(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(t,e,n,i,o,r){super.prepare(t,e,n,i,o,r);const s=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(t,e){const n=this.getSourceData(e.row,e.col);void 0!==n&&s.setValue(n),s.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Bv(l,r.handsontable),this.htOptions=l}beginEditing(t,e){const n=this.hot.getSettings().onBeginEditing;n&&!1===n()||super.beginEditing(t,e)}createElements(){super.createElements();const t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}finishEditing(t,e,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const t=this.htEditor.getValue();void 0!==t&&this.setValue(t)}super.finishEditing(t,e,n)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",(()=>{this.htEditor&&this.htEditor.destroy()})),this.hot.addHook("afterSetTheme",((t,e)=>{e||this.htEditor.useTheme(t)}))}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const e={group:QA,relativeToGroup:mO,position:"before"},n=(t,e)=>{const n=this.htEditor;if(void 0!==t&&(t<0||n.flipped&&t>n.countRows()-1?n.deselectCell():n.selectCell(t,0),n.getData().length))return e.preventDefault(),by(e),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:t=>{const e=this.htEditor;let i,o;return!e.getSelectedLast()&&e.flipped?i=e.countRows()-1:e.getSelectedLast()&&(e.flipped?(o=e.getSelectedLast()[0],i=Math.max(0,o-1)):(o=e.getSelectedLast()[0],i=o-1)),n(i,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:t=>{const e=this.htEditor;let i,o;if(e.getSelectedLast()||e.flipped){if(e.getSelectedLast())if(e.flipped)i=e.getSelectedLast()[0]+1;else if(!e.flipped){const t=e.countRows()-1;o=e.getSelectedLast()[0],i=Math.min(t,o+1)}}else i=0;return n(i,t)},preventDefault:!1}],e)}unregisterShortcuts(){super.unregisterShortcuts();this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(QA)}}function t_(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function e_(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n_(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var i_=new WeakMap;class o_ extends JA{constructor(){super(...arguments),e_(this,"query",null),e_(this,"strippedChoices",[]),e_(this,"rawChoices",[]),t_(this,i_,this.hot.guid.slice(0,9)),e_(this,"sortByRelevance",(function(t,e,n){const i=[],o=[],r=t.length;let s,l,a,h,c=e.length;if(0===r){for(a=0;a<c;a++)o.push(a);return o}for(a=0;a<c;a++){if(l=ow(Wp(e[a])),n)h=l.indexOf(t);else{const e=this.cellProperties.locale;h=l.toLocaleLowerCase(e).indexOf(t.toLocaleLowerCase(e))}-1!==h&&(s=l.length-h-r,i.push({baseIndex:a,index:h,charsLeft:s,value:l}))}for(i.sort(((t,e)=>{if(-1===e.index)return-1;if(-1===t.index)return 1;if(t.index<e.index)return-1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return-1;if(t.charsLeft>e.charsLeft)return 1}return 0})),a=0,c=i.length;a<c;a++)o.push(i[a].baseIndex);return o}))}static get EDITOR_TYPE(){return"autocomplete"}getValue(){const t=this.rawChoices.find((t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value));return jp(t)?t:this.TEXTAREA.value}createElements(){super.createElements(),Mw(this.htContainer,"autocompleteEditor"),Mw(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Hw(this.TEXTAREA,[["type","text"],["role","combobox"],aw("listbox"),["aria-autocomplete","list"]])}prepare(t,e,n,i,o,r){var s;super.prepare(t,e,n,i,o,r),this.hot.getSettings().ariaTags&&Hw(this.TEXTAREA,[gw("false"),(s=`${n_(i_,this)}-listbox-${t}-${e}`,["aria-controls",s])])}open(){super.open();const t=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,e=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=null==n?void 0:n.length,{row:o,col:r}=this;var s;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",(t=>this.onBeforeKeyDown(t))),this.htEditor.updateSettings({colWidths:t?[Uw(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,autoRowSize:!0,renderer:(t,o,r,s,l,a,h)=>{eA(t,o,r,s,l,a,h);const{filteringCaseSensitive:c,allowHtml:u,locale:d}=this.cellProperties,g=this.query;let f,m,p=Wp(a);var w;p&&!u&&(f=!0===c?p.indexOf(g):p.toLocaleLowerCase(d).indexOf(g.toLocaleLowerCase(d)),-1!==f&&(m=p.substr(f,g.length),p=p.replace(m,`<strong>${m}</strong>`))),e&&Hw(o,[["role","option"],...n?[(w=i,["aria-setsize",w])]:[],...n?[pw(n.indexOf(a)+1)]:[],["id",`${this.htEditor.rootElement.id}_${r}-${s}`]]),o.innerHTML=p},afterSelectionEnd:(t,n)=>{if(e){const e=this.htEditor.getCell(t,n,!0);Hw(e,[["aria-selected","true"]]),Hw(this.TEXTAREA,...(i=e.id,["aria-activedescendant",i]))}var i}}),e&&(Hw(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,"role","presentation"),Hw(this.htEditor.rootElement,[["role","listbox"],(s="polite",["aria-live",s]),mw("text"),["id",`${n_(i_,this)}-listbox-${o}-${r}`]]),Hw(this.TEXTAREA,...gw("true"))),this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}))}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Hw(this.TEXTAREA,[gw("false")])}discardEditor(t){super.discardEditor(t),this.hot.view.render()}queryChoices(t){const e=this.cellProperties.source;this.query=t,"function"==typeof e?e.call(this.cellProperties,t,(t=>{this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))})):Array.isArray(e)?(this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))):this.updateChoicesList([])}updateChoicesList(t){const e=Kw(this.TEXTAREA),n=(i=this.TEXTAREA).selectionEnd?i.selectionEnd:0;var i;const o=this.cellProperties.sortByRelevance,r=this.cellProperties.filter;let s=null,l=null,a=t;o&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),a,this.cellProperties.filteringCaseSensitive));const h=Array.isArray(s)?s.length:0;if(!1===r)h&&(l=s[0]);else{const t=[];for(let e=0,n=a.length;e<n&&!(o&&h<=e);e++)h?t.push(a[s[e]]):t.push(a[e]);l=0,a=t}this.strippedChoices=a,0===a.length?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Op([a])),a.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(l)),this.hot.listen(),qw(this.TEXTAREA,e,e===n?void 0:n)}flipDropdownIfNeeded(){const t=Bw(this.hot.view._wt.wtTable.TABLE),e=t===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(e||!e&&(n||"horizontal"===n))return!1;const i=Dw(this.TEXTAREA),o=Yw(this.TEXTAREA),r=this.getHeight(),s=t.scrollTop,l=Yw(this.hot.view._wt.wtTable.THEAD),a=Dw(t),h=i.top-a.top-l+s,c=t.scrollHeight-h-l-o,u=r>c&&h>c;return u?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(u?h:c,r),u}limitDropdownIfNeeded(t,e){if(e>t){let n=0,i=0,o=0,r=null;do{o=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),n+=o,i+=1}while(n<t);r=n-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+e-r+"px"),this.setDropdownHeight(n-o)}}flipDropdown(t){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=-t+"px",this.htEditor.flipped=!0}unflipDropdown(){const t=this.htEditor.rootElement.style;t.position="absolute",t.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.htEditor.getSettings().width+Qw(this.hot.rootDocument)}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(t){this.htEditor.updateSettings({height:t})}highlightBestMatchingChoice(t){"number"==typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const t=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),e=parseInt(t.borderTopWidth,10)+parseInt(t.borderBottomWidth,10),n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},((t,e)=>e)).reduce(((t,e)=>t+this.htEditor.getRowHeight(e)),0)+e+1}getWidth(){const t=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),e=parseInt(t.borderInlineStartWidth,10)+parseInt(t.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(t){return this.stripValuesIfNeeded([t])[0]}stripValuesIfNeeded(t){const{allowHtml:e}=this.cellProperties,n=Pp(t,(t=>Wp(t)));return Pp(n,(t=>e?t:ow(t)))}allowKeyEventPropagation(t){const e=this.htEditor.getSelectedRangeLast(),n=e?e.from.row:-1;let i=!1;return t===py.ARROW_DOWN&&n>0&&n<this.htEditor.countRows()-1&&(i=!0),t===py.ARROW_UP&&n>-1&&(i=!0),i}onBeforeKeyDown(t){if(32===(e=t.keyCode)||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90||t.keyCode===py.BACKSPACE||t.keyCode===py.DELETE||t.keyCode===py.INSERT){let e=10;if(t.keyCode===py.C&&(t.ctrlKey||t.metaKey))return;this.isOpened()||(e+=10),this.htEditor&&this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}),e)}var e}}class r_ extends CO{static get EDITOR_TYPE(){return"checkbox"}beginEditing(t,e){if(e&&"mouseup"===e.type&&"TD"===e.target.nodeName){const t=this.TD.querySelector('input[type="checkbox"]');Tw(t,"htBadValue")||t.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}
/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const s_=()=>window,l_=()=>window.document,a_=(t,e)=>window.setTimeout(t,e),h_=function(t,e,n,i){t.addEventListener(e,n,!!i)},c_=function(t,e,n,i){t.removeEventListener(e,n,!!i)},u_=function(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")},d_=function(t,e){u_(t,e)||(t.className=""===t.className?e:t.className+" "+e)},g_=function(t,e){var n;t.className=(n=(" "+t.className+" ").replace(" "+e+" "," ")).trim?n.trim():n.replace(/^\s+|\s+$/g,"")},f_=function(t){return/Array/.test(Object.prototype.toString.call(t))},m_=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},p_=function(t){let e=t.getDay();return 0===e||6===e},w_=function(t){return t%4==0&&t%100!=0||t%400==0},v_=function(t,e){return[31,w_(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},y_=function(t){m_(t)&&t.setHours(0,0,0,0)},b_=function(t,e){return t.getTime()===e.getTime()},C_=function(t,e,n){let i,o;for(i in e)o=void 0!==t[i],o&&"object"==typeof e[i]&&null!==e[i]&&void 0===e[i].nodeName?m_(e[i])?n&&(t[i]=new Date(e[i].getTime())):f_(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=C_({},e[i],n):!n&&o||(t[i]=e[i]);return t},S_=function(t,e,n){let i=l_().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=C_(i,n),t.dispatchEvent(i)},R_=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},E_={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},T_=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},M_=function(t){let e=[],n="false";if(t.isEmpty){if(!t.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled")}return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},x_=function(t,e,n,i,o){let r=new Date(i,n,e),s=t.hasMoment?t.moment(r).isoWeek():function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),i=t.getDay(),o=e,r=o-1,s=function(t){return(t+7-1)%7};t.setDate(n+r-s(i));let l=new Date(t.getFullYear(),0,o),a=(t.getTime()-l.getTime())/864e5;return 1+Math.round((a-r+s(l.getDay()))/7)}(r,o);return'<td class="pika-week">'+s+"</td>"},H_=function(t,e,n,i){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},k_=function(t,e,n,i,o,r){let s,l,a,h,c,u=t._o,d=n===u.minYear,g=n===u.maxYear,f='<div id="'+r+'" class="pika-title" role="heading" aria-live="polite">',m=!0,p=!0;for(a=[],s=0;s<12;s++)a.push('<option value="'+(n===o?s-e:12+s-e)+'"'+(s===i?' selected="selected"':"")+(d&&s<u.minMonth||g&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(h='<div class="pika-label">'+u.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+a.join("")+"</select></div>",f_(u.yearRange)?(s=u.yearRange[0],l=u.yearRange[1]+1):(s=n-u.yearRange,l=1+n+u.yearRange),a=[];s<l&&s<=u.maxYear;s++)s>=u.minYear&&a.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return c='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+a.join("")+"</select></div>",u.showMonthAfterYear?f+=c+h:f+=h+c,d&&(0===i||u.minMonth>=i)&&(m=!1),g&&(11===i||u.maxMonth<=i)&&(p=!1),0===e&&(f+='<button class="pika-prev'+(m?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(f+='<button class="pika-next'+(p?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),f+"</div>"},I_=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+T_(t,e)+'">'+T_(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"}(t)+("<tbody>"+e.join("")+"</tbody></table>")};function O_(t){let e=this,n=e.config(t);e._onMouseDown=function(t){if(!e._v)return;let i=(t=t||s_().event).target||t.srcElement;if(i)if(u_(i,"is-disabled")||(!u_(i,"pika-button")||u_(i,"is-empty")||u_(i.parentNode,"is-disabled")?u_(i,"pika-prev")?e.prevMonth():u_(i,"pika-next")&&e.nextMonth():(e.setDate(new Date(i.getAttribute("data-pika-year"),i.getAttribute("data-pika-month"),i.getAttribute("data-pika-day"))),n.bound&&a_((function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()}),100))),u_(i,"pika-select"))e._c=!0;else{if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}},e._onChange=function(t){let n=(t=t||s_().event).target||t.srcElement;n&&(u_(n,"pika-select-month")?e.gotoMonth(n.value):u_(n,"pika-select-year")&&e.gotoYear(n.value))},e._onKeyChange=function(t){if(t=t||s_().event,e.isVisible())switch(t.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null)}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let t=this.moment(n.field.value,n.format,n.formatStrict);return t&&t.isValid()?t.toDate():null}return new Date(Date.parse(n.field.value))},e._onInputChange=function(t){let n;t.firedBy!==e&&(n=e._parseFieldValue(),m_(n)&&e.setDate(n),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let t=l_().activeElement;do{if(u_(t,"pika-single"))return}while(t=t.parentNode);e._c||(e._b=a_((function(){e.hide()}),50)),e._c=!1},e._onClick=function(t){let i=(t=t||s_().event).target||t.srcElement,o=i;if(i){!hasEventListeners&&u_(i,"pika-select")&&(i.onchange||(i.setAttribute("onchange","return;"),h_(i,"change",e._onChange)));do{if(u_(o,"pika-single")||o===n.trigger)return}while(o=o.parentNode);e._v&&i!==n.trigger&&o!==n.trigger&&e.hide()}},e.el=l_().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),h_(e.el,"mousedown",e._onMouseDown,!0),h_(e.el,"touchend",e._onMouseDown,!0),h_(e.el,"change",e._onChange),n.keyboardInput&&h_(l_(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?l_().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),h_(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let i=n.defaultDate;m_(i)?n.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",h_(n.trigger,"click",e._onInputClick),h_(n.trigger,"focus",e._onInputFocus),h_(n.trigger,"blur",e._onInputBlur)):this.show()}function A_(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}O_.prototype={config:function(t){this._o||(this._o=C_({},E_,!0));let e=C_(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,m_(e.minDate)||(e.minDate=!1),m_(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),f_(e.yearRange)){let t=(new Date).getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||t,e.yearRange[1]=parseInt(e.yearRange[1],10)||t}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||E_.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,m_(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return m_(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",S_(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),!m_(t))return;let n=this._o.minDate,i=this._o.maxDate;m_(n)&&t<n?t=n:m_(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),y_(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),S_(this._o.field,"change",{firedBy:this})),e||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(m_(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=o<n.getTime()||i.getTime()<o}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n,i=this.getDate()||new Date,o=24*parseInt(e)*60*60*1e3;"add"===t?n=new Date(i.valueOf()+o):"subtract"===t&&(n=new Date(i.valueOf()-o)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=R_(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=R_({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(y_(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=E_.minDate,this._o.minYear=E_.minYear,this._o.minMonth=E_.minMonth,this._o.startRange=E_.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(y_(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=E_.maxDate,this._o.maxYear=E_.maxYear,this._o.maxMonth=E_.maxMonth,this._o.endRange=E_.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e,n=this._o,i=n.minYear,o=n.maxYear,r=n.minMonth,s=n.maxMonth,l="";this._y<=i&&(this._y=i,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=o&&(this._y=o,!isNaN(s)&&this._m>s&&(this._m=s));for(let a=0;a<n.numberOfMonths;a++)e="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),l+='<div class="pika-lendar">'+k_(this,a,this.calendars[a].year,this.calendars[a].month,this.calendars[0].year,e)+this.render(this.calendars[a].year,this.calendars[a].month,e)+"</div>";this.el.innerHTML=l,n.bound&&"hidden"!==n.field.type&&a_((function(){n.trigger.focus()}),1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)},adjustPosition:function(){let t,e,n,i,o,r,s,l,a,h,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,i=s_().innerWidth||l_().documentElement.clientWidth,o=s_().innerHeight||l_().documentElement.clientHeight,r=l_().body.scrollTop||l_().documentElement.scrollTop,h=!0,c=!0,a=t.getBoundingClientRect(),s=a.left+s_().pageXOffset,l=a.bottom+s_().pageYOffset,(this._o.reposition&&s+e>i||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,h=!1),(this._o.reposition&&l+n>o+r||this._o.position.indexOf("top")>-1&&l-n-t.offsetHeight>0)&&(l=l-n-t.offsetHeight,c=!1),s<0&&(s=0),l<0&&(l=0),this.el.style.left=s+"px",this.el.style.top=l+"px",d_(this.el,h?"left-aligned":"right-aligned"),d_(this.el,c?"bottom-aligned":"top-aligned"),g_(this.el,h?"right-aligned":"left-aligned"),g_(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let i=this._o,o=new Date,r=v_(t,e),s=new Date(t,e,1).getDay(),l=[],a=[];y_(o),i.firstDay>0&&(s-=i.firstDay,s<0&&(s+=7));let h=0===e?11:e-1,c=11===e?0:e+1,u=0===e?t-1:t,d=11===e?t+1:t,g=v_(u,h),f=r+s,m=f;for(;m>7;)m-=7;f+=7-m;let p=!1;for(let w=0,v=0;w<f;w++){let n=new Date(t,e,w-s+1),f=!!m_(this._d)&&b_(n,this._d),m=b_(n,o),y=-1!==i.events.indexOf(n.toDateString()),b=w<s||w>=r+s,C=w-s+1,S=e,R=t,E=i.startRange&&b_(i.startRange,n),T=i.endRange&&b_(i.endRange,n),M=i.startRange&&i.endRange&&i.startRange<n&&n<i.endRange;b&&(w<s?(C=g+C,S=h,R=u):(C-=r,S=c,R=d));let x={day:C,month:S,year:R,hasEvent:y,isSelected:f,isToday:m,isDisabled:i.minDate&&n<i.minDate||i.maxDate&&n>i.maxDate||i.disableWeekends&&p_(n)||i.disableDayFn&&i.disableDayFn(n),isEmpty:b,isStartRange:E,isEndRange:T,isInRange:M,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&f&&(p=!0),a.push(M_(x)),7==++v&&(i.showWeekNumber&&a.unshift(x_(this,w-s,e,t,i.firstWeekOfYearMinDays)),l.push(H_(a,i.isRTL,i.pickWholeWeek,p)),a=[],v=0,p=!1)}return I_(i,l,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),g_(this.el,"is-hidden"),this._o.bound&&(h_(l_(),"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let t=this._v;!1!==t&&(this._o.bound&&c_(l_(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),d_(this.el,"is-hidden"),this._v=!1,void 0!==t&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),c_(this.el,"mousedown",this._onMouseDown,!0),c_(this.el,"touchend",this._onMouseDown,!0),c_(this.el,"change",this._onChange),t.keyboardInput&&c_(l_(),"keydown",this._onKeyChange),t.field&&(c_(t.field,"change",this._onInputChange),t.bound&&(c_(t.trigger,"click",this._onInputClick),c_(t.trigger,"focus",this._onInputFocus),c_(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};const __="date",P_="dateEditor";class N_ extends JO{constructor(){super(...arguments),A_(this,"defaultDateFormat","DD/MM/YYYY"),A_(this,"parentDestroyed",!1),A_(this,"$datePicker",null)}static get EDITOR_TYPE(){return __}init(){super.init(),this.hot.addHook("afterDestroy",(()=>{this.parentDestroyed=!0,this.destroyElements()})),this.hot.addHook("afterSetTheme",((t,e)=>{e||(xw(this.datePicker,/ht-theme-.*/g),Mw(this.datePicker,t))}))}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Mw(this.datePicker,"htDatepickerHolder");const t=this.hot.getCurrentThemeName();xw(this.datePicker,/ht-theme-.*/g),Mw(this.datePicker,t),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",(t=>{Tw(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()}))}destroyElements(){const t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}prepare(t,e,n,i,o,r){super.prepare(t,e,n,i,o,r)}open(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(t),super.open(),e.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:P_})}close(){var t;this._opened=!1,null!==(t=this.$datePicker)&&void 0!==t&&t.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout((()=>{const t=this.hot._getEditorManager();t.closeEditor(),this.hot.view.render(),t.prepareEditor()}));this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(P_),super.close()}finishEditing(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(t,e)}showDatepicker(t){const e=this.cellProperties.dateFormat||this.defaultDateFormat,n=this.hot.view.isMouseDown(),i=!!t&&vy(t.keyCode);let o;this.datePicker.style.display="block",this.$datePicker=new O_(this.getDatePickerConfig()),"function"==typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(Sd),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,Sd(o,e,!0).isValid()&&this.$datePicker.setMoment(Sd(o,e),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),i||n||this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,Sd(o,e,!0).isValid()&&this.$datePicker.setMoment(Sd(o,e),!0),i||n||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const t=this.TEXTAREA,e={};this.cellProperties&&this.cellProperties.datePickerConfig&&zv(e,this.cellProperties.datePickerConfig);const n=e.onSelect,i=e.onClose;return e.field=t,e.trigger=t,e.container=this.datePicker,e.bound=!1,e.keyboardInput=!1,e.format=e.format||this.defaultDateFormat,e.reposition=e.reposition||!1,e.isRTL=!1,e.onSelect=t=>{let e=t;isNaN(e.getTime())||(e=Sd(e).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(e),n&&n()},e.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},e}refreshDimensions(t){var e;if(super.refreshDimensions(t),this.state!==bO.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.hideDatepicker();const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:r}=null!==(e=o.getParentOverlay(this.TD))&&void 0!==e?e:this.hot.view._wt,s=n.getVisualFromRenderableIndex(r.getFirstPartiallyVisibleRow()),l=n.getVisualFromRenderableIndex(r.getLastPartiallyVisibleRow()),a=i.getVisualFromRenderableIndex(r.getFirstPartiallyVisibleColumn()),h=i.getVisualFromRenderableIndex(r.getLastPartiallyVisibleColumn());if(this.row>=s&&this.row<=l&&this.col>=a&&this.col<=h){const t=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+t.top+Yw(this.TD)}px`;let e=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?e+=t.right-Uw(this.datePicker):e+=t.left,this.datePickerStyle.left=`${e}px`}else this.hideDatepicker()}}class D_ extends o_{static get EDITOR_TYPE(){return"dropdown"}prepare(t,e,n,i,o,r){super.prepare(t,e,n,i,o,r),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}lb.getSingleton().add("beforeValidate",(function(t,e,n){const i=this.propToCol(n);if(Number.isInteger(i)){const t=this.getCellMeta(e,i);t.editor===D_&&void 0===t.strict&&(t.filter=!1,t.strict=!0)}}));class L_ extends JO{static get EDITOR_TYPE(){return"numeric"}}function V_(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class F_ extends JO{constructor(){super(...arguments),V_(this,"autoResize",KO(this.hot.rootDocument,{textContent:t=>"â¢".repeat(t.value.length)}))}static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Ow(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const W_="ht_editor_visible",j_="selectEditor";class B_ extends CO{static get EDITOR_TYPE(){return"select"}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const t=this.hot.rootDocument.createElement("DIV"),e=this.hot.getSettings().ariaTags;t.className="htAutocompleteArrow",e&&t.setAttribute("aria-hidden","true"),t.appendChild(this.hot.rootDocument.createTextNode(String.fromCharCode(9660))),Mw(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(t,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(t){this.select.value=t}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="";this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Tw(this.selectWrapper,W_)&&xw(this.selectWrapper,W_),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>this.refreshDimensions())),this.addHook("afterRowResize",(()=>this.refreshDimensions()))}prepare(t,e,n,i,o,r){super.prepare(t,e,n,i,o,r);const s=this.cellProperties.selectOptions;let l;l="function"==typeof s?this.prepareOptions(s(this.row,this.col,this.prop)):this.prepareOptions(s),Ow(this.select),qv(l,((t,e)=>{const n=this.hot.rootDocument.createElement("OPTION");n.value=e,_w(n,t),this.select.appendChild(n)}))}prepareOptions(t){let e={};if(Array.isArray(t))for(let n=0,i=t.length;n<i;n++)e[t[n]]=t[n];else"object"==typeof t&&(e=t);return e}refreshValue(){const t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){if(this.state!==bO.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:t,start:e,width:n,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${n}px`,o.top=`${t}px`,o[this.hot.isRtl()?"right":"left"]=`${e}px`,o.margin="0px",Mw(this.selectWrapper,W_)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),e={group:j_};this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const t=this.select.selectedIndex-1;t>=0&&(this.select[t].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const t=this.select.selectedIndex+1;t<=this.select.length-1&&(this.select[t].selected=!0)}}],e)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(j_)}}class z_ extends JO{static get EDITOR_TYPE(){return"time"}prepare(t,e,n,i,o,r){super.prepare(t,e,n,i,o,r),this.TEXTAREA.dir="ltr"}}function U_(t,e,n,i,o,r,s){tA.apply(this,[t,e,n,i,o,r,s]),_w(e,null==r?"":r,!1)}U_.RENDERER_TYPE="html";function Y_(t,e,n,i,o,r,s){const{rootDocument:l}=t,a=s.allowHtml?U_:eA,h=l.createElement("DIV"),c=t.getSettings().ariaTags;if(h.className="htAutocompleteArrow",c&&h.setAttribute("aria-hidden","true"),h.appendChild(l.createTextNode(String.fromCharCode(9660))),a.apply(this,[t,e,n,i,o,r,s]),e.firstChild||e.appendChild(l.createTextNode(String.fromCharCode(160))),e.insertBefore(h,e.firstChild),Mw(e,"htAutocomplete"),!t.acArrowListener){const o=new Sb(t);t.acArrowListener=function(o){Tw(o.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,i),e)},o.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",(()=>{o.destroy()}))}}Y_.RENDERER_TYPE="autocomplete";function $_(t,e,n,i,o,r,s){Y_.apply(this,[t,e,n,i,o,r,s])}$_.RENDERER_TYPE="dropdown";const G_=new WeakMap,K_=new WeakMap,X_="data-row",q_="data-col",Z_="checkboxRenderer",Q_="checkbox";function J_(t,e,n,i,o,r,s){const{rootDocument:l}=t,a=t.getSettings().ariaTags;tA.apply(this,[t,e,n,i,o,r,s]),function(t){let e=K_.get(t);if(!e){const{rootElement:n}=t;e=new Sb(t),e.addEventListener(n,"click",(e=>function(t,e){const{target:n}=t;if(!tP(n))return;if(!n.hasAttribute(X_)||!n.hasAttribute(q_))return;const i=parseInt(n.getAttribute(X_),10),o=parseInt(n.getAttribute(q_),10),r=e.getCellMeta(i,o);r.readOnly&&t.preventDefault()}(e,t))),e.addEventListener(n,"mouseup",(e=>function(t,e){const{target:n}=t;if(!tP(n))return;if(!n.hasAttribute(X_)||!n.hasAttribute(q_))return;setTimeout(e.listen,10)}(e,t))),e.addEventListener(n,"change",(e=>function(t,e){const{target:n}=t;if(!tP(n))return;if(!n.hasAttribute(X_)||!n.hasAttribute(q_))return;const i=parseInt(n.getAttribute(X_),10),o=parseInt(n.getAttribute(q_),10),r=e.getCellMeta(i,o);if(!r.readOnly){let n=null;n=t.target.checked?void 0===r.uncheckedTemplate||r.checkedTemplate:void 0!==r.uncheckedTemplate&&r.uncheckedTemplate,e.setDataAtCell(i,o,n)}}(e,t))),K_.set(t,e)}}(t);let h=function(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}(l);const c=s.label;let u=!1;if(void 0===s.checkedTemplate&&(s.checkedTemplate=!0),void 0===s.uncheckedTemplate&&(s.uncheckedTemplate=!1),Ow(e),r===s.checkedTemplate||Wp(r).toLocaleLowerCase(s.locale)===Wp(s.checkedTemplate).toLocaleLowerCase(s.locale)?h.checked=!0:r===s.uncheckedTemplate||Wp(r).toLocaleLowerCase(s.locale)===Wp(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?h.checked=!1:zp(r)?Mw(h,"noValue"):(h.style.display="none",Mw(h,"htBadValue"),u=!0),Hw(h,[[X_,n],[q_,i]]),a&&Hw(h,[lw(h.checked?t.getTranslatedPhrase(pk):t.getTranslatedPhrase(wk)),fw(h.checked),["role","checkbox"]]),!u&&c){let s="";if(c.value)s="function"==typeof c.value?c.value.call(this,n,i,o,r):c.value;else if(c.property){const e=t.getDataAtRowProp(n,c.property);s=null!==e?e:""}const a=function(t,e,n){const i=t.createElement("label");return i.className="htCheckboxRendererLabel "+(n?"fullWidth":""),i.appendChild(t.createTextNode(e)),i.cloneNode(!0)}(l,s,!0!==c.separated);"before"===c.position?c.separated?(e.appendChild(a),e.appendChild(h)):(a.appendChild(h),h=a):c.position&&"after"!==c.position||(c.separated?(e.appendChild(h),e.appendChild(a)):(a.insertBefore(h,a.firstChild),h=a))}function d(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=t.getSelectedRange(),i=[],o=new Map;let r=[],s=0;if(n){for(let l=0;l<n.length;l++){const{row:a,col:h}=n[l].getTopStartCorner(),{row:c,col:u}=n[l].getBottomEndCorner();for(let n=a;n<=c;n+=1)for(let l=h;l<=u;l+=1){const a=t.getCellMeta(n,l);if(a.hidden)continue;const h={checkedTemplate:a.checkedTemplate,uncheckedTemplate:a.uncheckedTemplate};if("checkbox"!==a.type){!0!==e||a.readOnly||(o.has(i.length)?o.set(i.length,[...o.get(i.length),[n,l,null]]):o.set(i.length,[[n,l,null]]));continue}if(!0===a.readOnly)continue;void 0===a.checkedTemplate&&(a.checkedTemplate=!0),void 0===a.uncheckedTemplate&&(a.uncheckedTemplate=!1);const c=t.getDataAtCell(n,l);!1===e?[a.checkedTemplate,a.checkedTemplate.toString()].includes(c)?r.push([n,l,a.uncheckedTemplate,h]):[a.uncheckedTemplate,a.uncheckedTemplate.toString(),null,void 0].includes(c)&&r.push([n,l,a.checkedTemplate,h]):r.push([n,l,a.uncheckedTemplate,h]),s+=1}i.push(s),s=0}r=r.every((t=>{let[,,e]=t;return e===r[0][2]}))?r.map((t=>{let[e,n,i]=t;return[e,n,i]})):r.map((t=>{let[e,n,,i]=t;return[e,n,i.checkedTemplate]})),r.length>0&&i.forEach(((e,n)=>{let i=r.splice(0,e);o.size&&o.has(n)&&(i=[...i,...o.get(n)]),t.setDataAtCell(i)}))}}function g(){const e=t.getSelectedRange();if(e){for(let n=0;n<e.length;n++){const i=e[n].getTopStartCorner(),o=e[n].getBottomEndCorner();for(let e=i.row;e<=o.row;e++)for(let n=i.col;n<=o.col;n++){if(t.getCellMeta(e,n).readOnly)continue;const i=t.getCell(e,n);if(i instanceof HTMLElement){if(i.querySelectorAll("input[type=checkbox]").length>0)return!0}}}return!1}}(!c||c&&!c.separated)&&e.appendChild(h),u&&e.appendChild(l.createTextNode("#bad-value#")),G_.has(t)||(G_.set(t,!0),function(){const e=t.getShortcutManager().getContext("grid"),n={group:Z_,relativeToGroup:mO,position:"before"};e.addShortcuts([{keys:[["space"]],callback:()=>(d(),!g()),runOnlyIf:()=>{var e;return null===(e=t.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isCell()}},{keys:[["enter"]],callback:()=>(d(),!g()),runOnlyIf:()=>{const e=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(null==e?void 0:e.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(d(!0),!g()),runOnlyIf:()=>{var e;return null===(e=t.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isCell()}}],n)}())}function tP(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}lb.getSingleton().add("modifyAutoColumnSizeSeed",(function(t,e,n){const{label:i,type:o,row:r,column:s,prop:l}=e;if(o===Q_){if(i){const{value:e,property:o}=i;let a=n;if(e)a="function"==typeof e?e(r,s,l,n):e;else if(o){const t=this.getDataAtRowProp(r,o);a=null!==t?t:n}t=a}return t}})),J_.RENDERER_TYPE=Q_;function eP(t,e,n,i,o,r,s){Y_.apply(this,[t,e,n,i,o,r,s])}eP.RENDERER_TYPE="handsontable";var nP,iP,oP,rP,sP,lP,aP="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function hP(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function cP(){if(rP)return oP;rP=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(i,o,r,s,l,a,h){if(!isNaN(+i))return+i;let c="",u=i.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(u!==i)return-1*n(u,o,r,s,l,a);for(let e=0;e<t.length;e++){let h=t[e];if(c=i.replace(RegExp(`([0-9 ])(${h.key})$`),"$1"),c!==i)return n(c,o,r,s,l,a)*h.factor}if(c=i.replace("%",""),c!==i)return n(c,o,r,s,l,a)/100;let d=parseFloat(i);if(isNaN(d))return;let g=s(d);if(g&&"."!==g&&(c=i.replace(new RegExp(`${e(g)}$`),""),c!==i))return n(c,o,r,s,l,a);let f={};Object.keys(a).forEach((t=>{f[a[t]]=t}));let m=Object.keys(f).sort().reverse(),p=m.length;for(let t=0;t<p;t++){let e=m[t],h=f[e];if(c=i.replace(e,""),c!==i){let t;switch(h){case"thousand":t=Math.pow(10,3);break;case"million":t=Math.pow(10,6);break;case"billion":t=Math.pow(10,9);break;case"trillion":t=Math.pow(10,12)}return n(c,o,r,s,l,a)*t}}}function i(t,i,o="",r,s,l,a){if(""===t)return;if(t===s)return 0;let h=function(t,n,i){let o=t.replace(i,"");return o=o.replace(new RegExp(`([0-9])${e(n.thousands)}([0-9])`,"g"),"$1$2"),o=o.replace(n.decimal,"."),o}(t,i,o);return n(h,i,o,r,s,l)}return oP={unformat:function(t,e){const n=mP();let o,r=n.currentDelimiters(),s=n.currentCurrency().symbol,l=n.currentOrdinal(),a=n.getZeroFormat(),h=n.currentAbbreviations();if("string"==typeof t)o=function(t,e){if(!t.indexOf(":")||":"===e.thousands)return!1;let n=t.split(":");if(3!==n.length)return!1;let i=+n[0],o=+n[1],r=+n[2];return!isNaN(i)&&!isNaN(o)&&!isNaN(r)}(t,r)?function(t){let e=t.split(":"),n=+e[0],i=+e[1];return+e[2]+60*i+3600*n}(t):i(t,r,s,l,a,h);else{if("number"!=typeof t)return;o=t}if(void 0!==o)return o}}}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function uP(){if(lP)return sP;lP=1;let t=cP();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:(t,e)=>"byte"===e.output,message:"`base` must be provided only when the output is `byte`",mandatory:t=>"byte"===t.output},characteristic:{type:"number",restriction:t=>t>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",lowPrecision:{type:"boolean",restriction:(t,e)=>!0===e.average,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:t=>t>=0,message:"value must be positive"},{restriction:(t,e)=>!e.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:t=>t>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(t,e)=>"percent"===e.output,message:"`prefixSymbol` can be provided only when the output is `percent`"}},i={languageTag:{type:"string",mandatory:!0,restriction:t=>t.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function o(e){return void 0!==t.unformat(e)}function r(t,e,i,o=!1){let s=Object.keys(t).map((i=>{if(!e[i])return!1;let o=t[i],s=e[i];if("string"==typeof s&&(s={type:s}),"format"===s.type){if(!r(o,n,`[Validate ${i}]`,!0))return!1}else if(typeof o!==s.type)return!1;if(s.restrictions&&s.restrictions.length){let e=s.restrictions.length;for(let n=0;n<e;n++){let{restriction:e,message:i}=s.restrictions[n];if(!e(o,t))return!1}}if(s.restriction&&!s.restriction(o,t))return!1;if(s.validValues&&-1===s.validValues.indexOf(o))return!1;if(s.children){if(!r(o,s.children,`[Validate ${i}]`))return!1}return!0}));return o||s.push(...Object.keys(e).map((n=>{let i=e[n];if("string"==typeof i&&(i={type:i}),i.mandatory){let e=i.mandatory;if("function"==typeof e&&(e=e(t)),e&&void 0===t[n])return!1}return!0}))),s.reduce(((t,e)=>t&&e),!0)}function s(t){return r(t,n)}return sP={validate:function(t,e){let n=o(t),i=s(e);return n&&i},validateFormat:s,validateInput:o,validateLanguage:function(t){return r(t,i)}}}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var dP,gP,fP={parseFormat:function(t,e={}){return"string"!=typeof t?t:(function(t,e){if(-1===t.indexOf("$")){if(-1===t.indexOf("%"))return-1!==t.indexOf("bd")?(e.output="byte",void(e.base="general")):-1!==t.indexOf("b")?(e.output="byte",void(e.base="binary")):-1!==t.indexOf("d")?(e.output="byte",void(e.base="decimal")):void(-1===t.indexOf(":")?-1!==t.indexOf("o")&&(e.output="ordinal"):e.output="time");e.output="percent"}else e.output="currency"}(t=function(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}(t=function(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}(t,e),e),e),function(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}(t,e),function(t,e){let n=t.split(".")[0].match(/0+/);n&&(e.characteristic=n[0].length)}(t,e),function(t,e){if(-1!==t.indexOf(".")){let n=t.split(".")[0];e.optionalCharacteristic=-1===n.indexOf("0")}}(t,e),function(t,e){-1!==t.indexOf("a")&&(e.average=!0)}(t,e),function(t,e){-1!==t.indexOf("K")?e.forceAverage="thousand":-1!==t.indexOf("M")?e.forceAverage="million":-1!==t.indexOf("B")?e.forceAverage="billion":-1!==t.indexOf("T")&&(e.forceAverage="trillion")}(t,e),function(t,e){let n=t.split(".")[1];if(n){let t=n.match(/0+/);t&&(e.mantissa=t[0].length)}}(t,e),function(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}(t,e),function(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=-1!==n.indexOf("["))}(t,e),function(t,e){-1!==t.indexOf(",")&&(e.thousandSeparated=!0)}(t,e),function(t,e){-1!==t.indexOf(" ")&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}(t,e),function(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}(t,e),function(t,e){t.match(/^\+/)&&(e.forceSign=!0)}(t,e),e)}};
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function mP(){if(gP)return dP;gP=1;const t=iP?nP:(iP=1,nP={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),e=uP(),n=fP;let i,o={},r={},s=null,l={};function a(t){i=t}function h(){return r[i]}return o.languages=()=>Object.assign({},r),o.currentLanguage=()=>i,o.currentBytes=()=>h().bytes||{},o.currentCurrency=()=>h().currency,o.currentAbbreviations=()=>h().abbreviations,o.currentDelimiters=()=>h().delimiters,o.currentOrdinal=()=>h().ordinal,o.currentDefaults=()=>Object.assign({},h().defaults,l),o.currentOrdinalDefaultFormat=()=>Object.assign({},o.currentDefaults(),h().ordinalFormat),o.currentByteDefaultFormat=()=>Object.assign({},o.currentDefaults(),h().byteFormat),o.currentPercentageDefaultFormat=()=>Object.assign({},o.currentDefaults(),h().percentageFormat),o.currentCurrencyDefaultFormat=()=>Object.assign({},o.currentDefaults(),h().currencyFormat),o.currentTimeDefaultFormat=()=>Object.assign({},o.currentDefaults(),h().timeFormat),o.setDefaults=t=>{t=n.parseFormat(t),e.validateFormat(t)&&(l=t)},o.getZeroFormat=()=>s,o.setZeroFormat=t=>s="string"==typeof t?t:null,o.hasZeroFormat=()=>null!==s,o.languageData=t=>{if(t){if(r[t])return r[t];throw new Error(`Unknown tag "${t}"`)}return h()},o.registerLanguage=(t,n=!1)=>{if(!e.validateLanguage(t))throw new Error("Invalid language data");r[t.languageTag]=t,n&&a(t.languageTag)},o.setLanguage=(e,n=t.languageTag)=>{if(!r[e]){let t=e.split("-")[0],i=Object.keys(r).find((e=>e.split("-")[0]===t));return r[i]?void a(i):void a(n)}a(e)},o.registerLanguage(t),i=t.languageTag,dP=o}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
function pP(t,e){t.forEach((t=>{let n;try{n=function(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}(`../languages/${t}`)}catch(i){}n&&e.registerLanguage(n)}))}var wP,vP={exports:{}};wP=vP,function(t){var e,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,r="[BigNumber Error] ",s=r+"Number primitive has more than 15 significant digits: ",l=1e14,a=14,h=9007199254740991,c=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],u=1e7,d=1e9;function g(t){var e=0|t;return t>0||t===e?e:e-1}function f(t){for(var e,n,i=1,o=t.length,r=t[0]+"";i<o;){for(e=t[i++]+"",n=a-e.length;n--;e="0"+e);r+=e}for(o=r.length;48===r.charCodeAt(--o););return r.slice(0,o+1||1)}function m(t,e){var n,i,o=t.c,r=e.c,s=t.s,l=e.s,a=t.e,h=e.e;if(!s||!l)return null;if(n=o&&!o[0],i=r&&!r[0],n||i)return n?i?0:-l:s;if(s!=l)return s;if(n=s<0,i=a==h,!o||!r)return i?0:!o^n?1:-1;if(!i)return a>h^n?1:-1;for(l=(a=o.length)<(h=r.length)?a:h,s=0;s<l;s++)if(o[s]!=r[s])return o[s]>r[s]^n?1:-1;return a==h?0:a>h^n?1:-1}function p(t,e,n,i){if(t<e||t>n||t!==o(t))throw Error(r+(i||"Argument")+("number"==typeof t?t<e||t>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function w(t){var e=t.c.length-1;return g(t.e/a)==e&&t.c[e]%2!=0}function v(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function y(t,e,n){var i,o;if(e<0){for(o=n+".";++e;o+=n);t=o+t}else if(++e>(i=t.length)){for(o=n,e-=i;--e;o+=n);t+=o}else e<i&&(t=t.slice(0,e)+"."+t.slice(e));return t}e=function t(e){var b,C,S,R,E,T,M,x,H,k,I=U.prototype={constructor:U,toString:null,valueOf:null},O=new U(1),A=20,_=4,P=-7,N=21,D=-1e7,L=1e7,V=!1,F=1,W=0,j={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},B="0123456789abcdefghijklmnopqrstuvwxyz",z=!0;function U(t,e){var i,r,l,c,u,d,g,f,m=this;if(!(m instanceof U))return new U(t,e);if(null==e){if(t&&!0===t._isBigNumber)return m.s=t.s,void(!t.c||t.e>L?m.c=m.e=null:t.e<D?m.c=[m.e=0]:(m.e=t.e,m.c=t.c.slice()));if((d="number"==typeof t)&&0*t==0){if(m.s=1/t<0?(t=-t,-1):1,t===~~t){for(c=0,u=t;u>=10;u/=10,c++);return void(c>L?m.c=m.e=null:(m.e=c,m.c=[t]))}f=String(t)}else{if(!n.test(f=String(t)))return S(m,f,d);m.s=45==f.charCodeAt(0)?(f=f.slice(1),-1):1}(c=f.indexOf("."))>-1&&(f=f.replace(".","")),(u=f.search(/e/i))>0?(c<0&&(c=u),c+=+f.slice(u+1),f=f.substring(0,u)):c<0&&(c=f.length)}else{if(p(e,2,B.length,"Base"),10==e&&z)return K(m=new U(t),A+m.e+1,_);if(f=String(t),d="number"==typeof t){if(0*t!=0)return S(m,f,d,e);if(m.s=1/t<0?(f=f.slice(1),-1):1,U.DEBUG&&f.replace(/^0\.0*|\./,"").length>15)throw Error(s+t)}else m.s=45===f.charCodeAt(0)?(f=f.slice(1),-1):1;for(i=B.slice(0,e),c=u=0,g=f.length;u<g;u++)if(i.indexOf(r=f.charAt(u))<0){if("."==r){if(u>c){c=g;continue}}else if(!l&&(f==f.toUpperCase()&&(f=f.toLowerCase())||f==f.toLowerCase()&&(f=f.toUpperCase()))){l=!0,u=-1,c=0;continue}return S(m,String(t),d,e)}d=!1,(c=(f=C(f,e,10,m.s)).indexOf("."))>-1?f=f.replace(".",""):c=f.length}for(u=0;48===f.charCodeAt(u);u++);for(g=f.length;48===f.charCodeAt(--g););if(f=f.slice(u,++g)){if(g-=u,d&&U.DEBUG&&g>15&&(t>h||t!==o(t)))throw Error(s+m.s*t);if((c=c-u-1)>L)m.c=m.e=null;else if(c<D)m.c=[m.e=0];else{if(m.e=c,m.c=[],u=(c+1)%a,c<0&&(u+=a),u<g){for(u&&m.c.push(+f.slice(0,u)),g-=a;u<g;)m.c.push(+f.slice(u,u+=a));u=a-(f=f.slice(u)).length}else u-=g;for(;u--;f+="0");m.c.push(+f)}}else m.c=[m.e=0]}function Y(t,e,n,i){var o,r,s,l,a;if(null==n?n=_:p(n,0,8),!t.c)return t.toString();if(o=t.c[0],s=t.e,null==e)a=f(t.c),a=1==i||2==i&&(s<=P||s>=N)?v(a,s):y(a,s,"0");else if(r=(t=K(new U(t),e,n)).e,l=(a=f(t.c)).length,1==i||2==i&&(e<=r||r<=P)){for(;l<e;a+="0",l++);a=v(a,r)}else if(e-=s,a=y(a,r,"0"),r+1>l){if(--e>0)for(a+=".";e--;a+="0");}else if((e+=r-l)>0)for(r+1==l&&(a+=".");e--;a+="0");return t.s<0&&o?"-"+a:a}function $(t,e){for(var n,i,o=1,r=new U(t[0]);o<t.length;o++)(!(i=new U(t[o])).s||(n=m(r,i))===e||0===n&&r.s===e)&&(r=i);return r}function G(t,e,n){for(var i=1,o=e.length;!e[--o];e.pop());for(o=e[0];o>=10;o/=10,i++);return(n=i+n*a-1)>L?t.c=t.e=null:n<D?t.c=[t.e=0]:(t.e=n,t.c=e),t}function K(t,e,n,r){var s,h,u,d,g,f,m,p=t.c,w=c;if(p){t:{for(s=1,d=p[0];d>=10;d/=10,s++);if((h=e-s)<0)h+=a,u=e,g=p[f=0],m=o(g/w[s-u-1]%10);else if((f=i((h+1)/a))>=p.length){if(!r)break t;for(;p.length<=f;p.push(0));g=m=0,s=1,u=(h%=a)-a+1}else{for(g=d=p[f],s=1;d>=10;d/=10,s++);m=(u=(h%=a)-a+s)<0?0:o(g/w[s-u-1]%10)}if(r=r||e<0||null!=p[f+1]||(u<0?g:g%w[s-u-1]),r=n<4?(m||r)&&(0==n||n==(t.s<0?3:2)):m>5||5==m&&(4==n||r||6==n&&(h>0?u>0?g/w[s-u]:0:p[f-1])%10&1||n==(t.s<0?8:7)),e<1||!p[0])return p.length=0,r?(e-=t.e+1,p[0]=w[(a-e%a)%a],t.e=-e||0):p[0]=t.e=0,t;if(0==h?(p.length=f,d=1,f--):(p.length=f+1,d=w[a-h],p[f]=u>0?o(g/w[s-u]%w[u])*d:0),r)for(;;){if(0==f){for(h=1,u=p[0];u>=10;u/=10,h++);for(u=p[0]+=d,d=1;u>=10;u/=10,d++);h!=d&&(t.e++,p[0]==l&&(p[0]=1));break}if(p[f]+=d,p[f]!=l)break;p[f--]=0,d=1}for(h=p.length;0===p[--h];p.pop());}t.e>L?t.c=t.e=null:t.e<D&&(t.c=[t.e=0])}return t}function X(t){var e,n=t.e;return null===n?t.toString():(e=f(t.c),e=n<=P||n>=N?v(e,n):y(e,n,"0"),t.s<0?"-"+e:e)}return U.clone=t,U.ROUND_UP=0,U.ROUND_DOWN=1,U.ROUND_CEIL=2,U.ROUND_FLOOR=3,U.ROUND_HALF_UP=4,U.ROUND_HALF_DOWN=5,U.ROUND_HALF_EVEN=6,U.ROUND_HALF_CEIL=7,U.ROUND_HALF_FLOOR=8,U.EUCLID=9,U.config=U.set=function(t){var e,n;if(null!=t){if("object"!=typeof t)throw Error(r+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(p(n=t[e],0,d,e),A=n),t.hasOwnProperty(e="ROUNDING_MODE")&&(p(n=t[e],0,8,e),_=n),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((n=t[e])&&n.pop?(p(n[0],-d,0,e),p(n[1],0,d,e),P=n[0],N=n[1]):(p(n,-d,d,e),P=-(N=n<0?-n:n))),t.hasOwnProperty(e="RANGE"))if((n=t[e])&&n.pop)p(n[0],-d,-1,e),p(n[1],1,d,e),D=n[0],L=n[1];else{if(p(n,-d,d,e),!n)throw Error(r+e+" cannot be zero: "+n);D=-(L=n<0?-n:n)}if(t.hasOwnProperty(e="CRYPTO")){if((n=t[e])!==!!n)throw Error(r+e+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw V=!n,Error(r+"crypto unavailable");V=n}else V=n}if(t.hasOwnProperty(e="MODULO_MODE")&&(p(n=t[e],0,9,e),F=n),t.hasOwnProperty(e="POW_PRECISION")&&(p(n=t[e],0,d,e),W=n),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(n=t[e]))throw Error(r+e+" not an object: "+n);j=n}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(n=t[e])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(r+e+" invalid: "+n);z="0123456789"==n.slice(0,10),B=n}}return{DECIMAL_PLACES:A,ROUNDING_MODE:_,EXPONENTIAL_AT:[P,N],RANGE:[D,L],CRYPTO:V,MODULO_MODE:F,POW_PRECISION:W,FORMAT:j,ALPHABET:B}},U.isBigNumber=function(t){if(!t||!0!==t._isBigNumber)return!1;if(!U.DEBUG)return!0;var e,n,i=t.c,s=t.e,h=t.s;t:if("[object Array]"=={}.toString.call(i)){if((1===h||-1===h)&&s>=-d&&s<=d&&s===o(s)){if(0===i[0]){if(0===s&&1===i.length)return!0;break t}if((e=(s+1)%a)<1&&(e+=a),String(i[0]).length==e){for(e=0;e<i.length;e++)if((n=i[e])<0||n>=l||n!==o(n))break t;if(0!==n)return!0}}}else if(null===i&&null===s&&(null===h||1===h||-1===h))return!0;throw Error(r+"Invalid BigNumber: "+t)},U.maximum=U.max=function(){return $(arguments,-1)},U.minimum=U.min=function(){return $(arguments,1)},U.random=(R=9007199254740992,E=Math.random()*R&2097151?function(){return o(Math.random()*R)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,n,s,l,h,u=0,g=[],f=new U(O);if(null==t?t=A:p(t,0,d),l=i(t/a),V)if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(l*=2));u<l;)(h=131072*e[u]+(e[u+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),e[u]=n[0],e[u+1]=n[1]):(g.push(h%1e14),u+=2);u=l/2}else{if(!crypto.randomBytes)throw V=!1,Error(r+"crypto unavailable");for(e=crypto.randomBytes(l*=7);u<l;)(h=281474976710656*(31&e[u])+1099511627776*e[u+1]+4294967296*e[u+2]+16777216*e[u+3]+(e[u+4]<<16)+(e[u+5]<<8)+e[u+6])>=9e15?crypto.randomBytes(7).copy(e,u):(g.push(h%1e14),u+=7);u=l/7}if(!V)for(;u<l;)(h=E())<9e15&&(g[u++]=h%1e14);for(l=g[--u],t%=a,l&&t&&(h=c[a-t],g[u]=o(l/h)*h);0===g[u];g.pop(),u--);if(u<0)g=[s=0];else{for(s=-1;0===g[0];g.splice(0,1),s-=a);for(u=1,h=g[0];h>=10;h/=10,u++);u<a&&(s-=a-u)}return f.e=s,f.c=g,f}),U.sum=function(){for(var t=1,e=arguments,n=new U(e[0]);t<e.length;)n=n.plus(e[t++]);return n},C=function(){var t="0123456789";function e(t,e,n,i){for(var o,r,s=[0],l=0,a=t.length;l<a;){for(r=s.length;r--;s[r]*=e);for(s[0]+=i.indexOf(t.charAt(l++)),o=0;o<s.length;o++)s[o]>n-1&&(null==s[o+1]&&(s[o+1]=0),s[o+1]+=s[o]/n|0,s[o]%=n)}return s.reverse()}return function(n,i,o,r,s){var l,a,h,c,u,d,g,m,p=n.indexOf("."),w=A,v=_;for(p>=0&&(c=W,W=0,n=n.replace(".",""),d=(m=new U(i)).pow(n.length-p),W=c,m.c=e(y(f(d.c),d.e,"0"),10,o,t),m.e=m.c.length),h=c=(g=e(n,i,o,s?(l=B,t):(l=t,B))).length;0==g[--c];g.pop());if(!g[0])return l.charAt(0);if(p<0?--h:(d.c=g,d.e=h,d.s=r,g=(d=b(d,m,w,v,o)).c,u=d.r,h=d.e),p=g[a=h+w+1],c=o/2,u=u||a<0||null!=g[a+1],u=v<4?(null!=p||u)&&(0==v||v==(d.s<0?3:2)):p>c||p==c&&(4==v||u||6==v&&1&g[a-1]||v==(d.s<0?8:7)),a<1||!g[0])n=u?y(l.charAt(1),-w,l.charAt(0)):l.charAt(0);else{if(g.length=a,u)for(--o;++g[--a]>o;)g[a]=0,a||(++h,g=[1].concat(g));for(c=g.length;!g[--c];);for(p=0,n="";p<=c;n+=l.charAt(g[p++]));n=y(n,h,l.charAt(0))}return n}}(),b=function(){function t(t,e,n){var i,o,r,s,l=0,a=t.length,h=e%u,c=e/u|0;for(t=t.slice();a--;)l=((o=h*(r=t[a]%u)+(i=c*r+(s=t[a]/u|0)*h)%u*u+l)/n|0)+(i/u|0)+c*s,t[a]=o%n;return l&&(t=[l].concat(t)),t}function e(t,e,n,i){var o,r;if(n!=i)r=n>i?1:-1;else for(o=r=0;o<n;o++)if(t[o]!=e[o]){r=t[o]>e[o]?1:-1;break}return r}function n(t,e,n,i){for(var o=0;n--;)t[n]-=o,o=t[n]<e[n]?1:0,t[n]=o*i+t[n]-e[n];for(;!t[0]&&t.length>1;t.splice(0,1));}return function(i,r,s,h,c){var u,d,f,m,p,w,v,y,b,C,S,R,E,T,M,x,H,k=i.s==r.s?1:-1,I=i.c,O=r.c;if(!(I&&I[0]&&O&&O[0]))return new U(i.s&&r.s&&(I?!O||I[0]!=O[0]:O)?I&&0==I[0]||!O?0*k:k/0:NaN);for(b=(y=new U(k)).c=[],k=s+(d=i.e-r.e)+1,c||(c=l,d=g(i.e/a)-g(r.e/a),k=k/a|0),f=0;O[f]==(I[f]||0);f++);if(O[f]>(I[f]||0)&&d--,k<0)b.push(1),m=!0;else{for(T=I.length,x=O.length,f=0,k+=2,(p=o(c/(O[0]+1)))>1&&(O=t(O,p,c),I=t(I,p,c),x=O.length,T=I.length),E=x,S=(C=I.slice(0,x)).length;S<x;C[S++]=0);H=O.slice(),H=[0].concat(H),M=O[0],O[1]>=c/2&&M++;do{if(p=0,(u=e(O,C,x,S))<0){if(R=C[0],x!=S&&(R=R*c+(C[1]||0)),(p=o(R/M))>1)for(p>=c&&(p=c-1),v=(w=t(O,p,c)).length,S=C.length;1==e(w,C,v,S);)p--,n(w,x<v?H:O,v,c),v=w.length,u=1;else 0==p&&(u=p=1),v=(w=O.slice()).length;if(v<S&&(w=[0].concat(w)),n(C,w,S,c),S=C.length,-1==u)for(;e(O,C,x,S)<1;)p++,n(C,x<S?H:O,S,c),S=C.length}else 0===u&&(p++,C=[0]);b[f++]=p,C[0]?C[S++]=I[E]||0:(C=[I[E]],S=1)}while((E++<T||null!=C[0])&&k--);m=null!=C[0],b[0]||b.splice(0,1)}if(c==l){for(f=1,k=b[0];k>=10;k/=10,f++);K(y,s+(y.e=f+d*a-1)+1,h,m)}else y.e=d,y.r=+m;return y}}(),T=/^(-?)0([xbo])(?=\w[\w.]*$)/i,M=/^([^.]+)\.$/,x=/^\.([^.]+)$/,H=/^-?(Infinity|NaN)$/,k=/^\s*\+(?=[\w.])|^\s+|\s+$/g,S=function(t,e,n,i){var o,s=n?e:e.replace(k,"");if(H.test(s))t.s=isNaN(s)?null:s<0?-1:1;else{if(!n&&(s=s.replace(T,(function(t,e,n){return o="x"==(n=n.toLowerCase())?16:"b"==n?2:8,i&&i!=o?t:e})),i&&(o=i,s=s.replace(M,"$1").replace(x,"0.$1")),e!=s))return new U(s,o);if(U.DEBUG)throw Error(r+"Not a"+(i?" base "+i:"")+" number: "+e);t.s=null}t.c=t.e=null},I.absoluteValue=I.abs=function(){var t=new U(this);return t.s<0&&(t.s=1),t},I.comparedTo=function(t,e){return m(this,new U(t,e))},I.decimalPlaces=I.dp=function(t,e){var n,i,o,r=this;if(null!=t)return p(t,0,d),null==e?e=_:p(e,0,8),K(new U(r),t+r.e+1,e);if(!(n=r.c))return null;if(i=((o=n.length-1)-g(this.e/a))*a,o=n[o])for(;o%10==0;o/=10,i--);return i<0&&(i=0),i},I.dividedBy=I.div=function(t,e){return b(this,new U(t,e),A,_)},I.dividedToIntegerBy=I.idiv=function(t,e){return b(this,new U(t,e),0,1)},I.exponentiatedBy=I.pow=function(t,e){var n,s,l,h,c,u,d,g,f=this;if((t=new U(t)).c&&!t.isInteger())throw Error(r+"Exponent not an integer: "+X(t));if(null!=e&&(e=new U(e)),c=t.e>14,!f.c||!f.c[0]||1==f.c[0]&&!f.e&&1==f.c.length||!t.c||!t.c[0])return g=new U(Math.pow(+X(f),c?t.s*(2-w(t)):+X(t))),e?g.mod(e):g;if(u=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new U(NaN);(s=!u&&f.isInteger()&&e.isInteger())&&(f=f.mod(e))}else{if(t.e>9&&(f.e>0||f.e<-1||(0==f.e?f.c[0]>1||c&&f.c[1]>=24e7:f.c[0]<8e13||c&&f.c[0]<=9999975e7)))return h=f.s<0&&w(t)?-0:0,f.e>-1&&(h=1/h),new U(u?1/h:h);W&&(h=i(W/a+2))}for(c?(n=new U(.5),u&&(t.s=1),d=w(t)):d=(l=Math.abs(+X(t)))%2,g=new U(O);;){if(d){if(!(g=g.times(f)).c)break;h?g.c.length>h&&(g.c.length=h):s&&(g=g.mod(e))}if(l){if(0===(l=o(l/2)))break;d=l%2}else if(K(t=t.times(n),t.e+1,1),t.e>14)d=w(t);else{if(0==(l=+X(t)))break;d=l%2}f=f.times(f),h?f.c&&f.c.length>h&&(f.c.length=h):s&&(f=f.mod(e))}return s?g:(u&&(g=O.div(g)),e?g.mod(e):h?K(g,W,_,void 0):g)},I.integerValue=function(t){var e=new U(this);return null==t?t=_:p(t,0,8),K(e,e.e+1,t)},I.isEqualTo=I.eq=function(t,e){return 0===m(this,new U(t,e))},I.isFinite=function(){return!!this.c},I.isGreaterThan=I.gt=function(t,e){return m(this,new U(t,e))>0},I.isGreaterThanOrEqualTo=I.gte=function(t,e){return 1===(e=m(this,new U(t,e)))||0===e},I.isInteger=function(){return!!this.c&&g(this.e/a)>this.c.length-2},I.isLessThan=I.lt=function(t,e){return m(this,new U(t,e))<0},I.isLessThanOrEqualTo=I.lte=function(t,e){return-1===(e=m(this,new U(t,e)))||0===e},I.isNaN=function(){return!this.s},I.isNegative=function(){return this.s<0},I.isPositive=function(){return this.s>0},I.isZero=function(){return!!this.c&&0==this.c[0]},I.minus=function(t,e){var n,i,o,r,s=this,h=s.s;if(e=(t=new U(t,e)).s,!h||!e)return new U(NaN);if(h!=e)return t.s=-e,s.plus(t);var c=s.e/a,u=t.e/a,d=s.c,f=t.c;if(!c||!u){if(!d||!f)return d?(t.s=-e,t):new U(f?s:NaN);if(!d[0]||!f[0])return f[0]?(t.s=-e,t):new U(d[0]?s:3==_?-0:0)}if(c=g(c),u=g(u),d=d.slice(),h=c-u){for((r=h<0)?(h=-h,o=d):(u=c,o=f),o.reverse(),e=h;e--;o.push(0));o.reverse()}else for(i=(r=(h=d.length)<(e=f.length))?h:e,h=e=0;e<i;e++)if(d[e]!=f[e]){r=d[e]<f[e];break}if(r&&(o=d,d=f,f=o,t.s=-t.s),(e=(i=f.length)-(n=d.length))>0)for(;e--;d[n++]=0);for(e=l-1;i>h;){if(d[--i]<f[i]){for(n=i;n&&!d[--n];d[n]=e);--d[n],d[i]+=l}d[i]-=f[i]}for(;0==d[0];d.splice(0,1),--u);return d[0]?G(t,d,u):(t.s=3==_?-1:1,t.c=[t.e=0],t)},I.modulo=I.mod=function(t,e){var n,i,o=this;return t=new U(t,e),!o.c||!t.s||t.c&&!t.c[0]?new U(NaN):!t.c||o.c&&!o.c[0]?new U(o):(9==F?(i=t.s,t.s=1,n=b(o,t,0,3),t.s=i,n.s*=i):n=b(o,t,0,F),(t=o.minus(n.times(t))).c[0]||1!=F||(t.s=o.s),t)},I.multipliedBy=I.times=function(t,e){var n,i,o,r,s,h,c,d,f,m,p,w,v,y,b,C=this,S=C.c,R=(t=new U(t,e)).c;if(!(S&&R&&S[0]&&R[0]))return!C.s||!t.s||S&&!S[0]&&!R||R&&!R[0]&&!S?t.c=t.e=t.s=null:(t.s*=C.s,S&&R?(t.c=[0],t.e=0):t.c=t.e=null),t;for(i=g(C.e/a)+g(t.e/a),t.s*=C.s,(c=S.length)<(m=R.length)&&(v=S,S=R,R=v,o=c,c=m,m=o),o=c+m,v=[];o--;v.push(0));for(y=l,b=u,o=m;--o>=0;){for(n=0,p=R[o]%b,w=R[o]/b|0,r=o+(s=c);r>o;)n=((d=p*(d=S[--s]%b)+(h=w*d+(f=S[s]/b|0)*p)%b*b+v[r]+n)/y|0)+(h/b|0)+w*f,v[r--]=d%y;v[r]=n}return n?++i:v.splice(0,1),G(t,v,i)},I.negated=function(){var t=new U(this);return t.s=-t.s||null,t},I.plus=function(t,e){var n,i=this,o=i.s;if(e=(t=new U(t,e)).s,!o||!e)return new U(NaN);if(o!=e)return t.s=-e,i.minus(t);var r=i.e/a,s=t.e/a,h=i.c,c=t.c;if(!r||!s){if(!h||!c)return new U(o/0);if(!h[0]||!c[0])return c[0]?t:new U(h[0]?i:0*o)}if(r=g(r),s=g(s),h=h.slice(),o=r-s){for(o>0?(s=r,n=c):(o=-o,n=h),n.reverse();o--;n.push(0));n.reverse()}for((o=h.length)-(e=c.length)<0&&(n=c,c=h,h=n,e=o),o=0;e;)o=(h[--e]=h[e]+c[e]+o)/l|0,h[e]=l===h[e]?0:h[e]%l;return o&&(h=[o].concat(h),++s),G(t,h,s)},I.precision=I.sd=function(t,e){var n,i,o,r=this;if(null!=t&&t!==!!t)return p(t,1,d),null==e?e=_:p(e,0,8),K(new U(r),t,e);if(!(n=r.c))return null;if(i=(o=n.length-1)*a+1,o=n[o]){for(;o%10==0;o/=10,i--);for(o=n[0];o>=10;o/=10,i++);}return t&&r.e+1>i&&(i=r.e+1),i},I.shiftedBy=function(t){return p(t,-9007199254740991,h),this.times("1e"+t)},I.squareRoot=I.sqrt=function(){var t,e,n,i,o,r=this,s=r.c,l=r.s,a=r.e,h=A+4,c=new U("0.5");if(1!==l||!s||!s[0])return new U(!l||l<0&&(!s||s[0])?NaN:s?r:1/0);if(0==(l=Math.sqrt(+X(r)))||l==1/0?(((e=f(s)).length+a)%2==0&&(e+="0"),l=Math.sqrt(+e),a=g((a+1)/2)-(a<0||a%2),n=new U(e=l==1/0?"5e"+a:(e=l.toExponential()).slice(0,e.indexOf("e")+1)+a)):n=new U(l+""),n.c[0])for((l=(a=n.e)+h)<3&&(l=0);;)if(o=n,n=c.times(o.plus(b(r,o,h,1))),f(o.c).slice(0,l)===(e=f(n.c)).slice(0,l)){if(n.e<a&&--l,"9999"!=(e=e.slice(l-3,l+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(K(n,n.e+A+2,1),t=!n.times(n).eq(r));break}if(!i&&(K(o,o.e+A+2,0),o.times(o).eq(r))){n=o;break}h+=4,l+=4,i=1}return K(n,n.e+A+1,_,t)},I.toExponential=function(t,e){return null!=t&&(p(t,0,d),t++),Y(this,t,e,1)},I.toFixed=function(t,e){return null!=t&&(p(t,0,d),t=t+this.e+1),Y(this,t,e)},I.toFormat=function(t,e,n){var i,o=this;if(null==n)null!=t&&e&&"object"==typeof e?(n=e,e=null):t&&"object"==typeof t?(n=t,t=e=null):n=j;else if("object"!=typeof n)throw Error(r+"Argument not an object: "+n);if(i=o.toFixed(t,e),o.c){var s,l=i.split("."),a=+n.groupSize,h=+n.secondaryGroupSize,c=n.groupSeparator||"",u=l[0],d=l[1],g=o.s<0,f=g?u.slice(1):u,m=f.length;if(h&&(s=a,a=h,h=s,m-=s),a>0&&m>0){for(s=m%a||a,u=f.substr(0,s);s<m;s+=a)u+=c+f.substr(s,a);h>0&&(u+=c+f.slice(s)),g&&(u="-"+u)}i=d?u+(n.decimalSeparator||"")+((h=+n.fractionGroupSize)?d.replace(new RegExp("\\d{"+h+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):d):u}return(n.prefix||"")+i+(n.suffix||"")},I.toFraction=function(t){var e,n,i,o,s,l,h,u,d,g,m,p,w=this,v=w.c;if(null!=t&&(!(h=new U(t)).isInteger()&&(h.c||1!==h.s)||h.lt(O)))throw Error(r+"Argument "+(h.isInteger()?"out of range: ":"not an integer: ")+X(h));if(!v)return new U(w);for(e=new U(O),d=n=new U(O),i=u=new U(O),p=f(v),s=e.e=p.length-w.e-1,e.c[0]=c[(l=s%a)<0?a+l:l],t=!t||h.comparedTo(e)>0?s>0?e:d:h,l=L,L=1/0,h=new U(p),u.c[0]=0;g=b(h,e,0,1),1!=(o=n.plus(g.times(i))).comparedTo(t);)n=i,i=o,d=u.plus(g.times(o=d)),u=o,e=h.minus(g.times(o=e)),h=o;return o=b(t.minus(n),i,0,1),u=u.plus(o.times(d)),n=n.plus(o.times(i)),u.s=d.s=w.s,m=b(d,i,s*=2,_).minus(w).abs().comparedTo(b(u,n,s,_).minus(w).abs())<1?[d,i]:[u,n],L=l,m},I.toNumber=function(){return+X(this)},I.toPrecision=function(t,e){return null!=t&&p(t,1,d),Y(this,t,e,2)},I.toString=function(t){var e,n=this,i=n.s,o=n.e;return null===o?i?(e="Infinity",i<0&&(e="-"+e)):e="NaN":(null==t?e=o<=P||o>=N?v(f(n.c),o):y(f(n.c),o,"0"):10===t&&z?e=y(f((n=K(new U(n),A+o+1,_)).c),n.e,"0"):(p(t,2,B.length,"Base"),e=C(y(f(n.c),o,"0"),10,t,i,!0)),i<0&&n.c[0]&&(e="-"+e)),e},I.valueOf=I.toJSON=function(){return X(this)},I._isBigNumber=!0,null!=e&&U.set(e),U}(),e.default=e.BigNumber=e,wP.exports?wP.exports=e:(t||(t="undefined"!=typeof self&&self?self:window),t.BigNumber=e)}(aP);var yP=vP.exports;
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const bP=mP(),CP=uP(),SP=fP,RP=yP,EP={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},TP={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:MP,decimalSuffixes:xP}=bP.currentBytes(),HP={general:{scale:1024,suffixes:xP,marker:"bd"},binary:{scale:1024,suffixes:MP,marker:"b"},decimal:{scale:1e3,suffixes:xP,marker:"d"}};function kP(t,e={},n){if("string"==typeof e&&(e=SP.parseFormat(e)),!CP.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",r=function(t,e,n){switch(e.output){case"currency":return function(t,e,n){const i=n.currentCurrency();let o,r=Object.assign({},e),s=Object.assign({},TP,r),l="",a=!!s.totalLength||!!s.forceAverage||s.average,h=r.currencyPosition||i.position,c=r.currencySymbol||i.symbol;const u=void 0!==s.spaceSeparatedCurrency?s.spaceSeparatedCurrency:s.spaceSeparated;void 0===r.lowPrecision&&(r.lowPrecision=!1);u&&(l=" ");"infix"===h&&(o=l+c+l);let d=_P({instance:t,providedFormat:r,state:n,decimalSeparator:o});"prefix"===h&&(d=t._value<0&&"sign"===s.negative?`-${l}${c}${d.slice(1)}`:t._value>0&&s.forceSign?`+${l}${c}${d.slice(1)}`:c+l+d);h&&"postfix"!==h||(l=!s.spaceSeparatedAbbreviation&&a?"":l,d=d+l+c);return d}(t,e=PP(e,bP.currentCurrencyDefaultFormat()),bP);case"percent":return function(t,e,n,i){let o=e.prefixSymbol,r=_P({instance:i(100*t._value),providedFormat:e,state:n}),s=Object.assign({},TP,e);if(o)return`%${s.spaceSeparated?" ":""}${r}`;return`${r}${s.spaceSeparated?" ":""}%`}(t,e=PP(e,bP.currentPercentageDefaultFormat()),bP,n);case"byte":return function(t,e,n,i){let o=e.base||"binary",r=Object.assign({},TP,e);const{binarySuffixes:s,decimalSuffixes:l}=n.currentBytes();let a={general:{scale:1024,suffixes:l||xP,marker:"bd"},binary:{scale:1024,suffixes:s||MP,marker:"b"},decimal:{scale:1e3,suffixes:l||xP,marker:"d"}}[o],{value:h,suffix:c}=IP(t._value,a.suffixes,a.scale),u=_P({instance:i(h),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()});return`${u}${r.spaceSeparated?" ":""}${c}`}(t,e=PP(e,bP.currentByteDefaultFormat()),bP,n);case"time":return e=PP(e,bP.currentTimeDefaultFormat()),function(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-60*e*60)/60),i=Math.round(t._value-60*e*60-60*n);return`${e}:${n<10?"0":""}${n}:${i<10?"0":""}${i}`}(t);case"ordinal":return function(t,e,n){let i=n.currentOrdinal(),o=Object.assign({},TP,e),r=_P({instance:t,providedFormat:e,state:n}),s=i(t._value);return`${r}${o.spaceSeparated?" ":""}${s}`}(t,e=PP(e,bP.currentOrdinalDefaultFormat()),bP);default:return _P({instance:t,providedFormat:e,numbro:n})}}(t,e,n);return r=function(t,e){return e+t}(r,i),r=function(t,e){return t+e}(r,o),r}function IP(t,e,n){let i=e[0],o=Math.abs(t);if(o>=n){for(let r=1;r<e.length;++r){let s=Math.pow(n,r),l=Math.pow(n,r+1);if(o>=s&&o<l){i=e[r],t/=s;break}}i===e[0]&&(t/=Math.pow(n,e.length-1),i=e[e.length-1])}return{value:t,suffix:i}}function OP(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function AP(t,e,n=Math.round){if(-1!==t.toString().indexOf("e"))return function(t,e){let n=t.toString(),[i,o]=n.split("e"),[r,s=""]=i.split(".");if(+o>0)n=r+s+OP(o-s.length);else{let t=".";t=+r<0?`-0${t}`:`0${t}`;let i=(OP(-o-1)+Math.abs(r)+s).substr(0,e);i.length<e&&(i+=OP(e-i.length)),n=t+i}return+o>0&&e>0&&(n+=`.${OP(e)}`),n}(t,e);return new RP(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function _P({instance:t,providedFormat:e,state:n=bP,decimalSeparator:i,defaults:o=n.currentDefaults()}){let r=t._value;if(0===r&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(r))return r.toString();let s=Object.assign({},TP,o,e),l=s.totalLength,a=l?0:s.characteristic,h=s.optionalCharacteristic,c=s.forceAverage,u=s.lowPrecision,d=!!l||!!c||s.average,g=l?-1:d&&void 0===e.mantissa?0:s.mantissa,f=!l&&(void 0===e.optionalMantissa?-1===g:s.optionalMantissa),m=s.trimMantissa,p=s.thousandSeparated,w=s.spaceSeparated,v=s.negative,y=s.forceSign,b=s.exponential,C=s.roundingFunction,S="";if(d){let t=function({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:i,spaceSeparated:o=!1,totalLength:r=0,roundingFunction:s=Math.round}){let l="",a=Math.abs(t),h=-1;if(e&&i[e]&&EP[e]?(l=i[e],t/=EP[e]):a>=EP.trillion||n&&1===s(a/EP.trillion)?(l=i.trillion,t/=EP.trillion):a<EP.trillion&&a>=EP.billion||n&&1===s(a/EP.billion)?(l=i.billion,t/=EP.billion):a<EP.billion&&a>=EP.million||n&&1===s(a/EP.million)?(l=i.million,t/=EP.million):(a<EP.million&&a>=EP.thousand||n&&1===s(a/EP.thousand))&&(l=i.thousand,t/=EP.thousand),l&&(l=(o?" ":"")+l),r){let e=t<0,n=t.toString().split(".")[0],i=e?n.length-1:n.length;h=Math.max(r-i,0)}return{value:t,abbreviation:l,mantissaPrecision:h}}({value:r,forceAverage:c,lowPrecision:u,abbreviations:n.currentAbbreviations(),spaceSeparated:w,roundingFunction:C,totalLength:l});r=t.value,S+=t.abbreviation,l&&(g=t.mantissaPrecision)}if(b){let t=function({value:t,characteristicPrecision:e}){let[n,i]=t.toExponential().split("e"),o=+n;return e?(1<e&&(o*=Math.pow(10,e-1),i=+i-(e-1),i=i>=0?`+${i}`:i),{value:o,abbreviation:`e${i}`}):{value:o,abbreviation:`e${i}`}}({value:r,characteristicPrecision:a});r=t.value,S=t.abbreviation+S}let R=function(t,e,n,i,o,r){if(-1===i)return t;let s=AP(e,i,r),[l,a=""]=s.toString().split(".");if(a.match(/^0+$/)&&(n||o))return l;let h=a.match(/0+$/);return o&&h?`${l}.${a.toString().slice(0,h.index)}`:s.toString()}(r.toString(),r,f,g,m,C);return R=function(t,e,n,i){let o=t,[r,s]=o.toString().split(".");if(r.match(/^-?0$/)&&n)return s?`${r.replace("0","")}.${s}`:r.replace("0","");const l=e<0&&0===r.indexOf("-");if(l&&(r=r.slice(1),o=o.slice(1)),r.length<i){let t=i-r.length;for(let e=0;e<t;e++)o=`0${o}`}return l&&(o=`-${o}`),o.toString()}(R,r,h,a),R=function(t,e,n,i,o){let r=i.currentDelimiters(),s=r.thousands;o=o||r.decimal;let l=r.thousandsSize||3,a=t.toString(),h=a.split(".")[0],c=a.split(".")[1];const u=e<0&&0===h.indexOf("-");if(n){u&&(h=h.slice(1));let t=function(t,e){let n=[],i=0;for(let o=t;o>0;o--)i===e&&(n.unshift(o),i=0),i++;return n}(h.length,l);t.forEach(((t,e)=>{h=h.slice(0,t+e)+s+h.slice(t+e)})),u&&(h=`-${h}`)}return a=c?h+o+c:h,a}(R,r,p,n,i),(d||b)&&(R=function(t,e){return t+e}(R,S)),(y||r<0)&&(R=function(t,e,n){return 0===e?t:0==+t?t.replace("-",""):e>0?`+${t}`:"sign"===n?t:`(${t.replace("-","")})`}(R,r,v)),R}function PP(t,e){if(!t)return e;let n=Object.keys(t);return 1===n.length&&"output"===n[0]?e:t}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
const NP=yP;function DP(t,e,n){let i=new NP(t._value),o=e;return n.isNumbro(e)&&(o=e._value),o=new NP(o),t._value=i.minus(o).toNumber(),t}
/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
const LP=mP(),VP=uP(),FP=(WP=GP,{loadLanguagesInNode:t=>pP(t,WP)});var WP;const jP=cP();let BP=(t=>({format:(...e)=>kP(...e,t),getByteUnit:(...e)=>function(t){let e=HP.general;return IP(t._value,e.suffixes,e.scale).suffix}(...e,t),getBinaryByteUnit:(...e)=>function(t){let e=HP.binary;return IP(t._value,e.suffixes,e.scale).suffix}(...e,t),getDecimalByteUnit:(...e)=>function(t){let e=HP.decimal;return IP(t._value,e.suffixes,e.scale).suffix}(...e,t),formatOrDefault:PP}))(GP),zP=(t=>({add:(e,n)=>function(t,e,n){let i=new NP(t._value),o=e;return n.isNumbro(e)&&(o=e._value),o=new NP(o),t._value=i.plus(o).toNumber(),t}(e,n,t),subtract:(e,n)=>DP(e,n,t),multiply:(e,n)=>function(t,e,n){let i=new NP(t._value),o=e;return n.isNumbro(e)&&(o=e._value),o=new NP(o),t._value=i.times(o).toNumber(),t}(e,n,t),divide:(e,n)=>function(t,e,n){let i=new NP(t._value),o=e;return n.isNumbro(e)&&(o=e._value),o=new NP(o),t._value=i.dividedBy(o).toNumber(),t}(e,n,t),set:(e,n)=>function(t,e,n){let i=e;return n.isNumbro(e)&&(i=e._value),t._value=i,t}(e,n,t),difference:(e,n)=>function(t,e,n){let i=n(t._value);return DP(i,e,n),Math.abs(i._value)}(e,n,t),BigNumber:NP}))(GP);const UP=fP;class YP{constructor(t){this._value=t}clone(){return GP(this._value)}format(t={}){return BP.format(this,t)}formatCurrency(t){return"string"==typeof t&&(t=UP.parseFormat(t)),(t=BP.formatOrDefault(t,LP.currentCurrencyDefaultFormat())).output="currency",BP.format(this,t)}formatTime(t={}){return t.output="time",BP.format(this,t)}binaryByteUnits(){return BP.getBinaryByteUnit(this)}decimalByteUnits(){return BP.getDecimalByteUnit(this)}byteUnits(){return BP.getByteUnit(this)}difference(t){return zP.difference(this,t)}add(t){return zP.add(this,t)}subtract(t){return zP.subtract(this,t)}multiply(t){return zP.multiply(this,t)}divide(t){return zP.divide(this,t)}set(t){return zP.set(this,$P(t))}value(){return this._value}valueOf(){return this._value}}function $P(t){let e=t;return GP.isNumbro(t)?e=t._value:"string"==typeof t?e=GP.unformat(t):isNaN(t)&&(e=NaN),e}function GP(t){return new YP($P(t))}GP.version="2.5.0",GP.isNumbro=function(t){return t instanceof YP},GP.language=LP.currentLanguage,GP.registerLanguage=LP.registerLanguage,GP.setLanguage=LP.setLanguage,GP.languages=LP.languages,GP.languageData=LP.languageData,GP.zeroFormat=LP.setZeroFormat,GP.defaultFormat=LP.currentDefaults,GP.setDefaults=LP.setDefaults,GP.defaultCurrencyFormat=LP.currentCurrencyDefaultFormat,GP.validate=VP.validate,GP.loadLanguagesInNode=FP.loadLanguagesInNode,GP.unformat=jP.unformat,GP.BigNumber=zP.BigNumber;var KP=hP(GP);function XP(t,e){if(LC(t)){const n=e.numericFormat,i=n&&n.culture||"-",o=n&&n.pattern;if(void 0!==i&&!KP.languages()[i]){const t=i.replace("-",""),e=KP.allLanguages?KP.allLanguages[i]:KP[t];e&&KP.registerLanguage(e)}KP.setLanguage(i),t=KP(t).format(o||"0")}return t}function qP(t,e,n,i,o,r,s){let l=r;if(LC(l)){const t=s.className||"",n=t.length?t.split(" "):[];l=XP(l,s),n.indexOf("htLeft")<0&&n.indexOf("htCenter")<0&&n.indexOf("htRight")<0&&n.indexOf("htJustify")<0&&n.push("htRight"),n.indexOf("htNumeric")<0&&n.push("htNumeric"),s.className=n.join(" "),e.dir="ltr"}eA(t,e,n,i,o,l,s)}qP.RENDERER_TYPE="numeric";function ZP(t,e,n,i,o,r,s){eA.apply(this,[t,e,n,i,o,r,s]);const l=s.hashLength||e.innerHTML.length,a=s.hashSymbol||"*";let h="";VC(l-1,(()=>{h+=a})),_w(e,h)}ZP.RENDERER_TYPE="password";function QP(t,e,n,i,o,r,s){eA.apply(this,[t,e,n,i,o,r,s])}QP.RENDERER_TYPE="select";function JP(t,e,n,i,o,r,s){eA.apply(this,[t,e,n,i,o,r,s]),e.dir="ltr"}JP.RENDERER_TYPE="time";function tN(t,e){let n=t;null==n&&(n=""),this.allowEmpty&&""===n?e(!0):this.strict&&this.source?"function"==typeof this.source?this.source(n,eN(n,e)):eN(n,e)(this.source):e(!0)}function eN(t,e){const n=t;return function(t){let i=!1;for(let e=0,o=t.length;e<o;e++)if(n===t[e]){i=!0;break}e(i)}}tN.VALIDATOR_TYPE="autocomplete";function nN(t,e){const n=vb(__,this.instance);let i=t,o=!0;null==i&&(i="");let r=Sd(i,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Sd(new Date(i)).isValid()||r;if(this.allowEmpty&&""===i&&(s=!0,r=!0),s||(o=!1),!s&&r&&(o=!0),s&&!r)if(!0===this.correctFormat){const t=function(t,e){const n=Sd(function(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}(t)),i=Sd(t,e),o=t.search(/[A-z]/g)>-1;let r;r=n.isValid()&&n.format("x")===i.format("x")||!i.isValid()||o?n:i;return r.format(e)}(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,t,"dateValidator"),o=!0}else o=!1;e(o)}nN.VALIDATOR_TYPE="date";function iN(t,e){tN.apply(this,[t,e])}iN.VALIDATOR_TYPE="dropdown";function oN(t,e){let n=t;null==n&&(n=""),this.allowEmpty&&""===n?e(!0):e(""!==n&&LC(t))}oN.VALIDATOR_TYPE="numeric";const rN=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function sN(t,e){const n=this.timeFormat||"h:mm:ss a";let i=!0,o=t;null===o&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;const r=/^\d{1,2}$/.test(o);r&&(o+=":00");const s=Sd(o,rN,!0).isValid()?Sd(o):Sd(o,n);let l=s.isValid(),a=Sd(o,n,!0).isValid()&&!r;if(this.allowEmpty&&""===o&&(l=!0,a=!0),l||(i=!1),!l&&a&&(i=!0),l&&!a)if(!0===this.correctFormat){const t=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,t,"timeValidator"),i=!0}else i=!1;e(i)}sN.VALIDATOR_TYPE="time";const lN={CELL_TYPE:"autocomplete",editor:o_,renderer:Y_,validator:tN},aN={CELL_TYPE:"checkbox",editor:r_,renderer:J_};function hN(t,e,n,i,o,r,s){Y_.apply(this,[t,e,n,i,o,r,s])}hN.RENDERER_TYPE="date";const cN={CELL_TYPE:"date",editor:N_,renderer:hN,validator:nN},uN={CELL_TYPE:"dropdown",editor:D_,renderer:$_,validator:iN},dN={CELL_TYPE:"handsontable",editor:JA,renderer:eP},gN={CELL_TYPE:"numeric",editor:L_,renderer:qP,validator:oN,dataType:"number"},fN={CELL_TYPE:"password",editor:F_,renderer:ZP,copyable:!1},mN={CELL_TYPE:"select",editor:B_,renderer:QP},pN={CELL_TYPE:"time",editor:z_,renderer:JP,validator:sN};function wN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vN(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yN(t,e){return t.get(bN(t,e))}function bN(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const CN=new Map([["plugin",function(t){return!!tS(t)}],["cell-type",FI],["editor",fb],["renderer",oS],["validator",uS]]),SN=Symbol("mainSetting"),RN=[];let EN=null;var TN=new WeakMap,MN=new WeakSet;class xN{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(t){var e,n;wN(e=this,n=MN),n.add(e),vN(this,"eventManager",new Sb(this)),vN(this,"pluginName",null),vN(this,"pluginsInitializedCallbacks",[]),vN(this,"isPluginsReady",!1),vN(this,"enabled",!1),vN(this,"initialized",!1),function(t,e,n){wN(t,e),e.set(t,n)}(this,TN,{}),Xv(this,"hot",t,{writable:!1}),EN=null,this.hot.addHook("afterPluginsInitialized",(()=>this.onAfterPluginsInitialized())),this.hot.addHook("afterUpdateSettings",(t=>this.onUpdateSettings(t))),this.hot.addHook("beforeInit",(()=>this.init()))}init(){this.pluginName=this.hot.getPluginName(this);const t=this.constructor.PLUGIN_DEPS,e=Array.isArray(t)?t:[];if(e.length>0){const t=[];if(e.forEach((e=>{const[n,i]=e.split(":");if(!CN.has(n))throw new Error(`Unknown plugin dependency type "${n}" was found.`);CN.get(n)(i)||t.push(` - ${i} (${n})`)})),t.length>0){const e=[`The ${this.pluginName} plugin requires the following modules:\n`,`${t.join("\n")}\n`].join("");RN.push(e)}}EN||(EN=JC()),EN.indexOf("UndoRedo")>=0&&EN.splice(EN.indexOf("UndoRedo"),1),EN.indexOf(this.pluginName)>=0&&EN.splice(EN.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}));if(0===EN.length){if(RN.length>0){const t=[`${RN.join("\n")}\n`,"You have to import and register them manually."].join("");throw RN.length=0,new Error(t)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var t;null===(t=this.eventManager)||void 0===t||t.clear(),this.clearHooks(),this.enabled=!1}getSetting(t){const e=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(void 0===t)return e;const n=this.constructor.DEFAULT_SETTINGS;var i,o;return(Array.isArray(e)||Kv(e))&&n[SN]===t?Array.isArray(e)?e:null!==(i=e[t])&&void 0!==i?i:n[t]:Kv(e)&&null!==(o=e[t])&&void 0!==o?o:n[t]}addHook(t,e,n){yN(TN,this)[t]=yN(TN,this)[t]||[];const i=yN(TN,this)[t];this.hot.addHook(t,e,n),i.push(e),yN(TN,this)[t]=i}removeHooks(t){Np(yN(TN,this)[t]||[],(e=>{this.hot.removeHook(t,e)}))}clearHooks(){const t=yN(TN,this);qv(t,((t,e)=>this.removeHooks(e))),t.length=0}callOnPluginsReady(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}onAfterPluginsInitialized(){Np(this.pluginsInitializedCallbacks,(t=>t())),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(t){const e=bN(MN,this,HN).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}updatePlugin(){}destroy(){var t;null===(t=this.eventManager)||void 0===t||t.destroy(),this.clearHooks(),qv(this,((t,e)=>{"hot"!==e&&(this[e]=null)})),delete this.t,delete this.hot}}function HN(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if("boolean"==typeof e)return e;for(let n=0;n<e.length;n++)if(void 0!==t[e[n]])return!0;return!1}function kN(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const IN=class{constructor(t){kN(this,"hot",null),kN(this,"container",null),kN(this,"injected",!1),kN(this,"rows",[]),kN(this,"columns",[]),kN(this,"samples",null),kN(this,"settings",{useHeaders:!0}),this.hot=t}addRow(t,e){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:t};this.rows.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(t)),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(t){const e=this.hot.getColHeader(0);if(null!=e){const e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}addColumn(t,e){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:t};this.columns.push(n),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(t){this.injected||this.injectTable(),Np(this.rows,(e=>{const{height:n}=e.table.getBoundingClientRect();t(e.row,Math.ceil(n))}))}getWidths(t){this.injected||this.injectTable(),Np(this.columns,(e=>{const{width:n}=e.table.getBoundingClientRect();t(e.col,Math.ceil(n))}))}setSettings(t){this.settings=t}setSetting(t,e){this.settings||(this.settings={}),this.settings[t]=e}getSettings(){return this.settings}getSetting(t){return this.settings?this.settings[t]:null}createColGroupsCol(t){const e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1,-1)),this.samples.forEach((n=>{Np(n.strings,(n=>{e.appendChild(this.createColElement(n.col,t))}))})),e}createRow(t){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),i=e.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,i),n.appendChild(i)),this.samples.forEach((i=>{Np(i.strings,(i=>{const o=i.col,r=this.hot.getCellMeta(t,o),s=this.hot.getCellRenderer(r),l=e.createElement("td");l.setAttribute("ghost-table",1),s(this.hot,l,t,o,this.hot.colToProp(o),i.value,r),n.appendChild(l)}))})),n}appendColumnHeadersRow(){const{rootDocument:t}=this.hot,e=t.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=t.createElement("th");n.push([-1,i]),e.appendChild(i)}this.samples.forEach((i=>{Np(i.strings,(i=>{const o=i.col,r=t.createElement("th");n.push([o,r]),e.appendChild(r)}))})),this.table.tHead.appendChild(e),Np(n,(t=>{const[e,n]=t;this.hot.view.appendColHeader(e,n)}))}createCol(t){const{rootDocument:e}=this.hot,n=e.createDocumentFragment();return this.samples.forEach((i=>{Np(i.strings,(i=>{const o=i.row,r=this.hot.getCellMeta(o,t),s=this.hot.getCellRenderer(r),l=e.createElement("td"),a=e.createElement("tr");l.setAttribute("ghost-table",1),s(this.hot,l,o,t,this.hot.colToProp(t),i.value,r),a.appendChild(l),n.appendChild(a)}))})),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(t,e){const n=this.hot.rootDocument.createElement("col");let i=0;e>=0&&t>=0&&(i=this.hot.getCellMeta(e,t).colspan);let o=this.hot.getColWidth(t);if(i>1)for(let r=t+1;r<t+i;r++)o+=this.hot.getColWidth(r);return n.style.width=`${o}px`,n}createTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),i=e.createElement("table"),o=e.createElement("thead"),r=e.createElement("tbody"),s=e.createElement("colgroup"),l=e.createElement("tr"),a=e.createElement("th");return this.isVertical()&&i.appendChild(s),this.isHorizontal()&&(l.appendChild(a),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&r.appendChild(l),i.appendChild(r),Mw(i,t),n.appendChild(i),{fragment:n,table:i,tHead:o,tBody:r,colGroup:s,tr:l,th:a}}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),i=e.createElement("div");return Mw(i,`htGhostTable htAutoSize ${t.trim()}`),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}};function ON(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class AN{static get SAMPLE_COUNT(){return 3}constructor(t){ON(this,"samples",null),ON(this,"dataFactory",null),ON(this,"customSampleCount",null),ON(this,"allowDuplicates",!1),this.dataFactory=t}getSampleCount(){return this.customSampleCount?this.customSampleCount:AN.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,e){return this.generateSamples("row",e,t)}generateColumnSamples(t,e){return this.generateSamples("col",e,t)}generateSamples(t,e,n){const i=new Map,{from:o,to:r}="number"==typeof n?{from:n,to:n}:n;return VC(o,r,(n=>{const o=this.generateSample(t,e,n);i.set(n,o)})),i}generateSample(t,e,n){if("row"!==t&&"col"!==t)throw new Error("Unsupported sample type");const i=new Map,o="row"===t?"col":"row",r=[];return VC(e.from,e.to,(e=>{const s="row"===t?this.dataFactory(n,e):this.dataFactory(e,n);if(!1===s)return;const{value:l,bundleSeed:a}=s,h="string"==typeof a&&a.length>0;let c;c=h?a:Kv(l)?`${Object.keys(l).length}`:Array.isArray(l)?`${l.length}`:`${Wp(l).length}`,i.has(c)||i.set(c,{needed:this.getSampleCount(),strings:[]});const u=i.get(c);if(u.needed){(!(r.indexOf(l)>-1)||this.allowDuplicates||h)&&(u.strings.push({value:l,[o]:e}),r.push(l),u.needed-=1)}})),i}}const _N=AN;function PN(t,e,n){NN(t,e),e.set(t,n)}function NN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DN(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LN(t,e){return t.get(FN(t,e))}function VN(t,e,n){return t.set(FN(t,e),n),n}function FN(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}lb.getSingleton().register("modifyAutoColumnSizeSeed");const WN="autoColumnSize";var jN=new WeakMap,BN=new WeakMap,zN=new WeakSet;class UN extends xN{static get PLUGIN_KEY(){return WN}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){var e,n;super(t),NN(e=this,n=zN),n.add(e),DN(this,"ghostTable",new IN(this.hot)),DN(this,"samplesGenerator",new _N(((t,e)=>{const n=this.hot.toPhysicalRow(t),i=this.hot.toPhysicalColumn(e);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(i))return!1;const o=this.hot.getCellMeta(t,e);let r="";o.spanned||(r=this.hot.getDataAtCell(t,e));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,o,r)),{value:r,bundleSeed:s}}))),DN(this,"inProgress",!1),DN(this,"measuredColumns",0),DN(this,"columnWidthsMap",new rx),PN(this,jN,[]),PN(this,BN,[]),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",((t,e,n)=>FN(zN,this,XN).call(this,t,e,n)))}isEnabled(){return!1!==this.hot.getSettings()[WN]&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const e=this.getSetting("samplingRatio");e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return FN(zN,t,GN).call(t,...n)})),this.addHook("beforeChangeRender",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return FN(zN,t,KN).call(t,...n)})),this.addHook("afterFormulasValuesUpdate",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return FN(zN,t,ZN).call(t,...n)})),this.addHook("beforeRender",(()=>FN(zN,this,$N).call(this))),this.addHook("modifyColWidth",((t,e)=>this.getColumnWidth(e,t))),this.addHook("init",(()=>FN(zN,this,qN).call(this))),super.enablePlugin()}updatePlugin(){VN(BN,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",((t,e,n)=>FN(zN,this,XN).call(this,t,e,n)))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const t=this.getFirstVisibleColumn(),e=this.getLastVisibleColumn();if(-1===t||-1===e)return;const n=this.hot.renderCall;this.calculateColumnsWidth({from:t,to:e},void 0,n)}calculateColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i="number"==typeof t?{from:t,to:t}:t,o="number"==typeof e?{from:e,to:e}:e;VC(i.from,i.to,(t=>{let e=this.hot.toPhysicalColumn(t);if(null===e&&(e=t),n||null===this.columnWidthsMap.getValueAtIndex(e)&&!this.hot._getColWidthFromSettings(e)){this.samplesGenerator.generateColumnSamples(t,o).forEach(((t,e)=>this.ghostTable.addColumn(e,t)))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)}))}),!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const r=()=>{if(!this.hot)return ny(o),void(this.inProgress=!1);this.calculateColumnsWidth({from:n,to:Math.min(n+UN.CALCULATION_STEP,i)},t,e),n=n+UN.CALCULATION_STEP+1,n<i?o=ey(r):(ny(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateColumnsWidth({from:0,to:s},t,e),n=s+1),n<i?r():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const t=this.hot.getSettings()[WN];let e=UN.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return Kv(t)&&(e=t.syncLimit,nw(e)?e=WC(n,e):e>>=0),Math.min(e,n)}getColumnWidth(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e;return void 0===i&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),n&&"number"==typeof i&&(i=Math.max(i,US))),i}getFirstVisibleColumn(){var t;return null!==(t=this.hot.getFirstRenderedVisibleColumn())&&void 0!==t?t:-1}getLastVisibleColumn(){var t;return null!==(t=this.hot.getLastRenderedVisibleColumn())&&void 0!==t?t:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce(((t,e,n)=>{const i=LN(jN,this).length;return(i-1<n||LN(jN,this)[n]!==e)&&t.push(this.hot.toVisualColumn(n)),i-1<n?LN(jN,this).push(e):LN(jN,this)[n]=e,t}),[])}clearCache(t){Array.isArray(t)?this.hot.batchExecution((()=>{t.forEach((t=>{this.columnWidthsMap.setValueAtIndex(t,null)}))}),!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter((t=>null===t)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function YN(t){const e={from:0,to:this.hot.countRows()-1};t.forEach((t=>{const n=this.hot.toPhysicalColumn(t);if(null!==n&&!this.hot._getColWidthFromSettings(n)){this.samplesGenerator.generateColumnSamples(t,e).forEach(((t,e)=>this.ghostTable.addColumn(e,t)))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)}))}),!0),this.ghostTable.clean())}function $N(){this.calculateVisibleColumnsWidth(),this.inProgress||(FN(zN,this,YN).call(this,LN(BN,this)),VN(BN,this,[]))}function GN(t,e){e||this.recalculateAllColumnsWidth()}function KN(t){const e=t.reduce(((t,e)=>{let[,n]=e;const i=this.hot.propToCol(n);return Number.isInteger(i)&&-1===t.indexOf(i)&&t.push(i),t}),[]);LN(BN,this).push(...e)}function XN(t,e,n){let i=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function qN(){VN(jN,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function ZN(t){const e=t.reduce(((t,e)=>{var n;const i=null===(n=e.address)||void 0===n?void 0:n.col;if(Number.isInteger(i)){const e=this.hot.toVisualColumn(i);-1===t.indexOf(e)&&t.push(e)}return t}),[]);LN(BN,this).push(...e)}const QN={horizontal:"horizontal",vertical:"vertical"};function JN(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function tD(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eD(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}lb.getSingleton().register("modifyAutofillRange"),lb.getSingleton().register("beforeAutofill"),lb.getSingleton().register("afterAutofill");const nD="autofill",iD=["fillHandle"];var oD=new WeakSet;class rD extends xN{constructor(){super(...arguments),JN(this,oD),tD(this,"addingStarted",!1),tD(this,"mouseDownOnCellCorner",!1),tD(this,"mouseDragOutside",!1),tD(this,"handleDraggedCells",0),tD(this,"directions",[]),tD(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return nD}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[nD,...iD]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(t=>eD(oD,this,lD).call(this,t))),this.addHook("afterOnCellCornerDblClick",(t=>eD(oD,this,sD).call(this,t))),this.addHook("beforeOnCellMouseOver",((t,e)=>eD(oD,this,aD).call(this,e))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const t=this.hot.getSelectedRangeLast(),{row:e,col:n}=t.getTopStartCorner(),{row:i,col:o}=t.getBottomEndCorner(),r=this.hot.runHooks("modifyCopyableRange",[{startRow:e,startCol:n,endRow:i,endCol:o}]),s=[],l=[],a=[];return Np(r,(t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===s.indexOf(e)&&s.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===l.indexOf(e)&&l.push(e)})),Np(s,(t=>{const e=[];Np(l,(n=>{e.push(this.hot.getCopyableData(t,n))})),a.push(e)})),a}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[t,e,n,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),r=o.getTopStartCorner(),s=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[r.row,r.col,s.row,s.col],a=this.hot.runHooks("modifyAutofillRange",[Math.min(r.row,t),Math.min(r.col,e),Math.max(s.row,n),Math.max(s.col,i)],l),{directionOfDrag:h,startOfDragCoords:c,endOfDragCoords:u}=function(t,e,n){let i,o,r;return e[0]===t[0]&&e[1]<t[1]?(r="left",i=n(e[0],e[1]),o=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(r="right",i=n(e[0],t[3]+1),o=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(r="up",i=n(e[0],e[1]),o=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(r="down",i=n(t[2]+1,e[1]),o=n(e[2],e[3])),i&&i.normalize(),o&&o.normalize(),{directionOfDrag:r,startOfDragCoords:i,endOfDragCoords:o}}(l,a,((t,e)=>this.hot._createCellCoords(t,e)));if(c&&c.row>-1&&c.col>-1){const t=this.getSelectionData(),e=o.clone(),n=this.hot._createCellRange(c,c,u),i=this.hot.runHooks("beforeAutofill",t,e,n,h);if(!1===i)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let r=i;const s=i;if(["up","left"].indexOf(h)>-1&&(1!==s.length||0!==s[0].length))if(r=[],"up"===h){const t=u.row-c.row+1,e=t%s.length;for(let n=0;n<t;n++)r.push(s[(n+(s.length-e))%s.length])}else{const t=u.col-c.col+1,e=t%s[0].length;for(let n=0;n<s.length;n++){r.push([]);for(let i=0;i<t;i++)r[n].push(s[n][(i+(s[n].length-e))%s[n].length])}}this.hot.populateFromArray(c.row,c.col,r,u.row,u.col,`${this.pluginName}.fill`,null),this.setSelection(a),this.hot.runHooks("afterAutofill",r,e,n,h),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}getCoordsOfDragAndDropBorders(t){const e=this.hot.getSelectedRangeLast(),n=e.getBottomEndCorner();let i=t;if(this.directions.includes(QN.vertical)&&this.directions.includes(QN.horizontal)){const o=e.getTopStartCorner();(n.col<=t.col||o.col>=t.col)&&(i=this.hot._createCellCoords(n.row,t.col)),(n.row<t.row||o.row>t.row)&&(i=this.hot._createCellCoords(t.row,n.col))}else if(this.directions.includes(QN.vertical))i=this.hot._createCellCoords(t.row,n.col);else{if(!this.directions.includes(QN.horizontal))return;i=this.hot._createCellCoords(n.row,t.col)}return this.reduceSelectionAreaIfNeeded(i)}showBorder(t){const e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout((()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1}),200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();t[2]<n-1&&e[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(t){const e=this.hot.getData(),n=this.hot.countRows();let i;for(let o=t[2]+1;o<n;o++){for(let i=t[1];i<=t[3];i++){if(!zp(e[o][i]))return-1}const n=e[o][t[1]-1],r=e[o][t[3]+1];zp(n)&&zp(r)||(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}setSelection(t){this.hot.selectCell(...Pp(t,(t=>Math.max(t,0))),!1,!1)}selectAdjacent(){const t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return-1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(t){const{documentElement:e}=this.hot.rootDocument,n=Dw(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+Yw(this.hot.table),i=Dw(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+Uw(this.hot.table);return t.clientY>n&&t.clientX<=i}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseup",(()=>eD(oD,this,hD).call(this))),this.eventManager.addEventListener(t,"mousemove",(t=>eD(oD,this,cD).call(this,t)))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const t=function(t){const e={};return!0===t?(e.directions=Object.keys(QN),e.autoInsertRow=!0):Kv(t)?(jp(t.autoInsertRow)?t.direction===QN.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,jp(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(QN)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}destroy(){super.destroy()}}function sD(){this.selectAdjacent()&&this.fillIn()}function lD(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function aD(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function hD(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function cD(t){const e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function uD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dD(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gD(t,e){return t.get(fD(t,e))}function fD(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mD="autoRowSize";var pD=new WeakMap,wD=new WeakSet;class vD extends xN{static get PLUGIN_KEY(){return mD}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(t){var e,n;super(t),uD(e=this,n=wD),n.add(e),dD(this,"headerHeight",null),dD(this,"ghostTable",new IN(this.hot)),dD(this,"samplesGenerator",new _N(((t,e)=>{const n=this.hot.toPhysicalRow(t),i=this.hot.toPhysicalColumn(e);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(i))return!1;if(t>=0&&e>=0){if(this.hot.getCellMeta(t,e).hidden)return!1}let o;return t>=0?o=this.hot.getDataAtCell(t,e):-1===t&&(o=this.hot.getColHeader(e)),{value:o}}))),dD(this,"inProgress",!1),dD(this,"measuredRows",0),dD(this,"rowHeightsMap",new rx),function(t,e,n){uD(t,e),e.set(t,n)}(this,pD,[]),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",((t,e,n)=>fD(wD,this,CD).call(this,t,e,n)))}isEnabled(){const t=this.hot.getSettings()[mD];return!0===t||Kv(t)}enablePlugin(){var t=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const e=this.getSetting("samplingRatio");e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return fD(wD,t,SD).call(t,...n)})),this.addHook("beforeChangeRender",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return fD(wD,t,RD).call(t,...n)})),this.addHook("beforeColumnResize",(()=>this.recalculateAllRowsHeight())),this.addHook("afterFormulasValuesUpdate",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return fD(wD,t,TD).call(t,...n)})),this.addHook("beforeRender",(()=>fD(wD,this,bD).call(this))),this.addHook("modifyRowHeight",((t,e)=>this.getRowHeight(e,t))),this.addHook("init",(()=>fD(wD,this,ED).call(this))),this.addHook("modifyColumnHeaderHeight",(()=>this.getColumnHeaderHeight())),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",((t,e,n)=>fD(wD,this,CD).call(this,t,e,n)))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const t=this.getFirstVisibleRow(),e=this.getLastVisibleRow();if(-1===t||-1===e)return;const n=this.hot.renderCall;this.calculateRowsHeight({from:t,to:e},void 0,n)}calculateRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i="number"==typeof t?{from:t,to:t}:t,o="number"==typeof e?{from:e,to:e}:e;if(null!==this.hot.getColHeader(0)){const t=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(t.get(-1))}VC(i.from,i.to,(t=>{let e=this.hot.toPhysicalRow(t);if(null===e&&(e=t),n||null===this.rowHeightsMap.getValueAtIndex(e)){this.samplesGenerator.generateRowSamples(t,o).forEach(((t,e)=>this.ghostTable.addRow(e,t)))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((t,e)=>{t<0?this.headerHeight=e:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(t),e)}))}),!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const r=()=>{if(!this.hot)return ny(o),void(this.inProgress=!1);this.calculateRowsHeight({from:n,to:Math.min(n+vD.CALCULATION_STEP,i)},t,e),n=n+vD.CALCULATION_STEP+1,n<i?o=ey(r):(ny(o),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateRowsHeight({from:0,to:s},t,e),n=s+1),n<i?r():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const t=this.hot.getSettings()[mD];let e=vD.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return Kv(t)&&(e=t.syncLimit,nw(e)?e=WC(n,e):e>>=0),Math.min(e,n)}getRowHeight(t,e){const n=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t));let i=e;return null!==n&&n>(e||0)&&(i=n),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var t;return null!==(t=this.hot.getFirstRenderedVisibleRow())&&void 0!==t?t:-1}getLastVisibleRow(){var t;return null!==(t=this.hot.getLastRenderedVisibleRow())&&void 0!==t?t:-1}clearCache(t){this.headerHeight=null,Array.isArray(t)?this.hot.batchExecution((()=>{t.forEach((t=>{this.rowHeightsMap.setValueAtIndex(t,null)}))}),!0):this.rowHeightsMap.clear()}clearCacheByRange(t){const{from:e,to:n}="number"==typeof t?{from:t,to:t}:t;this.hot.batchExecution((()=>{VC(Math.min(e,n),Math.max(e,n),(t=>{this.rowHeightsMap.setValueAtIndex(t,null)}))}),!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter((t=>null===t)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function yD(t){const e={from:0,to:this.hot.countCols()-1};t.forEach((t=>{this.samplesGenerator.generateRowSamples(t,e).forEach(((t,e)=>this.ghostTable.addRow(e,t)))})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((t,e)=>{const n=this.hot.toPhysicalRow(t);this.rowHeightsMap.setValueAtIndex(n,e)}))}),!0),this.ghostTable.clean())}function bD(){var t,e,n;this.calculateVisibleRowsHeight(),this.inProgress||(fD(wD,this,yD).call(this,gD(pD,this)),e=this,n=[],(t=pD).set(fD(t,e),n))}function CD(t,e,n){let i=t;return n&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function SD(t,e){e||this.recalculateAllRowsHeight()}function RD(t){const e=t.reduce(((t,e)=>{let[n]=e;return-1===t.indexOf(n)&&t.push(n),t}),[]);gD(pD,this).push(...e)}function ED(){this.recalculateAllRowsHeight()}function TD(t){const e=t.reduce(((t,e)=>{var n;const i=null===(n=e.address)||void 0===n?void 0:n.row;if(Number.isInteger(i)){const e=this.hot.toVisualRow(i);-1===t.indexOf(e)&&t.push(e)}return t}),[]);gD(pD,this).push(...e)}const{getListWithInsertedItems:MD,getListWithRemovedItems:xD}=mx("physicallyIndexed");const HD=class extends nx{constructor(){super((t=>t))}insert(t,e){const n=cx(this.indexedValues,e);this.indexedValues=MD(n,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){const e=xD(this.indexedValues,t);this.indexedValues=hx(e,t),super.remove(t)}},{getListWithInsertedItems:kD,getListWithRemovedItems:ID}=mx("physicallyIndexed");function OD(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function AD(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const _D="bindRowsWithHeaders",PD=new Map([["loose",HD],["strict",class extends nx{constructor(){super((t=>t))}insert(t,e){this.indexedValues=kD(this.indexedValues,t,e,((t,e)=>this.getNextValue(e))),super.insert(t,e)}remove(t){this.indexedValues=ID(this.indexedValues,t),super.remove(t)}getNextValue(t){return Math.max(...this.getValues())+1+t}}]]);var ND=new WeakSet;class DD extends xN{constructor(){super(...arguments),OD(this,ND),AD(this,"headerIndexes",null)}static get PLUGIN_KEY(){return _D}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings()[_D]}enablePlugin(){var t;if(this.enabled)return;const e=null!==(t=PD.get(this.getSetting()))&&void 0!==t?t:PD.get("loose");this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new e),this.addHook("modifyRowHeader",(t=>function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(ND,this,LD).call(this,t))),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function LD(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function VD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FD(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WD(t,e){return t.get(BD(t,e))}function jD(t,e,n){return t.set(BD(t,e),n),n}function BD(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zD="collapsibleColumns",UD=["nestedHeaders"],YD="collapsibleIndicator",$D=zD,GD=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var KD=new WeakMap,XD=new WeakSet;class qD extends xN{constructor(){var t,e;super(...arguments),VD(t=this,e=XD),e.add(t),FD(this,"nestedHeadersPlugin",null),FD(this,"headerStateManager",null),function(t,e,n){VD(t,e),e.set(t,n)}(this,KD,null)}static get PLUGIN_KEY(){return zD}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[zD,...UD]}isEnabled(){return!!this.hot.getSettings()[zD]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();e||Ey("You need to configure the Nested Headers plugin in order to use collapsible headers."),jD(KD,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(()=>BD(XD,this,JD).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return BD(XD,t,tL).call(t,...n)})),this.addHook("afterGetColHeader",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return BD(XD,t,ZD).call(t,...n)})),this.addHook("beforeOnCellMouseDown",((t,e,n)=>BD(XD,this,QD).call(this,t,e,n))),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:t}=this.hot.getSettings();"boolean"==typeof t?this.headerStateManager.mapState((t=>({collapsible:t.origColspan>1}))):Array.isArray(t)&&(this.headerStateManager.mapState((()=>({collapsible:!1}))),this.headerStateManager.mergeStateWith(t))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),jD(KD,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var t;const{row:e,col:n}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:r}=null!==(t=this.headerStateManager.getHeaderTreeNodeData(e,n))&&void 0!==t?t:{};if(i)return o?this.expandSection({row:e,col:r}):this.collapseSection({row:e,col:r}),!1},runOnlyIf:()=>{var t,e;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isHeader())},group:$D,relativeToGroup:mO,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup($D)}clearButtons(){if(!this.hot.view)return;const t=this.hot.view._wt.getSetting("columnHeaders").length,e=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(t){t&&t.parentNode.removeChild(t)};VC(0,t-1,(t=>{const r=e.childNodes[t],s=n.childNodes[t],l=i?i.childNodes[t]:null;VC(0,r.childNodes.length-1,(t=>{let e=r.childNodes[t].querySelector(`.${YD}`);o(e),s&&s.childNodes[t]&&(e=s.childNodes[t].querySelector(`.${YD}`),o(e)),i&&l&&l.childNodes[t]&&(e=l.childNodes[t].querySelector(`.${YD}`),o(e))}))}))}expandSection(t){this.toggleCollapsibleSection([t],"expand")}collapseSection(t){this.toggleCollapsibleSection([t],"collapse")}toggleAllCollapsibleSections(t){const e=this.headerStateManager.mapNodes((e=>{const{collapsible:n,origColspan:i,headerLevel:o,columnIndex:r,isCollapsed:s}=e;if(!0===n&&i>1&&(s&&"expand"===t||!s&&"collapse"===t))return{row:this.headerStateManager.levelToRowCoords(o),col:r}}));this.toggleCollapsibleSection(e,t)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(t,e){if(!GD.has(e))throw new Error(`Unsupported action is passed (${e}).`);if(!Array.isArray(t))return;const n=_p(t,(t=>{let{row:e}=t;return e<0}));let i=n.length>0;Np(n,(t=>{var n;let{row:o,col:r}=t;const{collapsible:s,isCollapsed:l}=null!==(n=this.headerStateManager.getHeaderSettings(o,r))&&void 0!==n?n:{};if(!s||l&&"collapse"===e||!l&&"expand"===e)return i=!1,!1}));const o=[],r=[];i&&Np(n,(t=>{let{row:n,col:i}=t;const{colspanCompensation:s,affectedColumns:l,rollbackModification:a}=this.headerStateManager.triggerNodeModification(e,n,i);s>0&&(r.push(...l),o.push(a))}));const s=this.getCollapsedColumns();let l=[];"collapse"===e?l=Dp([...s,...r]):"expand"===e&&(l=_p(s,(t=>!r.includes(t))));const a=GD.get(e);if(!1===this.hot.runHooks(a.beforeHook,s,l,i))return void Np(o,(t=>{t()}));this.hot.batchExecution((()=>{Np(r,(t=>{WD(KD,this).setValueAtIndex(this.hot.toPhysicalColumn(t),a.hideColumn)}))}),!0);const h=this.getCollapsedColumns().length!==s.length,c=this.hot.getSelectedRangeLast();if("collapse"===e&&h&&c){const{row:t,col:e}=c.highlight;if((this.hot.rowIndexMapper.isHidden(t)||this.hot.columnIndexMapper.isHidden(e))&&r.includes(e)){const n=t>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(t,1,!0):t,i=e>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(e,1,!0):e;null!==n&&null!==i&&this.hot.selectCell(n,i)}}this.hot.runHooks(a.afterHook,s,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return WD(KD,this).getHiddenIndexes()}destroy(){jD(KD,this,null),super.destroy()}}function ZD(t,e,n){var i;const{collapsible:o,origColspan:r,isCollapsed:s}=null!==(i=this.headerStateManager.getHeaderSettings(n,t))&&void 0!==i?i:{},l=o&&r>1&&t>=this.hot.getSettings().fixedColumnsStart,a=this.hot.getSettings().ariaTags;let h=e.querySelector(`.${YD}`);var c;(kw(e,[gw("")[0]]),l)?(h||(h=this.hot.rootDocument.createElement("div"),Mw(h,YD),e.querySelector("div:first-child").appendChild(h)),xw(h,["collapsed","expanded"]),s?(Mw(h,"collapsed"),Pw(h,"+"),a&&Hw(e,...gw(!1))):(Mw(h,"expanded"),Pw(h,"-"),a&&Hw(e,...gw(!0))),a&&Hw(h,"aria-hidden","true")):null===(c=h)||void 0===c||c.remove()}function QD(t,e){Tw(t.target,YD)&&(Tw(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Tw(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),by(t))}function JD(){this.updatePlugin()}function tL(t,e){e||this.updatePlugin()}function eL(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const nL=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];class iL{constructor(t,e){eL(this,"hot",void 0),eL(this,"sortingStates",new dx),eL(this,"sortEmptyCells",false),eL(this,"indicator",true),eL(this,"headerAction",true),eL(this,"compareFunctionFactory",void 0),eL(this,"mapName",void 0),this.hot=t,this.mapName=e,this.hot.columnIndexMapper.registerMap(e,this.sortingStates)}updateAllColumnsProperties(t){Kv(t)&&qv(t,((t,e)=>{nL.includes(e)&&(this[e]=t)}))}getAllColumnsProperties(){const t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}getSortOrderOfColumn(t){var e;return null===(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))||void 0===e?void 0:e.sortOrder}getIndexOfColumnInSortQueue(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex((e=>{let[n]=e;return n===t}))}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(t){return Kv(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}getSortStates(){if(null===this.sortingStates)return[];return this.sortingStates.getEntries().map((t=>{let[e,n]=t;return a({column:this.hot.toVisualColumn(e)},n)}))}getColumnSortState(t){const e=this.getSortOrderOfColumn(t);if(jp(e))return{column:t,sortOrder:e}}setSortStates(t){this.sortingStates.clear();for(let e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function oL(t,e,n){const i=e.locale;return function(e,o){const{sortEmptyCells:r}=n;return"string"==typeof e&&(e=e.toLocaleLowerCase(i)),"string"==typeof o&&(o=o.toLocaleLowerCase(i)),e===o?dL:zp(e)?zp(o)?dL:r&&"asc"===t?gL:fL:zp(o)?r&&"asc"===t?fL:gL:isNaN(e)&&!isNaN(o)?"asc"===t?fL:gL:!isNaN(e)&&isNaN(o)?"asc"===t?gL:fL:(isNaN(e)||isNaN(o)||(e=parseFloat(e),o=parseFloat(o)),e<o?"asc"===t?gL:fL:e>o?"asc"===t?fL:gL:dL)}}const rL="default";const{register:sL,getItem:lL,hasItem:aL}=cb("sorting.compareFunctionFactory"),{register:hL,getItem:cL}=cb("sorting.mainSortComparator");function uL(t){return aL(t)?lL(t):lL(rL)}sL("checkbox",(function(t,e,n){const i=e.checkedTemplate,o=e.uncheckedTemplate,{sortEmptyCells:r}=n;return function(s,l){const a=zp(s),h=zp(l),c=a?o:s,u=h?o:l,d=c===o||c===i,g=u===o||u===i;if(!1===r){if(a&&!1===h)return fL;if(!1===a&&h)return gL}return!1===d&&g?"asc"===t?gL:fL:d&&!1===g?"asc"===t?fL:gL:!1===d&&!1===g?oL(t,e,n)(s,l):c===o&&u===i?"asc"===t?gL:fL:c===i&&u===o?"asc"===t?fL:gL:dL}})),sL("date",(function(t,e,n){return RL(t,e.dateFormat,n)})),sL(rL,oL),sL("numeric",(function(t,e,n){return function(e,i){const o=parseFloat(e),r=parseFloat(i),{sortEmptyCells:s}=n;if(o===r||isNaN(o)&&isNaN(r))return dL;if(s){if(zp(e))return"asc"===t?gL:fL;if(zp(i))return"asc"===t?fL:gL}return isNaN(o)?fL:isNaN(r)?gL:o<r?"asc"===t?gL:fL:o>r?"asc"===t?fL:gL:dL}})),sL("time",(function(t,e,n){return RL(t,e.timeFormat,n)}));const dL=0,gL=-1,fL=1;const mL="asc",pL="desc",wL="colHeader";function vL(t){if(t.some((t=>!1===function(t){if(!1===Kv(t))return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[mL,pL].includes(n)}(t))))return!1;const e=t.map((t=>{let{column:e}=t;return e}));return new Set(e).size===e.length}function yL(t){if(t!==pL)return t===mL?pL:mL}function bL(t){return t.querySelector(`.${wL}`)}function CL(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return-1===Array.from(n).indexOf(e.parentNode)-n.length}function SL(t,e,n){return-1===t&&e>=0&&!1===Sy(n)}function RL(t,e,n){return function(i,o){const{sortEmptyCells:r}=n;if(i===o)return dL;if(zp(i))return zp(o)?dL:r&&"asc"===t?gL:fL;if(zp(o))return r&&"asc"===t?fL:gL;const s=Sd(i,e),l=Sd(o,e);return s.isValid()?l.isValid()?l.isAfter(s)?"asc"===t?gL:fL:l.isBefore(s)?"asc"===t?fL:gL:dL:gL:fL}}const EL="indicatorDisabled",TL="columnSorting",ML="sortAction",xL=new Map([[mL,"ascending"],[pL,"descending"]]);function HL(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function kL(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IL(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const OL="columnSorting",AL="append",_L=OL;hL(OL,(function(t,e){return function(n,i){const[,...o]=n,[,...r]=i;return function(n){const i=t[n],s=e[n],l=o[n],a=r[n],h=s.columnSorting;return(h.compareFunctionFactory?h.compareFunctionFactory:uL(s.type))(i,s,h)(l,a)}(0)}})),lb.getSingleton().register("beforeColumnSort"),lb.getSingleton().register("afterColumnSort");var PL=new WeakSet;class NL extends xN{constructor(){super(...arguments),HL(this,PL),kL(this,"columnStatesManager",null),kL(this,"columnMetaCache",null),kL(this,"pluginKey",OL),kL(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return OL}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var t=this;this.enabled||(this.columnStatesManager=new iL(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new rx((t=>{let e=this.hot.toVisualColumn(t);return null===e&&(e=t),this.getMergedPluginSettings(e)})),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",((t,e)=>IL(PL,this,LL).call(this,t,e))),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return IL(PL,t,FL).call(t,...n)})),this.addHook("afterOnCellMouseDown",((t,e)=>this.onAfterOnCellMouseDown(t,e))),this.addHook("afterInit",(()=>IL(PL,this,DL).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return IL(PL,t,VL).call(t,...n)})),this.hot.view&&IL(PL,this,DL).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const t=(t,e)=>{const n=bL(e);!1!==CL(t,e)&&null!==n&&this.updateHeaderClasses(n)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("afterGetColHeader",t)})),this.hot.batchExecution((()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)}),!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(t.col)),!1},runOnlyIf:()=>{var t,e;const n=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return n&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(n)&&-1===n.row&&n.col>=0},relativeToGroup:mO,position:"before",group:_L})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_L)}sort(t){const e=this.getSortConfig(),n=this.getNormalizedSortConfigs(t),i=this.areValidSortConfigs(n);!1!==this.hot.runHooks("beforeColumnSort",e,n,i)&&(0===e.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new px),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",e,i?n:e,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(t){return jp(t)?this.columnStatesManager.getColumnSortState(t):this.columnStatesManager.getSortStates()}setSortConfig(t){const e=this.getNormalizedSortConfigs(t);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t]}areValidSortConfigs(t){const e=this.hot.countCols();return vL(t)&&t.every((t=>{let{column:n}=t;return n<=e&&n>=0}))}saveAllSortSettings(t){const e=this.columnStatesManager.getAllColumnsProperties();e.initialConfig=Pp(t,(t=>{let e=t,{column:n}=e,i=c(e,["column"]);return a({column:this.hot.toPhysicalColumn(n)},i)})),this.hot.runHooks("persistentStateSave","columnSorting",e)}getAllSavedSortSettings(){const t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);const e=t.value,n=t=>{let e=t,{column:n}=e,i=c(e,["column"]);return a({column:this.hot.toVisualColumn(n)},i)};return jp(e)&&Array.isArray(e.initialConfig)&&(e.initialConfig=Pp(e.initialConfig,n)),e}getColumnNextConfig(t){const e=this.columnStatesManager.getSortOrderOfColumn(t);if(jp(e)){const n=yL(e);return jp(n)?{column:t,sortOrder:n}:void 0}const n=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<n)return{column:t,sortOrder:yL()}}getNextSortConfig(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:AL;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(t),i=-1!==n,o=this.getSortConfig(),r=this.getColumnNextConfig(t);if(i){if(Bp(r))return[...o.slice(0,n),...o.slice(n+1)];if(e===AL)return[...o.slice(0,n),...o.slice(n+1),r];if("replace"===e)return[...o.slice(0,n),r,...o.slice(n+1)]}return jp(r)?o.concat(r):o}getPluginColumnConfig(t){if(Kv(t)){const e=t[this.pluginKey];if(Kv(e))return e}return{}}getMergedPluginSettings(t){const e=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,t),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(n,e,this.getPluginColumnConfig(o.columns[t])):sv(o.columns)?Object.assign(n,e,this.getPluginColumnConfig(o.columns(t))):Object.assign(n,e)}getFirstCellSettings(t){const e=this.hot.getCellMeta(0,t),n=Object.create(e);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(t)),n}getNumberOfRowsToSort(t){const e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}sortByPresetSortStates(t){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),0===t.length)return;const e=[],n=this.hot.countRows(),i=e=>Pp(t,(t=>this.hot.getDataAtCell(e,t.column)));for(let a=0;a<this.getNumberOfRowsToSort(n);a+=1)e.push([this.hot.toPhysicalRow(a)].concat(i(a)));const o=Pp(e,(t=>t[0]));!function(t,e){const n=cL(e);for(var i=arguments.length,o=new Array(i>2?i-2:0),r=2;r<i;r++)o[r-2]=arguments[r];t.sort(n(...o))}(e,this.pluginKey,Pp(t,(t=>t.sortOrder)),Pp(t,(t=>this.getFirstCellSettings(t.column))));for(let a=e.length;a<n;a+=1)e.push([a].concat(i(a)));const r=Pp(e,(t=>t[0])),s=new Map(Pp(o,((t,e)=>[t,r[e]]))),l=Pp(this.hot.rowIndexMapper.getIndexesSequence(),(t=>s.has(t)?s.get(t):t));this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(t){if(Kv(t)){this.columnStatesManager.updateAllColumnsProperties(t);const e=t.initialConfig;(Array.isArray(e)||Kv(e))&&this.sort(e)}else this.hot.render()}updateHeaderClasses(t){if(xw(t,Array.from(xL.values()).concat(ML,EL,TL)),!1!==this.enabled){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];Mw(t,function(t,e,n,i){const o=[TL];if(i&&o.push(ML),!1===n)return o.push(EL),o;const r=t.getSortOrderOfColumn(e);return jp(r)&&o.push(xL.get(r)),o}(...n))}}onUpdateSettings(t){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),jp(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}wasClickableHeaderClicked(t,e){return this.getFirstCellSettings(e)[this.pluginKey].headerAction&&Tw(t.target,wL)}onAfterOnCellMouseDown(t,e){if(!1!==SL(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col));const t=this.hot.getActiveEditor(),n=this.getColumnNextConfig(e.col);null!=t&&t.isOpened()&&this.hot.getCellValidator(t.row,t.col)?this.hot.addHookOnce("postAfterValidate",(()=>{this.sort(n)})):this.sort(n)}}destroy(){var t;null===(t=this.columnStatesManager)||void 0===t||t.destroy(),super.destroy()}}function DL(){const t=this.getAllSavedSortSettings();if(Kv(t))this.sortBySettings(t);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}function LL(t,e){const n=bL(e);if(!1===CL(t,e)||null===n)return;const i=this.getFirstCellSettings(t)[this.pluginKey],o=i.indicator,r=i.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,o,r),this.hot.getSettings().ariaTags){const n=this.columnStatesManager.getSortOrderOfColumn(t);Hw(e,...(s=n?`${n}ending`:"none",["aria-sort",s]))}var s}function VL(t){!0===t&&this.hot.view&&IL(PL,this,DL).call(this)}function FL(t,e,n,i){!1!==SL(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function WL(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const jL=class{constructor(t,e){WL(this,"plugin",void 0),WL(this,"hot",void 0),WL(this,"endpoints",[]),WL(this,"settings",void 0),WL(this,"settingsType","array"),WL(this,"currentEndpoint",null),WL(this,"cellsToSetCache",[]),this.plugin=t,this.hot=this.plugin.hot,this.settings=e}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(t){return this.parseSettings(t.call(this))}parseSettings(t){const e=[];let n=t;if(n||"function"!=typeof this.settings)return n||(n=this.settings),Np(n,(t=>{const n={};this.assignSetting(t,n,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(t,n,"reversedRowCoords",!1),this.assignSetting(t,n,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,n,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(t,n,"sourceColumn",t.destinationColumn),this.assignSetting(t,n,"type","sum"),this.assignSetting(t,n,"forceNumeric",!1),this.assignSetting(t,n,"suppressDataTypeErrors",!0),this.assignSetting(t,n,"customFunction",null),this.assignSetting(t,n,"readOnly",!0),this.assignSetting(t,n,"roundFloat",!1),e.push(n)})),e;this.settingsType="function"}assignSetting(t,e,n,i){if("ranges"!==n||void 0!==t[n]){if("ranges"!==n||0!==t[n].length)if(void 0===t[n]){if(i instanceof Error)throw i;e[n]=i}else"destinationRow"===n&&e.reversedRowCoords?e[n]=this.hot.countRows()-t[n]-1:e[n]=t[n]}else e[n]=i}resetSetupBeforeStructureAlteration(t,e,n){if("function"!==this.settingsType)return;const i=t.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();Np(o,(o=>{"row"===i&&o.destinationRow>=e&&("insert_row"===t?o.alterRowOffset=n:"remove_row"===t&&(o.alterRowOffset=-1*n)),"col"===i&&o.destinationColumn>=e&&("insert_col"===t?o.alterColumnOffset=n:"remove_col"===t&&(o.alterColumnOffset=-1*n))})),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(t,e,n,i,o){let r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const t=()=>(this.hot.removeHook("beforeViewRender",t),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",t)}const s=t.indexOf("row")>-1?"row":"col",l=t.indexOf("remove")>-1?-1:1,a=this.getAllEndpoints(),h=0===t.indexOf("move_row"),c=e;Np(a,(t=>{"row"===s&&t.destinationRow>=c&&(t.alterRowOffset=l*n),"col"===s&&t.destinationColumn>=c&&(t.alterColumnOffset=l*n)})),this.resetAllEndpoints(a,!h),Np(a,h?t=>{this.extendEndpointRanges(t,c,i[0],i.length),this.recreatePhysicalRanges(t),this.clearOffsetInformation(t)}:t=>{this.shiftEndpointCoordinates(t,c)}),r&&this.refreshAllEndpoints()}clearOffsetInformation(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}extendEndpointRanges(t,e,n,i){Np(t.ranges,(t=>{t[1]&&(e>=t[0]&&e<=t[1]?n>t[1]?t[1]+=i:n<t[0]&&(t[0]-=i):n>=t[0]&&n<=t[1]&&(t[1]-=i,e<=t[0]&&(t[0]+=1,t[1]+=1)))}))}recreatePhysicalRanges(t){const e=t.ranges,n=[],i=[];Np(e,(t=>{const e=[];if(t[1])for(let n=t[0];n<=t[1];n++)e.push(this.hot.toPhysicalRow(n));else e.push(this.hot.toPhysicalRow(t[0]));i.push(e)})),Np(i,(t=>{let e=[];Np(t,((i,o)=>{0===o?e.push(i):t[o]!==t[o-1]+1&&(e.push(t[o-1]),n.push(e),e=[],e.push(i)),o===t.length-1&&(e.push(i),n.push(e))}))})),t.ranges=n}shiftEndpointCoordinates(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,Np(t.ranges,(n=>{Np(n,((i,o)=>{i>=e&&(n[o]+=t.alterRowOffset||0)}))}))):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}resetAllEndpoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.some((t=>{const e=t.alterRowOffset||0,n=t.alterColumnOffset||0;return t.destinationRow+e>=this.hot.countRows()||t.destinationColumn+n>=this.hot.countCols()}))||(this.cellsToSetCache=[],Np(t,(t=>{this.resetEndpointValue(t,e)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],Np(this.getAllEndpoints(),(t=>{this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(t){const e=[];this.cellsToSetCache=[],Np(t,((t,n,i)=>{`${t[2]||""}`!=`${t[3]}`&&Np(this.getAllEndpoints(),((t,o)=>{this.hot.propToCol(i[n][1])===t.sourceColumn&&-1===e.indexOf(o)&&e.push(o)}))})),Np(e,(t=>{this.refreshEndpoint(this.getEndpoint(t))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach((t=>{const e=this.hot.toVisualRow(t.destinationRow);if(null!==e){const n=this.hot.getCellMeta(e,t.destinationColumn);n.readOnly=t.readOnly,n.className="columnSummaryResult"}}))}refreshEndpoint(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}resetEndpointValue(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=t.alterRowOffset||0,i=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(e?n:0)),this.hot.toVisualColumn(t.destinationColumn+(e?i:0)),""])}setEndpointValue(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const o=this.hot.toVisualRow(t.destinationRow);if(null!==o){const n=this.hot.getCellMeta(o,t.destinationColumn);"init"!==e&&n.readOnly===t.readOnly||(n.readOnly=t.readOnly,n.className="columnSummaryResult")}if((!0===t.roundFloat||Number.isInteger(t.roundFloat))&&!isNaN(t.result)){const e=t.roundFloat;let n=0;Number.isInteger(e)&&(n=Math.min(Math.max(0,e),100)),t.result=t.result.toFixed(n)}n?this.hot.setDataAtCell(i,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Ey("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}};function BL(t){return null==t||isNaN(t)}function zL(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function UL(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YL(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const $L="columnSummary";var GL=new WeakSet;class KL extends xN{constructor(){super(...arguments),zL(this,GL),UL(this,"endpoints",null)}static get PLUGIN_KEY(){return $L}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings()[$L]}enablePlugin(){var t=this;this.enabled||(this.settings=this.hot.getSettings()[$L],this.endpoints=new jL(this,this.settings),this.addHook("afterInit",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return YL(GL,t,XL).call(t,...n)})),this.addHook("afterChange",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return YL(GL,t,ZL).call(t,...n)})),this.addHook("afterUpdateSettings",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return YL(GL,t,qL).call(t,...n)})),this.addHook("beforeCreateRow",((t,e,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,e,null,n))),this.addHook("beforeCreateCol",((t,e,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,e,null,n))),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)})),this.addHook("beforeRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)})),this.addHook("afterCreateRow",((t,e,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,e,null,n))),this.addHook("afterCreateCol",((t,e,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,e,null,n))),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)})),this.addHook("afterRowMove",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return YL(GL,t,QL).call(t,...n)})),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t)}}calculateSum(t){let e=0;return qv(t.ranges,(n=>{e+=this.getPartialSum(n,t.sourceColumn)})),e}getPartialSum(t,e){let n=0,i=t[1]||t[0],o=null,r=0;do{if(o=this.getCellValue(i,e),o=BL(o)?null:o,null!==o){const t=(`${o}`.split(".")[1]||[]).length||1;t>r&&(r=t)}n+=o||0,i-=1}while(i>=t[0]);return Math.round(n*s(10,r))/s(10,r)}calculateMinMax(t,e){let n=null;return qv(t.ranges,(i=>{const o=this.getPartialMinMax(i,t.sourceColumn,e);if(null===n&&null!==o&&(n=o),null!==o)switch(e){case"min":n=Math.min(n,o);break;case"max":n=Math.max(n,o)}})),null===n?"Not enough data":n}getPartialMinMax(t,e,n){let i,o=null,r=t[1]||t[0];do{if(i=this.getCellValue(r,e),i=BL(i)?null:i,null===o)o=i;else if(null!==i)switch(n){case"min":o=Math.min(o,i);break;case"max":o=Math.max(o,i)}r-=1}while(r>=t[0]);return o}countEmpty(t,e){let n,i=0,o=t[1]||t[0];do{n=this.getCellValue(o,e),n=BL(n)?null:n,null===n&&(i+=1),o-=1}while(o>=t[0]);return i}countEntries(t){let e=0;return qv(t.ranges,(n=>{const i=void 0===n[1]?1:n[1]-n[0]+1,o=this.countEmpty(n,t.sourceColumn);e+=i,e-=o})),e}calculateAverage(t){return this.calculateSum(t)/this.countEntries(t)}getCellValue(t,e){const n=this.hot.toVisualRow(t),i=this.hot.toVisualColumn(e);let o=this.hot.getSourceDataAtCell(t,e),r="";if(null!==n&&null!==i&&(r=this.hot.getCellMeta(n,i).className||""),r.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof o&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Fp`ColumnSummary plugin: cell at (${t}, ${e}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function XL(){this.endpoints.initEndpoints()}function qL(t){void 0!==t.columns&&this.endpoints.refreshCellMetas()}function ZL(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}function QL(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function JL(t,e,n){tV(t,e),e.set(t,n)}function tV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eV(t,e){return t.get(iV(t,e))}function nV(t,e,n){return t.set(iV(t,e),n),n}function iV(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oV=new WeakMap,rV=new WeakMap,sV=new WeakMap,lV=new WeakSet;class aV{constructor(){var t,e;tV(t=this,e=lV),e.add(t),JL(this,oV,!0),JL(this,rV,null),JL(this,sV,new ResizeObserver((t=>iV(lV,this,hV).call(this,t))))}setObservedElement(t){nV(rV,this,t)}unobserve(){eV(sV,this).unobserve(eV(rV,this))}observe(){nV(oV,this,!0),eV(sV,this).observe(eV(rV,this))}destroy(){eV(sV,this).disconnect()}}function hV(t){!eV(oV,this)&&Array.isArray(t)&&t.length?t.forEach((t=>{let{borderBoxSize:e}=t;const{inlineSize:n,blockSize:i}=e[0];this.runLocalHooks("resize",n,i)})):nV(oV,this,!1)}function cV(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function uV(t,e){return t.get(gV(t,e))}function dV(t,e,n){return t.set(gV(t,e),n),n}function gV(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}$v(aV,UE);var fV=new WeakMap,mV=new WeakMap,pV=new WeakMap,wV=new WeakMap,vV=new WeakMap,yV=new WeakMap,bV=new WeakMap;class CV{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(t,e){var n=this;cV(this,fV,void 0),cV(this,mV,!1),cV(this,pV,null),cV(this,wV,void 0),cV(this,vV,void 0),cV(this,yV,!0),cV(this,bV,new aV),dV(fV,this,t),dV(mV,this,e),dV(wV,this,this.createEditor()),dV(vV,this,uV(wV,this).style),uV(bV,this).setObservedElement(this.getInputElement()),uV(bV,this).addLocalHook("resize",(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n.runLocalHooks("resize",...e)})),this.hide()}setPosition(t,e){uV(vV,this).left=`${t}px`,uV(vV,this).top=`${e}px`}setSize(t,e){if(t&&e){const n=this.getInputElement();n.style.width=`${t}px`,n.style.height=`${e}px`}}getSize(){return{width:Uw(this.getInputElement()),height:Yw(this.getInputElement())}}observeSize(){uV(bV,this).observe()}resetSize(){const t=this.getInputElement();t.style.width="",t.style.height=""}setReadOnlyState(t){this.getInputElement().readOnly=t}show(){uV(vV,this).display="block",dV(yV,this,!1)}hide(){uV(bV,this).unobserve(),uV(yV,this)||(uV(vV,this).display="none"),dV(yV,this,!0)}isVisible(){return"block"===uV(vV,this).display}setValue(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return uV(fV,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const t=uV(fV,this).createElement("div"),e=uV(fV,this).createElement("textarea");return t.style.display="none",dV(pV,this,uV(fV,this).createElement("div")),uV(pV,this).setAttribute("dir",uV(mV,this)?"rtl":"ltr"),Mw(uV(pV,this),CV.CLASS_EDITOR_CONTAINER),uV(fV,this).body.appendChild(uV(pV,this)),Mw(t,CV.CLASS_EDITOR),Mw(e,CV.CLASS_INPUT),e.setAttribute("data-hot-input",!0),t.appendChild(e),uV(pV,this).appendChild(t),t}getInputElement(){return uV(wV,this).querySelector(`.${CV.CLASS_INPUT}`)}getEditorElement(){return uV(wV,this)}destroy(){const t=uV(pV,this)?uV(pV,this).parentNode:null;uV(wV,this).parentNode.removeChild(uV(wV,this)),dV(wV,this,null),dV(vV,this,null),uV(bV,this).destroy(),t&&t.removeChild(uV(pV,this))}}$v(CV,UE);const SV=CV;function RV(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class EV{constructor(t){RV(this,"wasLastActionShow",!0),RV(this,"showDebounced",null),RV(this,"hidingTimer",null),this.updateDelay(t)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout((()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")}),250)}show(t){this.wasLastActionShow=!0,this.showDebounced(t)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=lv((t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)}),t)}destroy(){this.clearLocalHooks()}}$v(EV,UE);const TV=EV;function MV(t,e){const n={};return Np(t,(t=>{t.forAll(((t,i)=>{t>=0&&i>=0&&(n[t]||(n[t]=[]),n[t][i]=e(t,i))}))})),n}function xV(t,e,n,i,o){Np(t,(t=>{t.forAll(((t,r)=>{t>=0&&r>=0&&function(t,e,n,i,o,r){const s=o(t,e);let l=i;s.className&&(l="vertical"===n?function(t,e){return-1!==t.indexOf(e)?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}(s.className,i):function(t,e){return-1!==t.indexOf(e)?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}(s.className,i));r(t,e,"className",l)}(t,r,e,n,i,o)}))}))}function HV(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function kV(t,e){let n=!1;return Array.isArray(t)&&Np(t,(t=>(t.forAll(((t,i)=>{if(t>=0&&i>=0&&e(t,i))return n=!0,!1})),n))),n}function IV(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:t}=e.defaultView,{top:i,left:o}=t.getBoundingClientRect();n.top=i,n.left=o}return n}const OV="---------";const AV="alignment";const _V="clear_column";const PV="col_left";const NV="col_right";const DV="make_read_only";const LV="redo";const VV="remove_col";const FV="remove_row";const WV="row_above";const jV="row_below";const BV="no_items";const zV="undo";const UV=[WV,jV,PV,NV,_V,FV,VV,zV,LV,DV,AV,OV,BV],YV={[OV]:function(){return{name:OV}},[BV]:function(){return{key:BV,name(){return this.getTranslatedPhrase(Ux)},disabled:!0,isCommand:!1}},[WV]:function(){return{key:WV,name(){return this.getTranslatedPhrase(Yx)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.row<0)return!0;if(this.selection.isSelectedByCorner()){return 0===this.countRows()}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}},[jV]:function(){return{key:jV,name(){return this.getTranslatedPhrase($x)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.row<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows))},hidden(){return!this.getSettings().allowInsertRow}}},[PV]:function(){return{key:PV,name(){return this.getTranslatedPhrase(Gx)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.col<0)return!0;if(this.selection.isSelectedByCorner()){return 0===this.countCols()}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}},[NV]:function(){return{key:NV,name(){return this.getTranslatedPhrase(Kx)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden(){return!this.getSettings().allowInsertColumn}}},[_V]:function(){return{key:_V,name(){return this.getTranslatedPhrase(tH)},callback(t,e){const n=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||(!!(t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByColumnHeader())}}},[FV]:function(){return{key:FV,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,i]=t[0];n-i!=0&&(e=1)}return this.getTranslatedPhrase(Xx,e)},callback(){this.alter("remove_row",function(t){const e=mI(t.getSelected());if(0===e||1===e)return[];const n=pI(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;return Np(t.getSelected(),(t=>{const{from:e,to:o}=n(t),r=Math.max(e.row,0),s=o.row-r+1;Np(Array.from(new Array(s),((t,e)=>r+e)),(t=>{i.has(t)||i.add(t)}))})),Ap(Array.from(i).sort(((t,e)=>t-e)),((t,e,n,i)=>(0!==n&&e===i[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[])}(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}},[VV]:function(){return{key:VV,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,i]=t[0];n-i!=0&&(e=1)}return this.getTranslatedPhrase(qx,e)},callback(){this.alter("remove_col",function(t){const e=mI(t.getSelected());if(0===e||1===e)return[];const n=pI(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;return Np(t.getSelected(),(t=>{const{from:e,to:o}=n(t),r=Math.max(e.col,0),s=o.col-r+1;Np(Array.from(new Array(s),((t,e)=>r+e)),(t=>{i.has(t)||i.add(t)}))})),Ap(Array.from(i).sort(((t,e)=>t-e)),((t,e,n,i)=>(0!==n&&e===i[n-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t)),[])}(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}},[zV]:function(){return{key:zV,name(){return this.getTranslatedPhrase(Zx)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[LV]:function(){return{key:LV,name(){return this.getTranslatedPhrase(Qx)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[DV]:function(){return{key:DV,checkable:!0,ariaChecked(){return kV(this.getSelectedRange(),((t,e)=>this.getCellMeta(t,e).readOnly))},ariaLabel(){return this.getTranslatedPhrase(Jx)},name(){let t=this.getTranslatedPhrase(Jx);return kV(this.getSelectedRange(),((t,e)=>this.getCellMeta(t,e).readOnly))&&(t=HV(t)),t},callback(){const t=this.getSelectedRange(),e=kV(t,((t,e)=>this.getCellMeta(t,e).readOnly));Np(t,(t=>{t.forAll(((t,n)=>{t>=0&&n>=0&&this.setCellMeta(t,n,"readOnly",!e)}))})),this.render()},disabled(){const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||(!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))))}}},[AV]:function(){return{key:AV,name(){return this.getTranslatedPhrase(fH)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner()))},submenu:{items:[{key:`${AV}:left`,name(){return this.getTranslatedPhrase(mH)},callback(){const t=this.getSelectedRange(),e=MV(t,((t,e)=>this.getCellMeta(t,e).className)),n="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,n,i),xV(t,n,i,((t,e)=>this.getCellMeta(t,e)),((t,e,n,i)=>this.setCellMeta(t,e,n,i))),this.render()},disabled:!1},{key:`${AV}:center`,name(){return this.getTranslatedPhrase(pH)},callback(){const t=this.getSelectedRange(),e=MV(t,((t,e)=>this.getCellMeta(t,e).className)),n="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,n,i),xV(t,n,i,((t,e)=>this.getCellMeta(t,e)),((t,e,n,i)=>this.setCellMeta(t,e,n,i))),this.render()},disabled:!1},{key:`${AV}:right`,name(){return this.getTranslatedPhrase(wH)},callback(){const t=this.getSelectedRange(),e=MV(t,((t,e)=>this.getCellMeta(t,e).className)),n="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,n,i),xV(t,n,i,((t,e)=>this.getCellMeta(t,e)),((t,e,n,i)=>this.setCellMeta(t,e,n,i))),this.render()},disabled:!1},{key:`${AV}:justify`,name(){return this.getTranslatedPhrase(vH)},callback(){const t=this.getSelectedRange(),e=MV(t,((t,e)=>this.getCellMeta(t,e).className)),n="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,n,i),xV(t,n,i,((t,e)=>this.getCellMeta(t,e)),((t,e,n,i)=>this.setCellMeta(t,e,n,i))),this.render()},disabled:!1},{name:OV},{key:`${AV}:top`,name(){return this.getTranslatedPhrase(yH)},callback(){const t=this.getSelectedRange(),e=MV(t,((t,e)=>this.getCellMeta(t,e).className)),n="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,n,i),xV(t,n,i,((t,e)=>this.getCellMeta(t,e)),((t,e,n,i)=>this.setCellMeta(t,e,n,i))),this.render()},disabled:!1},{key:`${AV}:middle`,name(){return this.getTranslatedPhrase(bH)},callback(){const t=this.getSelectedRange(),e=MV(t,((t,e)=>this.getCellMeta(t,e).className)),n="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,i),xV(t,n,i,((t,e)=>this.getCellMeta(t,e)),((t,e,n,i)=>this.setCellMeta(t,e,n,i))),this.render()},disabled:!1},{key:`${AV}:bottom`,name(){return this.getTranslatedPhrase(CH)},callback(){const t=this.getSelectedRange(),e=MV(t,((t,e)=>this.getCellMeta(t,e).className)),n="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,n,i),xV(t,n,i,((t,e)=>this.getCellMeta(t,e)),((t,e,n,i)=>this.setCellMeta(t,e,n,i))),this.render()},disabled:!1}]}}}};function $V(){const t={};return qv(YV,((e,n)=>{t[n]=e()})),t}function GV(t,e,n){KV(t,e),e.set(t,n)}function KV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XV(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qV(t,e,n){return t.set(QV(t,e),n),n}function ZV(t,e){return t.get(QV(t,e))}function QV(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const JV="comments",tF="comment",eF="value",nF="style",iF="readOnly",oF=JV,rF=`plugin:${JV}`;var sF=new WeakMap,lF=new WeakMap,aF=new WeakMap,hF=new WeakMap,cF=new WeakMap,uF=new WeakMap,dF=new WeakSet;class gF extends xN{constructor(){var t,e;super(...arguments),KV(t=this,e=dF),e.add(t),XV(this,"range",{}),GV(this,sF,null),GV(this,lF,null),GV(this,aF,!1),GV(this,hF,!1),GV(this,cF,null),GV(this,uF,"")}static get PLUGIN_KEY(){return JV}static get PLUGIN_PRIORITY(){return 60}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[JV]}enablePlugin(){var t=this;this.enabled||(ZV(sF,this)||(qV(sF,this,new SV(this.hot.rootDocument,this.hot.isRtl())),ZV(sF,this).addLocalHook("resize",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return QV(dF,t,bF).call(t,...n)}))),ZV(lF,this)||qV(lF,this,new TV(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",(t=>this.addToContextMenu(t))),this.addHook("afterRenderer",((t,e,n,i,o,r)=>QV(dF,this,wF).call(this,t,r))),this.addHook("afterScroll",(()=>QV(dF,this,SF).call(this))),this.addHook("afterBeginEditing",(()=>this.hide())),this.addHook("afterDocumentKeyDown",(t=>QV(dF,this,CF).call(this,t))),this.addHook("afterSetTheme",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return QV(dF,t,RF).call(t,...n)})),ZV(lF,this).addLocalHook("hide",(()=>this.hide())),ZV(lF,this).addLocalHook("show",((t,e)=>this.showAtCell(t,e))),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){ZV(lF,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=this.hot.getShortcutManager(),e=t.getContext("grid"),n=t.addContext(rF);e.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const e=this.hot.getSelectedRangeLast();qV(hF,this,!0),this.hot.scrollToFocusedCell((()=>{this.setRange(e),this.show(),this.focusEditor(),t.setActiveContextName(rF),this.hot._registerTimeout((()=>{qV(hF,this,!1)}))}))},stopPropagation:!0,runOnlyIf:()=>{var t;return null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell()},group:oF}),n.addShortcut({keys:[["Escape"]],callback:()=>{ZV(sF,this).setValue(ZV(uF,this)),this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>ZV(sF,this).isVisible()&&ZV(sF,this).isFocused(),group:oF}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>ZV(sF,this).isVisible()&&ZV(sF,this).isFocused(),group:oF})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(oF)}registerListeners(){const{rootDocument:t}=this.hot,e=this.getEditorInputElement();this.eventManager.addEventListener(t,"mouseover",(t=>QV(dF,this,mF).call(this,t))),this.eventManager.addEventListener(t,"mousedown",(t=>QV(dF,this,fF).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>QV(dF,this,pF).call(this))),this.eventManager.addEventListener(e,"focus",(()=>QV(dF,this,yF).call(this))),this.eventManager.addEventListener(e,"blur",(()=>QV(dF,this,vF).call(this)))}setRange(t){this.range=t}clearRange(){this.range={}}targetIsCellWithComment(t){const e=yw(t.target,"TD","TBODY");return!!(e&&Tw(e,"htCommentCell")&&yw(e,[this.hot.rootElement]))}targetIsCommentTextArea(t){return this.getEditorInputElement()===t.target}setComment(t){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const e=ZV(sF,this).getValue();let n="";null!=t?n=t:null!=e&&(n=e);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[eF]:n}),this.hot.render()}setCommentAtCell(t,e,n){this.setRange({from:this.hot._createCellCoords(t,e)}),this.setComment(n)}removeComment(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,tF),t&&this.hot.render(),this.hide()}removeCommentAtCell(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(t,e)}),this.removeComment(n)}getComment(){const t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,eF)}getCommentAtCell(t,e){return this.getCommentMeta(t,e,eF)}show(){var t;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:e,col:n}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return ZV(lF,this).cancelHiding(),ZV(sF,this).setValue(null!==(t=i[tF]?i[tF][eF]:null)&&void 0!==t?t:""),ZV(sF,this).show(),this.refreshEditor(!0),!0}showAtCell(t,e){return this.setRange({from:this.hot._createCellCoords(t,e)}),this.show()}hide(){ZV(sF,this).hide()}refreshEditor(){var t,e;if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.range.from&&ZV(sF,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{row:o,col:r}=this.range.from;let s=n.getRenderableFromVisualIndex(o),l=i.getRenderableFromVisualIndex(r);const a=null===s;ZV(sF,this).setPosition(0,0),null===s&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1))),null===l&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1)));const h=null===s,c=null===l;s=null!==(t=s)&&void 0!==t?t:0,l=null!==(e=l)&&void 0!==e?e:0;const{rootWindow:u,view:{_wt:d}}=this.hot,{wtTable:g}=d,f=d.getCell({row:s,col:l},!0),m=this.getCommentMeta(o,r,nF);m?ZV(sF,this).setSize(m.width,m.height):ZV(sF,this).resetSize();const p=c?0:g.getColumnWidth(l),w=a&&!h?Yw(f):0,{left:v,top:y,width:b,height:C}=f.getBoundingClientRect(),{width:S,height:R}=ZV(sF,this).getSize(),{innerWidth:E,innerHeight:T}=this.hot.rootWindow,M=this.hot.rootDocument.documentElement;let x=v+u.scrollX+p,H=y+u.scrollY+w;this.hot.isRtl()&&(x-=S+p),this.hot.isLtr()&&v+b+S>E?x=v+u.scrollX-S-1:this.hot.isRtl()&&x<-(M.scrollWidth-M.clientWidth)&&(x=v+u.scrollX+p+1),y+R>T&&(H-=R-C+1),ZV(sF,this).setPosition(x,H),ZV(sF,this).setReadOnlyState(this.getCommentMeta(o,r,iF)),ZV(sF,this).observeSize()}focusEditor(){ZV(sF,this).focus()}updateCommentMeta(t,e,n){const i=this.hot.getCellMeta(t,e)[tF];let o;i?(o=Uv(i),zv(o,n)):o=n,this.hot.setCellMeta(t,e,tF,o)}getCommentMeta(t,e,n){const i=this.hot.getCellMeta(t,e);if(i[tF])return i[tF][n]}addToContextMenu(t){var e;t.items.push({name:OV},(e=this,{key:"commentsAddEdit",name(){var t;const n=null===(t=this.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return null!=n&&n.isCell()&&e.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(uH):this.getTranslatedPhrase(cH)},callback(){const t=this.getSelectedRangeLast();e.setRange(t),e.show(),e.focusEditor()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}),function(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(dH)},callback(){this.getSelectedRangeLast().forAll(((e,n)=>{e>=0&&n>=0&&t.removeCommentAtCell(e,n,!1)})),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this),function(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(gH);return kV(this.getSelectedRange(),((e,n)=>t.getCommentMeta(e,n,iF)))?HV(e):e},callback(){this.getSelectedRangeLast().forAll(((e,n)=>{if(e>=0&&n>=0){const i=!!t.getCommentMeta(e,n,iF);t.updateCommentMeta(e,n,{[iF]:!i})}}))},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this))}getEditorInputElement(){return ZV(sF,this).getInputElement()}destroy(){var t,e;null===(t=ZV(sF,this))||void 0===t||t.destroy(),null===(e=ZV(lF,this))||void 0===e||e.destroy(),super.destroy()}}function fF(t){if(this.hot.view&&this.hot.view._wt&&!ZV(aF,this)&&!this.targetIsCommentTextArea(t)){const e=yw(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function mF(t){const{rootDocument:e}=this.hot;if(!(ZV(aF,this)||ZV(sF,this).isFocused()||Tw(t.target,"wtBorder")||ZV(cF,this)===t.target)&&ZV(sF,this))if(qV(cF,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const e=this.hot._createCellRange(this.hot.getCoords(t.target));ZV(lF,this).show(e)}else Cw(t.target,e)&&!this.targetIsCommentTextArea(t)&&ZV(lF,this).hide()}function pF(){qV(aF,this,!1)}function wF(t,e){e[tF]&&e[tF][eF]&&Mw(t,e.commentedCellClassName)}function vF(){qV(uF,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function yF(){qV(uF,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(rF)}function bF(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[nF]:{width:t,height:e}})}function CF(t){ZV(sF,this).isFocused()&&by(t)}function SF(){ZV(hF,this)||this.hide()}function RF(){const t=ZV(sF,this).getEditorElement();xw(t,/ht-theme-.*/g),Mw(t,this.hot.getCurrentThemeName())}var EF=_t,TF=TypeError,MF=oe,xF=ki,HF=Vr,kF=function(t,e){if(!delete t[e])throw new TF("Cannot delete property "+EF(e)+" of "+EF(t))},IF=Wr;function OF(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}yo({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}()},{unshift:function(t){var e=MF(this),n=xF(e),i=arguments.length;if(i){IF(n+i);for(var o=n;o--;){var r=o+i;o in e?e[r]=e[o]:kF(e,r)}for(var s=0;s<i;s++)e[s]=arguments[s]}return HF(e,n+i)}});class AF{constructor(t){OF(this,"hot",void 0),OF(this,"commands",{}),OF(this,"commonCallback",null),this.hot=t}registerCommand(t,e){this.commands[t]=e}setCommonCallback(t){this.commonCallback=t}execute(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];const o=t.split(":"),r=o[0],s=2===o.length?o[1]:null;let l=this.commands[r];if(!l)throw new Error(`Menu command '${r}' not exists.`);if(s&&l.submenu&&(l=function(t,e){let n;return Np(e,(e=>{const i=e.key?e.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=e,!1})),n}(s,l.submenu.items)),!0===l.disabled)return;if("function"==typeof l.disabled&&!0===l.disabled.call(this.hot))return;if(ty(l,"submenu"))return;const a=[];"function"==typeof l.callback&&a.push(l.callback),"function"==typeof this.commonCallback&&a.push(this.commonCallback),n.unshift(o.join(":")),Np(a,(t=>t.apply(this.hot,n)))}}function _F(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class PF{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;_F(this,"hot",void 0),_F(this,"predefinedItems",$V()),_F(this,"defaultOrderPattern",void 0),this.hot=t,this.defaultOrderPattern=e}setPredefinedItems(t){const e={};this.defaultOrderPattern.length=0,qv(t,((t,n)=>{let i="";t.name===OV?(e[OV]=t,i=OV):isNaN(parseInt(n,10))?(t.key=void 0===t.key?n:t.key,e[n]=t,i=t.key):(e[t.key]=t,i=t.key),this.defaultOrderPattern.push(i)})),this.predefinedItems=e}getItems(){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=[];let o=t;o&&o.items?o=o.items:Array.isArray(o)||(o=e);Kv(o)?qv(o,((t,e)=>{let o=n["string"==typeof t?t:e];o||(o=t),Kv(t)?Bv(o,t):"string"==typeof o&&(o={name:o}),void 0===o.key&&(o.key=e),i.push(o)})):Np(o,((t,e)=>{let o=n[t];!o&&UV.indexOf(t)>=0||(o||(o={name:t,key:`${e}`}),Kv(t)&&Bv(o,t),void 0===o.key&&(o.key=e),i.push(o))}));return i}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}function NF(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class DF{constructor(t,e){NF(this,"top",void 0),NF(this,"topRelative",void 0),NF(this,"left",void 0),NF(this,"leftRelative",void 0),NF(this,"scrollTop",void 0),NF(this,"scrollLeft",void 0),NF(this,"cellHeight",void 0),NF(this,"cellWidth",void 0);const n=e.scrollY,i=e.scrollX;let o,r,s,l,a,h;this.rootWindow=e,this.type=this.getSourceType(t),"literal"===this.type?(o=parseInt(t.top,10),s=parseInt(t.left,10),a=t.height||0,h=t.width||0,r=o,l=s,o+=n,s+=i):"event"===this.type&&(o=parseInt(t.pageY,10),s=parseInt(t.pageX,10),a=t.target.clientHeight,h=t.target.clientWidth,r=o-n,l=s-i),this.top=o,this.topRelative=r,this.left=s,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=a,this.cellWidth=h}getSourceType(t){let e="literal";return t instanceof Event&&(e="event"),e}fitsAbove(t){return this.topRelative>=t.offsetHeight}fitsBelow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}fitsOnRight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}fitsOnLeft(t){return this.leftRelative>=t.offsetWidth}}function LF(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function VF(t,e){return t.get(WF(t,e))}function FF(t,e,n){return t.set(WF(t,e),n),n}function WF(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jF=new WeakMap,BF=new WeakMap,zF=new WeakMap,UF=new WeakMap,YF=new WeakMap;class $F{constructor(t){LF(this,jF,void 0),LF(this,BF,void 0),LF(this,zF,void 0),LF(this,UF,!1),LF(this,YF,{above:0,below:0,left:0,right:0}),FF(UF,this,t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return VF(YF,this)[t]=e,this}setElement(t){return FF(jF,this,t),this}setParentElement(t){return FF(BF,this,t),this}updatePosition(t){FF(zF,this,new DF(t,VF(jF,this).ownerDocument.defaultView)),VF(UF,this)?(VF(zF,this).fitsBelow(VF(jF,this))?this.setPositionBelowCursor():VF(zF,this).fitsAbove(VF(jF,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===VF(jF,this).dir?VF(zF,this).fitsOnLeft(VF(jF,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():VF(zF,this).fitsOnRight(VF(jF,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let t=VF(YF,this).above+VF(zF,this).top-VF(jF,this).offsetHeight;VF(BF,this)&&(t=VF(zF,this).top+VF(zF,this).cellHeight-VF(jF,this).offsetHeight+3),VF(jF,this).style.top=`${t}px`}setPositionBelowCursor(){let t=VF(YF,this).below+VF(zF,this).top+1;VF(BF,this)&&(t=VF(zF,this).top-1),VF(jF,this).style.top=`${t}px`}setPositionOnRightOfCursor(){let t=VF(zF,this).left;if(VF(BF,this)){const e=VF(BF,this).ownerDocument.defaultView,n=Number.parseInt(e.getComputedStyle(VF(BF,this).querySelector(".htCore")).borderRightWidth,10);t+=VF(zF,this).cellWidth+n}else t+=VF(YF,this).right;VF(jF,this).style.left=`${t}px`}setPositionOnLeftOfCursor(){let t=VF(YF,this).left+VF(zF,this).left-VF(jF,this).offsetWidth;if(VF(BF,this)){const e=VF(BF,this).ownerDocument.defaultView;t-=Number.parseInt(e.getComputedStyle(VF(BF,this).querySelector(".htCore")).borderLeftWidth,10)}VF(jF,this).style.left=`${t}px`}}function GF(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:i=()=>{},onClear:o=()=>{}}=t;const r=new Set;let s=jC(e,-1,a()-1);function l(t,e){const n=a()-1;if(t<0&&(t=n),t>n&&(t=0),r.has(t))return-1;r.add(t);return!1===i(t,!1)&&(t=l(1===e?++t:--t,e)),t}function a(){return Math.max(n(),0)}return{setCurrentPage:function(t){t>-1&&t<a()&&!1!==i(t,!0)&&(s=t)},getCurrentPage:function(){return s},toFirstItem:function(){a()>0&&(r.clear(),s=l(0,1))},toLastItem:function(){a()>0&&(r.clear(),s=l(a()-1,-1))},toNextItem:function(){a()>0&&(r.clear(),s=l(++s,1))},toPreviousItem:function(){a()>0&&(r.clear(),s=l(--s,-1))},getSize:a,clear:function(){r.clear(),s=e,o()}}}function KF(t){return ty(t,"submenu")}function XF(t){return new RegExp(OV,"i").test(t.name)}function qF(t,e){return!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(e)}function ZF(t){return ty(t,"disableSelection")}function QF(t,e){const n=t.slice(0);for(let i=0;i<n.length&&n[i].name===e;)n.shift();return n}function JF(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:OV,n=t.slice(0);return n=QF(n,e),n=function(t,e){let n=t.slice(0);return n.reverse(),n=QF(n,e),n.reverse(),n}(n,e),n=function(t){const e=[];return Np(t,((t,n)=>{n>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)})),e}(n),n}function tW(t){return GF({size:()=>t.countRows(),onItemSelect(e,n){const i=t.getCell(e,0);if(!i||function(t){return Tw(t,"htSeparator")}(i)||function(t){return Tw(t,"htDisabled")}(i)||function(t){return Tw(t,"htSelectionDisabled")}(i))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}const eW="menu",nW=eW;function iW(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function oW(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rW(t,e,n){return t.set(lW(t,e),n),n}function sW(t,e){return t.get(lW(t,e))}function lW(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var aW=new WeakMap,hW=new WeakMap,cW=new WeakMap;class uW{get tableBorderWidth(){return void 0===sW(cW,this)&&this.hotMenu&&rW(cW,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),sW(cW,this)}constructor(t,e){var n=this;oW(this,"hot",void 0),oW(this,"options",void 0),oW(this,"eventManager",new Sb(this)),oW(this,"container",void 0),oW(this,"positioner",void 0),oW(this,"hotMenu",null),oW(this,"hotSubMenus",{}),oW(this,"parentMenu",void 0),oW(this,"menuItems",null),oW(this,"origOutsideClickDeselects",null),iW(this,aW,void 0),iW(this,hW,void 0),iW(this,cW,void 0),this.hot=t,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new $F(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n.parentMenu.runLocalHooks("afterSelectionChange",...e)})),this.hot.addHook("afterSetTheme",((t,e)=>{var n;e||(null===(n=this.hotMenu)||void 0===n||n.useTheme(t))}))}registerEvents(){let t=this.hot.rootWindow;for(;t;)this.eventManager.addEventListener(t.document,"mousedown",(t=>this.onDocumentMouseDown(t))),this.eventManager.addEventListener(t.document,"touchstart",(t=>this.onDocumentMouseDown(t))),this.eventManager.addEventListener(t.document,"contextmenu",(t=>this.onDocumentContextMenu(t))),t=vw(t)}setMenuItems(t){this.menuItems=t}getNavigator(){return sW(aW,this)}getKeyboardShortcutsCtrl(){return sW(hW,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const t=lv((t=>this.openSubMenu(t)),300),e=this.options.minWidth||215;let n=!1,i=_p(this.menuItems,(t=>(t.key===BV&&(n=!0),function(t,e){return!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))}(t,this.hot))));if(i.length<1&&!n)i.push($V()[BV]);else if(0===i.length)return;i=JF(i,OV);let o=!1;const r={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:t=>jp(t)&&t<e?e:t,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(s=this.hot,(t,e,n,i,o,r)=>{const l=t.getSourceDataAtRow(n),a=s.rootDocument.createElement("div"),h="function"==typeof r?r.call(s):r,c="function"==typeof l.ariaLabel?l.ariaLabel.call(s):l.ariaLabel,u="function"==typeof l.ariaChecked?l.ariaChecked.call(s):l.ariaChecked;if(Ow(e),Mw(a,"htItemWrapper"),s.getSettings().ariaTags){const t=!qF(l,s)&&!ZF(l)&&!XF(l);Hw(e,[...(d=l,!0===d.checkable?[["role","menuitemcheckbox"],lw(c),fw(u)]:[["role","menuitem"],lw(h)]),...t?[sw(-1)]:[],...qF(l,s)?[["aria-disabled","true"]]:[],...KF(l)?[gw(!1)]:[]])}var d;e.className="",e.appendChild(a),XF(l)?Mw(e,"htSeparator"):"function"==typeof l.renderer?(Mw(e,"htCustomMenuRenderer"),e.appendChild(l.renderer(t,a,n,i,o,h))):_w(a,h),qF(l,s)?Mw(e,"htDisabled"):ZF(l)?Mw(e,"htSelectionDisabled"):KF(l)&&Mw(e,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeOnCellMouseOver:(t,e)=>{sW(aW,this).setCurrentPage(e.row)},afterOnCellMouseOver:(e,n)=>{this.isAllSubMenusClosed()?t(n.row):this.openSubMenu(n.row)},rowHeights:t=>i[t].name===OV?1:void 0,afterOnCellContextMenu:t=>{t.preventDefault(),fy()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(t,e,n,i,o)=>{this.hotMenu.view.isMouseDown()&&(o.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:t=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(t))},afterOnCellMouseUp:t=>{fy()&&Sy(t)||!o||!this.hasSelectedItem()||(uy()||gy()?this.hot._registerTimeout((()=>this.close(!0)),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};var s;this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,r),this.hotMenu.addHook("afterInit",(()=>this.onAfterInit())),this.hotMenu.init(),rW(aW,this,tW(this.hotMenu)),rW(hW,this,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=[];function i(t,e){s(e).addShortcuts(t,{group:eW})}function o(t,e){const o=s(e);t.forEach((t=>{let{keys:e}=t;e.forEach((t=>o.removeShortcutsByKeys(t)))})),n.push({shortcuts:t,contextName:e}),i(t,e)}function r(t){return t?`${nW}:${t}`:nW}function s(e){var n;const i=t.hotMenu.getShortcutManager(),o=r(e);return null!==(n=i.getContext(o))&&void 0!==n?n:i.addContext(o)}return i(function(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const o=e.getSettings(),r="function"==typeof o.tabMoves?o.tabMoves(n):o.tabMoves;i.includes("shift")?e.selection.transformStart(-r.row,-r.col):e.selection.transformStart(r.row,r.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=n.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}(t)),e.forEach((t=>{let{shortcuts:e,contextName:n}=t;o(e,n)})),{addCustomShortcuts:o,getCustomShortcuts:function(){return[...n]},getContext:s,listen:function(e){t.hotMenu.getShortcutManager().setActiveContextName(r(e))}}}(this)),sW(hW,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",(()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this))),this.runLocalHooks("afterOpen",this)}close(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened())if(t&&this.isSubMenu())this.parentMenu.close();else if(sW(aW,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){Hw(this.parentMenu.hotMenu.getCell(t[0],0),[gw(!1)])}}this.parentMenu.hotMenu.listen()}}openSubMenu(t){if(!this.hotMenu)return!1;const e=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!e||!function(t){return Tw(t,"htSubmenu")}(e))return!1;const n=this.hotMenu.getSourceDataAtRow(t),i=new uW(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(e.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&Hw(e,[gw(!0)]),i}closeSubMenu(t){const e=this.hotMenu.getSourceDataAtRow(t),n=this.hotSubMenus[e.key];if(n){n.destroy(),delete this.hotSubMenus[e.key];const i=this.hotMenu.getCell(t,0);this.hot.getSettings().ariaTags&&Hw(i,[gw(!1)])}}closeAllSubMenus(){Np(this.hotMenu.getData(),((t,e)=>this.closeSubMenu(e)))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;const e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),this.isCommandPassive(e))return;const n=this.hot.getSelectedRange(),i=n?function(t){return Pp(t,(t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()})))}(n):[];this.runLocalHooks("executeCommand",e.key,i,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,i,t)}isCommandPassive(t){return!1===t.isCommand||XF(t)||qF(t,this.hot)||KF(t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(t,e)}setPosition(t){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(t)}updateMenuDimensions(){const{wtTable:t}=this.hotMenu.view._wt,e=this.hotMenu.getSettings().data,n=t.hider.style,i=t.holder.style,o=parseInt(n.width,10),r=Ap(e,((t,e,n)=>{const i=this.hotMenu.getCell(n,0)?Yw(this.hotMenu.getCell(n,0)):0;return t+(e.name===OV?1:i)}),0);i.width=`${o}px`,i.height=`${r}px`,n.height=i.height}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.options.container.ownerDocument;let n,i=t;return i&&(sv(i)&&(i=i.call(this.hot),i=null===i||Bp(i)?"":i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,n=e.querySelector(`.${this.options.className}.${i}`)),n||(n=e.createElement("div"),Mw(n,`htMenu ${this.options.className}`),i&&Mw(n,i),this.options.container.appendChild(n)),n}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Hw(this.hotMenu.rootElement,[["role","menu"],sw(-1)])}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Cw(t.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Cw(t.target,".htMenu")||this.close(!0))}onDocumentContextMenu(t){this.isOpened()&&Tw(t.target,"htCore")&&Cw(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}function dW(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function gW(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fW(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}$v(uW,UE);const mW="contextMenu",pW=mW;lb.getSingleton().register("afterContextMenuDefaultOptions"),lb.getSingleton().register("beforeContextMenuShow"),lb.getSingleton().register("afterContextMenuShow"),lb.getSingleton().register("afterContextMenuHide"),lb.getSingleton().register("afterContextMenuExecute");var wW=new WeakSet;class vW extends xN{constructor(){super(...arguments),dW(this,wW),gW(this,"commandExecutor",new AF(this.hot)),gW(this,"itemsFactory",null),gW(this,"menu",null)}static get PLUGIN_KEY(){return mW}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[WV,jV,OV,PV,NV,OV,FV,VV,OV,zV,LV,OV,DV,OV,AV]}isEnabled(){return!!this.hot.getSettings()[mW]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[mW];"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new uW(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(()=>fW(wW,this,bW).call(this))),this.menu.addLocalHook("afterOpen",(()=>fW(wW,this,CW).call(this))),this.menu.addLocalHook("afterClose",(()=>fW(wW,this,SW).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.executeCommand.call(t,...n)})),this.addHook("afterOnCellContextMenu",(t=>fW(wW,this,yW).call(this,t))),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const e=this.hot.getCell(t.row,t.col,!0).getBoundingClientRect(),n=IV(this.menu.container,this.hot.rootDocument);this.open({left:e.left+n.left,top:e.top+n.top-1+e.height},{left:e.width,above:-e.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&!this.menu.isOpened()},group:pW})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(pW)}open(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};if(null!==(e=this.menu)&&void 0!==e&&e.isOpened())return;this.prepareMenuItems(),this.menu.open();this.menu.tableBorderWidth>0||(n.below+=1,n.right+=1,n.above-=1,n.left-=1),qv(n,((t,e)=>{this.menu.setOffset(e,t)})),this.menu.setPosition(t)}close(){var t;null===(t=this.menu)||void 0===t||t.close(),this.itemsFactory=null}executeCommand(t){null===this.itemsFactory&&this.prepareMenuItems();for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.commandExecutor.execute(t,...n)}prepareMenuItems(){this.itemsFactory=new PF(this.hot,vW.DEFAULT_ITEMS);const t=this.hot.getSettings()[mW],e={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",e),this.itemsFactory.setPredefinedItems(e.items);const n=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),Np(n,(t=>this.commandExecutor.registerCommand(t.key,t)))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function yW(t){const e=this.hot.getSettings(),n=e.rowHeaders,i=e.colHeaders;const o=t.target;if(this.close(),Tw(o,"handsontableInput"))return;if(t.preventDefault(),t.stopPropagation(),!n&&!i&&!(r=o,"TD"===r.nodeName||"TD"===r.parentNode.nodeName||Tw(o,"current")&&Tw(o,"wtBorder")))return;var r;const s=IV(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function bW(){this.hot.runHooks("beforeContextMenuShow",this)}function CW(){this.hot.runHooks("afterContextMenuShow",this)}function SW(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}vW.SEPARATOR={name:OV};class RW{constructor(){this.data={}}setData(t,e){this.data[t]=e}getData(t){return this.data[t]||void 0}}class EW{constructor(){this.clipboardData=new RW}preventDefault(){}}function TW(t,e,n){MW(t,e),e.set(t,n)}function MW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xW(t,e){return t.get(kW(t,e))}function HW(t,e,n){return t.set(kW(t,e),n),n}function kW(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var IW=new WeakMap,OW=new WeakMap,AW=new WeakMap,_W=new WeakMap,PW=new WeakMap,NW=new WeakMap,DW=new WeakSet;class LW{constructor(t){let{countRows:e,countColumns:n,rowsLimit:i,columnsLimit:o,countColumnHeaders:r}=t;var s,l;MW(s=this,l=DW),l.add(s),TW(this,IW,void 0),TW(this,OW,void 0),TW(this,AW,void 0),TW(this,_W,void 0),TW(this,PW,void 0),TW(this,NW,void 0),HW(OW,this,e),HW(AW,this,n),HW(_W,this,i),HW(PW,this,o),HW(NW,this,r)}setSelectedRange(t){HW(IW,this,t)}getCellsRange(){if(0===xW(OW,this).call(this)||0===xW(AW,this).call(this))return null;const{row:t,col:e}=xW(IW,this).getTopStartCorner(),{row:n,col:i}=xW(IW,this).getBottomEndCorner(),o=kW(DW,this,FW).call(this,t,n),r=kW(DW,this,VW).call(this,e,i);return{isRangeTrimmed:n!==o||i!==r,startRow:t,startCol:e,endRow:o,endCol:r}}getMostBottomColumnHeadersRange(){if(0===xW(AW,this).call(this)||0===xW(NW,this).call(this))return null;const{col:t}=xW(IW,this).getTopStartCorner(),{col:e}=xW(IW,this).getBottomEndCorner(),n=kW(DW,this,VW).call(this,t,e);return{isRangeTrimmed:e!==n,startRow:-1,startCol:t,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(0===xW(AW,this).call(this)||0===xW(NW,this).call(this))return null;const{col:t}=xW(IW,this).getTopStartCorner(),{col:e}=xW(IW,this).getBottomEndCorner(),n=kW(DW,this,VW).call(this,t,e);return{isRangeTrimmed:e!==n,startRow:-xW(NW,this).call(this),startCol:t,endRow:-1,endCol:n}}}function VW(t,e){return Math.min(e,Math.max(t+xW(PW,this).call(this)-1,t))}function FW(t,e){return Math.min(e,Math.max(t+xW(_W,this).call(this)-1,t))}function WW(t){const e=[],n=[];return Np(t,(t=>{VC(Math.min(t.startRow,t.endRow),Math.max(t.startRow,t.endRow),(t=>{-1===e.indexOf(t)&&e.push(t)}));VC(Math.min(t.startCol,t.endCol),Math.max(t.startCol,t.endCol),(t=>{-1===n.indexOf(t)&&n.push(t)}))})),{rows:e,columns:n}}function jW(t,e,n){BW(t,e),e.set(t,n)}function BW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zW(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UW(t,e){return t.get($W(t,e))}function YW(t,e,n){return t.set($W(t,e),n),n}function $W(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}lb.getSingleton().register("afterCopyLimit"),lb.getSingleton().register("modifyCopyableRange"),lb.getSingleton().register("beforeCut"),lb.getSingleton().register("afterCut"),lb.getSingleton().register("beforePaste"),lb.getSingleton().register("afterPaste"),lb.getSingleton().register("beforeCopy"),lb.getSingleton().register("afterCopy");const GW="copyPaste",KW=["fragmentSelection"],XW=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var qW=new WeakMap,ZW=new WeakMap,QW=new WeakMap,JW=new WeakMap,tj=new WeakMap,ej=new WeakMap,nj=new WeakMap,ij=new WeakMap,oj=new WeakSet;class rj extends xN{constructor(){var t,e;super(...arguments),BW(t=this,e=oj),e.add(t),zW(this,"columnsLimit",Infinity),zW(this,"rowsLimit",Infinity),zW(this,"pasteMode","overwrite"),zW(this,"uiContainer",this.hot.rootDocument.body),jW(this,qW,!1),jW(this,ZW,!1),jW(this,QW,!1),jW(this,JW,"cells-only"),jW(this,tj,!1),jW(this,ej,!1),jW(this,nj,new LW({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),jW(this,ij,!1),zW(this,"copyableRanges",[])}static get PLUGIN_KEY(){return GW}static get SETTING_KEYS(){return[GW,...KW]}static get PLUGIN_PRIORITY(){return 80}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:Infinity,columnsLimit:Infinity,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[GW]}enablePlugin(){var t,e,n=this;this.enabled||(this.pasteMode=null!==(t=this.getSetting("pasteMode"))&&void 0!==t?t:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),YW(qW,this,this.getSetting("copyColumnHeaders")),YW(ZW,this,this.getSetting("copyColumnGroupHeaders")),YW(QW,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=null!==(e=this.getSetting("uiContainer"))&&void 0!==e?e:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",(t=>$W(oj,this,cj).call(this,t))),this.addHook("afterSelection",(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return $W(oj,n,uj).call(n,...e)})),this.addHook("afterSelectionEnd",(()=>$W(oj,this,dj).call(this))),this.eventManager.addEventListener(this.hot.rootDocument,"copy",(function(){return n.onCopy(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"cut",(function(){return n.onCut(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"paste",(function(){return n.onPaste(...arguments)})),cy()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return $W(oj,n,gj).call(n,...e)})),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return $W(oj,n,fj).call(n,...e)})),this.addHook("afterSelection",(()=>$W(oj,this,mj).call(this)))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){YW(JW,this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only"),YW(tj,this,!0),$W(oj,this,sj).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){YW(ej,this,!0),$W(oj,this,sj).call(this,"cut")}getRangedCopyableData(t){return _I(this.getRangedData(t))}getRangedData(t){const e=[],{rows:n,columns:i}=WW(t);return Np(n,(t=>{const n=[];Np(i,(e=>{t<0?n.push(this.hot.getColHeader(e,t)):n.push(this.hot.getCopyableData(t,e))})),e.push(n)})),e}paste(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t&&!e)return;const n=new EW;t&&n.clipboardData.setData("text/plain",t),e&&n.clipboardData.setData("text/html",e),this.onPaste(n)}setCopyableText(){const t=this.hot.getSelectedRangeLast();if(!t)return;if(t.isSingleHeader())return void(this.copyableRanges=[]);UW(nj,this).setSelectedRange(t);const e=new Map([["headers",null],["cells",null]]);"column-headers-only"===UW(JW,this)?e.set("headers",UW(nj,this).getMostBottomColumnHeadersRange()):("with-column-headers"===UW(JW,this)?e.set("headers",UW(nj,this).getMostBottomColumnHeadersRange()):"with-column-group-headers"===UW(JW,this)&&e.set("headers",UW(nj,this).getAllColumnHeadersRange()),e.set("cells",UW(nj,this).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter((t=>null!==t)).map((t=>{let{startRow:e,startCol:n,endRow:i,endCol:o}=t;return{startRow:e,startCol:n,endRow:i,endCol:o}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=e.get("cells");if(null!==n&&n.isRangeTrimmed){const{startRow:t,startCol:e,endRow:i,endCol:o}=n;this.hot.runHooks("afterCopyLimit",i-t+1,o-e+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}populateValues(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!t.length)return;const n=t.length,i=t[0].length,o=[],{row:r,col:s}=e.getTopStartCorner(),{row:l,col:a}=e.getBottomEndCorner();let h=r,c=s,u=r,d=s;for(;o.length<n||h<=l;){const{skipRowOnPaste:e,visualRow:l}=this.hot.getCellMeta(h,s);if(h=l+1,!0===e)continue;u=l,c=s;const g=[],f=o.length%n;for(;g.length<i||c<=a;){const{skipColumnOnPaste:e,visualCol:n}=this.hot.getCellMeta(r,c);if(c=n+1,!0===e)continue;d=n;const o=g.length%i;g.push(t[f][o])}o.push(g)}return YW(ij,this,!0),this.hot.populateFromArray(r,s,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[r,s,u,d]}onCopy(t){var e;const n=this.hot.getFocusManager().getRefocusElement(),i=null===(e=t.target)||void 0===e?void 0:e.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!UW(tj,this)||this.isEditorOpened()||t.target instanceof HTMLElement&&(i&&t.target!==n||!i&&t.target!==this.hot.rootDocument.body))return;t.preventDefault(),this.setCopyableText(),YW(tj,this,!1);const o=this.getRangedData(this.copyableRanges),r=$W(oj,this,lj).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,r)){const e=_I(o);if(t&&t.clipboardData){const n=DC(o,this.hot.rootDocument);t.clipboardData.setData("text/plain",e),t.clipboardData.setData("text/html",[XW,n].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",e);this.hot.runHooks("afterCopy",o,this.copyableRanges,r)}YW(JW,this,"cells-only")}onCut(t){var e;const n=this.hot.getFocusManager().getRefocusElement(),i=null===(e=t.target)||void 0===e?void 0:e.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!UW(ej,this)||this.isEditorOpened()||t.target instanceof HTMLElement&&(i&&t.target!==n||!i&&t.target!==this.hot.rootDocument.body))return;t.preventDefault(),this.setCopyableText(),YW(ej,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const e=_I(o);if(t&&t.clipboardData){const n=DC(o,this.hot.rootDocument);t.clipboardData.setData("text/plain",e),t.clipboardData.setData("text/html",[XW,n].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",e);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(t){var e;const n=this.hot.getFocusManager().getRefocusElement(),i=null===(e=t.target)||void 0===e?void 0:e.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||t.target instanceof HTMLElement&&(i&&t.target!==n||!i&&t.target!==this.hot.rootDocument.body))return;let o;if(t.preventDefault(),t&&void 0!==t.clipboardData){const e=rw(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(e&&/(<table)|(<TABLE)/g.test(e)){const t=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const n={},i=e.createDocumentFragment(),o=e.createElement("div");i.appendChild(o);let r=t;if("string"==typeof r){const t=r.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(t=>{const e=t.match(/<td\b[^>]*?>/g)[0];return`${e}${t.substring(e.length,t.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(/<p.*?>/g,"\n").replace("\n","").replaceAll(/<\/(.*)>\s+$/gm,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/gm,"")}</td>`}));o.insertAdjacentHTML("afterbegin",`${t}`),r=o.querySelector("table")}if(!r||!function(t){return"TABLE"===(t&&t.nodeName||"")}(r))return;const s=o.querySelector('meta[name$="enerator"]'),l=null!==r.querySelector("tbody th"),a=r.querySelector("tr"),h=a?Array.from(a.cells).reduce(((t,e)=>t+e.colSpan),0)-(l?1:0):0,c=r.tFoot&&Array.from(r.tFoot.rows)||[],u=[];let d=!1,g=0,f=0;if(r.tHead){const t=Array.from(r.tHead.rows).filter((t=>{const e=null!==t.querySelector("td");return e&&u.push(t),!e}));g=t.length,d=g>0,g>1?n.nestedHeaders=Array.from(t).reduce(((t,e)=>{const n=Array.from(e.cells).reduce(((t,e,n)=>{if(l&&0===n)return t;const{colSpan:i,innerHTML:o}=e,r=i>1?{label:o,colspan:i}:o;return t.push(r),t}),[]);return t.push(n),t}),[]):d&&(n.colHeaders=Array.from(t[0].children).reduce(((t,e,n)=>(l&&0===n||t.push(e.innerHTML),t)),[]))}u.length&&(n.fixedRowsTop=u.length),c.length&&(n.fixedRowsBottom=c.length);const m=[...u,...Array.from(r.tBodies).reduce(((t,e)=>(t.push(...Array.from(e.rows)),t)),[]),...c];f=m.length;const p=new Array(f);for(let y=0;y<f;y++)p[y]=new Array(h);const w=[],v=[];for(let y=0;y<f;y++){const t=m[y],e=Array.from(t.cells),n=e.length;for(let i=0;i<n;i++){const t=e[i],{nodeName:n,innerHTML:o,rowSpan:r,colSpan:l}=t,a=p[y].findIndex((t=>void 0===t));if("TD"===n){if(r>1||l>1){for(let t=y;t<y+r;t++)if(t<f)for(let e=a;e<a+l;e++)p[t][e]=null;const e=t.getAttribute("style");e&&e.includes("mso-ignore:colspan")||w.push({col:a,row:y,rowspan:r,colspan:l})}let e="";e=s&&/excel/gi.test(s.content)?o.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):o.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),p[y][a]=e.replace(PC,(t=>_C[t]))}else v.push(o)}}return w.length&&(n.mergeCells=w),v.length&&(n.rowHeaders=v),p.length&&(n.data=p),n}(e,this.hot.rootDocument);o=t.data}else o=t.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof o&&(o=function(t){const e=[[""]];if(0===t.length)return e;let n,i=0,o=0;for(;t.length>0&&n!==t.length;)if(n=t.length,t.match(AI))t=t.replace(AI,""),i+=1,e[o][i]="";else if(t.match(II))t=t.replace(II,""),i=0,o+=1,e[o]=[""];else{let n="";if(t.startsWith('"')){let e=0,i=!0;for(;i;){const o=t.slice(0,1);'"'===o&&(e+=1),n+=o,(0===(t=t.slice(1)).length||t.match(/^[\t\r\n]/)&&e%2==0)&&(i=!1)}n=n.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(t=>new Array(Math.floor(t.length/2)).fill('"').join("")))}else{const e=t.match(OI);n=e?e[0]:"",t=t.slice(n.length)}e[o][i]=n}return e}(o)),void 0===o||o&&0===o.length)return;if(!1===this.hot.runHooks("beforePaste",o,this.copyableRanges))return;const[r,s,l,a]=this.populateValues(o);this.hot.selectCell(r,s,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,a)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function sj(t){if(cy()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:i}=e.highlight,o=this.hot.getCell(n,i,!0);o&&function(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];ov(t,n),e(),rv(t,n)}(o,(()=>{this.hot.rootDocument.execCommand(t)}))}}else this.hot.rootDocument.execCommand(t)}function lj(t){const{rows:e}=WW(t);let n=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function aj(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i&&ov(i)}}}function hj(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);null!=i&&i.hasAttribute("contenteditable")&&rv(i)}}}function cj(t){var e;t.items.push({name:"---------"},(e=this,{key:"copy",name(){return this.getTranslatedPhrase(eH)},callback(){e.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1})),UW(qW,this)&&t.items.push(function(t){return{key:"copy_with_column_headers",name(){const t=this.getSelectedRangeLast(),e=t?jC(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(nH,e)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this)),UW(ZW,this)&&t.items.push(function(t){return{key:"copy_with_column_group_headers",name(){const t=this.getSelectedRangeLast(),e=t?jC(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(iH,e)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this)),UW(QW,this)&&t.items.push(function(t){return{key:"copy_column_headers_only",name(){const t=this.getSelectedRangeLast(),e=t?jC(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(oH,e)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this)),t.items.push(function(t){return{key:"cut",name(){return this.getTranslatedPhrase(rH)},callback(){t.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const t=this.getSelectedRangeLast();if(!t)return!0;if(t.isSingleHeader())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}(this))}function uj(t,e,n,i,o){UW(ij,this)&&(o.value=!0),YW(ij,this,!1)}function dj(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function gj(){$W(oj,this,hj).call(this)}function fj(){$W(oj,this,aj).call(this)}function mj(){$W(oj,this,hj).call(this)}function pj(t,e){return`border_row${t}col${e}`}function wj(t){var e,n;(jp(t.start)||jp(t.left))&&(t.start=null!==(e=t.start)&&void 0!==e?e:t.left);(jp(t.end)||jp(t.right))&&(t.end=null!==(n=t.end)&&void 0!==n?n:t.right);return delete t.left,delete t.right,t}function vj(t){return jp(t.start)&&(t.left=t.start),jp(t.end)&&(t.right=t.end),t}function yj(t,e){return{id:pj(t,e),border:{width:1,color:"#000",cornerVisible:!1},row:t,col:e,top:{hide:!0},bottom:{hide:!0},start:{hide:!0},end:{hide:!0}}}function bj(t,e){let n=!1;return Np(t.getSelectedRange(),(i=>{i.forAll(((i,o)=>{if(i<0||o<0)return;const r=t.getCellMeta(i,o).borders;if(r){if(!e)return n=!0,!1;if(!ty(r[e],"hide")||!1===r[e].hide)return n=!0,!1}}))})),n}function Cj(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}const Sj=new Map([["left","start"],["right","end"]]);function Rj(t){return{key:"borders:bottom",name(){let t=this.getTranslatedPhrase(TH);return bj(this,"bottom")&&(t=Cj(t)),t},callback(e,n){const i=bj(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function Ej(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(MH);return bj(this,e)&&(t=Cj(t)),t},callback(n,i){const o=bj(this,e);t.prepareBorder(i,e,o)}}}function Tj(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(xH)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!bj(this)}}}function Mj(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(EH);return bj(this,e)&&(t=Cj(t)),t},callback(n,i){const o=bj(this,e);t.prepareBorder(i,e,o)}}}function xj(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function Hj(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kj(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ij="customBorders";var Oj=new WeakSet;class Aj extends xN{constructor(){super(...arguments),xj(this,Oj),Hj(this,"savedBorders",[])}static get PLUGIN_KEY(){return Ij}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[Ij]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>kj(Oj,this,_j).call(this,t))),this.addHook("init",(()=>kj(Oj,this,Pj).call(this))),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(t,e){let n=["top","bottom","start","end"],i=null;e&&(this.checkSettingsCohesion([e]),n=Object.keys(e),i=wj(e));const o=pI(mI(t),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});Np(t,(t=>{o(t).forAll(((t,e)=>{Np(n,(n=>{var o,r;this.prepareBorderFromCustomAdded(t,e,i,(o=n,null!==(r=Sj.get(o))&&void 0!==r?r:o))}))}))})),this.hot.view.render()}getBorders(t){if(!Array.isArray(t))return this.savedBorders;const e=pI(mI(t),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),n=[];return Np(t,(t=>{e(t).forAll(((t,e)=>{Np(this.savedBorders,(i=>{i.row===t&&i.col===e&&n.push(vj(i))}))}))})),n}clearBorders(t){t?this.setBorders(t):(Np(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")})),this.savedBorders.length=0)}insertBorderIntoSettings(t,e){this.checkSavedBorders(t)||this.savedBorders.push(t);const n=this.hot._createCellRange(this.hot._createCellCoords(t.row,t.col));this.checkCustomSelections(t,n,e)||this.hot.selection.highlight.addCustomSelection({border:t,visualCellRange:n})}prepareBorderFromCustomAdded(t,e,n,i){const o=this.hot.countRows(),r=this.hot.countCols();if(t>=o||e>=r)return;let s=yj(t,e);var l,a;n&&(l=s,ty(a=n,"border")&&a.border&&(l.border=a.border),ty(a,"top")&&jp(a.top)&&(a.top?(Kv(a.top)||(a.top={width:1,color:"#000"}),l.top=a.top):(a.top={hide:!0},l.top=a.top)),ty(a,"bottom")&&jp(a.bottom)&&(a.bottom?(Kv(a.bottom)||(a.bottom={width:1,color:"#000"}),l.bottom=a.bottom):(a.bottom={hide:!0},l.bottom=a.bottom)),ty(a,"start")&&jp(a.start)&&(a.start?(Kv(a.start)||(a.start={width:1,color:"#000"}),l.start=a.start):(a.start={hide:!0},l.start=a.start)),ty(a,"end")&&jp(a.end)&&(a.end?(Kv(a.end)||(a.end={width:1,color:"#000"}),l.end=a.end):(a.end={hide:!0},l.end=a.end)),s=l,Np(this.hot.selection.highlight.customSelections,(t=>{if(s.id===t.settings.id)return Object.assign(t.settings,n),s.id=t.settings.id,s.top=t.settings.top,s.bottom=t.settings.bottom,s.start=t.settings.start,s.end=t.settings.end,!1}))),this.hot.setCellMeta(t,e,"borders",vj(s)),this.insertBorderIntoSettings(s,i)}prepareBorderFromCustomAddedRange(t,e){const n=Math.min(t.to.row,this.hot.countRows()-1),i=Math.min(t.to.col,this.hot.countCols()-1);VC(t.from.row,n,(n=>{VC(t.from.col,i,(i=>{const o=yj(n,i);let r=0;n===t.from.row&&ty(e,"top")&&(r+=1,o.top=e.top),n===t.to.row&&ty(e,"bottom")&&(r+=1,o.bottom=e.bottom),i===t.from.col&&ty(e,"start")&&(r+=1,o.start=e.start),i===t.to.col&&ty(e,"end")&&(r+=1,o.end=e.end),r>0&&(this.hot.setCellMeta(n,i,"borders",vj(o)),this.insertBorderIntoSettings(o))}))}))}removeAllBorders(t,e){const n=pj(t,e);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}setBorder(t,e,n,i){let o=this.hot.getCellMeta(t,e).borders;if(o=o&&void 0!==o.border?wj(o):yj(t,e),i){o[n]={hide:!0};if(4===this.countHide(o))this.removeAllBorders(t,e);else{this.checkCustomSelectionsFromContextMenu(o,n,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(t,e,"borders",vj(o))}}else{o[n]={width:1,color:"#000"};this.checkCustomSelectionsFromContextMenu(o,n,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(t,e,"borders",vj(o))}}prepareBorder(t,e,n){Np(t,(t=>{let{start:i,end:o}=t;if(i.row===o.row&&i.col===o.col)"noBorders"===e?this.removeAllBorders(i.row,i.col):this.setBorder(i.row,i.col,e,n);else switch(e){case"noBorders":VC(i.col,o.col,(t=>{VC(i.row,o.row,(e=>{this.removeAllBorders(e,t)}))}));break;case"top":VC(i.col,o.col,(t=>{this.setBorder(i.row,t,e,n)}));break;case"bottom":VC(i.col,o.col,(t=>{this.setBorder(o.row,t,e,n)}));break;case"start":VC(i.row,o.row,(t=>{this.setBorder(t,i.col,e,n)}));break;case"end":VC(i.row,o.row,(t=>{this.setBorder(t,o.col,e,n)}))}}))}createCustomBorders(t){Np(t,(t=>{const e=wj(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,e):this.prepareBorderFromCustomAdded(t.row,t.col,e)}))}countHide(t){const{top:e,bottom:n,start:i,end:o}=t;return Ap([e,n,i,o],((t,e)=>{let n=t;return e&&e.hide&&(n+=1),n}),0)}clearBordersFromSelectionSettings(t){const e=Pp(this.hot.selection.highlight.customSelections,(t=>t.settings.id)).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}clearNullCellRange(){Np(this.hot.selection.highlight.customSelections,((t,e)=>{if(null===t.cellRange)return this.hot.selection.highlight.customSelections[e].destroy(),this.hot.selection.highlight.customSelections.splice(e,1),!1}))}hideBorders(){Np(this.savedBorders,(t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange()}))}spliceBorder(t){const e=Pp(this.savedBorders,(t=>t.id)).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}checkSavedBorders(t){let e=!1;return 4===this.countHide(t)?(this.spliceBorder(t.id),e=!0):Np(this.savedBorders,((n,i)=>{if(t.id===n.id)return this.savedBorders[i]=t,e=!0,!1})),e}checkCustomSelectionsFromContextMenu(t,e,n){let i=!1;return Np(this.hot.selection.highlight.customSelections,(o=>{if(t.id===o.settings.id){return Np(this.hot.view._wt.selectionManager.getBorderInstances(o),(t=>{t.toggleHiddenClass(e,n)})),i=!0,!1}})),i}checkCustomSelections(t,e,n){const i=this.countHide(t);let o=!1;return 4===i?(this.removeAllBorders(t.row,t.col),o=!0):Np(this.hot.selection.highlight.customSelections,(i=>{if(t.id===i.settings.id){if(i.visualCellRange=e,i.commit(),n){Np(this.hot.view._wt.selectionManager.getBorderInstances(i),(e=>{e.changeBorderStyle(n,t)}))}return o=!0,!1}})),o}changeBorderSettings(){const t=this.hot.getSettings()[Ij];if(Array.isArray(t)){const e=Uv(t);this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)}else void 0!==t&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(t){const e=t.some((t=>jp(t.left)||jp(t.right)));const n=function(t){return t.some((t=>jp(t.start)||jp(t.end)))}(t);if(e&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&e)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function _j(t){var e;this.hot.getSettings()[Ij]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(SH)},disabled(){const t=this.getSelectedRangeLast();return!t||(!!t.isSingleHeader()||this.selection.isSelectedByCorner())},submenu:{items:[(e=this,{key:"borders:top",name(){let t=this.getTranslatedPhrase(RH);return bj(this,"top")&&(t=Cj(t)),t},callback(t,n){const i=bj(this,"top");e.prepareBorder(n,"top",i)}}),Mj(this),Rj(this),Ej(this),Tj(this)]}})}function Pj(){this.changeBorderSettings()}function Nj(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function Dj(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lj(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Vj="dragToScroll";var Fj=new WeakSet;class Wj extends xN{constructor(){super(...arguments),Nj(this,Fj),Dj(this,"boundaries",null),Dj(this,"callback",null),Dj(this,"listening",!1)}static get PLUGIN_KEY(){return Vj}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings()[Vj]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",(t=>Lj(Fj,this,jj).call(this,t))),this.addHook("afterOnCellCornerMouseDown",(t=>Lj(Fj,this,jj).call(this,t))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=t}setCallback(t){this.callback=t}check(t,e){let n=0,i=0;e<this.boundaries.top?i=e-this.boundaries.top:e>this.boundaries.bottom&&(i=e-this.boundaries.bottom),t<this.boundaries.left?n=t-this.boundaries.left:t>this.boundaries.right&&(n=t-this.boundaries.right),this.callback(n,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:t}=this.hot;let e=t;for(;e;)this.eventManager.addEventListener(e.document,"contextmenu",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mouseup",(()=>this.unlisten())),this.eventManager.addEventListener(e.document,"mousemove",(t=>this.onMouseMove(t))),e=vw(e)}unregisterEvents(){this.eventManager.clear()}onMouseMove(t){this.isListening()&&this.check(t.clientX,t.clientY)}destroy(){super.destroy()}}function jj(t){if(Sy(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback(((t,n)=>{var i,o;const r=null!==(i=e.scrollLeft)&&void 0!==i?i:e.scrollX,s=null!==(o=e.scrollTop)&&void 0!==o?o:e.scrollY;e.scroll(r+50*Math.sign(t),s+20*Math.sign(n))})),this.listen()}function Bj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zj(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uj(t,e,n){return t.set(Yj(t,e),n),n}function Yj(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}lb.getSingleton().register("afterDropdownMenuDefaultOptions"),lb.getSingleton().register("beforeDropdownMenuShow"),lb.getSingleton().register("afterDropdownMenuShow"),lb.getSingleton().register("afterDropdownMenuHide"),lb.getSingleton().register("afterDropdownMenuExecute");const $j="dropdownMenu",Gj="changeType",Kj=$j;var Xj=new WeakMap,qj=new WeakSet;class Zj extends xN{static get PLUGIN_KEY(){return $j}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[PV,NV,OV,VV,OV,_V,OV,DV,OV,AV]}constructor(t){var e,n;super(t),Bj(e=this,n=qj),n.add(e),zj(this,"commandExecutor",new AF(this.hot)),zj(this,"itemsFactory",null),zj(this,"menu",null),function(t,e,n){Bj(t,e),e.set(t,n)}(this,Xj,!1),this.hot.addHook("afterGetColHeader",((t,e)=>Yj(qj,this,tB).call(this,t,e)))}isEnabled(){return this.hot.getSettings()[$j]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new PF(this.hot,Zj.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Yj(qj,t,sB).call(t,...n)})),this.addHook("beforeViewportScrollHorizontally",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Yj(qj,t,rB).call(t,...n)}));const e=this.hot.getSettings()[$j],n={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady((()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(e);this.menu&&this.menu.destroy(),this.menu=new uW(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",(()=>Yj(qj,this,eB).call(this))),this.menu.addLocalHook("afterOpen",(()=>Yj(qj,this,nB).call(this))),this.menu.addLocalHook("afterSubmenuOpen",(t=>Yj(qj,this,iB).call(this,t))),this.menu.addLocalHook("afterClose",(()=>Yj(qj,this,oB).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.executeCommand.call(t,...n)})),Np(i,(t=>this.commandExecutor.registerCommand(t.key,t)))}))}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const t=()=>{const{highlight:t}=this.hot.getSelectedRangeLast();if((t.isHeader()&&-1===t.row||t.isCell())&&t.col>=0){this.hot.selectColumns(t.col,t.col,-1);const{from:e}=this.hot.getSelectedRangeLast(),n=IV(this.menu.container,this.hot.rootDocument),i=this.hot.getCell(-1,e.col,!0).querySelector(`.${Gj}`),o=i.getBoundingClientRect();this.open({left:o.left+n.left,top:o.top+i.offsetHeight+n.top},{left:o.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};this.hot.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Kj},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isCell()&&!this.menu.isOpened()},group:Kj}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Kj)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",(t=>Yj(qj,this,Jj).call(this,t)))}open(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.menu.open(),qv(n,((t,e)=>{this.menu.setOffset(e,t)})),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close()}executeCommand(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.commandExecutor.execute(t,...n)}setListening(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Qj(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Jj(t){if(Tw(t.target,Gj)){const e=IV(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),Uj(Xj,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function tB(t,e){const n=e.parentNode;if(!n)return;const i=n.parentNode.childNodes,o=Array.prototype.indexOf.call(i,n);if(t<0||o!==i.length-1)return;const r=e.querySelector(`.${Gj}`);if(this.enabled&&r)return;if(!this.enabled)return void(r&&r.parentNode.removeChild(r));const s=this.hot.rootDocument.createElement("button");s.className=Gj,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Hw(s,[["aria-hidden","true"],lw(" ")]),Hw(e,[aw("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function eB(){this.hot.runHooks("beforeDropdownMenuShow",this)}function nB(){this.hot.runHooks("afterDropdownMenuShow",this),Yj(qj,this,Qj).call(this,this.menu)}function iB(t){Yj(qj,this,Qj).call(this,t)}function oB(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function rB(t){return n=this,(e=Xj).get(Yj(e,n))?null:t;var e,n}function sB(t){Tw(t.target,Gj)&&Uj(Xj,this,!0)}function lB(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Zj.SEPARATOR={name:OV};const aB=class{constructor(t){lB(this,"hot",void 0),lB(this,"options",{}),this.hot=t}setOptions(t){this.options=t}getData(){const{startRow:t,startCol:e,endRow:n,endCol:i}=this._getDataRange(),o=this.options,r=[];return VC(t,n,(t=>{const n=[];!o.exportHiddenRows&&this._isHiddenRow(t)||(VC(e,i,(e=>{!o.exportHiddenColumns&&this._isHiddenColumn(e)||n.push(this.hot.getDataAtCell(t,e))})),r.push(n))})),r}getRowHeaders(){const t=[];if(this.options.rowHeaders){const{startRow:e,endRow:n}=this._getDataRange(),i=this.hot.getRowHeader();VC(e,n,(e=>{!this.options.exportHiddenRows&&this._isHiddenRow(e)||t.push(i[e])}))}return t}getColumnHeaders(){const t=[];if(this.options.columnHeaders){const{startCol:e,endCol:n}=this._getDataRange(),i=this.hot.getColHeader();VC(e,n,(e=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(e)||t.push(i[e])}))}return t}_getDataRange(){const t=this.hot.countCols()-1,e=this.hot.countRows()-1;let[n=0,i=0,o=e,r=t]=this.options.range;return n=Math.max(n,0),i=Math.max(i,0),o=Math.min(o,e),r=Math.min(r,t),{startRow:n,startCol:i,endRow:o,endCol:r}}_isHiddenRow(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}_isHiddenColumn(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}};function hB(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class cB{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(t,e){hB(this,"dataProvider",void 0),hB(this,"options",void 0),this.dataProvider=t,this.options=this._mergeOptions(e),this.dataProvider.setOptions(this.options)}_mergeOptions(t){let e=Yv(this.constructor.DEFAULT_OPTIONS);const n=new Date;return e=Bv(Yv(cB.DEFAULT_OPTIONS),e),e=Bv(e,t),e.filename=iw(e.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),e}}const uB=cB,dB=String.fromCharCode(13),gB=String.fromCharCode(34),fB=String.fromCharCode(10);const mB=class extends uB{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const t=this.options,e=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const i=n.length>0,o=this.dataProvider.getRowHeaders(),r=o.length>0;let s=t.bom?String.fromCharCode(65279):"";return i&&(n=Pp(n,(t=>this._escapeCell(t,!0))),r&&(s+=t.columnDelimiter),s+=n.join(t.columnDelimiter),s+=t.rowDelimiter),Np(e,((e,n)=>{n>0&&(s+=t.rowDelimiter),r&&(s+=this._escapeCell(o[n])+t.columnDelimiter),s+=e.map((t=>this._escapeCell(t))).join(t.columnDelimiter)})),s}_escapeCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Wp(t);return""!==n&&(e||n.indexOf(dB)>=0||n.indexOf(gB)>=0||n.indexOf(fB)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n=`"${n}"`),n}},pB="csv",wB={[pB]:mB};class vB extends xN{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}exportAsBlob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}downloadFile(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:n,rootWindow:i}=this.hot,o=this._createTypeFormatter(t,e),r=this._createBlob(o),s=i.URL||i.webkitURL,l=n.createElement("a"),a=`${o.options.filename}.${o.options.fileExtension}`;if(void 0!==l.download){const t=s.createObjectURL(r);l.style.display="none",l.setAttribute("href",t),l.setAttribute("download",a),n.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),n.body.removeChild(l),setTimeout((()=>{s.revokeObjectURL(t)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(r,a)}_createTypeFormatter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!wB[t])throw new Error(`Export format type "${t}" is not supported.`);return function(t,e,n){return"function"==typeof wB[t]?new wB[t](e,n):null}(t,new aB(this.hot),e)}_createBlob(t){let e=null;return"undefined"!=typeof Blob&&(e=new Blob([t.export()],{type:`${t.options.mimeType};charset=${t.options.encoding}`})),e}}function yB(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class bB{constructor(t,e){let{id:n,stateless:i=!0}=e;yB(this,"hot",void 0),yB(this,"id",void 0),yB(this,"elements",[]),yB(this,"hidden",!1),yB(this,"stateId",""),yB(this,"state",void 0),this.hot=t,this.id=n,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new dx)}getElements(){return this.elements}reset(){Np(this.elements,(t=>t.reset()))}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(t){this.state&&this.setState(this.state.getValueAtIndex(t))}setState(){throw new Error("The state setting logic is not implemented")}saveState(t){this.state&&this.state.setValueAtIndex(t,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Np(this.elements,(t=>t.destroy())),this.state=null,this.elements=null,this.hot=null}}$v(bB,UE);const CB={};function SB(t,e){if(!CB[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:i}=CB[t];let o=e;return i.inputValuesDecorator&&(o=i.inputValuesDecorator(o)),function(t){return n.apply(t.meta.instance,[].concat([t],[o]))}}function RB(t){if(!CB[t])throw Error(`Filter condition "${t}" does not exist.`);return CB[t].descriptor}function EB(t,e,n){n.key=t,CB[t]={condition:e,descriptor:n}}const TB="none";EB(TB,(function(){return!0}),{name:DH,inputsCount:0,showOperators:!1});const MB="empty";EB(MB,(function(t){return zp(t.value)}),{name:LH,inputsCount:0,showOperators:!0});const xB="not_empty";EB(xB,(function(t,e){return!SB(MB,e)(t)}),{name:VH,inputsCount:0,showOperators:!0});const HB="eq";EB(HB,(function(t,e){let[n]=e;return Wp(t.value).toLocaleLowerCase(t.meta.locale)===Wp(n)}),{name:FH,inputsCount:1,showOperators:!0});const kB="neq";EB(kB,(function(t,e){return!SB(HB,e)(t)}),{name:WH,inputsCount:1,showOperators:!0});EB("gt",(function(t,e){let[n]=e,i=n;return"numeric"===t.meta.type&&(i=parseFloat(i,10)),t.value>i}),{name:$H,inputsCount:1,showOperators:!0});EB("gte",(function(t,e){let[n]=e,i=n;return"numeric"===t.meta.type&&(i=parseFloat(i,10)),t.value>=i}),{name:GH,inputsCount:1,showOperators:!0});EB("lt",(function(t,e){let[n]=e,i=n;return"numeric"===t.meta.type&&(i=parseFloat(i,10)),t.value<i}),{name:KH,inputsCount:1,showOperators:!0});EB("lte",(function(t,e){let[n]=e,i=n;return"numeric"===t.meta.type&&(i=parseFloat(i,10)),t.value<=i}),{name:XH,inputsCount:1,showOperators:!0});const IB="date_after";EB(IB,(function(t,e){let[n]=e;const i=Sd(t.value,t.meta.dateFormat),o=Sd(n,t.meta.dateFormat);return!(!i.isValid()||!o.isValid())&&i.diff(o)>=0}),{name:QH,inputsCount:1,showOperators:!0});const OB="date_before";EB(OB,(function(t,e){let[n]=e;const i=Sd(t.value,t.meta.dateFormat),o=Sd(n,t.meta.dateFormat);return!(!i.isValid()||!o.isValid())&&i.diff(o)<=0}),{name:JH,inputsCount:1,showOperators:!0});const AB="between";EB(AB,(function(t,e){let[n,i]=e,o=n,r=i;if("numeric"===t.meta.type){const t=parseFloat(o,10),e=parseFloat(r,10);o=Math.min(t,e),r=Math.max(t,e)}else if("date"===t.meta.type){const e=SB(OB,[r]),n=SB(IB,[o]);return e(t)&&n(t)}return t.value>=o&&t.value<=r}),{name:qH,inputsCount:2,showOperators:!0});const _B="not_between";EB(_B,(function(t,e){return!SB(AB,e)(t)}),{name:ZH,inputsCount:2,showOperators:!0});const PB="begins_with";EB(PB,(function(t,e){let[n]=e;return Wp(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Wp(n))}),{name:jH,inputsCount:1,showOperators:!0});const NB="ends_with";EB(NB,(function(t,e){let[n]=e;return Wp(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Wp(n))}),{name:BH,inputsCount:1,showOperators:!0});const DB="contains";EB(DB,(function(t,e){let[n]=e;return Wp(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Wp(n))>=0}),{name:zH,inputsCount:1,showOperators:!0});const LB="not_contains";EB(LB,(function(t,e){return!SB(DB,e)(t)}),{name:UH,inputsCount:1,showOperators:!0});const VB="date_tomorrow";EB(VB,(function(t){const e=Sd(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(Sd().subtract(-1,"days").startOf("day"),"d")}),{name:ek,inputsCount:0});const FB="date_today";EB(FB,(function(t){const e=Sd(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(Sd().startOf("day"),"d")}),{name:tk,inputsCount:0});const WB="date_yesterday";function jB(t,e){let n=t;return""===n&&(n=`(${e})`),n}EB(WB,(function(t){const e=Sd(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(Sd().subtract(1,"days").startOf("day"),"d")}),{name:nk,inputsCount:0}),function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};oy||(oy="object"==typeof Intl?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?(t,e)=>`${t}`.localeCompare(e):(t,e)=>t===e?0:t>e?-1:1)}();const BB=new Set([1]).has(1),zB=BB&&"function"==typeof Array.from;function UB(t){let e=t;return BB&&(e=new Set(e)),function(t){let n;return n=BB?e.has(t):!!~e.indexOf(t),n}}function YB(t){return null==t?"":t}function $B(t){let e=t;return e=zB?Array.from(new Set(e)):Dp(e),e=e.sort(((t,e)=>"number"==typeof t&&"number"==typeof e?t-e:t===e?0:t>e?1:-1)),e}function GB(t,e,n,i){const o=[],r=t===e;let s;return r||(s=UB(e)),Np(t,(t=>{let e=!1;(r||s(t))&&(e=!0);const l={checked:e,value:t,visualValue:jB(t,n)};i&&i(l),o.push(l)})),o}const KB="by_value";EB(KB,(function(t,e){let[n]=e;return n(t.value)}),{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[UB(e)]},showOperators:!1});const XB={};function qB(t,e,n){XB[t]={name:e,func:n}}const ZB="conjunction";qB(ZB,rk,(function(t,e){return t.every((t=>t.func(e)))}));const QB="disjunction";qB(QB,sk,(function(t,e){return t.some((t=>t.func(e)))}));const JB="disjunctionWithExtraCondition";qB(JB,sk,(function(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some((t=>t.func(e)))&&t[t.length-1].func(e)}));const tz="numeric",ez="text",nz="date",iz={[tz]:[TB,OV,MB,xB,OV,HB,kB,OV,"gt","gte","lt","lte",AB,_B],[ez]:[TB,OV,MB,xB,OV,HB,kB,OV,PB,NB,OV,DB,LB],[nz]:[TB,OV,MB,xB,OV,HB,kB,OV,OB,IB,AB,OV,VB,FB,WB]};function oz(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const rz="built",sz="building",lz=["click","input","keydown","keypress","keyup","focus","blur","change"];let az=class t{static get DEFAULTS(){return Yv({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){oz(this,"hot",void 0),oz(this,"eventManager",new Sb(this)),oz(this,"options",void 0),oz(this,"_element",void 0),oz(this,"buildState",void 0),this.hot=e,this.options=Bv(t.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===sz?this._element:this.buildState===rz?(this.update(),this._element):(this.buildState=sz,this.build(),this.buildState=rz,this._element)}isBuilt(){return this.buildState===rz}translateIfPossible(t){return"string"==typeof t&&t.startsWith(PH)?this.hot.getTranslatedPhrase(t):t}build(){const t=(t,e)=>{this.eventManager.addEventListener(t,e,(t=>this.runLocalHooks(e,t,this)))};if(this.buildState||(this.buildState=sz),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&Mw(this._element,this.options.className),this.options.children.length)Np(this.options.children,(t=>this._element.appendChild(t.element)));else if(this.options.wrapIt){const e=this.hot.rootDocument.createElement(this.options.tagName);e.setAttribute("data-hot-input",!0),qv(this.options,((t,n)=>{void 0!==e[n]&&"className"!==n&&"tagName"!==n&&"children"!==n&&(e[n]=this.translateIfPossible(t))})),this._element.appendChild(e),Np(lz,(n=>t(e,n)))}else Np(lz,(e=>t(this._element,e)))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};function hz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cz(t,e){return t.get(uz(t,e))}function uz(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}$v(az,UE);var dz=new WeakMap,gz=new WeakSet;class fz extends az{static get DEFAULTS(){return Yv({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(t,e){var n,i;super(t,Bv(fz.DEFAULTS,e)),hz(n=this,i=gz),i.add(n),function(t,e,n){hz(t,e),e.set(t,n)}(this,dz,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",(t=>uz(gz,this,mz).call(this,t)))}build(){super.build();const t=this.hot.rootDocument.createElement("div");var e,n,i;e=dz,n=this,i=this._element.firstChild,e.set(uz(e,n),i),Mw(this._element,"htUIInput"),Mw(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(cz(dz,this).type=this.options.type,cz(dz,this).placeholder=this.translateIfPossible(this.options.placeholder),cz(dz,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&cz(dz,this).focus()}}function mz(t){this.options.value=t.target.value}function pz(t,e,n){wz(t,e),e.set(t,n)}function wz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vz(t,e,n){return t.set(bz(t,e),n),n}function yz(t,e){return t.get(bz(t,e))}function bz(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cz=new WeakMap,Sz=new WeakMap,Rz=new WeakMap,Ez=new WeakMap,Tz=new WeakMap,Mz=new WeakSet;class xz extends az{static get DEFAULTS(){return Yv({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(t,e){var n,i;super(t,Bv(xz.DEFAULTS,e)),wz(n=this,i=Mz),i.add(n),pz(this,Cz,null),pz(this,Sz,[]),pz(this,Rz,void 0),pz(this,Ez,void 0),pz(this,Tz,void 0),this.registerHooks()}getMenu(){return yz(Cz,this)}registerHooks(){this.addLocalHook("click",(()=>bz(Mz,this,Iz).call(this)))}setItems(t){vz(Sz,this,this.translateNames(t)),yz(Cz,this)&&yz(Cz,this).setMenuItems(yz(Sz,this))}translateNames(t){return Np(t,(t=>{t.name=this.translateIfPossible(t.name)})),t}build(){super.build(),vz(Cz,this,new uW(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),yz(Cz,this).setMenuItems(yz(Sz,this));const t=new az(this.hot,{className:"htUISelectCaption"}),e=new az(this.hot,{className:"htUISelectDropdown"});vz(Rz,this,t),vz(Ez,this,t.element),vz(Tz,this,e),this.hot.getSettings().ariaTags&&(Hw(e.element,[["aria-hidden","true"]]),Hw(this._element,[["role","listbox"]])),Np([t,e],(t=>this._element.appendChild(t.element))),yz(Cz,this).addLocalHook("select",(t=>bz(Mz,this,Hz).call(this,t))),yz(Cz,this).addLocalHook("afterClose",(()=>bz(Mz,this,kz).call(this))),this.update()}update(){if(!this.isBuilt())return;let t;t=this.options.value?this.options.value.name:yz(Cz,this).hot.getTranslatedPhrase(DH),yz(Ez,this).textContent=t,super.update()}openOptions(){const t=this.element.getBoundingClientRect();yz(Cz,this)&&(yz(Cz,this).open(),yz(Cz,this).setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}),yz(Cz,this).getNavigator().toFirstItem(),yz(Cz,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){yz(Cz,this)&&yz(Cz,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){yz(Cz,this)&&(yz(Cz,this).destroy(),vz(Cz,this,null)),yz(Rz,this)&&yz(Rz,this).destroy(),yz(Tz,this)&&yz(Tz,this).destroy(),super.destroy()}}function Hz(t){t.name!==OV&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function kz(){this.runLocalHooks("afterClose")}function Iz(){this.openOptions()}function Oz(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function Az(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _z(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Pz=new WeakSet;class Nz extends bB{constructor(t,e){super(t,{id:e.id,stateless:!1}),Oz(this,Pz),Az(this,"name",""),Az(this,"addSeparator",!1),this.name=e.name,this.addSeparator=e.addSeparator,this.elements.push(new xz(this.hot,{menuContainer:e.menuContainer})),this.elements.push(new fz(this.hot,{placeholder:gk})),this.elements.push(new fz(this.hot,{placeholder:fk})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",(t=>_z(Pz,this,Dz).call(this,t))).addLocalHook("afterClose",(()=>this.runLocalHooks("afterClose"))).addLocalHook("tabKeydown",(t=>this.runLocalHooks("selectTabKeydown",t))),Np(this.getInputElements(),(t=>{t.addLocalHook("keydown",(t=>_z(Pz,this,Lz).call(this,t)))}))}setState(t){if(this.reset(),!t)return;const e=Yv(t.command);e.name.startsWith(NH)&&(e.name=this.hot.getTranslatedPhrase(e.name)),this.getSelectElement().setValue(e),Np(t.args,((t,n)=>{if(n>e.inputsCount-1)return!1;const i=this.getInputElement(n);i.setValue(t),i[e.inputsCount>n?"show":"hide"](),n||this.hot._registerTimeout((()=>i.focus()),10)}))}getState(){const t=this.getSelectElement().getValue()||RB(TB),e=[];return Np(this.getInputElements(),((n,i)=>{t.inputsCount>i&&e.push(n.getValue())})),{command:t,args:e}}updateState(t,e){const n=RB(t?t.name:TB);this.state.setValueAtIndex(e,{command:n,args:t?t.args:[]}),t||Np(this.getInputElements(),(t=>t.setValue(null)))}getSelectElement(){return this.elements.filter((t=>t instanceof xz))[0]}getInputElement(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}getInputElements(){return this.elements.filter((t=>t instanceof fz))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,n,i,o,r)=>{Mw(e.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Mw(e.parentNode,"border");const s=this.hot.rootDocument.createElement("div");return Mw(s,"htFiltersMenuLabel"),s.textContent=r,e.appendChild(s),e.parentElement.hasAttribute("ghost-table")||Np(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getPlugin("filters").getSelectedColumn();let e=[RB(TB)];if(null!==t){const{visualIndex:n}=t;e=function(t){const e=[];let n=t;return iz[n]||(n=ez),Np(iz[n],(t=>{let n;n=t===OV?{name:OV}:Yv(RB(t)),e.push(n)})),e}(this.hot.getDataType(0,n,this.hot.countRows(),n))}Np(this.getInputElements(),(t=>t.hide())),this.getSelectElement().setItems(e),super.reset(),this.getSelectElement().setValue(e[0])}}function Dz(t){Np(this.getInputElements(),((e,n)=>{e[t.inputsCount>n?"show":"hide"](),0===n&&this.hot._registerTimeout((()=>e.focus()),10)})),this.runLocalHooks("change",t)}function Lz(t){yy(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),by(t))}function Vz(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Fz(t,e){return t.get(jz(t,e))}function Wz(t,e,n){return t.set(jz(t,e),n),n}function jz(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bz=new WeakMap,zz=new WeakMap;class Uz extends az{static get DEFAULTS(){return Yv({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,e){super(t,Bv(Uz.DEFAULTS,e)),Vz(this,Bz,void 0),Vz(this,zz,void 0)}build(){super.build();const t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),Wz(zz,this,t),Wz(Bz,this,this._element.firstChild),Fz(Bz,this).checked=this.options.checked,this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(Fz(zz,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&Fz(Bz,this).checked}setChecked(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(Fz(Bz,this).checked=t)}focus(){this.isBuilt()&&Fz(Bz,this).focus()}}function Yz(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function $z(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Gz=new WeakSet;class Kz extends bB{constructor(t,e){super(t,{id:e.id,stateless:!1}),Yz(this,Gz),$z(this,"name",""),this.name=e.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(Mw(e.parentNode,"htFiltersMenuOperators"),Np(this.elements,(t=>e.appendChild(t.element))),e)}}buildOperatorsElement(){const t=[ZB,QB];Np(t,(e=>{const n=new Uz(this.hot,{name:"operator",label:{htmlFor:e,textContent:(i=e,XB[i].name)},value:e,checked:e===t[0],id:e});var i;n.addLocalHook("change",(t=>function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(Gz,this,Xz).call(this,t))),this.elements.push(n)}))}setChecked(t){if(this.elements.length<t)throw Error(Fp`Radio button with index ${t} doesn't exist.`);Np(this.elements,((e,n)=>{e.setChecked(n===t)}))}getActiveOperationId(){const t=this.elements.find((t=>t instanceof Uz&&t.isChecked()));return t?t.getValue():ZB}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&Np(this.elements,(e=>{e.setChecked(e.getValue()===t)}))}updateState(){let t=arguments.length>1?arguments[1]:void 0,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ZB;e===JB&&(e=QB),this.state.setValueAtIndex(t,e)}reset(){this.setChecked(0)}}function Xz(t){this.setState(t.target.value)}function qz(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Zz(t,e){return t.get(Qz(t,e))}function Qz(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jz=new WeakMap;class tU extends az{static get DEFAULTS(){return Yv({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(t,e){super(t,Bv(tU.DEFAULTS,e)),qz(this,Jz,void 0)}build(){var t,e,n;super.build(),t=Jz,e=this,n=this._element.firstChild,t.set(Qz(t,e),n)}update(){this.isBuilt()&&(Zz(Jz,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Zz(Jz,this).focus()}activate(){Zz(Jz,this).click()}}function eU(t,e,n){nU(t,e),e.set(t,n)}function nU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iU(t,e){return t.get(rU(t,e))}function oU(t,e,n){return t.set(rU(t,e),n),n}function rU(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const sU="multipleSelect.itemBox";var lU=new WeakMap,aU=new WeakMap,hU=new WeakMap,cU=new WeakMap,uU=new WeakMap,dU=new WeakMap,gU=new WeakSet;class fU extends az{static get DEFAULTS(){return Yv({className:"htUIMultipleSelect",value:[]})}constructor(t,e){var n,i;super(t,Bv(fU.DEFAULTS,e)),nU(n=this,i=gU),i.add(n),eU(this,lU,[]),eU(this,aU,void 0),eU(this,hU,void 0),eU(this,cU,void 0),eU(this,uU,void 0),eU(this,dU,void 0),oU(cU,this,new fz(this.hot,{placeholder:dk,className:"htUIMultipleSelectSearch"})),oU(uU,this,new tU(this.hot,{textContent:ak,className:"htUISelectAll"})),oU(dU,this,new tU(this.hot,{textContent:hk,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return iU(aU,this)}registerHooks(){iU(cU,this).addLocalHook("keydown",(t=>rU(gU,this,pU).call(this,t))),iU(cU,this).addLocalHook("input",(t=>rU(gU,this,mU).call(this,t))),iU(uU,this).addLocalHook("click",(t=>rU(gU,this,wU).call(this,t))),iU(dU,this).addLocalHook("click",(t=>rU(gU,this,vU).call(this,t)))}setItems(t){var e;oU(lU,this,t),null===(e=iU(aU,this))||void 0===e||e.loadData(iU(lU,this))}setLocale(t){oU(hU,this,t)}getLocale(){return iU(hU,this)}getItems(){return[...iU(lU,this)]}getValue(){return function(t){const e=[];return t.forEach((t=>{t.checked&&e.push(t.value)})),e}(iU(lU,this))}getSearchInputElement(){return iU(cU,this)}getSelectAllElement(){return iU(uU,this)}getClearAllElement(){return iU(dU,this)}isSelectedAllValues(){return iU(lU,this).length===this.getValue().length}build(){super.build();const{rootDocument:t}=this.hot,e=t.createElement("div"),n=new az(this.hot,{className:"htUISelectionControls",children:[iU(uU,this),iU(dU,this)]});this._element.appendChild(iU(cU,this).element),this._element.appendChild(n.element),this._element.appendChild(e);const i=e=>{var n;if(!this._element)return;null===(n=iU(aU,this))||void 0===n||n.destroy(),Mw(e,"htUIMultipleSelectHot"),oU(aU,this,new this.hot.constructor(e,{data:iU(lU,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(t,e,n,i,o,r)=>{t.title=r.instance.getDataAtRowProp(e,r.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{iU(aU,this).listen()},colWidths:()=>iU(aU,this).container.scrollWidth-Qw(t),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),iU(aU,this).init(),this.hot.addHook("afterSetTheme",((t,e)=>{e||iU(aU,this).useTheme(t)}));const i=iU(aU,this).getShortcutManager().getContext("grid");i.removeShortcutsByKeys(["Tab"]),i.removeShortcutsByKeys(["Shift","Tab"]),i.addShortcut({keys:[["Escape"]],callback:t=>{this.runLocalHooks("keydown",t,this)},group:sU}),i.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:t=>{iU(aU,this).deselectCell(),this.runLocalHooks("keydown",t,this),this.runLocalHooks("listTabKeydown",t,this)},group:sU})};i(e),this.hot._registerTimeout((()=>i(e)),100)}focus(){this.isBuilt()&&iU(aU,this).listen()}reset(){iU(cU,this).reset(),iU(uU,this).reset(),iU(dU,this).reset()}update(){this.isBuilt()&&(iU(aU,this).loadData(function(t,e){const n=UB(e);return t.map((t=>(t.checked=n(t.value),t)))}(iU(lU,this),this.options.value)),super.update())}destroy(){var t;null===(t=iU(aU,this))||void 0===t||t.destroy(),iU(cU,this).destroy(),iU(dU,this).destroy(),iU(uU,this).destroy(),oU(cU,this,null),oU(dU,this,null),oU(uU,this,null),oU(aU,this,null),oU(lU,this,null),super.destroy()}}function mU(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;n=""===e?[...iU(lU,this)]:iU(lU,this).filter((t=>`${t.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0)),iU(aU,this).loadData(n)}function pU(t){this.runLocalHooks("keydown",t,this);av(yy,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),by(t),iU(aU,this).listen(),iU(aU,this).selectCell(0,0))}function wU(t){const e=[];t.preventDefault(),iU(aU,this).getSourceData().forEach(((t,n)=>{t.checked=!0,e.push(GM(t,n)[0])})),iU(aU,this).setSourceDataAtCell(e)}function vU(t){const e=[];t.preventDefault(),iU(aU,this).getSourceData().forEach(((t,n)=>{t.checked=!1,e.push(GM(t,n)[0])})),iU(aU,this).setSourceDataAtCell(e)}function yU(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function bU(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CU(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var SU,RU=new WeakSet;class EU extends bB{constructor(t,e){super(t,{id:e.id,stateless:!1}),yU(this,RU),bU(this,"name",""),this.name=e.name,this.elements.push(new fU(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",(t=>CU(RU,this,TU).call(this,t))).addLocalHook("listTabKeydown",(t=>this.runLocalHooks("listTabKeydown",t))),this.hot.addHook("modifyFiltersMultiSelectValue",((t,e)=>CU(RU,this,xU).call(this,t,e)))}getElements(){const t=this.getMultipleSelectElement();return[t.getSearchInputElement(),t.getSelectAllElement(),t.getClearAllElement(),this.getMultipleSelectElement()]}setState(t){if(this.reset(),t&&t.command.key===KB){const e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}getState(){const t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?TB:KB},args:[t.getValue()],itemsSnapshot:e}}updateState(t){const e=(e,n,i,o,r)=>{const[s]=_p(n,(t=>t.name===KB)),l={},a=this.hot.getTranslatedPhrase(lk);if(s){const n=o(e,r),h=Pp(n,(t=>t.value)),c=new Map(n.map((t=>[t.value,this.hot.getCellMeta(t.meta.visualRow,t.meta.visualCol)]))),u=$B(h);i&&(s.args[0]=i);const d=[],g=GB(u,s.args[0],a,(t=>{t.checked&&d.push(t.value),CU(RU,this,MU).call(this,t,c)})),f=t.editedConditionStack.column;l.locale=this.hot.getCellMeta(0,f).locale,l.args=[d],l.command=RB(KB),l.itemsSnapshot=g}else l.args=[],l.command=RB(TB);this.state.setValueAtIndex(e,l)};e(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&e(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter((t=>t instanceof fU))[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,n,i,o,r)=>{Mw(e.parentNode,"htFiltersMenuValue");const s=this.hot.rootDocument.createElement("div");return Mw(s,"htFiltersMenuLabel"),s.textContent=r,e.appendChild(s),e.parentElement.hasAttribute("ghost-table")||Np(this.elements,(t=>e.appendChild(t.element))),e}}}reset(){const t=this.hot.getTranslatedPhrase(lk),e=this._getColumnVisibleValues(),n=e.map((t=>t.value)),i=new Map(e.map((t=>[t.value,t.meta]))),o=$B(n),r=GB(o,o,t,(t=>{CU(RU,this,MU).call(this,t,i)}));this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(o);const s=this.hot.getPlugin("filters").getSelectedColumn();null!==s&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}_getColumnVisibleValues(){const t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:Pp(this.hot.getDataAtCol(t.visualIndex),((e,n)=>({value:YB(e),meta:this.hot.getCellMeta(n,t.visualIndex)})))}}function TU(t){yy(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),by(t))}function MU(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function xU(t,e){return"numeric"===e.type?XP(t,e):t}function HU(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function kU(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var IU=new WeakSet;class OU extends bB{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,e){super(t,{id:e.id,stateless:!0}),HU(this,IU),kU(this,"name",""),this.name=e.name,this.elements.push(new fz(this.hot,{type:"button",value:ck,className:"htUIButton htUIButtonOK",identifier:OU.BUTTON_OK})),this.elements.push(new fz(this.hot,{type:"button",value:uk,className:"htUIButton htUIButtonCancel",identifier:OU.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){Np(this.elements,(t=>{t.addLocalHook("click",((t,e)=>function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(IU,this,AU).call(this,t,e)))}))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>(Mw(e.parentNode,"htFiltersMenuActionBar"),Np(this.elements,(t=>e.appendChild(t.element))),e)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function AU(t,e){e.options.identifier===SU.BUTTON_OK?this.accept():this.cancel()}function _U(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}SU=OU;const PU="ConditionCollection.filteringStates";class NU{constructor(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];_U(this,"hot",void 0),_U(this,"isMapRegistrable",void 0),_U(this,"filteringStates",new dx),_U(this,"previousConditionStack",null),this.hot=t,this.isMapRegistrable=e,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(PU,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(t,e){var n;const i=this.filteringStates.getValueAtIndex(e),o=null!==(n=null==i?void 0:i.conditions)&&void 0!==n?n:[],r=null==i?void 0:i.operation;return this.isMatchInConditions(o,t,r)}isMatchInConditions(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ZB;return!t.length||function(t){if(!XB[t])throw Error(`Operation with id "${t}" does not exist.`);const e=XB[t].func;return function(t,n){return e(t,n)}}(n)(t,e)}addCondition(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ZB,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,t).locale,r=Pp(e.args,(t=>"string"==typeof t?t.toLocaleLowerCase(o):t)),s=e.name||e.command.key;null===this.previousConditionStack&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",t);const l=this.getOperation(t);if(l){if(l!==n)throw Error(Fp`The column of index ${t} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Bp(XB[n]))throw new Error(Fp`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const a=this.getConditions(t);0===a.length?this.filteringStates.setValueAtIndex(t,{operation:n,conditions:[{name:s,args:r,func:SB(s,r)}]},i):a.push({name:s,args:r,func:SB(s,r)}),this.runLocalHooks("afterAdd",t)}getConditions(t){var e,n;return null!==(e=null===(n=this.filteringStates.getValueAtIndex(t))||void 0===n?void 0:n.conditions)&&void 0!==e?e:[]}getOperation(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map((t=>{let[e]=t;return e}))}getColumnStackPosition(t){return this.getFilteredColumns().indexOf(t)}exportAllConditions(){return Ap(this.filteringStates.getEntries(),((t,e)=>{let[n,{operation:i,conditions:o}]=e;return t.push({column:n,operation:i,conditions:Pp(o,(t=>{let{name:e,args:n}=t;return{name:e,args:n}}))}),t}),[])}importAllConditions(t){this.clean(),Np(t,(t=>{Np(t.conditions,(e=>this.addCondition(t.column,e)))}))}removeConditions(t){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(t,e){const n=this.getConditions(t);return e?n.some((t=>t.name===e)):n.length>0}setPreviousConditionStack(t){this.previousConditionStack=t}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(PU),this.filteringStates=null,this.clearLocalHooks()}}$v(NU,UE);const DU=NU;function LU(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const VU=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];LU(this,"conditionCollection",void 0),LU(this,"columnDataFactory",void 0),this.conditionCollection=t,this.columnDataFactory=e}filter(){let t=[];return Np(this.conditionCollection.getFilteredColumns(),((e,n)=>{let i=this.columnDataFactory(e);n&&(i=this._getIntersectData(i,t)),t=this.filterByColumn(e,i)})),t}filterByColumn(t){const e=[];return Np(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],(n=>{void 0!==n&&this.conditionCollection.isMatch(n,t)&&e.push(n)})),e}_getIntersectData(t,e){const n=[];return Np(e,(e=>{const i=e.meta.visualRow;void 0!==t[i]&&(n[i]=t[i])})),n}};function FU(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function WU(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jU(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var BU=new WeakSet;class zU{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];FU(this,BU),WU(this,"hot",void 0),WU(this,"conditionCollection",void 0),WU(this,"columnDataFactory",void 0),WU(this,"changes",[]),WU(this,"grouping",!1),WU(this,"latestEditedColumnPosition",-1),WU(this,"latestOrderStack",[]),this.hot=t,this.conditionCollection=e,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",(t=>jU(BU,this,UU).call(this,t))),this.conditionCollection.addLocalHook("afterRemove",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("afterAdd",(t=>this.updateStatesAtColumn(t))),this.conditionCollection.addLocalHook("beforeClean",(()=>jU(BU,this,YU).call(this))),this.conditionCollection.addLocalHook("afterClean",(()=>jU(BU,this,$U).call(this)))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,Np(this.changes,(t=>{this.updateStatesAtColumn(t)})),this.changes.length=0}updateStatesAtColumn(t,e){var n=this;if(this.grouping)return void(-1===this.changes.indexOf(t)&&this.changes.push(t));const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(t);-1===o&&(o=this.latestEditedColumnPosition);const r=i.slice(0,o),s=i.slice(o);s.length&&s[0].column===t&&s.shift();const l=function(t){const e=t.length;return function n(i){return function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];const l=i.concat(r);let a;return a=l.length>=e?t.apply(this,l):n(l),a}}([])}((function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const o=new DU(n.hot,!1),r=[].concat(t,i);o.importAllConditions(r);const s=n.columnDataFactory(e);let l;l=o.isEmpty()?s:new VU(o,(t=>n.columnDataFactory(t))).filter(),l=Pp(l,(t=>t.meta.visualRow));const a=UB(l);return o.destroy(),_p(s,(t=>a(t.meta.visualRow)))}))(r),a=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:a},dependentConditionStacks:s,filteredRowsFactory:l,conditionArgsChange:e})}destroy(){this.clearLocalHooks(),qv(this,((t,e)=>{this[e]=null}))}}function UU(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function YU(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function $U(){Np(this.latestOrderStack,(t=>{this.updateStatesAtColumn(t)}))}$v(zU,UE);const GU=zU;const KU="filters";function XU(t,e){let n,i=-1;const o=(r=e,GF({initialPage:0,size:()=>r.length,onItemSelect:(t,e)=>{const n=r[t];return n instanceof fU?e:!(n.element&&!Nw(n.element))&&void n.focus()}}));var r;const s=t=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(KU),o.setCurrentPage(e.indexOf(t))};function l(t){const r=n.getKeyboardShortcutsCtrl(),s=t.getKeyboardShortcutsCtrl();o.clear(),s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:r.getContext(KU),callback:()=>{t.isSubMenu()&&t.close(),r.listen(KU)}}]),t.isSubMenu()||r.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{const e=n.getNavigator();e.getCurrentPage()>-1&&(i=e.getCurrentPage()),e.clear(),t.shiftKey?o.toPreviousItem():o.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:t=>{const n=e[o.getCurrentPage()];n instanceof xz&&(n.openOptions(),t.preventDefault()),n instanceof tU&&(n.activate(),t.preventDefault()),n instanceof az||t.preventDefault()}}],KU)}function c(t){t.addLocalHook("afterSelectionChange",(t=>{t.key.startsWith("filter_")||o.clear()})),t.addLocalHook("afterSubmenuOpen",l),t.addLocalHook("afterOpen",l),n=t}return e.forEach((t=>{t instanceof az&&(t.addLocalHook("click",s(t)),t.addLocalHook("focus",s(t)),t.addLocalHook("afterClose",s(t)))})),c(t),h(a({},o),{listen:function(){n.focus(),n.getKeyboardShortcutsCtrl().listen(KU)},setMenu:c,getMenu:function(){return n},getLastMenuPage:function(){return i}})}function qU(t,e,n){ZU(t,e),e.set(t,n)}function ZU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QU(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JU(t,e){return t.get(tY(t,e))}function tY(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const eY="filters",nY=eY;var iY=new WeakMap,oY=new WeakMap,rY=new WeakSet;class sY extends xN{static get PLUGIN_KEY(){return eY}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(t){var e,n;super(t),ZU(e=this,n=rY),n.add(e),QU(this,"dropdownMenuPlugin",null),QU(this,"conditionCollection",null),QU(this,"conditionUpdateObserver",null),QU(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),QU(this,"filtersRowsMap",null),qU(this,iY,void 0),qU(this,oY,new WeakSet),this.hot.addHook("afterGetColHeader",((t,e)=>tY(rY,this,mY).call(this,t,e)))}isEnabled(){return!!this.hot.getSettings()[eY]}enablePlugin(){var t=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new gx),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,i=t=>(t.addLocalHook("accept",(()=>tY(rY,this,dY).call(this,"accept"))),t.addLocalHook("cancel",(()=>tY(rY,this,dY).call(this,"cancel"))),t.addLocalHook("change",(e=>tY(rY,this,gY).call(this,t,e))),t),o=()=>`${this.hot.getTranslatedPhrase(ik)}:`,r=()=>`${this.hot.getTranslatedPhrase(ok)}:`;if(!this.components.get("filter_by_condition")){const t=new Nz(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:n});t.addLocalHook("afterClose",(()=>tY(rY,this,fY).call(this))),this.components.set("filter_by_condition",i(t))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Kz(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const t=new Nz(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});t.addLocalHook("afterClose",(()=>tY(rY,this,fY).call(this))),this.components.set("filter_by_condition2",i(t))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new EU(this.hot,{id:"filter_by_value",name:r}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new OU(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new DU(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new GU(this.hot,this.conditionCollection,(t=>this.getDataMapAtColumn(t))),this.conditionUpdateObserver.addLocalHook("update",(t=>tY(rY,this,pY).call(this,t)))),this.components.forEach((t=>t.show())),this.addHook("afterDropdownMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return tY(rY,t,uY).call(t,...n)})),this.addHook("beforeDropdownMenuShow",(()=>tY(rY,this,cY).call(this))),this.addHook("afterDropdownMenuShow",(()=>tY(rY,this,aY).call(this))),this.addHook("afterDropdownMenuHide",(()=>tY(rY,this,hY).call(this))),this.addHook("afterChange",(t=>tY(rY,this,lY).call(this,t))),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!JU(iY,this)&&this.dropdownMenuPlugin.enabled){const t=[{focus:()=>{const t=JU(iY,this).getMenu(),e=t.getNavigator(),n=JU(iY,this).getLastMenuPage();t.focus(),n>0?e.setCurrentPage(n):e.toFirstItem()}},...Array.from(this.components).map((t=>{let[,e]=t;return e.getElements()})).flat()];s=iY,l=this,a=XU(this.dropdownMenuPlugin.menu,t),s.set(tY(s,l),a);const e=t=>{JU(iY,this).listen(),t.preventDefault(),yy(t.keyCode,"TAB")&&(t.shiftKey?JU(iY,this).toPreviousItem():JU(iY,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",e),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",e)}var s,l,a;this.registerShortcuts(),super.enablePlugin()}disablePlugin(){var t;this.enabled&&(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(((t,e)=>{t.destroy(),this.components.set(e,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const t=this.hot.getSelected();this.clearConditions(),this.filter(),t&&this.hot.selectCells(t)},group:nY})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(nY)}addCondition(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ZB;const o=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(o,{command:{key:e},args:n},i)}removeConditions(t){const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}clearConditions(t){if(void 0===t)this.conditionCollection.clean();else{const e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}filter(){const{navigableHeaders:t}=this.hot.getSettings(),e=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",o,this.conditionCollection.previousConditionStack))if(n){const n=[];this.hot.batchExecution((()=>{this.filtersRowsMap.clear(),i=Pp(e.filter(),(t=>t.meta.visualRow));const t=UB(i);VC(this.hot.countSourceRows()-1,(e=>{t(e)||n.push(e)})),Np(n,(t=>{this.filtersRowsMap.setValueAtIndex(t,!0)}))}),!0),t||i.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(t?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var t;const e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}getDataMapAtColumn(t){const e=this.hot.toVisualColumn(t),n=[];return Np(this.hot.getSourceDataAtCol(e),((t,i)=>{var o;const{row:r,col:s,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:u,locale:d}=this.hot.getCellMeta(i,e),g=null!==(o=this.hot.getDataAtCell(this.hot.toVisualRow(i),e))&&void 0!==o?o:t;n.push({meta:{row:r,col:s,visualCol:l,visualRow:a,type:h,instance:c,dateFormat:u,locale:d},value:YB(g)})})),n}updateValueComponentCondition(t){const e=$B(this.hot.getDataAtCol(t));this.conditionUpdateObserver.updateStatesAtColumn(t,e)}restoreComponents(t){var e;const n=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach((t=>{t.isHidden()||t.restoreState(n)})),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(t,e,n,i){let o=t;return o===QB&&e.command.key!==TB&&n.command.key!==TB&&i.command.key!==TB?o=JB:i.command.key!==TB&&(e.command.key!==TB&&n.command.key!==TB||(o=ZB)),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const t=this.components.get("filter_by_condition"),{command:e}=t.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new VU(t,(t=>this.getDataMapAtColumn(t)))}getIndexesOfComponents(){const t=[];if(!this.dropdownMenuPlugin)return t;const e=this.dropdownMenuPlugin.menu;for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Np(i,(n=>{Np(e.menuItems,((e,i)=>{e.key===n.getMenuItemDescriptor().key&&t.push(i)}))})),t}changeComponentsVisibility(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const e=this.dropdownMenuPlugin.menu.hotMenu,n=e.getPlugin("hiddenRows");for(var i=arguments.length,o=new Array(i>1?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];const s=this.getIndexesOfComponents(...o);t?n.showRows(s):n.hideRows(s),e.render()}hideComponents(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility(!1,...e)}showComponents(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.changeComponentsVisibility(!0,...e)}destroy(){this.enabled&&(this.components.forEach(((t,e)=>{null!==t&&(t.destroy(),this.components.set(e,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function lY(t){t&&Np(t,(t=>{const[,e]=t,n=this.hot.propToCol(e);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)}))}function aY(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function hY(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function cY(){const t=this.dropdownMenuPlugin.menu;JU(oY,this).has(t)||JU(iY,this).setMenu(t),JU(oY,this).add(t)}function uY(t){t.items.push({name:OV}),this.components.forEach((e=>{t.items.push(e.getMenuItemDescriptor())}))}function dY(t){var e;if("accept"===t){const t=this.getSelectedColumn();var n;if(null===t)return void(null===(n=this.dropdownMenuPlugin)||void 0===n||n.close());const{physicalIndex:e}=t,i=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),r=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),i,o,r);this.conditionUpdateObserver.groupChanges();let l=this.conditionCollection.getColumnStackPosition(e);-1===l&&(l=void 0),this.conditionCollection.removeConditions(e),i.command.key!==TB&&(this.conditionCollection.addCondition(e,i,s,l),o.command.key!==TB&&this.conditionCollection.addCondition(e,o,s,l)),r.command.key!==TB&&this.conditionCollection.addCondition(e,r,s,l),this.conditionUpdateObserver.flush(),this.components.forEach((t=>t.saveState(e))),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}function gY(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor!==Nz||e.inputsCount||this.setListeningDropdownMenu(),n.updateMenuDimensions()}function fY(){this.setListeningDropdownMenu()}function mY(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?Mw(e,"htFiltersActive"):xw(e,"htFiltersActive")}function pY(t){var e;if(null===(e=this.dropdownMenuPlugin)||void 0===e||!e.enabled)return;const{editedConditionStack:{conditions:n,column:i}}=t,o=n.filter((t=>t.name===KB)),r=n.filter((t=>t.name!==KB));if(o.length>=2||r.length>=3)Ey(Fp`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const e=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(r[0],i),this.components.get("filter_by_condition2").updateState(r[1],i),this.components.get("filter_operators").updateState(e,i),this.components.get("filter_by_value").updateState(t)}}const wY="internal-use-in-handsontable",vY={licenseKey:wY,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function yY(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:null===(e=t[h$])||void 0===e||null===(e=e.language)||void 0===e?void 0:e.langCode}}function bY(t){return Object.keys(t).reduce(((e,n)=>("hyperformula"!==n&&(e[n]=t[n]),e)),{})}function CY(){const t="engine_relationship",e=cb(h$);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function SY(){const t="shared_engine_usage",e=cb(h$);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function RY(t){const e=t.getSettings(),n=e[h$],i=null==n?void 0:n.engine;if(!0===n)return null;if(Bp(i))return null;var o;if("function"==typeof i.hyperformula||"function"==typeof i)return function(t,e,n){const i=e[h$],o=function(t){var e;const n=t[h$],i=bY(null!=n&&null!==(e=n.engine)&&void 0!==e&&e.hyperformula?n.engine:{}),o=yY(t);return a(a(a({},vY),i),o)}(e),r=CY(),s=SY();(function(t,e){e&&e.forEach((e=>{const{name:n,plugin:i,translations:o}=e;try{t.registerFunction(n,i,o)}catch(r){Ey(r.message)}}))})(t,i.functions),function(t,e){if(e){const{langCode:i}=e;try{t.registerLanguage(i,e)}catch(n){Ey(n.message)}}}(t,i.language);const l=t.buildEmpty(o);return r.set(l,[n]),s.set(l,[n.guid]),function(t,e){e&&(t.suspendEvaluation(),e.forEach((e=>{const{name:n,expression:i,scope:o,options:r}=e;try{t.addNamedExpression(n,i,o,r)}catch(s){Ey(s.message)}})),t.resumeEvaluation())}(l,i.namedExpressions),l.on("sheetAdded",(()=>{l.rebuildAndRecalculate()})),l.on("sheetRemoved",(()=>{l.rebuildAndRecalculate()})),l}(null!==(o=i.hyperformula)&&void 0!==o?o:i,e,t);if("object"==typeof i&&Bp(i.hyperformula)){const e=CY(),n=SY().get(i);return e.has(i)||e.set(i,[]),e.get(i).push(t),n&&n.push(t.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:wY}),i.getConfig().leapYear1900===vY.leapYear1900&&!1!==Gv(i.getConfig().nullDate,vY.nullDate)||Ey(Fp`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function EY(t){var e;const n=CY(),i=0===n.size?[]:Array.from(null!==(e=n.get(t))&&void 0!==e?e:[]);return new Map(i.map((t=>[t.getPlugin("formulas").sheetId,t])))}function TY(t,e){if(t){const n=CY(),i=n.get(t),o=SY(),r=o.get(t);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),0===i.length&&n.delete(t)),r&&r.includes(e.guid)&&(r.splice(r.indexOf(e.guid),1),0===r.length&&(o.delete(t),t.destroy()))}}const MY="DD/MM/YYYY";function xY(t){return"string"==typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function HY(t,e){return"string"==typeof t&&"date"===e}function kY(t,e){return Sd(t,e,!0).isValid()}function IY(t,e){return Sd(t,e,!0).format(MY)}function OY(t,e){return Sd(new Date(Date.UTC(0,0,t+-1))).format(e)}function AY(t,e,n){const i=function(t,e){const n=[];return t.forEach((t=>{const i={from:t,to:e};n.forEach((t=>{const e=t.from>t.to,n=t.to<=i.from;t.from>i.from&&n&&e&&(i.from+=1)})),i.from>=e&&(e+=1),n.push(i)})),n}(t,function(t,e,n){const i=Array.from(Array(n).keys()).filter((e=>!1===t.includes(e)));var o;return 0===e?null!==(o=i[e])&&void 0!==o?o:0:i[e-1]+1}(t,e,n));return function(t){return t.forEach(((e,n)=>{t.slice(n+1).forEach((t=>{const n=t.from<t.to;t.from>e.from&&n&&(t.from-=1)}))})),t}(i)}function _Y(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function PY(t,e){return t.get(DY(t,e))}function NY(t,e,n){return t.set(DY(t,e),n),n}function DY(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var LY=new WeakMap,VY=new WeakMap,FY=new WeakMap,WY=new WeakMap,jY=new WeakMap,BY=new WeakMap,zY=new WeakMap;const UY=class{constructor(t,e,n){_Y(this,LY,void 0),_Y(this,VY,void 0),_Y(this,FY,void 0),_Y(this,WY,[]),_Y(this,jY,[]),_Y(this,BY,void 0),_Y(this,zY,[]),NY(LY,this,t),NY(VY,this,e),NY(FY,this,n)}setRemovedHfIndexes(t){return NY(zY,this,t.map((t=>{const e=PY(VY,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(e)}))),PY(zY,this)}getRemovedHfIndexes(){return PY(zY,this)}getHfIndexFromVisualIndex(t){const e=PY(VY,this).getIndexesSequence(),n=PY(VY,this).getNotTrimmedIndexes();return e.indexOf(n[t])}syncMoves(t){const e=`move${tw(PY(LY,this))}s`;PY(FY,this).getEngine().batch((()=>{t.forEach((t=>{const n=t.from!==t.to,i=t.from+1!==t.to;n&&i&&PY(FY,this).getEngine()[e](PY(FY,this).getSheetId(),t.from,1,t.to)}))}))}storeMovesInformation(t,e,n){!1!==n&&(NY(jY,this,t.map((t=>this.getHfIndexFromVisualIndex(t)))),NY(BY,this,this.getHfIndexFromVisualIndex(e)))}calculateAndSyncMoves(t,e){if(PY(FY,this).isPerformingUndoRedo())return;if(!1===t||!1===e)return;const n=AY(PY(jY,this),PY(BY,this),PY(VY,this).getNumberOfIndexes());null===PY(FY,this).getSheetId()?PY(FY,this).getPostponeAction((()=>this.syncMoves(n))):this.syncMoves(n)}getIndexesChangeSyncMethod(){const t=`set${tw(PY(LY,this))}Order`;return e=>{if(PY(FY,this).isPerformingUndoRedo())return;const n=PY(VY,this).getIndexesSequence();if("update"===e&&n.length>0){const e=PY(WY,this).map((t=>n.indexOf(t))),i=PY(FY,this).getEngine().getSheetDimensions(PY(FY,this).getSheetId());let o;o="row"===PY(LY,this)?i.height:i.width;for(let t=e.length;t<o;t+=1)e.push(t);PY(FY,this).getEngine()[t](PY(FY,this).getSheetId(),e)}NY(WY,this,n)}}init(){NY(WY,this,PY(VY,this).getIndexesSequence())}};function YY(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function $Y(t,e){return t.get(KY(t,e))}function GY(t,e,n){return t.set(KY(t,e),n),n}function KY(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var XY=new WeakMap,qY=new WeakMap,ZY=new WeakMap,QY=new WeakMap,JY=new WeakMap,t$=new WeakMap,e$=new WeakMap;const n$=class{constructor(t,e,n){YY(this,XY,void 0),YY(this,qY,void 0),YY(this,ZY,void 0),YY(this,QY,!1),YY(this,JY,!1),YY(this,t$,null),YY(this,e$,null),GY(XY,this,new UY("row",t,this)),GY(qY,this,new UY("column",e,this)),GY(ZY,this,n)}getForAxis(t){return $Y("row"===t?XY:qY,this)}setPerformUndo(t){GY(QY,this,t)}setPerformRedo(t){GY(JY,this,t)}isPerformingUndoRedo(){return $Y(QY,this)||$Y(JY,this)}getSheetId(){return $Y(e$,this)}getEngine(){return $Y(t$,this)}getPostponeAction(){return $Y(ZY,this)}setupSyncEndpoint(t,e){GY(t$,this,t),GY(e$,this,e),$Y(XY,this).init(),$Y(qY,this).init()}};function i$(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o$(t,e,n){r$(t,e),e.set(t,n)}function r$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s$(t,e,n){return t.set(a$(t,e),n),n}function l$(t,e){return t.get(a$(t,e))}function a$(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const h$="formulas",c$=["maxRows","maxColumns","language"];lb.getSingleton().register("afterNamedExpressionAdded"),lb.getSingleton().register("afterNamedExpressionRemoved"),lb.getSingleton().register("afterSheetAdded"),lb.getSingleton().register("afterSheetRemoved"),lb.getSingleton().register("afterSheetRenamed"),lb.getSingleton().register("afterFormulasValuesUpdate");const u$=t=>"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t;var d$=new WeakMap,g$=new WeakMap,f$=new WeakMap,m$=new WeakSet;class p$ extends xN{constructor(){var t,e,n;super(...arguments),t=this,r$(e=this,n=m$),n.add(e),o$(this,d$,!1),o$(this,g$,!1),o$(this,f$,[["valuesUpdated",function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return a$(m$,t,N$).call(t,...n)}],["namedExpressionAdded",function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return a$(m$,t,D$).call(t,...n)}],["namedExpressionRemoved",function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return a$(m$,t,L$).call(t,...n)}],["sheetAdded",function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return a$(m$,t,V$).call(t,...n)}],["sheetRenamed",function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return a$(m$,t,F$).call(t,...n)}],["sheetRemoved",function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return a$(m$,t,W$).call(t,...n)}]]),i$(this,"staticRegister",cb("formulas")),i$(this,"engine",null),i$(this,"sheetName",null),i$(this,"indexSyncer",null),i$(this,"rowAxisSyncer",null),i$(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return h$}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[h$,...c$]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[h$]}enablePlugin(){var t,e=this;if(!this.enabled)if(this.engine=null!==(t=RY(this.hot))&&void 0!==t?t:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const t=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==t&&(this.sheetName=t)}this.addHook("beforeLoadData",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,y$).call(e,...n)})),this.addHook("afterLoadData",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,C$).call(e,...n)})),this.addHook("beforeUpdateData",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,y$).call(e,...n)})),this.addHook("afterUpdateData",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,C$).call(e,...n)})),this.addHook("modifyData",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,S$).call(e,...n)})),this.addHook("modifySourceData",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,R$).call(e,...n)})),this.addHook("beforeValidate",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,w$).call(e,...n)})),this.addHook("afterSetSourceDataAtCell",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,T$).call(e,...n)})),this.addHook("afterSetDataAtCell",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,E$).call(e,...n)})),this.addHook("afterSetDataAtRowProp",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,E$).call(e,...n)})),this.addHook("beforeCreateRow",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,M$).call(e,...n)})),this.addHook("beforeCreateCol",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,x$).call(e,...n)})),this.addHook("afterCreateRow",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,I$).call(e,...n)})),this.addHook("afterCreateCol",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,O$).call(e,...n)})),this.addHook("beforeRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,H$).call(e,...n)})),this.addHook("beforeRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,k$).call(e,...n)})),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,A$).call(e,...n)})),this.addHook("afterRemoveCol",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,_$).call(e,...n)})),this.indexSyncer=new n$(this.hot.rowIndexMapper,this.hot.columnIndexMapper,(t=>{this.hot.addHookOnce("init",(()=>{t()}))})),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",((t,e,n,i)=>{this.rowAxisSyncer.storeMovesInformation(t,e,i)})),this.hot.addHook("beforeColumnMove",((t,e,n,i)=>{this.columnAxisSyncer.storeMovesInformation(t,e,i)})),this.hot.addHook("afterRowMove",((t,e,n,i,o)=>{this.rowAxisSyncer.calculateAndSyncMoves(i,o)})),this.hot.addHook("afterColumnMove",((t,e,n,i,o)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,o)})),this.hot.addHook("beforeColumnFreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart,e)})),this.hot.addHook("afterColumnFreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.hot.addHook("beforeColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart-1,e)})),this.hot.addHook("afterColumnUnfreeze",((t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)})),this.addHook("afterCellMetaReset",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,b$).call(e,...n)})),this.addHook("beforeUndo",(()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()})),this.addHook("beforeRedo",(()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformUndo(!1)})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformRedo(!1)})),this.addHook("afterDetachChild",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,P$).call(e,...n)})),this.addHook("beforeAutofill",(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a$(m$,e,v$).call(e,...n)})),l$(f$,this).forEach((t=>{let[e,n]=t;return this.engine.on(e,n)})),super.enablePlugin()}else Ey("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}disablePlugin(){l$(f$,this).forEach((t=>{let[e,n]=t;return this.engine.off(e,n)})),TY(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(t){const e=function(t){var e;const n=t[h$],i=bY(null!=n&&null!==(e=n.engine)&&void 0!==e&&e.hyperformula?n.engine:{}),o=yY(t);return a(a({},i),o)}(this.hot.getSettings());(function(t,e){return Object.keys(e).some((n=>void 0!==e[n]&&e[n]!==t[n]))})(this.engine.getConfig(),e)&&this.engine.updateConfig(e);const n=this.hot.getSettings()[h$];if(jp(n)&&jp(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!t.data&&null===this.sheetName){const t=this.hot.getSettings()[h$].sheetName;t&&this.engine.doesSheetExist(t)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=t?t:void 0,this.hot.getSourceDataArray())}super.updatePlugin(t)}destroy(){l$(f$,this).forEach((t=>{var e;let[n,i]=t;return null===(e=this.engine)||void 0===e?void 0:e.off(n,i)})),s$(f$,this,null),TY(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(t,e){if(jp(e)&&(n=e,!(Array.isArray(n)&&n.length&&n.every((t=>Array.isArray(t))))))return Ey("The provided data should be an array of arrays."),!1;var n;if(null!=t&&this.engine.doesSheetExist(t))return Ey("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(null!=t?t:void 0);return e&&this.engine.setSheetContent(this.engine.getSheetId(n),e),n}catch(i){return Ey(i.message),!1}}switchSheet(t){if(!this.engine.doesSheetExist(t))return void Ty(`The sheet named \`${t}\` does not exist, switch aborted.`);this.sheetName=t;const e=this.engine.getSheetSerialized(this.sheetId);e.length>0&&this.hot.loadData(e,`${tw(h$)}.switchSheet`)}getCellType(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(t),o=this.hot.toPhysicalColumn(e);return null!==i&&null!==o?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)}):"EMPTY"}isFormulaCellType(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)})}renderDependentSheets(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new Set;t.forEach((t=>{var e;const i=null==t||null===(e=t.address)||void 0===e?void 0:e.sheet;void 0!==i&&(n.has(i)||n.add(i))})),EY(this.engine).forEach(((t,i)=>{var o;(e||i!==this.sheetId)&&n.has(i)&&(t.render(),null===(o=t.view)||void 0===o||o.adjustElementsSize())}))}validateDependentCells(t){const e=t=>{var e;const{row:n,col:i,sheet:o}=null!==(e=null==t?void 0:t.address)&&void 0!==e?e:{};return jp(o)?`${o}:${n}x${i}`:""},n=new Set((arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map((t=>e(t))));t.forEach((t=>{var i,o;const{row:r,col:s}=null!==(i=t.address)&&void 0!==i?i:{};if(!1===jp(r)||!1===jp(s)||r>=this.hot.countRows()||s>=this.hot.countCols())return;const l=null==t||null===(o=t.address)||void 0===o?void 0:o.sheet,a=e(t);if(void 0!==l&&!n.has(a)){const t=EY(this.engine).get(l);if(!t)return;t.validateCell(t.getDataAtCell(r,s),t.getCellMeta(r,s),(()=>{}))}}))}syncChangeWithEngine(t,e,n){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i))return void Ey(`Not possible to set cell data at ${JSON.stringify(i)}`);const o=this.hot.getCellMeta(t,e);var r;return HY(n,o.type)&&(kY(n,o.dateFormat)?n=IY(n,o.dateFormat):!1===("string"==typeof(r=n)&&r.startsWith("="))&&(n=`'${n}`)),this.engine.setCellContents(i,n)}}function w$(t,e,n){const i=this.hot.propToCol(n);if(this.isFormulaCellType(e,i)){const t={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},n=this.hot.getCellMeta(e,i);let o=this.engine.getCellValue(t);return"date"===n.type&&LC(o)&&(o=OY(o,n.dateFormat)),"object"==typeof o&&null!==o?o.value:o}return t}function v$(t,e,n){const{row:i,col:o}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),{row:l,col:a}=n.getTopStartCorner(),{row:h,col:c}=n.getBottomEndCorner(),u={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(d))return!1;const g=this.engine.getFillRangeData(u,d),{row:f,col:m}=u.start,{row:p,col:w}=u.end,v=p-f+1,y=w-m+1;for(let S=0;S<g.length;S+=1)for(let t=0;t<g[S].length;t+=1){const e=g[S][t],n=f+S%v,i=m+t%y,o=this.hot.getCellMeta(n,i);HY(e,o.type)&&(e.startsWith("'")?g[S][t]=e.slice(1):!1===this.isFormulaCellType(n,i,this.sheetId)&&(g[S][t]=(b=e,C=o.dateFormat,Sd(b,MY,!0).format(C))))}var b,C;return g}function y$(t,e){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(tw(h$))||s$(g$,this,Bp(this.hot.getSettings().data))}function b$(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach(((n,i)=>{n.forEach(((n,o)=>{const r=this.hot.getCellMeta(i,o),s=r.dateFormat;HY(n,r.type)&&(e=!0,kY(n,s)?t[i][o]=IY(n,s):!1===this.isFormulaCellType(i,o)&&(t[i][o]=`'${n}`))}))})),!0===e&&(s$(d$,this,!0),this.engine.setSheetContent(this.sheetId,t),s$(d$,this,!1))}function C$(t,e){var n,i;if(!(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(tw(h$)))if(this.sheetName=(n=this.engine,!Bp(i=this.hot.getSettings()[h$].sheetName)&&n.doesSheetExist(i)||(i=n.addSheet(i)),i),l$(g$,this))this.switchSheet(this.sheetName);else{const t=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,t)){s$(d$,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),s$(d$,this,!1)}}}function S$(t,e,n,i){if("get"!==i||l$(d$,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const o=this.hot.toVisualRow(t);if(null===o||null===e)return;if(!this.isFormulaCellType(o,e)){if("ARRAY"!==this.getCellType(o,e))return void(xY(n.value)&&(n.value=xY(r=n.value)?r.substr(1):r))}var r;const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let l=this.engine.getCellValue(s),a=this.hot.getCellsMeta().find((t=>t.visualRow===o&&t.visualCol===e));void 0===a&&(a={}),"date"===a.type&&LC(l)&&(l=OY(l,a.dateFormat));const h="object"==typeof l&&null!==l?l.value:l;n.value=h}function R$(t,e,n,i){if("get"!==i||l$(d$,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const o=this.hot.toVisualRow(t),r=this.hot.propToCol(e);if(null===o||null===r)return;if(!this.isFormulaCellType(o,r)){if("ARRAY"!==this.getCellType(o,r))return}const s=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===s.width&&0===s.height)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function E$(t,e){if(u$(e))return;const n=[],i=[],o=this.engine.batch((()=>{t.forEach((t=>{let[e,o,,r]=t;const s=this.hot.propToCol(o),l=this.hot.toPhysicalRow(e),a=this.hot.toPhysicalColumn(s),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};null!==l&&null!==a?this.syncChangeWithEngine(e,s,r):n.push([e,s,r]),i.push({address:h})}))}));n.length&&this.hot.addHookOnce("afterChange",(()=>{const t=this.engine.batch((()=>{n.forEach((t=>{let[e,n,i]=t;this.syncChangeWithEngine(e,n,i)}))}));this.renderDependentSheets(t,!0)})),this.renderDependentSheets(o),this.validateDependentCells(o,i)}function T$(t,e){if(u$(e))return;const n=[],i=[];t.forEach((t=>{let[e,o,,r]=t;const s=this.hot.propToCol(o);if(!LC(s))return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(l)?(i.push({address:l}),n.push(...this.engine.setCellContents(l,r))):Ey(`Not possible to set source cell data at ${JSON.stringify(l)}`)})),this.renderDependentSheets(n),this.validateDependentCells(n,i)}function M$(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function x$(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function H$(t,e,n){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(n).every((t=>this.engine.isItPossibleToRemoveRows(this.sheetId,[t,1])))&&void 0}function k$(t,e,n){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(n).every((t=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[t,1])))&&void 0}function I$(t,e,n){if(u$(n))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function O$(t,e,n){if(u$(n))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function A$(t,e,n,i){if(u$(i))return;const o=this.rowAxisSyncer.getRemovedHfIndexes().sort(((t,e)=>e-t)),r=this.engine.batch((()=>{o.forEach((t=>{this.engine.removeRows(this.sheetId,[t,1])}))}));this.renderDependentSheets(r)}function _$(t,e,n,i){if(u$(i))return;const o=this.columnAxisSyncer.getRemovedHfIndexes().sort(((t,e)=>e-t)),r=this.engine.batch((()=>{o.forEach((t=>{this.engine.removeColumns(this.sheetId,[t,1])}))}));this.renderDependentSheets(r)}function P$(t,e,n){var i;s$(d$,this,!0);const o=this.hot.getSourceDataArray(n,0,n+((null===(i=e.__children)||void 0===i?void 0:i.length)||0),this.hot.countSourceCols());s$(d$,this,!1),o.forEach(((t,e)=>{t.forEach(((t,i)=>{this.engine.setCellContents({col:i,row:n+e,sheet:this.sheetId},[[t]])}))}))}function N$(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function D$(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function L$(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function V$(t){this.hot.runHooks("afterSheetAdded",t)}function F$(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function W$(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function j$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function B$(t,e){return t.get(U$(t,e))}function z$(t,e,n){return t.set(U$(t,e),n),n}function U$(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}lb.getSingleton().register("beforeHideColumns"),lb.getSingleton().register("afterHideColumns"),lb.getSingleton().register("beforeUnhideColumns"),lb.getSingleton().register("afterUnhideColumns");const Y$="hiddenColumns";var $$=new WeakMap,G$=new WeakSet;class K$ extends xN{constructor(){var t,e;super(...arguments),j$(t=this,e=G$),e.add(t),function(t,e,n){j$(t,e),e.set(t,n)}(this,$$,null)}static get PLUGIN_KEY(){return Y$}static get PLUGIN_PRIORITY(){return 310}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[Y$]}enablePlugin(){var t=this;this.enabled||(z$($$,this,new sx),B$($$,this).addLocalHook("init",(()=>U$(G$,this,tG).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,B$($$,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return U$(G$,t,J$).call(t,...n)})),this.addHook("afterGetCellMeta",((t,e,n)=>U$(G$,this,q$).call(this,t,e,n))),this.addHook("modifyColWidth",((t,e)=>U$(G$,this,X$).call(this,t,e)),2),this.addHook("afterGetColHeader",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return U$(G$,t,Q$).call(t,...n)})),this.addHook("modifyCopyableRange",(t=>U$(G$,this,Z$).call(this,t))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showColumns(t){const e=this.getHiddenColumns(),n=this.isValidConfig(t);let i=e;const o=B$($$,this).getValues().slice(),r=t.length>0;if(n&&r){Np(t.map((t=>this.hot.toPhysicalColumn(t))),(t=>{o[t]=!1})),i=Ap(o,((t,e,n)=>(e&&t.push(this.hot.toVisualColumn(n)),t)),[])}!1!==this.hot.runHooks("beforeUnhideColumns",e,i,n&&r)&&(n&&r&&B$($$,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",e,i,n&&r,n&&i.length<e.length))}showColumn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showColumns(e)}hideColumns(t){const e=this.getHiddenColumns(),n=this.isValidConfig(t);let i=e;n&&(i=Array.from(new Set(e.concat(t))));!1!==this.hot.runHooks("beforeHideColumns",e,i,n)&&(n&&this.hot.batchExecution((()=>{Np(t,(t=>{B$($$,this).setValueAtIndex(this.hot.toPhysicalColumn(t),!0)}))}),!0),this.hot.runHooks("afterHideColumns",e,i,n,n&&i.length>e.length))}hideColumn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideColumns(e)}getHiddenColumns(){return Pp(B$($$,this).getHiddenIndexes(),(t=>this.hot.toVisualColumn(t)))}isHidden(t){return B$($$,this).getValueAtIndex(this.hot.toPhysicalColumn(t))||!1}isValidConfig(t){const e=this.hot.countCols();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){Np(this.hot.getCellsMeta(),(t=>{t&&(t.skipColumnOnPaste=!1)}))}destroy(){z$($$,this,null),super.destroy()}}function X$(t,e){return this.isHidden(e)?0:this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"==typeof t&&this.hot.hasColHeaders()?t+15:void 0}function q$(t,e,n){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){const t=n.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenColumn");e>-1&&t.splice(e,1),n.className=t.join(" ")}}}function Z$(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(t,n,i,o)=>{e.push({startRow:t,endRow:n,startCol:i,endCol:o})};return Np(t,(t=>{let e=!0,i=0;VC(t.startCol,t.endCol,(o=>{this.isHidden(o)?(e||n(t.startRow,t.endRow,i,o-1),e=!0):(e&&(i=o),o===t.endCol&&n(t.startRow,t.endRow,i,o),e=!1)}))})),e}function Q$(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),Mw(e,n)}function J$(t){var e;t.items.push({name:OV},(e=this,{key:"hidden_columns_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[,n,,i]=t;n-i!=0&&(e=1)}return this.getTranslatedPhrase(IH,e)},callback(){const{from:t,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(t.col,n.col),0),o=Math.max(t.col,n.col),r=[];for(let e=i;e<=o;e+=1)r.push(e);e.hideColumns(r);const s=r[r.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(t){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(OH,t)},callback(){var n,i;if(0===e.length)return;let o=e[0],r=e[e.length-1];o=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,r=null!==(i=this.columnIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==i?i:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),r-o+1===this.countCols()||this.selectColumns(o,r)},disabled:!1,hidden(){const n=Pp(t.getHiddenColumns(),(t=>this.toPhysicalColumn(t)));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),o=i.getTopStartCorner().col,r=i.getBottomEndCorner().col,s=this.columnIndexMapper,l=s.getRenderableFromVisualIndex(o),a=s.getRenderableFromVisualIndex(r),h=s.getNotTrimmedIndexes(),c=[];if(o!==r){if(r-o+1>a-l+1){const t=h.slice(o,r+1);c.push(...t.filter((t=>n.includes(t))))}}else if(0===l&&l<o)c.push(...h.slice(0,o));else if(null===l)c.push(...h.slice(0,this.countCols()));else{const t=this.countCols()-1;a===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1))&&t>r&&c.push(...h.slice(r+1))}return Np(c,(t=>{e.push(this.toVisualColumn(t))})),0===e.length}}}(this))}function tG(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function eG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nG(t,e){return t.get(oG(t,e))}function iG(t,e,n){return t.set(oG(t,e),n),n}function oG(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}lb.getSingleton().register("beforeHideRows"),lb.getSingleton().register("afterHideRows"),lb.getSingleton().register("beforeUnhideRows"),lb.getSingleton().register("afterUnhideRows");const rG="hiddenRows";var sG=new WeakMap,lG=new WeakSet;class aG extends xN{constructor(){var t,e;super(...arguments),eG(t=this,e=lG),e.add(t),function(t,e,n){eG(t,e),e.set(t,n)}(this,sG,null)}static get PLUGIN_KEY(){return rG}static get PLUGIN_PRIORITY(){return 320}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[rG]}enablePlugin(){var t=this;this.enabled||(iG(sG,this,new sx),nG(sG,this).addLocalHook("init",(()=>oG(lG,this,fG).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,nG(sG,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return oG(lG,t,gG).call(t,...n)})),this.addHook("afterGetCellMeta",((t,e,n)=>oG(lG,this,cG).call(this,t,e,n))),this.addHook("modifyRowHeight",((t,e)=>oG(lG,this,hG).call(this,t,e))),this.addHook("afterGetRowHeader",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return oG(lG,t,dG).call(t,...n)})),this.addHook("modifyCopyableRange",(t=>oG(lG,this,uG).call(this,t))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showRows(t){const e=this.getHiddenRows(),n=this.isValidConfig(t);let i=e;const o=nG(sG,this).getValues().slice(),r=t.length>0;if(n&&r){Np(t.map((t=>this.hot.toPhysicalRow(t))),(t=>{o[t]=!1})),i=Ap(o,((t,e,n)=>(e&&t.push(this.hot.toVisualRow(n)),t)),[])}!1!==this.hot.runHooks("beforeUnhideRows",e,i,n&&r)&&(n&&r&&nG(sG,this).setValues(o),this.hot.runHooks("afterUnhideRows",e,i,n&&r,n&&i.length<e.length))}showRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.showRows(e)}hideRows(t){const e=this.getHiddenRows(),n=this.isValidConfig(t);let i=e;n&&(i=Array.from(new Set(e.concat(t))));!1!==this.hot.runHooks("beforeHideRows",e,i,n)&&(n&&this.hot.batchExecution((()=>{Np(t,(t=>{nG(sG,this).setValueAtIndex(this.hot.toPhysicalRow(t),!0)}))}),!0),this.hot.runHooks("afterHideRows",e,i,n,n&&i.length>e.length))}hideRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.hideRows(e)}getHiddenRows(){return Pp(nG(sG,this).getHiddenIndexes(),(t=>this.hot.toVisualRow(t)))}isHidden(t){return nG(sG,this).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}isValidConfig(t){const e=this.hot.countRows();return!!(Array.isArray(t)&&t.length>0)&&t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}resetCellsMeta(){Np(this.hot.getCellsMeta(),(t=>{t&&(t.skipRowOnPaste=!1)}))}destroy(){iG(sG,this,null),super.destroy()}}function hG(t,e){return this.isHidden(e)?0:t}function cG(t,e,n){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){const t=n.className.split(" ");if(t.length>0){const e=t.indexOf("afterHiddenRow");e>-1&&t.splice(e,1),n.className=t.join(" ")}}}function uG(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(t,n,i,o)=>{e.push({startRow:t,endRow:n,startCol:i,endCol:o})};return Np(t,(t=>{let e=!0,i=0;VC(t.startRow,t.endRow,(o=>{this.isHidden(o)?(e||n(i,o-1,t.startCol,t.endCol),e=!0):(e&&(i=o),o===t.endRow&&n(i,o,t.startCol,t.endCol),e=!1)}))})),e}function dG(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),Mw(e,n)}function gG(t){var e;t.items.push({name:OV},(e=this,{key:"hidden_rows_hide",name(){const t=this.getSelectedLast();let e=0;if(Array.isArray(t)){const[n,,i]=t;n-i!=0&&(e=1)}return this.getTranslatedPhrase(AH,e)},callback(){const{from:t,to:n}=this.getSelectedRangeLast(),i=Math.max(Math.min(t.row,n.row),0),o=Math.max(t.row,n.row),r=[];for(let e=i;e<=o;e+=1)r.push(e);e.hideRows(r);const s=r[r.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(t){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(_H,t)},callback(){var n,i;if(0===e.length)return;let o=e[0],r=e[e.length-1];o=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))&&void 0!==n?n:0,r=null!==(i=this.rowIndexMapper.getNearestNotHiddenIndex(r+1,1))&&void 0!==i?i:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),r-o+1===this.countRows()||this.selectRows(o,r)},disabled:!1,hidden(){const n=Pp(t.getHiddenRows(),(t=>this.toPhysicalRow(t)));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),o=i.getTopStartCorner().row,r=i.getBottomEndCorner().row,s=this.rowIndexMapper,l=s.getRenderableFromVisualIndex(o),a=s.getRenderableFromVisualIndex(r),h=s.getNotTrimmedIndexes(),c=[];if(o!==r){if(r-o+1>a-l+1){const t=h.slice(o,r+1);c.push(...t.filter((t=>n.includes(t))))}}else if(0===l&&l<o)c.push(...h.slice(0,o));else if(null===l)c.push(...h.slice(0,this.countRows()));else{const t=this.countRows()-1;a===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1))&&t>r&&c.push(...h.slice(r+1))}return Np(c,(t=>{e.push(this.toVisualRow(t))})),0===e.length}}}(this))}function fG(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function mG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pG(t,e){return t.get(vG(t,e))}function wG(t,e,n){return t.set(vG(t,e),n),n}function vG(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}lb.getSingleton().register("beforeColumnFreeze"),lb.getSingleton().register("afterColumnFreeze"),lb.getSingleton().register("beforeColumnUnfreeze"),lb.getSingleton().register("afterColumnUnfreeze");const yG="manualColumnFreeze";var bG=new WeakMap,CG=new WeakSet;class SG extends xN{constructor(){var t,e;super(...arguments),mG(t=this,e=CG),e.add(t),function(t,e,n){mG(t,e),e.set(t,n)}(this,bG,!1)}static get PLUGIN_KEY(){return yG}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings()[yG]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(t=>vG(CG,this,RG).call(this,t))),this.addHook("beforeColumnMove",((t,e)=>vG(CG,this,EG).call(this,t,e))),super.enablePlugin())}disablePlugin(){wG(bG,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(t){const e=this.hot.getSettings(),n=e.fixedColumnsStart<this.hot.countCols()&&t>e.fixedColumnsStart-1;pG(bG,this)||wG(bG,this,!0);!1!==this.hot.runHooks("beforeColumnFreeze",t,n)&&(n&&(this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart),e._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",t,n))}unfreezeColumn(t){const e=this.hot.getSettings(),n=e.fixedColumnsStart>0&&t<=e.fixedColumnsStart-1;pG(bG,this)||wG(bG,this,!0);!1!==this.hot.runHooks("beforeColumnUnfreeze",t,n)&&(n&&(e._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",t,n))}}function RG(t){var e;t.items.push({name:"---------"},(e=this,{key:"freeze_column",name(){return this.getTranslatedPhrase(sH)},callback(t,n){const[{start:{col:i}}]=n;e.freezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(e=!0),e}}),function(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(lH)},callback(e,n){const[{start:{col:i}}]=n;t.unfreezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const t=this.getSelectedRange();let e=!1;return(void 0===t||t.length>1||t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(e=!0),e}}}(this))}function EG(t,e){if(pG(bG,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n)return!1;if(t.some((t=>t<n)))return!1}}function TG(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const MG="px";const xG=class{constructor(t){TG(this,"hot",void 0),TG(this,"_element",null),TG(this,"state",0),TG(this,"inlineProperty",void 0),this.hot=t,this.inlineProperty=t.isRtl()?"right":"left"}appendTo(t){t.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(t,e){LC(t)&&(this._element.style.top=t+MG),LC(e)&&(this._element.style[this.inlineProperty]=e+MG)}getPosition(){const t=this._element.style;return{top:t.top?parseInt(t.top,10):0,start:t[this.inlineProperty]?parseInt(t[this.inlineProperty],10):0}}setSize(t,e){LC(t)&&(this._element.style.width=t+MG),LC(e)&&(this._element.style.height=e+MG)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){LC(t)&&(this._element.style.marginTop=t+MG),LC(e)&&(this._element.style[`margin${tw(this.inlineProperty)}`]=e+MG)}getOffset(){const t=this._element.style,e=`margin${tw(this.inlineProperty)}`;return{top:t.marginTop?parseInt(t.marginTop,10):0,start:t[e]?parseInt(t[e],10):0}}};const HG=class extends xG{build(){super.build(),Mw(this._element,"ht__manualColumnMove--backlight")}};const kG=class extends xG{build(){super.build(),Mw(this._element,"ht__manualColumnMove--guideline")}};function IG(t,e,n){OG(t,e),e.set(t,n)}function OG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AG(t,e,n){return t.set(PG(t,e),n),n}function _G(t,e){return t.get(PG(t,e))}function PG(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}lb.getSingleton().register("beforeColumnMove"),lb.getSingleton().register("afterColumnMove");const NG="manualColumnMove",DG="ht__manualColumnMove",LG="show-ui",VG="on-moving--columns",FG="after-selection--columns";var WG=new WeakMap,jG=new WeakMap,BG=new WeakMap,zG=new WeakMap,UG=new WeakMap,YG=new WeakMap,$G=new WeakMap,GG=new WeakMap,KG=new WeakMap,XG=new WeakMap,qG=new WeakMap,ZG=new WeakSet;class QG extends xN{constructor(){var t,e;super(...arguments),OG(t=this,e=ZG),e.add(t),IG(this,WG,new HG(this.hot)),IG(this,jG,new kG(this.hot)),IG(this,BG,[]),IG(this,zG,0),IG(this,UG,!1),IG(this,YG,{}),IG(this,$G,void 0),IG(this,GG,void 0),IG(this,KG,void 0),IG(this,XG,void 0),IG(this,qG,void 0)}static get PLUGIN_KEY(){return NG}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings()[NG]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return PG(ZG,t,JG).call(t,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return PG(ZG,t,eK).call(t,...n)})),this.addHook("afterScrollVertically",(()=>PG(ZG,this,iK).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return PG(ZG,t,oK).call(t,...n)})),this.buildPluginUI(),this.registerEvents(),Mw(this.hot.rootElement,DG),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){xw(this.hot.rootElement,DG),this.unregisterEvents(),_G(WG,this).destroy(),_G(jG,this).destroy(),super.disablePlugin()}moveColumn(t,e){return this.moveColumns([t],e)}moveColumns(t,e){const n=_G($G,this),i=this.isMovePossible(t,e),o=this.hot.runHooks("beforeColumnMove",t,e,n,i);if(AG($G,this,void 0),!1===o)return;i&&this.hot.columnIndexMapper.moveIndexes(t,e);const r=i&&this.isColumnOrderChanged(t,e);return this.hot.runHooks("afterColumnMove",t,e,n,i,r),r}dragColumn(t,e){return this.dragColumns([t],e)}dragColumns(t,e){const n=this.countFinalIndex(t,e);return AG($G,this,e),this.moveColumns(t,n)}isMovePossible(t,e){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=t.length+e>n,o=e<0,r=t.some((t=>t<0)),s=t.some((t=>t>=n));return!(i||o||r||s)}isColumnOrderChanged(t,e){return t.some(((t,n)=>t-n!==e))}countFinalIndex(t,e){const n=Ap(t,((t,n)=>(n<e&&(t+=1),t)),0);return e-n}getColumnsWidth(t,e){const n=this.hot.columnIndexMapper;let i=0;for(let o=t;o<=e;o+=1){const t=n.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==t&&(i+=this.hot.view._wt.wtTable.getColumnWidth(t)||0)}return i}moveBySettingsOrLoad(){const t=this.hot.getSettings()[NG];if(Array.isArray(t))this.moveColumns(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(t){return t<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value?t.value:[]}prepareColumnsToMoving(t,e){const n=[];return VC(t,e,(t=>{n.push(t)})),n}refreshPositions(){const t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(_G(GG,this))&&t>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1)});const e=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,i="number"==typeof n.scrollX?n.scrollX:n.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,_G(GG,this)-1);const r=e.hider.offsetWidth,s=e.TBODY.offsetLeft,l=_G(WG,this).getOffset().start,a=_G(WG,this).getSize().width;let h=0,c=0;if(this.hot.isRtl()){const t=this.hot.rootWindow,e=Uw(this.hot.rootElement),o=t.innerWidth-_G(KG,this)-e;c=t.innerWidth-_G(YG,this).eventPageX-o-(void 0===n.scrollX?i:0)}else c=_G(YG,this).eventPageX-(_G(KG,this)-(void 0===n.scrollX?i:0));if(_G(XG,this)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(_G(GG,this))&&(o+=i),o+=h,_G(GG,this)<0)_G(qG,this)>0?_G(YG,this).col=0:_G(YG,this).col=t>0?t-1:t;else if(_G(YG,this).TD.offsetWidth/2+o<=c){const t=_G(GG,this)>=_G(zG,this)?_G(zG,this)-1:_G(GG,this);_G(YG,this).col=t+1,o+=_G(YG,this).TD.offsetWidth}else _G(YG,this).col=_G(GG,this);let u=c,d=o;c+a+l>=r?u=r-a-l:c+l<s+h&&(u=s+h+Math.abs(l)),o>=r-1?d=r-1:0===d?d=1:void 0!==n.scrollX&&_G(GG,this)<_G(qG,this)&&(d-=_G(KG,this)<=n.scrollX?_G(KG,this):0),_G(WG,this).setPosition(null,u),_G(jG,this).setPosition(null,d)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>PG(ZG,this,tK).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>PG(ZG,this,nK).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_G(WG,this).build(),_G(jG,this).build()}destroy(){_G(WG,this).destroy(),_G(jG,this).destroy(),super.destroy()}}function JG(t,e,n,i){const o=this.hot.view._wt.wtTable,r=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),l=Tw(t.target,"sortAction");if(!s||!r||_G(UG,this)||0!==t.button||l)return AG(UG,this,!1),_G(BG,this).length=0,void xw(this.hot.rootElement,[VG,LG]);const a=_G(jG,this).isBuilt()&&!_G(jG,this).isAppended(),h=_G(WG,this).isBuilt()&&!_G(WG,this).isAppended();a&&h&&(_G(jG,this).appendTo(o.hider),_G(WG,this).appendTo(o.hider));const{from:c,to:u}=s,d=Math.min(c.col,u.col),g=Math.max(c.col,u.col);if(e.row<0&&e.col>=d&&e.col<=g){i.column=!0,AG(UG,this,!0);const r=n.firstChild?function(t,e){const n={x:t.offsetX,y:t.offsetY};let i=t.target;if(!(e instanceof HTMLElement)||i!==e&&i.contains(e))return n;for(;i!==e;)n.x+=i.offsetLeft,n.y+=i.offsetTop,i=i.offsetParent;return n}(t,n.firstChild).x:t.offsetX;_G(YG,this).eventPageX=t.pageX,AG(GG,this,e.col),_G(YG,this).TD=n,_G(YG,this).col=e.col,AG(BG,this,this.prepareColumnsToMoving(d,g)),AG(XG,this,!!this.hot.getSettings().rowHeaders),AG(zG,this,this.hot.countCols()),AG(qG,this,this.hot.getSettings().fixedColumnsStart),AG(KG,this,Dw(this.hot.rootElement).left);const s=_G(XG,this)?-1:0,l=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,a=e.col<_G(qG,this),h=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),c=Math.abs(r-(this.hot.isRtl()?n.offsetWidth:0)),u=this.getColumnsWidth(d,e.col-1)+c,f=this.getColumnsWidth(s,d-1)+(a?h:0)+u;_G(WG,this).setPosition(l,f),_G(WG,this).setSize(this.getColumnsWidth(d,g),o.hider.offsetHeight-l),_G(WG,this).setOffset(null,-u),Mw(this.hot.rootElement,VG)}else xw(this.hot.rootElement,FG),AG(UG,this,!1),_G(BG,this).length=0}function tK(t){_G(UG,this)&&(_G(YG,this).eventPageX=t.pageX,this.refreshPositions())}function eK(t,e,n,i){this.hot.getSelectedRangeLast()&&_G(UG,this)&&(_G(BG,this).indexOf(e.col)>-1?xw(this.hot.rootElement,LG):Mw(this.hot.rootElement,LG),i.row=!0,i.column=!0,i.cell=!0,AG(GG,this,e.col),_G(YG,this).TD=n)}function nK(){const t=_G(YG,this).col,e=_G(BG,this).length;if(AG(GG,this,void 0),AG(UG,this,!1),xw(this.hot.rootElement,[VG,LG,FG]),this.hot.selection.isSelectedByColumnHeader()&&Mw(this.hot.rootElement,FG),e<1||void 0===t)return;const n=_G(BG,this)[0],i=this.hot.toPhysicalColumn(n),o=this.dragColumns(_G(BG,this),t);if(_G(BG,this).length=0,!0===o){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const t=this.hot.toVisualColumn(i),n=t+e-1;this.hot.selectColumns(t,n)}}function iK(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1+t.holder.scrollTop;_G(WG,this).setPosition(e),_G(WG,this).setSize(null,t.hider.offsetHeight-e)}function oK(){this.moveBySettingsOrLoad()}function rK(t,e,n){sK(t,e),e.set(t,n)}function sK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lK(t,e,n){return t.set(hK(t,e),n),n}function aK(t,e){return t.get(hK(t,e))}function hK(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cK="manualColumnResize",uK="manualColumnWidths";var dK=new WeakMap,gK=new WeakMap,fK=new WeakMap,mK=new WeakMap,pK=new WeakMap,wK=new WeakMap,vK=new WeakMap,yK=new WeakMap,bK=new WeakMap,CK=new WeakMap,SK=new WeakMap,RK=new WeakMap,EK=new WeakMap,TK=new WeakMap,MK=new WeakMap,xK=new WeakMap,HK=new WeakSet;class kK extends xN{static get PLUGIN_KEY(){return cK}static get PLUGIN_PRIORITY(){return 130}constructor(t){var e,n;super(t),sK(e=this,n=HK),n.add(e),rK(this,dK,null),rK(this,gK,null),rK(this,fK,[]),rK(this,mK,null),rK(this,pK,null),rK(this,wK,null),rK(this,vK,null),rK(this,yK,null),rK(this,bK,this.hot.rootDocument.createElement("DIV")),rK(this,CK,this.hot.rootDocument.createElement("DIV")),rK(this,SK,null),rK(this,RK,!1),rK(this,EK,0),rK(this,TK,null),rK(this,MK,void 0),rK(this,xK,void 0),Mw(aK(bK,this),"manualColumnResizer"),Mw(aK(CK,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[cK]}enablePlugin(){var t=this;this.enabled||(lK(MK,this,new rx),aK(MK,this).addLocalHook("init",(()=>hK(HK,this,IK).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,aK(MK,this)),this.addHook("modifyColWidth",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return hK(HK,t,DK).call(t,...n)}),1),this.addHook("beforeStretchingColumnWidth",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return hK(HK,t,LK).call(t,...n)}),1),this.addHook("beforeColumnResize",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return hK(HK,t,VK).call(t,...n)})),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){lK(xK,this,aK(MK,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",uK,aK(MK,this).getValues())}loadManualColumnWidths(){const t={};return this.hot.runHooks("persistentStateLoad",uK,t),t.value}setManualSize(t,e){const n=Math.max(e,20),i=this.hot.toPhysicalColumn(t);return aK(MK,this).setValueAtIndex(i,n),n}clearManualSize(t){const e=this.hot.toPhysicalColumn(t);aK(MK,this).setValueAtIndex(e,null)}setupHandlePosition(t){if(!t.parentNode)return;lK(dK,this,t);const{_wt:e}=this.hot.view,n=e.wtTable.getCoords(aK(dK,this)),i=n.col;if(i<0)return;const o=Yw(aK(dK,this)),r=aK(dK,this).getBoundingClientRect();let s;i<e.getSetting("fixedColumnsStart")&&(s=e.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(aK(dK,this),n.row,n.col)),s||(s=e.wtOverlays.topOverlay.getRelativeCellPosition(aK(dK,this),n.row,n.col)),lK(gK,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),lK(fK,this,[]);const l=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&l){Np(this.hot.getSelectedRange(),(t=>{VC(t.getTopStartCorner().col,t.getBottomEndCorner().col,(t=>{aK(fK,this).includes(t)||aK(fK,this).push(t)}))}))}aK(fK,this).includes(aK(gK,this))||lK(fK,this,[aK(gK,this)]),lK(yK,this,s.start-6),lK(vK,this,parseInt(r.width,10)),aK(bK,this).style.top=`${s.top}px`,aK(bK,this).style[this.inlineDir]=`${aK(yK,this)+aK(vK,this)}px`,aK(bK,this).style.height=`${o}px`,this.hot.rootElement.appendChild(aK(bK,this))}refreshHandlePosition(){aK(bK,this).style[this.inlineDir]=`${aK(yK,this)+aK(mK,this)}px`}setupGuidePosition(){const t=parseInt(Yw(aK(bK,this)),10),e=parseInt(aK(bK,this).style.top,10)+t,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Mw(aK(bK,this),"active"),Mw(aK(CK,this),"active"),aK(CK,this).style.top=`${e}px`,this.refreshGuidePosition(),aK(CK,this).style.height=n-t+"px",this.hot.rootElement.appendChild(aK(CK,this))}refreshGuidePosition(){aK(CK,this).style[this.inlineDir]=aK(bK,this).style[this.inlineDir]}hideHandleAndGuide(){xw(aK(bK,this),"active"),xw(aK(CK,this),"active")}checkIfColumnHeader(t){const e=yw(t,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(e,n)=>{const i=this.hot.runHooks("beforeColumnResize",aK(pK,this),e,!0);void 0!==i&&lK(pK,this,i),this.setManualSize(e,aK(pK,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",aK(pK,this),e,!0),n&&t()};if(aK(EK,this)>=2){aK(fK,this).length>1?(Np(aK(fK,this),(t=>{e(t)})),t()):Np(aK(fK,this),(t=>{e(t,!0)}))}lK(EK,this,0),lK(TK,this,null)}bindEvents(){const{rootWindow:t,rootElement:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",(t=>hK(HK,this,OK).call(this,t))),this.eventManager.addEventListener(e,"mousedown",(t=>hK(HK,this,AK).call(this,t))),this.eventManager.addEventListener(t,"mousemove",(t=>hK(HK,this,_K).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>hK(HK,this,PK).call(this))),this.eventManager.addEventListener(aK(bK,this),"contextmenu",(()=>hK(HK,this,NK).call(this)))}destroy(){super.destroy()}}function IK(){const t=this.hot.getSettings()[cK],e=this.loadManualColumnWidths();void 0!==e?this.hot.batchExecution((()=>{e.forEach(((t,e)=>{aK(MK,this).setValueAtIndex(e,t)}))}),!0):Array.isArray(t)?(this.hot.batchExecution((()=>{t.forEach(((t,e)=>{aK(MK,this).setValueAtIndex(e,t)}))}),!0),lK(xK,this,t)):!0===t&&Array.isArray(aK(xK,this))&&this.hot.batchExecution((()=>{aK(xK,this).forEach(((t,e)=>{aK(MK,this).setValueAtIndex(e,t)}))}),!0)}function OK(t){if(!iv(t.target)&&!0!==aK(RK,this)&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");!e||null!==n&&"1"!==n||aK(SK,this)||this.setupHandlePosition(e)}}function AK(t){t.target.parentNode===this.hot.rootElement&&Tw(t.target,"manualColumnResizer")&&(this.setupHandlePosition(aK(dK,this)),this.setupGuidePosition(),lK(SK,this,!0),null===aK(TK,this)&&(lK(TK,this,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(aK(TK,this))),lK(EK,this,aK(EK,this)+1),this.startX=t.pageX,lK(pK,this,aK(vK,this)))}function _K(t){if(aK(SK,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();lK(mK,this,aK(vK,this)+e),Np(aK(fK,this),(t=>{lK(pK,this,this.setManualSize(t,aK(mK,this)))})),this.refreshHandlePosition(),this.refreshGuidePosition()}}function PK(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(e,n)=>{this.hot.runHooks("beforeColumnResize",aK(pK,this),e,!1),n&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",aK(pK,this),e,!1)};if(aK(SK,this)){if(this.hideHandleAndGuide(),lK(SK,this,!1),aK(pK,this)!==aK(vK,this)){aK(fK,this).length>1?(Np(aK(fK,this),(t=>{e(t)})),t()):Np(aK(fK,this),(t=>{e(t,!0)}))}this.setupHandlePosition(aK(dK,this))}}function NK(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(aK(bK,this)),this.hot.rootElement.removeChild(aK(CK,this)),lK(SK,this,!1),lK(RK,this,!0),this.hot._registerImmediate((()=>{lK(RK,this,!1)}))}function DK(t,e){let n=t;if(this.enabled){const t=this.hot.toPhysicalColumn(e),i=aK(MK,this).getValueAtIndex(t);this.hot.getSettings()[cK]&&i&&(n=i)}return n}function LK(t,e){const n=aK(MK,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return"number"==typeof n?n:t}function VK(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function FK(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const WK="px";const jK=class{constructor(t){FK(this,"hot",void 0),FK(this,"_element",null),FK(this,"state",0),this.hot=t}appendTo(t){t.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(t,e){void 0!==t&&(this._element.style.top=t+WK),void 0!==e&&(this._element.style.left=e+WK)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(t,e){t&&(this._element.style.width=t+WK),e&&(this._element.style.height=e+WK)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){t&&(this._element.style.marginTop=t+WK),e&&(this._element.style.marginLeft=e+WK)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const BK=class extends jK{build(){super.build(),Mw(this._element,"ht__manualRowMove--backlight")}};const zK=class extends jK{build(){super.build(),Mw(this._element,"ht__manualRowMove--guideline")}};function UK(t,e,n){YK(t,e),e.set(t,n)}function YK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $K(t,e,n){return t.set(KK(t,e),n),n}function GK(t,e){return t.get(KK(t,e))}function KK(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}lb.getSingleton().register("beforeRowMove"),lb.getSingleton().register("afterRowMove");const XK="manualRowMove",qK="ht__manualRowMove",ZK="show-ui",QK="on-moving--rows",JK="after-selection--rows";var tX=new WeakMap,eX=new WeakMap,nX=new WeakMap,iX=new WeakMap,oX=new WeakMap,rX=new WeakMap,sX=new WeakSet;class lX extends xN{constructor(){var t,e;super(...arguments),YK(t=this,e=sX),e.add(t),UK(this,tX,new BK(this.hot)),UK(this,eX,new zK(this.hot)),UK(this,nX,[]),UK(this,iX,void 0),UK(this,oX,{}),UK(this,rX,void 0)}static get PLUGIN_KEY(){return XK}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings()[XK]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return KK(sX,t,aX).call(t,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return KK(sX,t,cX).call(t,...n)})),this.addHook("afterScrollHorizontally",(()=>KK(sX,this,dX).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return KK(sX,t,gX).call(t,...n)})),this.buildPluginUI(),this.registerEvents(),Mw(this.hot.rootElement,qK),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){xw(this.hot.rootElement,qK),this.unregisterEvents(),GK(tX,this).destroy(),GK(eX,this).destroy(),super.disablePlugin()}moveRow(t,e){return this.moveRows([t],e)}moveRows(t,e){const n=GK(rX,this),i=this.isMovePossible(t,e),o=this.hot.runHooks("beforeRowMove",t,e,n,i);if($K(rX,this,void 0),!1===o)return;i&&this.hot.rowIndexMapper.moveIndexes(t,e);const r=i&&this.isRowOrderChanged(t,e);return this.hot.runHooks("afterRowMove",t,e,n,i,r),r}dragRow(t,e){return this.dragRows([t],e)}dragRows(t,e){const n=this.countFinalIndex(t,e);return $K(rX,this,e),this.moveRows(t,n)}isMovePossible(t,e){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=t.length+e>n,o=e<0,r=t.some((t=>t<0)),s=t.some((t=>t>=n));return!(i||o||r||s)}isRowOrderChanged(t,e){return t.some(((t,n)=>t-n!==e))}countFinalIndex(t,e){const n=Ap(t,((t,n)=>(n<e&&(t+=1),t)),0);return e-n}getRowsHeight(t,e){const n=this.hot.rowIndexMapper;let i=0;for(let o=t;o<=e;o++){const t=n.getRenderableFromVisualIndex(o);null!==t&&(i+=this.hot.view._wt.wtTable.getRowHeight(t)||this.hot.view.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const t=this.hot.getSettings()[XK];if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(t){return t<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(t){return t>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}prepareRowsToMoving(){const t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;const{from:n,to:i}=t;return VC(Math.min(n.row,i.row),Math.max(n.row,i.row),(t=>{e.push(t)})),e}refreshPositions(){const t=GK(oX,this).coords,e=this.hot.getFirstFullyVisibleRow(),n=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(t.row)&&e>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(e-1,-1)),this.isFixedRowBottom(t.row)&&n<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,r=GK(oX,this).TD,s=this.hot.rootElement,l=Dw(s),a=Bw(s),h=o.holder.scrollTop,c=this.hot.rootWindow!==a?a.scrollTop:0,u=l.top-c,d=GK(oX,this).eventPageY-u+h,g=o.hider.offsetHeight,f=o.TBODY.offsetTop,m=GK(tX,this).getOffset().top,p=GK(tX,this).getSize().height,w=r.offsetHeight/2,v=r.offsetHeight;let y=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1);const b=d>=y+w;this.isFixedRowTop(t.row)&&(y+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),t.row<0?GK(oX,this).row=e>0?e-1:e:b?(GK(oX,this).row=t.row+1,y+=0===t.row?v-1:v):GK(oX,this).row=t.row;let C=d,S=y;d+p+m>=g?C=g-p-m:d+m<f&&(C=f+Math.abs(m)),y>=g-1&&(S=g-1),GK(tX,this).setPosition(C),GK(eX,this).setPosition(S)}registerEvents(){const{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",(t=>KK(sX,this,hX).call(this,t))),this.eventManager.addEventListener(t,"mouseup",(()=>KK(sX,this,uX).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){GK(tX,this).build(),GK(eX,this).build()}destroy(){GK(tX,this).destroy(),GK(eX,this).destroy(),super.destroy()}}function aX(t,e,n,i){const{wtTable:o,wtViewport:r}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast();if(!l||!s||GK(iX,this)||0!==t.button)return $K(iX,this,!1),GK(nX,this).length=0,void xw(this.hot.rootElement,[QK,ZK]);const a=GK(eX,this).isBuilt()&&!GK(eX,this).isAppended(),h=GK(tX,this).isBuilt()&&!GK(tX,this).isAppended();a&&h&&(GK(eX,this).appendTo(o.hider),GK(tX,this).appendTo(o.hider));const{from:c,to:u}=l,d=Math.min(c.row,u.row),g=Math.max(c.row,u.row);if(e.col<0&&e.row>=d&&e.row<=g){i.row=!0,$K(iX,this,!0),GK(oX,this).eventPageY=t.pageY,GK(oX,this).coords=e,GK(oX,this).TD=n,$K(nX,this,this.prepareRowsToMoving());const s=o.holder.scrollLeft+r.getRowHeaderWidth(),l=this.getRowsHeight(d,e.row-1)+t.offsetY;GK(tX,this).setPosition(null,s),GK(tX,this).setSize(o.hider.offsetWidth-s,this.getRowsHeight(d,g)),GK(tX,this).setOffset(-l,null),Mw(this.hot.rootElement,QK),this.refreshPositions()}else xw(this.hot.rootElement,JK),$K(iX,this,!1),GK(nX,this).length=0}function hX(t){GK(iX,this)&&(GK(oX,this).eventPageY=t.pageY,this.refreshPositions())}function cX(t,e,n,i){this.hot.getSelectedRangeLast()&&GK(iX,this)&&(GK(nX,this).indexOf(e.row)>-1?xw(this.hot.rootElement,ZK):Mw(this.hot.rootElement,ZK),i.row=!0,i.column=!0,i.cell=!0,GK(oX,this).coords=e,GK(oX,this).TD=n)}function uX(){const t=GK(oX,this).row,e=GK(nX,this).length;if($K(iX,this,!1),xw(this.hot.rootElement,[QK,ZK,JK]),this.hot.selection.isSelectedByRowHeader()&&Mw(this.hot.rootElement,JK),e<1||void 0===t)return;const n=GK(nX,this)[0],i=this.hot.toPhysicalRow(n),o=this.dragRows(GK(nX,this),t);if(GK(nX,this).length=0,!0===o){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const t=this.hot.toVisualRow(i),n=t+e-1;this.hot.selectRows(t,n)}}function dX(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth()+t.holder.scrollLeft;GK(tX,this).setPosition(null,e),GK(tX,this).setSize(t.hider.offsetWidth-e)}function gX(){this.moveBySettingsOrLoad()}function fX(t,e,n){mX(t,e),e.set(t,n)}function mX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pX(t,e,n){return t.set(vX(t,e),n),n}function wX(t,e){return t.get(vX(t,e))}function vX(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const yX="manualRowResize",bX="manualRowHeights";var CX=new WeakMap,SX=new WeakMap,RX=new WeakMap,EX=new WeakMap,TX=new WeakMap,MX=new WeakMap,xX=new WeakMap,HX=new WeakMap,kX=new WeakMap,IX=new WeakMap,OX=new WeakMap,AX=new WeakMap,_X=new WeakMap,PX=new WeakMap,NX=new WeakMap,DX=new WeakMap,LX=new WeakSet;class VX extends xN{static get PLUGIN_KEY(){return yX}static get PLUGIN_PRIORITY(){return 30}constructor(t){var e,n;super(t),mX(e=this,n=LX),n.add(e),fX(this,CX,null),fX(this,SX,null),fX(this,RX,[]),fX(this,EX,null),fX(this,TX,null),fX(this,MX,null),fX(this,xX,null),fX(this,HX,null),fX(this,kX,this.hot.rootDocument.createElement("DIV")),fX(this,IX,this.hot.rootDocument.createElement("DIV")),fX(this,OX,!1),fX(this,AX,!1),fX(this,_X,0),fX(this,PX,null),fX(this,NX,void 0),fX(this,DX,void 0),Mw(wX(kX,this),"manualRowResizer"),Mw(wX(IX,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[yX]}enablePlugin(){this.enabled||(pX(NX,this,new rx),wX(NX,this).addLocalHook("init",(()=>vX(LX,this,YX).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,wX(NX,this)),this.addHook("modifyRowHeight",((t,e)=>vX(LX,this,UX).call(this,t,e))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){pX(DX,this,wX(NX,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",bX,wX(NX,this).getValues())}loadManualRowHeights(){const t={};return this.hot.runHooks("persistentStateLoad",bX,t),t.value}setManualSize(t,e){const n=this.hot.toPhysicalRow(t),i=Math.max(e,this.hot.view.getDefaultRowHeight());return wX(NX,this).setValueAtIndex(n,i),i}getLastDesiredRowHeight(){return wX(EX,this)}setupHandlePosition(t){pX(CX,this,t);const{view:e}=this.hot,{_wt:n}=e,i=n.wtTable.getCoords(wX(CX,this)),o=i.row;if(o<0)return;const r=Uw(wX(CX,this)),s=wX(CX,this).getBoundingClientRect(),l=o<n.getSetting("fixedRowsTop"),a=o>=e.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let h;l?h=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(wX(CX,this),i.row,i.col):a&&(h=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(wX(CX,this),i.row,i.col)),h||(h=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(wX(CX,this),i.row,i.col)),pX(SX,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),pX(RX,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&c){Np(this.hot.getSelectedRange(),(t=>{VC(t.getTopStartCorner().row,t.getBottomStartCorner().row,(t=>{wX(RX,this).includes(t)||wX(RX,this).push(t)}))}))}wX(RX,this).includes(wX(SX,this))||pX(RX,this,[wX(SX,this)]),pX(HX,this,h.top-6),pX(xX,this,parseInt(s.height,10)),wX(kX,this).style.top=`${wX(HX,this)+wX(xX,this)}px`,wX(kX,this).style[this.inlineDir]=`${h.start}px`,wX(kX,this).style.width=`${r}px`,this.hot.rootElement.appendChild(wX(kX,this))}refreshHandlePosition(){wX(kX,this).style.top=`${wX(HX,this)+wX(EX,this)}px`}setupGuidePosition(){const t=parseInt(Uw(wX(kX,this)),10),e=parseInt(wX(kX,this).style[this.inlineDir],10)+t,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Mw(wX(kX,this),"active"),Mw(wX(IX,this),"active"),wX(IX,this).style.top=wX(kX,this).style.top,wX(IX,this).style[this.inlineDir]=`${e}px`,wX(IX,this).style.width=n-t+"px",this.hot.rootElement.appendChild(wX(IX,this))}refreshGuidePosition(){wX(IX,this).style.top=wX(kX,this).style.top}hideHandleAndGuide(){xw(wX(kX,this),"active"),xw(wX(IX,this),"active")}checkIfRowHeader(t){const e=yw(t,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}getActualRowHeight(t){const e=this.hot.view._wt.wtTable.getRowHeight(t);return void 0!==e&&wX(TX,this)<e?e:wX(TX,this)}afterMouseDownTimeout(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(e,n)=>{const i=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!0);void 0!==i&&pX(TX,this,i),this.setManualSize(e,wX(TX,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!0),n&&t()};if(wX(_X,this)>=2){wX(RX,this).length>1?(Np(wX(RX,this),(t=>{e(t)})),t()):Np(wX(RX,this),(t=>{e(t,!0)}))}pX(_X,this,0),pX(PX,this,null)}bindEvents(){const{rootElement:t,rootWindow:e}=this.hot;this.eventManager.addEventListener(t,"mouseover",(t=>vX(LX,this,FX).call(this,t))),this.eventManager.addEventListener(t,"mousedown",(t=>vX(LX,this,WX).call(this,t))),this.eventManager.addEventListener(e,"mousemove",(t=>vX(LX,this,jX).call(this,t))),this.eventManager.addEventListener(e,"mouseup",(()=>vX(LX,this,BX).call(this))),this.eventManager.addEventListener(wX(kX,this),"contextmenu",(()=>vX(LX,this,zX).call(this)))}destroy(){super.destroy()}}function FX(t){if(!iv(t.target)&&!0!==wX(AX,this)&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(wX(OX,this)||this.setupHandlePosition(e))}}function WX(t){Tw(t.target,"manualRowResizer")&&(this.setupHandlePosition(wX(CX,this)),this.setupGuidePosition(),pX(OX,this,!0),null===wX(PX,this)&&(pX(PX,this,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(wX(PX,this))),pX(_X,this,wX(_X,this)+1),pX(MX,this,t.pageY),pX(TX,this,wX(xX,this)))}function jX(t){wX(OX,this)&&(pX(EX,this,wX(xX,this)+(t.pageY-wX(MX,this))),Np(wX(RX,this),(t=>{pX(TX,this,this.setManualSize(t,wX(EX,this)))})),this.refreshHandlePosition(),this.refreshGuidePosition())}function BX(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(e,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!1),n&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!1)};if(wX(OX,this)){if(this.hideHandleAndGuide(),pX(OX,this,!1),wX(TX,this)!==wX(xX,this)){wX(RX,this).length>1?(Np(wX(RX,this),(t=>{e(t)})),t()):Np(wX(RX,this),(t=>{e(t,!0)}))}this.setupHandlePosition(wX(CX,this))}}function zX(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(wX(kX,this)),this.hot.rootElement.removeChild(wX(IX,this)),pX(OX,this,!1),pX(AX,this,!0),this.hot._registerImmediate((()=>{pX(AX,this,!1)}))}function UX(t,e){let n=t;if(this.enabled){const t=this.hot.toPhysicalRow(e),i=wX(NX,this).getValueAtIndex(t);this.hot.getSettings()[yX]&&i&&(n=i)}return n}function YX(){const t=this.hot.getSettings()[yX],e=this.loadManualRowHeights();this.hot.batchExecution((()=>{void 0!==e?e.forEach(((t,e)=>{wX(NX,this).setValueAtIndex(e,t)})):Array.isArray(t)?(t.forEach(((t,e)=>{wX(NX,this).setValueAtIndex(e,t)})),pX(DX,this,t)):!0===t&&Array.isArray(wX(DX,this))&&wX(DX,this).forEach(((t,e)=>{wX(NX,this).setValueAtIndex(e,t)}))}),!0)}Dy("flatMap");var $X=I,GX=Qe,KX=us,XX=Fh,qX=yo,ZX=I,QX=Lt,JX=Qe,tq=us,eq=function(t,e){e&&"string"==typeof t||GX(t);var n=XX(t);return KX(GX(void 0!==n?$X(n,t):t))},nq=Ks,iq=dh((function(){for(var t,e,n=this.iterator,i=this.mapper;;){if(e=this.inner)try{if(!(t=JX(ZX(e.next,e.iterator))).done)return t.value;this.inner=null}catch(o){nq(n,"throw",o)}if(t=JX(ZX(this.next,n)),this.done=!!t.done)return;try{this.inner=eq(i(t.value,this.counter++),!1)}catch(o){nq(n,"throw",o)}}}));function oq(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function rq(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sq(t,e){return t.get(aq(t,e))}function lq(t,e,n){return t.set(aq(t,e),n),n}function aq(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}qX({target:"Iterator",proto:!0,real:!0,forced:false},{flatMap:function(t){return JX(this),QX(t),new iq(tq(this),{mapper:t,inner:null})}});var hq=new WeakMap;const cq=class{constructor(t,e,n,i,o,r){rq(this,"row",void 0),rq(this,"col",void 0),rq(this,"rowspan",void 0),rq(this,"colspan",void 0),rq(this,"removed",!1),rq(this,"cellCoordsFactory",void 0),rq(this,"cellRangeFactory",void 0),oq(this,hq,null),this.row=t,this.col=e,this.rowspan=n,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=r}static NEGATIVE_VALUES_WARNING(t){let{row:e,col:n,rowspan:i,colspan:o}=t;return Fp`The merged cell declared with {row: ${e}, col: ${n},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(t){let{row:e,col:n}=t;return Fp`The merged cell declared at [${e}, ${n}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(t){let{row:e,col:n}=t;return Fp`The merged cell declared at [${e}, ${n}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(t){let{row:e,col:n}=t;return Fp`The merged cell declared at [${e}, ${n}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(t){let{row:e,col:n,rowspan:i,colspan:o}=t;return e<0||n<0||i<0||o<0}static isSingleCell(t){let{rowspan:e,colspan:n}=t;return 1===n&&1===e}static containsZeroSpan(t){let{rowspan:e,colspan:n}=t;return 0===n||0===e}static isOutOfBounds(t,e,n){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=n||t.col+t.colspan-1>=n}normalize(t){const e=t.countRows(),n=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),lq(hq,this,null)}includes(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}includesHorizontally(t){return this.col<=t&&this.col+this.colspan-1>=t}includesVertically(t){return this.row<=t&&this.row+this.rowspan-1>=t}shift(t,e){const n=t[0]||t[1],i=e+Math.abs(t[0]||t[1])-1,o=t[0]?"colspan":"rowspan",r=t[0]?"col":"row",s=Math.min(e,i),l=Math.max(e,i),a=this[r],h=this[r]+this[o]-1;if(a>=e&&(this[r]+=n),n>0)e<=h&&e>a&&(this[o]+=n);else if(n<0){if(s<=a&&l>=h)return this.removed=!0,lq(hq,this,null),!1;if(a>=s&&a<=l){const t=l-a+1,e=Math.abs(n)-t;this[r]-=e+n,this[o]-=t}else if(a<=s&&h>=l)this[o]+=n;else if(a<=s&&h>=s&&h<l){const t=h-s+1;this[o]-=t}}return lq(hq,this,null),!0}isFarther(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return sq(hq,this)||lq(hq,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),sq(hq,this)}};function uq(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function dq(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gq(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fq=new WeakSet;class mq{constructor(t){uq(this,fq),dq(this,"plugin",void 0),dq(this,"mergedCells",[]),dq(this,"mergedCellsMatrix",new Map),dq(this,"hot",void 0),this.plugin=t,this.hot=t.hot}static IS_OVERLAPPING_WARNING(t){let{row:e,col:n}=t;return Fp`The merged cell declared at [${e}, ${n}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(t,e){var n;return!!this.mergedCellsMatrix.has(t)&&(null!==(n=this.mergedCellsMatrix.get(t).get(e))&&void 0!==n&&n)}getByRange(t){let e=!1;return Np(this.mergedCells,(n=>!(n.row<=t.from.row&&n.row+n.rowspan-1>=t.to.row&&n.col<=t.from.col&&n.col+n.colspan-1>=t.to.col)||(e=n,e))),e}filterOverlappingMergeCells(t){const e=new Set;this.mergedCells.forEach((t=>{const{row:n,col:i,colspan:o,rowspan:r}=t;for(let s=n;s<n+r;s++)for(let t=i;t<i+o;t++)e.add(`r${s},c${t}`)}));return t.filter((t=>{const{row:n,col:i,colspan:o,rowspan:r}=t,s=new Set;let l=!1;for(let a=n;a<n+r;a++){for(let n=i;n<i+o;n++){const i=`r${a},c${n}`;if(e.has(i)){Ey(mq.IS_OVERLAPPING_WARNING(t)),l=!0;break}s.add(i)}if(l)break}return l||e.add(...s),!l}))}getWithinRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{row:n,col:i}=t.getTopStartCorner(),{row:o,col:r}=t.getBottomEndCorner(),s=[];for(let l=n;l<=o;l++)for(let t=i;t<=r;t++){const n=this.get(l,t);n&&(e||!e&&n.row===l&&n.col===t)&&s.push(n)}return s}add(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=t.row,i=t.col,o=t.rowspan,r=t.colspan,s=new cq(n,i,o,r,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(n,i),a=!e&&this.isOverlapping(s);return l||a?(Ey(mq.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),this.mergedCells.push(s),gq(fq,this,wq).call(this,s),s)}remove(t,e){const n=this.get(t,e),i=n?this.mergedCells.indexOf(n):-1;return!(!n||-1===i)&&(this.mergedCells.splice(i,1),gq(fq,this,vq).call(this,n),n)}clear(){Np(this.mergedCells,(t=>{let{row:e,col:n,rowspan:i,colspan:o}=t;VC(e,e+i,(t=>{VC(n,n+o,(e=>{const n=this.hot.getCell(t,e);n&&(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="")}))}))})),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(t){const e=t.getRange();for(let n=0;n<this.mergedCells.length;n++){if(this.mergedCells[n].getRange().overlaps(e))return!0}return!1}isFirstRenderableMergedCell(t,e){const n=this.get(t,e);if(!n)return!1;const{row:i,col:o,rowspan:r,colspan:s}=n,l=this.hot.view.getActiveOverlayName(),a=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),h=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),c=jC(a,i,i+r-1),u=jC(h,o,o+s-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(c,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(u,1)===e}getFirstRenderableCoords(t,e){const n=this.get(t,e);if(!n||this.isFirstRenderableMergedCell(t,e))return this.hot._createCellCoords(t,e);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(t,e){const n=gq(fq,this,pq).call(this,t,"col",-1);let i=e;for(let o=0;o<n.length;o++)if(n[o]<=e){i=n[o];break}return i}getEndMostColumnIndex(t,e){const n=gq(fq,this,pq).call(this,t,"col",1);let i=e;for(let o=0;o<n.length;o++)if(n[o]>=e){i=n[o];break}return i}getTopMostRowIndex(t,e){const n=gq(fq,this,pq).call(this,t,"row",-1);let i=e;for(let o=0;o<n.length;o++)if(n[o]<=e){i=n[o];break}return i}getBottomMostRowIndex(t,e){const n=gq(fq,this,pq).call(this,t,"row",1);let i=e;for(let o=0;o<n.length;o++)if(n[o]>=e){i=n[o];break}return i}shiftCollections(t,e,n){const i=[0,0];switch(t){case"right":i[0]+=n;break;case"left":i[0]-=n;break;case"down":i[1]+=n;break;case"up":i[1]-=n}const o=[];this.mergedCells.forEach((t=>{t.shift(i,e),t.removed&&o.push(t)})),o.forEach((t=>{this.mergedCells.splice(this.mergedCells.indexOf(t),1)})),this.mergedCellsMatrix.clear(),this.mergedCells.forEach((t=>{gq(fq,this,wq).call(this,t)}))}}function pq(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=new Map,o=1===n?t.getTopStartCorner():t.getBottomEndCorner(),r=1===n?t.getBottomEndCorner():t.getTopStartCorner();for(let s=o.row;1===n?s<=r.row:s>=r.row;s+=n)for(let t=o.col;1===n?t<=r.col:t>=r.col;t+=n){const o="row"===e?s:t,r=this.get(s,t);let l=o;r&&(l=1===n?r[e]+r[`${e}span`]-1:r[e]),i.has(o)||i.set(o,new Set),i.get(o).add(l)}return Array.from(new Set(Array.from(i.entries()).filter((t=>{let[,e]=t;return 1===e.size})).flatMap((t=>{let[,e]=t;return Array.from(e)}))))}function wq(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function vq(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}const yq=mq;function bq(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const Cq=class{constructor(t){bq(this,"plugin",void 0),bq(this,"mergedCellsCollection",void 0),bq(this,"currentFillData",null),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(t){if(t[0]===t[2]&&t[1]===t[3]){const e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}getDirection(t,e){let n=null;return n=e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left",n}snapDragArea(t,e,n,i){const o=e.slice(0),r=this.getAutofillSize(t,e,n),[s,l,a,h]=t,c=["up","down"].indexOf(n)>-1?a-s+1:h-l+1,u=r-Math.floor(r/c)*c,d=this.getFarthestCollection(t,e,n,i);if(d)if("down"===n){const t=d.row+d.rowspan-s-u;o[2]+t>=this.plugin.hot.countRows()?o[2]-=u:o[2]+=u?t:0}else if("right"===n){const t=d.col+d.colspan-l-u;o[3]+t>=this.plugin.hot.countCols()?o[3]-=u:o[3]+=u?t:0}else if("up"===n){const t=a-u-d.row+1;o[0]+t<0?o[0]+=u:o[0]-=u?t:0}else if("left"===n){const t=h-u-d.col+1;o[1]+t<0?o[1]+=u:o[1]-=u?t:0}return this.updateCurrentFillCache({baseArea:t,dragDirection:n,foundMergedCells:i,fillSize:r,dragArea:o,cycleLength:c}),o}updateCurrentFillCache(t){this.currentFillData||(this.currentFillData={}),Bv(this.currentFillData,t)}getAutofillSize(t,e,n){const[i,o,r,s]=t,[l,a,h,c]=e;switch(n){case"up":return i-l;case"down":return h-r;case"left":return o-a;case"right":return c-s;default:return null}}getDragArea(t,e,n){const[i,o,r,s]=t,[l,a,h,c]=e;switch(n){case"up":return[l,a,i-1,s];case"down":return[r+1,o,h,s];case"left":return[l,a,r,o-1];case"right":return[i,s+1,h,c];default:return null}}getFarthestCollection(t,e,n,i){const[o,r,s,l]=t,a=["up","down"].indexOf(n)>-1,h=a?s:l,c=a?o:r,u=this.getAutofillSize(t,e,n),d=a?s-o+1:l-r+1,g=u-Math.floor(u/d)*d;let f=null,m=null,p=null;switch(n){case"up":f="includesVertically",p=h-g+1;break;case"left":f="includesHorizontally",p=h-g+1;break;case"down":f="includesVertically",p=c+g-1;break;case"right":f="includesHorizontally",p=c+g-1}return Np(i,(t=>{t[f](p)&&t.isFarther(m,n)&&(m=t)})),m}recreateAfterDataPopulation(t){if(!this.currentFillData)return;const e=this.getRangeFromChanges(t),n=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(t,n)=>{switch(i){case"up":return t.row-n>=e.from.row;case"down":return t.row+t.rowspan-1+n<=e.to.row;case"left":return t.col-n>=e.from.column;case"right":return t.col+t.colspan-1+n<=e.to.column;default:return null}};let r=0,s=null,l=1;do{for(let t=0;t<n.length;t+=1){if(s=n[t],r=l*this.currentFillData.cycleLength,o(s,r))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:s.row-r,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+r,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-r,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+r,colspan:s.colspan})}t===n.length-1&&(l+=1)}}while(o(s,r));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(t){const e={min:null,max:null},n={min:null,max:null};return Np(t,(t=>{const i=t[0],o=this.plugin.hot.propToCol(t[1]);(null===e.min||i<e.min)&&(e.min=i),(null===e.max||i>e.max)&&(e.max=i),(null===n.min||o<n.min)&&(n.min=o),(null===n.max||o>n.max)&&(n.max=o)})),{from:{row:e.min,column:n.min},to:{row:e.max,column:n.max}}}dragAreaOverlapsCollections(t,e,n){const i=this.getDragArea(t,e,n),[o,r,s,l]=i,a=this.plugin.hot._createCellCoords(o,r),h=this.plugin.hot._createCellCoords(s,l),c=this.plugin.hot._createCellRange(a,a,h);return this.mergedCellsCollection.getWithinRange(c,!0).length>0}};function Sq(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const Rq=class{constructor(t){Sq(this,"plugin",void 0),Sq(this,"hot",void 0),Sq(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=t,this.hot=t.hot}getSelectedMergedCellClassName(t,e,n,i){const o=Math.min(n[0],n[2]),r=Math.min(n[1],n[3]),s=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]);if(void 0===i)return;if(!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,e))return;const a=this.plugin.mergedCellsCollection.get(t,e);if(!a)return;const h=a.getLastRow(),c=a.getLastColumn();return o<=a.row&&r<=a.col&&s>=h&&l>=c?`${this.fullySelectedMergedCellClassName}-${i}`:this.isMergeCellFullySelected(a,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(t,e){const n=[];if(!e||!t)return!1;for(let i=0;i<t.rowspan;i+=1)for(let e=0;e<t.colspan;e+=1)n.push(this.hot._createCellCoords(t.row+i,t.col+e));for(let i=0;i<n.length;i+=1){const t=[];for(let o=0;o<e.length;o+=1)t[o]=e[o].includes(n[i]);if(!t.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const t=[];for(let e=0;e<=7;e+=1)t.push(`${this.fullySelectedMergedCellClassName}-${e}`);return t.push(`${this.fullySelectedMergedCellClassName}-multiple`),t}};function Eq(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Tq{constructor(t){Eq(this,"data",void 0),Eq(this,"next",null),Eq(this,"prev",null),this.data=t}}const Mq=class{constructor(){Eq(this,"first",null),Eq(this,"last",null)}push(t){const e=new Tq(t);if(null===this.first)this.first=e,this.last=e;else{const t=this.last;this.last=e,e.prev=t,t.next=e}return e}unshift(t){const e=new Tq(t);if(null===this.first)this.first=e,this.last=e;else{const t=this.first;this.first=e,e.next=t,t.prev=e}}inorder(t){let e=this.first;for(;e;){const n=t(e);if(e===this.last||!0===n)break;e=e.next}}remove(t){if(null===this.first)return!1;let e,n,i=this.first;for(;i;){if(i.data===t)return e=i.next,n=i.prev,e&&(e.prev=n),n&&(n.next=e),i===this.first&&(this.first=e),i===this.last&&(this.last=n),!0;i=i.next}return!1}hasCycle(){let t=this.first,e=this.first;for(;;){if(null===t)return!1;if(t=t.next,null===t)return!1;if(t=t.next,e=e.next,t===e)return!0}}pop(){if(null===this.last)return null;const t=this.last;return this.last=this.last.prev,t}shift(){if(null===this.first)return null;const t=this.first;return this.first=this.first.next,t}recursiveReverse(){if(!this.first)return;!function t(e,n){n&&(t(n,n.next),n.next=e)}(this.first,this.first.next),this.first.next=null;const t=this.first;this.first=this.last,this.last=t}reverse(){if(!this.first||!this.first.next)return;let t,e=this.first.next,n=this.first;for(;e;)t=e.next,e.next=n,n.prev=e,n=e,e=t;this.first.next=null,this.last.prev=null,t=this.first,this.first=n,this.last=t}};function xq(t,e,n){Hq(t,e),e.set(t,n)}function Hq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kq(t,e){return t.get(Oq(t,e))}function Iq(t,e,n){return t.set(Oq(t,e),n),n}function Oq(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Aq=new WeakMap,_q=new WeakMap,Pq=new WeakMap,Nq=new WeakMap,Dq=new WeakMap,Lq=new WeakMap,Vq=new WeakMap,Fq=new WeakSet;class Wq{constructor(t){let{mergedCellsGetter:e,rowIndexMapper:n,columnIndexMapper:i}=t;var o,r;Hq(o=this,r=Fq),r.add(o),xq(this,Aq,new Mq),xq(this,_q,new Mq),xq(this,Pq,null),xq(this,Nq,null),xq(this,Dq,null),xq(this,Lq,null),xq(this,Vq,null),Iq(Dq,this,e),Iq(Lq,this,n),Iq(Vq,this,i)}getCurrentVerticalNode(){return kq(Nq,this).data}getFirstVerticalNode(){return kq(_q,this).first.data}getNextVerticalNode(){return kq(Nq,this).next.data}getPrevVerticalNode(){return kq(Nq,this).prev.data}getCurrentHorizontalNode(){return kq(Pq,this).data}getFirstHorizontalNode(){return kq(Aq,this).first.data}getNextHorizontalNode(){return kq(Pq,this).next.data}getPrevHorizontalNode(){return kq(Pq,this).prev.data}setPrevNodeAsActive(){Iq(Nq,this,kq(Nq,this).prev),Iq(Pq,this,kq(Pq,this).prev)}setNextNodeAsActive(){Iq(Nq,this,kq(Nq,this).next),Iq(Pq,this,kq(Pq,this).next)}buildFocusOrder(t){const e=t.getTopStartCorner(),n=t.getBottomEndCorner(),i=new WeakSet;Iq(Aq,this,new Mq);for(let r=e.row;r<=n.row;r++)if(!kq(Lq,this).isHidden(r))for(let o=e.col;o<=n.col;o++){if(kq(Vq,this).isHidden(o))continue;const e=Oq(Fq,this,jq).call(this,t,kq(Aq,this),i,r,o);e&&Iq(Pq,this,e)}kq(Aq,this).first&&(kq(Aq,this).first.prev=kq(Aq,this).last,kq(Aq,this).last.next=kq(Aq,this).first);const o=new WeakSet;Iq(_q,this,new Mq);for(let r=e.col;r<=n.col;r++)if(!kq(Vq,this).isHidden(r))for(let i=e.row;i<=n.row;i++){if(kq(Lq,this).isHidden(i))continue;const e=Oq(Fq,this,jq).call(this,t,kq(_q,this),o,i,r);e&&Iq(Nq,this,e)}kq(_q,this).first&&(kq(_q,this).first.prev=kq(_q,this).last,kq(_q,this).last.next=kq(_q,this).first)}setActiveNode(t,e){return kq(Aq,this).inorder((n=>{const{rowStart:i,rowEnd:o,colStart:r,colEnd:s}=n.data;if(t>=i&&t<=o&&e>=r&&e<=s)return Iq(Pq,this,n),!1})),kq(_q,this).inorder((n=>{const{rowStart:i,rowEnd:o,colStart:r,colEnd:s}=n.data;if(t>=i&&t<=o&&e>=r&&e<=s)return Iq(Nq,this,n),!1})),this}}function jq(t,e,n,i,o){const r=t.getTopStartCorner(),s=t.getBottomEndCorner(),l=t.highlight.clone().normalize(),a=kq(Dq,this).call(this,i,o);if(a&&n.has(a))return null;const h={colStart:o,colEnd:o,rowStart:i,rowEnd:i};if(a){if(n.add(a),a.row<r.row||a.row+a.rowspan-1>s.row||a.col<r.col||a.col+a.colspan-1>s.col)return null;h.colStart=a.col,h.colEnd=a.col+a.colspan-1,h.rowStart=a.row,h.rowEnd=a.row+a.rowspan-1}const c=e.push(h);return i===l.row&&o===l.col||a&&l.row>=a.row&&l.row<=a.row+a.rowspan-1&&l.col>=a.col&&l.col<=a.col+a.colspan-1?c:null}function Bq(t,e,n){zq(t,e),e.set(t,n)}function zq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uq(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yq(t,e,n){return t.set(Gq(t,e),n),n}function $q(t,e){return t.get(Gq(t,e))}function Gq(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}lb.getSingleton().register("beforeMergeCells"),lb.getSingleton().register("afterMergeCells"),lb.getSingleton().register("beforeUnmergeCells"),lb.getSingleton().register("afterUnmergeCells");const Kq="mergeCells",Xq=Kq;var qq=new WeakMap,Zq=new WeakMap,Qq=new WeakMap,Jq=new WeakMap,tZ=new WeakSet;class eZ extends xN{constructor(){var t,e;super(...arguments),zq(t=this,e=tZ),e.add(t),Uq(this,"mergedCellsCollection",null),Uq(this,"autofillCalculations",null),Uq(this,"selectionCalculations",null),Bq(this,qq,null),Bq(this,Zq,{row:0,col:0}),Bq(this,Qq,new Wq({mergedCellsGetter:(t,e)=>this.mergedCellsCollection.get(t,e),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Bq(this,Jq,function(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:i}=e;return{before:function(){},after:function(o,r,s){const l=t.mergedCellsCollection.get(r,s);if(!Kv(l))return o.removeAttribute("rowspan"),o.removeAttribute("colspan"),void(o.style.display="");const{row:a,col:h,colspan:c,rowspan:u}=l,[d,g]=t.translateMergedCellToRenderable(a,u,h,c),f=t.getSetting("virtualized"),m=d-n.getRenderableFromVisualIndex(r)+1,p=g-i.getRenderableFromVisualIndex(s)+1;let w=n.getNearestNotHiddenIndex(a,1),v=i.getNearestNotHiddenIndex(h,1);if(f){const t=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(t)||(w=Math.max(w,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(t)||(v=Math.max(v,e.getFirstRenderedVisibleColumn()))}const y=Math.min(u,m),b=Math.min(c,p);w===r&&v===s?(o.setAttribute("rowspan",y),o.setAttribute("colspan",b)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}}}(this))}static get PLUGIN_KEY(){return Kq}static get PLUGIN_PRIORITY(){return 150}static get DEFAULT_SETTINGS(){return{[SN]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[Kq]}enablePlugin(){var t=this;this.enabled||(this.mergedCellsCollection=new yq(this),this.autofillCalculations=new Cq(this),this.selectionCalculations=new Rq(this),this.addHook("afterInit",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,nZ).call(t,...n)})),this.addHook("modifyTransformFocus",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,oZ).call(t,...n)})),this.addHook("modifyTransformStart",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,rZ).call(t,...n)})),this.addHook("modifyTransformEnd",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,sZ).call(t,...n)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,lZ).call(t,...n)})),this.addHook("beforeSetRangeStart",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,cZ).call(t,...n)})),this.addHook("beforeSetRangeStartOnly",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,cZ).call(t,...n)})),this.addHook("beforeSelectionFocusSet",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,uZ).call(t,...n)})),this.addHook("afterSelectionFocusSet",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,dZ).call(t,...n)})),this.addHook("afterSelectionEnd",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,gZ).call(t,...n)})),this.addHook("modifyGetCellCoords",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,aZ).call(t,...n)})),this.addHook("modifyGetCoordsElement",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,aZ).call(t,...n)})),this.addHook("afterIsMultipleSelection",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,iZ).call(t,...n)})),this.addHook("afterRenderer",(function(){return $q(Jq,t).after(...arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,hZ).call(t,...n)})),this.addHook("afterGetCellMeta",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,fZ).call(t,...n)})),this.addHook("afterViewportRowCalculatorOverride",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,mZ).call(t,...n)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,pZ).call(t,...n)})),this.addHook("modifyAutofillRange",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,wZ).call(t,...n)})),this.addHook("afterCreateCol",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,vZ).call(t,...n)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,yZ).call(t,...n)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,bZ).call(t,...n)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,CZ).call(t,...n)})),this.addHook("afterChange",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,SZ).call(t,...n)})),this.addHook("beforeDrawBorders",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,RZ).call(t,...n)})),this.addHook("afterDrawSelection",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,EZ).call(t,...n)})),this.addHook("beforeRemoveCellClassNames",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,TZ).call(t,...n)})),this.addHook("beforeBeginEditing",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,MZ).call(t,...n)})),this.addHook("modifyRowHeightByOverlayName",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Gq(tZ,t,xZ).call(t,...n)})),this.addHook("beforeUndoStackChange",((t,e)=>{if("MergeCells"===e)return!1})),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!ay())return;const t=[];let e=[];this.mergedCellsCollection.mergedCells.forEach((t=>{const{row:n,rowspan:i}=t;for(let o=n+1;o<n+i;o++)e.push(o)})),e=[...new Set(e)],e.forEach((e=>{const n=this.hot.rowIndexMapper.getRenderableFromVisualIndex(e);this.hot.view._wt.wtOverlays.getOverlays(!0).map((t=>"master"===(null==t?void 0:t.name)?t:t.clone.wtTable)).forEach((e=>{const i=e.getRow(n);i&&(i.style.background=zw(i,"backgroundColor").replace(")",", 0.99)"),t.push(i))}))})),this.hot._registerTimeout((()=>{t.forEach((t=>{t.style.background=zw(t,"backgroundColor").replace(", 0.99)",")")}))}),1)}validateSetting(t){return!!t&&(cq.containsNegativeValues(t)?(Ey(cq.NEGATIVE_VALUES_WARNING(t)),!1):cq.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?(Ey(cq.IS_OUT_OF_BOUNDS_WARNING(t)),!1):cq.isSingleCell(t)?(Ey(cq.IS_SINGLE_CELL(t)),!1):!cq.containsZeroSpan(t)||(Ey(cq.ZERO_SPAN_WARNING(t)),!1))}generateFromSettings(){const t=this.getSetting("cells").filter((t=>this.validateSetting(t))),e=this.mergedCellsCollection.filterOverlappingMergeCells(t),n=[];e.forEach((t=>{const{row:e,col:i,rowspan:o,colspan:r}=t,s=this.hot._createCellCoords(e,i),l=this.hot._createCellCoords(e+o-1,i+r-1),a=this.hot._createCellRange(s,s,l);this.mergeRange(a,!0,!0);for(let h=e;h<e+o;h++)for(let t=i;t<i+r;t++)h===e&&t===i||n.push([h,t,null])})),0!==n.length&&this.hot.setDataAtCell(n,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(t){return!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(t)}mergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:e,to:n}=t;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}unmergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;const{from:e,to:n}=t;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,n.row,n.col,!1)}mergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=t.getTopStartCorner(),o=t.getBottomEndCorner(),r={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},s=[];let l=null;if(!this.canMergeRange(r,e))return!1;this.hot.runHooks("beforeMergeCells",t,e),VC(0,r.rowspan-1,(t=>{VC(0,r.colspan-1,(e=>{let n=null;s[t]||(s[t]=[]),0===t&&0===e?n=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r.row),this.hot.toPhysicalColumn(r.col)):this.hot.setCellMeta(r.row+t,r.col+e,"hidden",!0),s[t][e]=n}))})),this.hot.setCellMeta(r.row,r.col,"spanned",!0);return!this.mergedCellsCollection.add(r,e)||(n?l=[r.row,r.col,s]:this.hot.populateFromArray(r.row,r.col,s,void 0,void 0,this.pluginName),e||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",t,r,e),l)}unmergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.mergedCellsCollection.getWithinRange(t);0!==n.length&&(this.hot.runHooks("beforeUnmergeCells",t,e),Np(n,(t=>{this.mergedCellsCollection.remove(t.row,t.col),VC(0,t.rowspan-1,(e=>{VC(0,t.colspan-1,(n=>{this.hot.removeCellMeta(t.row+e,t.col+n,"hidden"),this.hot.removeCellMeta(t.row+e,t.col+n,"copyable")}))})),this.hot.removeCellMeta(t.row,t.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",t,e),this.hot.render())}toggleMerge(t){const e=this.mergedCellsCollection.get(t.from.row,t.from.col);e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col?this.unmergeRange(t):this.mergeSelection(t)}merge(t,e,n,i){const o=this.hot._createCellCoords(t,e),r=this.hot._createCellCoords(n,i);this.mergeRange(this.hot._createCellRange(o,o,r))}unmerge(t,e,n,i){const o=this.hot._createCellCoords(t,e),r=this.hot._createCellCoords(n,i);this.unmergeRange(this.hot._createCellRange(o,o,r))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const t=this.hot.getSelectedRangeLast();t&&!t.isSingleHeader()&&(this.toggleMerge(t),this.hot.render())},runOnlyIf:t=>!t.altKey,group:Xq})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Xq)}modifyViewportRowStart(t,e){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(t.startRow);for(let o=0;o<e;o+=1){const r=this.mergedCellsCollection.get(i,o);if(Kv(r)){const i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r.row,1));if(i<t.startRow)return t.startRow=i,void this.modifyViewportRowStart(t,e)}}}modifyViewportRowEnd(t,e){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(t.endRow);for(let o=0;o<e;o+=1){const r=this.mergedCellsCollection.get(i,o);if(Kv(r)){const i=r.row+r.rowspan-1,o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1));if(o>t.endRow)return t.endRow=o,void this.modifyViewportRowEnd(t,e)}}}modifyViewportColumnStart(t,e){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(t.startColumn);for(let o=0;o<e;o+=1){const r=this.mergedCellsCollection.get(o,i);if(Kv(r)){const i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r.col,1));if(i<t.startColumn)return t.startColumn=i,void this.modifyViewportColumnStart(t,e)}}}modifyViewportColumnEnd(t,e){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(t.endColumn);for(let o=0;o<e;o+=1){const r=this.mergedCellsCollection.get(o,i);if(Kv(r)){const i=r.col+r.colspan-1,o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1));if(o>t.endColumn)return t.endColumn=o,void this.modifyViewportColumnEnd(t,e)}}}translateMergedCellToRenderable(t,e,n,i){const{rowIndexMapper:o,columnIndexMapper:r}=this.hot;let s,l;s=0===e?o.getNearestNotHiddenIndex(t,1):o.getNearestNotHiddenIndex(t+e-1,-1),l=0===i?r.getNearestNotHiddenIndex(n,1):r.getNearestNotHiddenIndex(n+i-1,-1);return[t>=0?o.getRenderableFromVisualIndex(s):t,n>=0?r.getRenderableFromVisualIndex(l):n]}}function nZ(){this.generateFromSettings(),this.hot.render()}function iZ(t){if(t){const t=this.mergedCellsCollection.mergedCells,e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner(),i=e.getBottomEndCorner();for(let o=0;o<t.length;o+=1)if(n.row===t[o].row&&n.col===t[o].col&&i.row===t[o].row+t[o].rowspan-1&&i.col===t[o].col+t[o].colspan-1)return!1}return t}function oZ(t){$q(Zq,this).row=t.row,$q(Zq,this).col=t.col}function rZ(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot;$q(qq,this)&&(null!==o.getRenderableFromVisualIndex($q(qq,this).row)&&(n.row=$q(qq,this).row),null!==i.getRenderableFromVisualIndex($q(qq,this).col)&&(n.col=$q(qq,this).col),Yq(qq,this,null));const r=this.mergedCellsCollection.get(n.row,n.col);if(!r)return;const s=r.col,l=r.col+r.colspan-1;if(t.col<0){const e=n.col>=s&&n.col<=l?s-1:l,o=i.getNearestNotHiddenIndex(e,-1);t.col=null===o?-this.hot.view.countRenderableColumnsInRange(0,n.col):-Math.max(this.hot.view.countRenderableColumnsInRange(o,n.col)-1,1)}else if(t.col>0){const e=n.col>=s&&n.col<=l?l+1:s,o=i.getNearestNotHiddenIndex(e,1);t.col=null===o?this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(n.col,o)-1,1)}const a=r.row,h=r.row+r.rowspan-1;if(t.row<0){const e=n.row>=a&&n.row<=h?a-1:h,i=o.getNearestNotHiddenIndex(e,-1);t.row=null===i?-this.hot.view.countRenderableRowsInRange(0,n.row):-Math.max(this.hot.view.countRenderableRowsInRange(i,n.row)-1,1)}else if(t.row>0){const e=n.row>=a&&n.row<=h?h+1:a,i=o.getNearestNotHiddenIndex(e,1);t.row=null===i?this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):Math.max(this.hot.view.countRenderableRowsInRange(n.row,i)-1,1)}}function sZ(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:i}=e,{columnIndexMapper:o,rowIndexMapper:r}=this.hot,s=(t,e)=>{n.expand(this.hot._createCellCoords(t,e));for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange())};if(t.col<0){let r=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+t.col;s(i.row,r),"E-W"===e.getHorizontalDirection()&&"E-W"===n.getHorizontalDirection()&&(r=n.getTopStartCorner().col);const l=o.getNearestNotHiddenIndex(r,1);null!==l&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,i.col)-1,1))}else if(t.col>0){let r=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+t.col;s(i.row,r),"W-E"===e.getHorizontalDirection()&&"W-E"===n.getHorizontalDirection()&&(r=n.getBottomEndCorner().col);const l=o.getNearestNotHiddenIndex(r,-1);null!==l&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,l)-1,1))}if(t.row<0){let o=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+t.row;s(o,i.col),"S-N"===e.getVerticalDirection()&&"S-N"===n.getVerticalDirection()&&(o=n.getTopStartCorner().row);const l=r.getNearestNotHiddenIndex(o,1);null!==l&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,i.row)-1,1))}else if(t.row>0){let o=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+t.row;s(o,i.col),"N-S"===e.getVerticalDirection()&&"N-S"===n.getVerticalDirection()&&(o=n.getBottomStartCorner().row);const l=r.getNearestNotHiddenIndex(o,-1);null!==l&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,l)-1,1))}}function lZ(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader())return void Yq(qq,this,e.clone());for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Yq(qq,this,e.clone()),n&&e.assign(n)}function aZ(t,e,n,i){if(t<0||e<0)return;const o=this.mergedCellsCollection.get(t,e);if(!o)return;const{row:r,col:s,colspan:l,rowspan:a}=o,h=r,c=s,u=r+a-1,d=s+l-1;if("render"===i&&this.getSetting("virtualized")){const t=this.hot.view.getActiveOverlayName(),e=["top","top_inline_start_corner"].includes(t)?0:this.hot.getFirstRenderedVisibleRow(),n=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(t)?0:this.hot.getFirstRenderedVisibleColumn();return[jC(e,h,u),jC(n,c,d),jC(this.hot.getLastRenderedVisibleRow(),h,u),jC(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[h,c,u,d]}function hZ(t){var e;t.items.push({name:"---------"},(e=this,{key:"mergeCells",name(){const t=this.getSelectedLast();if(t){const n=e.mergedCellsCollection.get(t[0],t[1]);if(n.row===t[0]&&n.col===t[1]&&n.row+n.rowspan-1===t[2]&&n.col+n.colspan-1===t[3])return this.getTranslatedPhrase(hH)}return this.getTranslatedPhrase(aH)},callback(){const t=this.getSelectedRangeLast();if(!t)return;t.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=t;e.toggleMerge(t),this.selectCell(n.row,n.col,i.row,i.col,!1)},disabled(){const t=this.getSelectedLast();return!t||cq.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}function cZ(){Yq(qq,this,null)}function uZ(){if($q(qq,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),i=$q(qq,this).clone().normalize();$q(Qq,this).setActiveNode(i.row,i.col),$q(Zq,this).row>0||$q(Zq,this).col>0?$q(Qq,this).setPrevNodeAsActive():("E-W"===n&&$q(Zq,this).col<0||"S-N"===e&&$q(Zq,this).row<0)&&$q(Qq,this).setNextNodeAsActive()}function dZ(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:o}=this.hot;let r=null,s=null;if($q(Zq,this).col<0){const{rowEnd:t,colEnd:e}=$q(Qq,this).getPrevHorizontalNode();s=i.getNearestNotHiddenIndex(e,-1),r=o.getNearestNotHiddenIndex(t,-1)}else if($q(Zq,this).col>0){const{rowStart:t,colStart:e}=$q(Qq,this).getNextHorizontalNode();s=i.getNearestNotHiddenIndex(e,1),r=o.getNearestNotHiddenIndex(t,1)}else if($q(Zq,this).row<0){const{rowEnd:t,colEnd:e}=$q(Qq,this).getPrevVerticalNode();s=i.getNearestNotHiddenIndex(e,-1),r=o.getNearestNotHiddenIndex(t,-1)}else if($q(Zq,this).row>0){const{rowStart:t,colStart:e}=$q(Qq,this).getNextVerticalNode();s=i.getNearestNotHiddenIndex(e,1),r=o.getNearestNotHiddenIndex(t,1)}if(null!==r||null!==s){const i=this.hot._createCellCoords(r,s),o=this.mergedCellsCollection.get(i.row,i.col),l=this.hot.selection.highlight.getFocus();t=i.row,e=i.col,o?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(o.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(o.col,1)}):n.highlight.assign(i),l.clear(),l.add(i).commit()}$q(Qq,this).setActiveNode(t,e),Yq(Zq,this,{row:0,col:0})}function gZ(){this.hot.getSelectedRangeLast().isHeader()||$q(Qq,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function fZ(t,e,n){const i=this.mergedCellsCollection.get(t,e);i&&(i.row!==t||i.col!==e?n.copyable=!1:(n.rowspan=i.rowspan,n.colspan=i.colspan))}function mZ(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function pZ(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function wZ(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let i=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,i,n))return i=e,i;const o=this.hot._createCellCoords(e[0],e[1]),r=this.hot._createCellCoords(e[2],e[3]),s=this.hot._createCellRange(o,o,r),l=this.mergedCellsCollection.getWithinRange(s);return 0===l.length||(i=this.autofillCalculations.snapDragArea(e,i,n,l)),i}function vZ(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function yZ(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function bZ(t,e,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",t,e)}function CZ(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function SZ(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}function RZ(t,e){if(e&&"area"===e){const e=this.hot.getSelectedRangeLast();Np(this.mergedCellsCollection.getWithinRange(e),(n=>{e.getBottomEndCorner().row===n.getLastRow()&&e.getBottomEndCorner().col===n.getLastColumn()&&(t[2]=n.row,t[3]=n.col)}))}}function EZ(t,e,n,i){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,i)}function TZ(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function MZ(t,e,n,i){if(!(i instanceof MouseEvent))return;const o=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getByRange(o);if(!r)return;const s=this.hot._createCellCoords(r.row,r.col),l=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1);return 0===this.hot.selection.getLayerLevel()&&o.isEqual(this.hot._createCellRange(s,s,l))}function xZ(t,e,n){if(this.hot.getSettings().rowHeaders||"bottom"===n||"bottom_inline_start_corner"===n)return t;let i,o;if("master"===n)i=this.hot.getFirstRenderedVisibleColumn(),o=this.hot.getLastRenderedVisibleColumn();else{const t=this.hot.view.getOverlayByName(n);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t.clone.wtTable.getFirstRenderedColumn()),o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return t;const r=this.hot._createCellCoords(e,i),s=this.hot._createCellCoords(e,o),l=this.hot._createCellRange(r,r,s),a=this.mergedCellsCollection.getWithinRange(l,!0),h=a.reduce(((t,e)=>{let{rowspan:n}=e;return Math.max(t,n)}),1);let c=0;return a.length>1&&a[0].rowspan<h&&(c=h-a[0].rowspan),a.forEach((i=>{var o;let{rowspan:r}=i,s=0;s="top"===n||"top_inline_start_corner"===n?Math.min(h,this.hot.view.countNotHiddenFixedRowsTop()-e):r-c,t=Math.max(null!==(o=t)&&void 0!==o?o:0,Gq(tZ,this,HZ).call(this,e,s))})),t}function HZ(t,e){const n=this.hot.view.getDefaultRowHeight(),i=this.hot.getPlugin("autoRowSize");let o=0;for(let s=t;s<t+e;s++){var r;if(!this.hot.rowIndexMapper.isHidden(s))o+=null!==(r=null==i?void 0:i.getRowHeight(s))&&void 0!==r?r:n}return o}function kZ(){Ey(Fp`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const IZ="sort";function OZ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const AZ="multiColumnSorting",_Z="columnSorting",PZ=AZ;hL(AZ,(function(t,e){return function(n,i){const[,...o]=n,[,...r]=i;return function n(i){const s=t[i],l=e[i],a=o[i],h=r[i],c=l.multiColumnSorting,u=(c.compareFunctionFactory?c.compareFunctionFactory:uL(l.type))(s,l,c)(a,h);if(u===dL){const t=i+1;if(void 0!==e[t])return n(t)}return u}(0)}}));class NZ extends NL{constructor(){super(...arguments),OZ(this,"pluginKey",AZ)}static get PLUGIN_KEY(){return AZ}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[_Z]&&(kZ(),this.hot.getPlugin(_Z).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast();return-1===t.row&&t.col>=0&&this.sort(this.getNextSortConfig(t.col,AL)),!1},runOnlyIf:()=>{var t,e;const n=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return n&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:mO,position:"before",group:PZ})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(PZ)}sort(t){super.sort(t)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(t){return super.getSortConfig(t)}setSortConfig(t){super.setSortConfig(t)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}updateHeaderClasses(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];super.updateHeaderClasses(t,...n),xw(t,function(t){const e=t.className.split(" "),n=new RegExp(`^${IZ}-[0-9]{1,2}$`);return e.filter((t=>n.test(t)))}(t)),!1!==this.enabled&&Mw(t,function(t,e,n){const i=[];return!1===n||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&i.push(`${IZ}-${t.getIndexOfColumnInSortQueue(e)+1}`),i}(...n))}onUpdateSettings(t){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[_Z]&&kZ(),super.onUpdateSettings(t)}onAfterOnCellMouseDown(t,e){!1!==SL(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,AL))):this.sort(this.getColumnNextConfig(e.col)))}}function DZ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class LZ extends xN{constructor(){super(...arguments),DZ(this,"dragged",[]),DZ(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return uy()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const t=this,{rootElement:e}=this.hot;function n(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;const n=t.dragged.indexOf(e);if(-1===n)return!1;0===n?t.dragged=t.dragged.slice(0,1):1===n&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(e,"touchstart",(e=>{let n;return Tw(e.target,"topSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("top"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):Tw(e.target,"bottomSelectionHandle-HitArea")?(n=t.hot.getSelectedRangeLast(),t.dragged.push("bottom"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):void 0})),this.eventManager.addEventListener(e,"touchend",(e=>Tw(e.target,"topSelectionHandle-HitArea")?(n.call(t,"top"),t.touchStartRange=void 0,e.preventDefault(),!1):Tw(e.target,"bottomSelectionHandle-HitArea")?(n.call(t,"bottom"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0)),this.eventManager.addEventListener(e,"touchmove",(e=>{const{rootDocument:n}=this.hot;let i,o,r,s,l,a;if(0===t.dragged.length)return;const h=n.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY);h&&h!==t.lastSetCell&&("TD"!==h.nodeName&&"TH"!==h.nodeName||(i=t.hot.getCoords(h),-1===i.col&&(i.col=0),o=t.hot.getSelectedRangeLast(),r=o.getWidth(),s=o.getHeight(),l=o.getDirection(),1===r&&1===s&&t.hot.selection.setRangeEnd(i),a=t.getCurrentRangeCoords(o,i,t.touchStartRange.direction,l,t.dragged[0]),null!==a.start&&t.hot.selection.setRangeStart(a.start),t.hot.selection.setRangeEnd(a.end),t.lastSetCell=h),e.preventDefault())}))}getCurrentRangeCoords(t,e,n,i,o){const r=t.getTopStartCorner(),s=t.getBottomEndCorner(),l=t.getBottomStartCorner(),a=t.getTopEndCorner();let h={start:null,end:null};switch(n){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":h="top"===o?{start:this.hot._createCellCoords(e.row,t.highlight.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,r.col)};break;case"SE-NW":"bottom"===o&&(h={start:this.hot._createCellCoords(s.row,e.col),end:this.hot._createCellCoords(e.row,r.col)})}break;case"NW-SE":switch(i){case"NE-SW":"top"===o?h={start:e,end:l}:h.end=e;break;case"NW-SE":"top"===o?h={start:e,end:s}:h.end=e;break;case"SE-NW":"top"===o?h={start:e,end:r}:h.end=e;break;case"SW-NE":"top"===o?h={start:e,end:a}:h.end=e}break;case"SW-NE":switch(i){case"NW-SE":h="bottom"===o?{start:this.hot._createCellCoords(e.row,r.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(r.row,e.col),end:this.hot._createCellCoords(e.row,s.col)};break;case"SW-NE":h="top"===o?{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,s.col)}:{start:this.hot._createCellCoords(e.row,r.col),end:this.hot._createCellCoords(r.row,e.col)};break;case"SE-NW":"bottom"===o?h={start:this.hot._createCellCoords(e.row,a.col),end:this.hot._createCellCoords(r.row,e.col)}:"top"===o&&(h={start:l,end:e})}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":"top"===o&&(h.end=e);break;case"SE-NW":"top"===o?h.end=e:h={start:e,end:r}}}return h}isDragged(){return this.dragged.length>0}}function VZ(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:i=!1,crossHiddenColumns:o=[],isCollapsed:r=!1,isHidden:s=!1,isRoot:l=!1,isPlaceholder:a=!1,headerClassNames:h=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:i,isCollapsed:r,crossHiddenColumns:o,isHidden:s,isRoot:l,isPlaceholder:a,headerClassNames:h}}function FZ(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function WZ(t,e){return t.get(BZ(t,e))}function jZ(t,e,n){return t.set(BZ(t,e),n),n}function BZ(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zZ=["label","collapsible"];var UZ=new WeakMap,YZ=new WeakMap,$Z=new WeakMap;class GZ{constructor(){FZ(this,UZ,[]),FZ(this,YZ,0),FZ(this,$Z,Infinity)}setColumnsLimit(t){jZ($Z,this,t)}setData(){jZ(UZ,this,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Infinity;const n=[];if(0===e)return n;Np(t,(t=>{const i=[];let o=0;n.push(i),Np(t,(t=>{const n=VZ();if(Kv(t)){const{label:e,colspan:i,headerClassName:o}=t;n.label=Wp(e),"number"==typeof i&&i>1&&(n.colspan=i,n.origColspan=i),"string"==typeof o&&(n.headerClassNames=[...o.split(" ")])}else n.label=Wp(t);o+=n.origColspan;let r=!1;if(o>=e&&(n.colspan=n.origColspan-(o-e),n.origColspan=n.colspan,r=!0),i.push(n),n.colspan>1)for(let e=0;e<n.colspan-1;e++)i.push({label:"",isPlaceholder:!0});return!r}))}));const i=Math.max(...Pp(n,(t=>t.length)));return Np(n,(t=>{if(t.length<i){const e=Pp(new Array(i-t.length),(()=>VZ()));t.splice(t.length,0,...e)}})),n}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],WZ($Z,this))),jZ(YZ,this,WZ(UZ,this).length)}getData(){return WZ(UZ,this)}mergeWith(t){Np(t,(t=>{let e=t,{row:n,col:i}=e,o=c(e,["row","col"]);const r=this.getHeaderSettings(n,i);null!==r&&Bv(r,o,zZ)}))}map(t){Np(WZ(UZ,this),(e=>{Np(e,(e=>{const n=t(a({},e));Kv(n)&&Bv(e,n,zZ)}))}))}getHeaderSettings(t,e){var n;if(t>=WZ(YZ,this)||t<0)return null;const i=WZ(UZ,this)[t];return!1===Array.isArray(i)||e>=i.length?null:null!==(n=i[e])&&void 0!==n?n:null}getHeadersSettings(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=[];if(t>=WZ(YZ,this)||t<0)return i;const o=WZ(UZ,this)[t];let r=0;for(let s=e;s<o.length;s++){const t=o[s];if(t.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(r+=t.colspan,i.push(t),t.colspan>1&&(s+=t.colspan-1),r===n)break;if(r>n)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return WZ(YZ,this)}getColumnsCount(){return WZ(YZ,this)>0?WZ(UZ,this)[0].length:0}clear(){jZ(UZ,this,[]),jZ(YZ,this,0)}}function KZ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const XZ="DF-pre-order";const qZ=new Map([[XZ,function t(e,n){let i=e.call(n,this);for(let o=0;o<this.childs.length;o++){if(!1===i)return!1;i=t.call(this.childs[o],e,n)}return i}],["DF-post-order",function t(e,n){for(let i=0;i<this.childs.length;i++){if(!1===t.call(this.childs[i],e,n))return!1}return e.call(n,this)}],["BF",function(t,e){const n=[this];!function i(){if(0===n.length)return;const o=n.shift();n.push(...o.childs),!1!==t.call(e,o)&&i()}()}]]);class ZZ{constructor(t){KZ(this,"data",{}),KZ(this,"parent",null),KZ(this,"childs",[]),this.data=t}addChild(t){t.parent=this,this.childs.push(t)}cloneTree(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const e=new ZZ(a({},t.data));for(let n=0;n<t.childs.length;n++)e.addChild(this.cloneTree(t.childs[n]));return e}replaceTreeWith(t){this.data=a({},t.data),this.childs=[];for(let e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}walkDown(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!qZ.has(e))throw new Error(`Traversal strategy "${e}" does not exist`);qZ.get(e).call(this,t,this)}walkUp(t){const e=this,n=i=>{!1!==t.call(e,i)&&null!==i.parent&&n(i.parent)};n(this)}}function QZ(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function JZ(t,e){return t.get(tQ(t,e))}function tQ(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var eQ=new WeakMap,nQ=new WeakMap,iQ=new WeakMap;class oQ{constructor(t){var e,n,i;QZ(this,eQ,new Map),QZ(this,nQ,new Map),QZ(this,iQ,null),n=this,i=t,(e=iQ).set(tQ(e,n),i)}getRoots(){return Array.from(JZ(eQ,this).values())}getRootByColumn(t){let e;return JZ(nQ,this).has(t)&&(e=JZ(eQ,this).get(JZ(nQ,this).get(t))),e}getNode(t,e){const n=this.getRootByColumn(e);if(!n)return;const i=e-JZ(nQ,this).get(e);let o,r=0;return n.walkDown((n=>{const{data:{origColspan:s,headerLevel:l}}=n;if(t===l){if(i>=r&&i<=r+s-1)return o=n,o.data.isRoot=e===o.data.columnIndex,!1;r+=s}})),o}rebuildTreeIndex(){let t=0;JZ(nQ,this).clear(),Np(JZ(eQ,this),(e=>{let[,{data:{colspan:n}}]=e;for(let i=t;i<t+n;i++)JZ(nQ,this).set(i,t);t+=n}))}buildTree(){this.clear();const t=JZ(iQ,this).getColumnsCount();let e=0;for(;e<t;){const t=JZ(iQ,this).getHeaderSettings(0,e),n=new ZZ;JZ(eQ,this).set(e,n),this.buildLeaves(n,e,0,t.origColspan),e+=t.origColspan}this.rebuildTreeIndex()}buildLeaves(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const o=JZ(iQ,this).getHeadersSettings(n,e,i);n+=1,Np(o,(i=>{const o=h(a({},i),{headerLevel:n-1,columnIndex:e});let r;1===n?(t.data=o,r=t):(r=new ZZ(o),t.addChild(r)),n<JZ(iQ,this).getLayersCount()&&this.buildLeaves(r,e,n,i.origColspan),e+=i.origColspan}))}clear(){JZ(eQ,this).clear(),JZ(nQ,this).clear()}}function rQ(t,e){t.walkDown((t=>{let{data:n,childs:i}=t;if(!n.isHidden&&(e(n.columnIndex),0===i.length))for(let o=1;o<n.colspan;o++)e(n.columnIndex+o)}))}function sQ(t,e){let{childs:n}=t;if(0!==n.length)return n[0].data[e]}function lQ(t){return sQ(t,"origColspan")===t.data.origColspan}function aQ(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(lQ(t))return aQ(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let r=0;if(i.length>0)Np(i,(t=>{t.replaceTreeWith(t.data.clonedTree),t.data.clonedTree=null;const e=t.data;r+=e.colspan,rQ(t,(t=>{o.add(t)}))}));else{const{colspan:t,origColspan:n,columnIndex:i}=e;r=n-t;for(let e=1;e<n;e++)o.add(i+e)}return t.walkUp((t=>{const{data:e}=t;e.colspan+=r,e.colspan>=e.origColspan?(e.colspan=e.origColspan,e.isCollapsed=!1):lQ(t)&&(e.isCollapsed=sQ(t,"isCollapsed"))})),{rollbackModification:()=>hQ(t),affectedColumns:Array.from(o),colspanCompensation:r}}function hQ(t){var e;const{data:n,childs:i}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(lQ(t))return hQ(i[0]);n.isCollapsed=!0;const o=i.slice(1),r=new Set;if(o.length>0)Np(o,(t=>{rQ(t,(t=>{r.add(t)})),t.data.clonedTree=t.cloneTree(),t.walkDown((t=>{let{data:e}=t;e.isHidden=!0}))}));else{const{origColspan:t,columnIndex:e}=n;for(let n=1;n<t;n++){const t=e+n;r.add(t)}}const s=n.colspan-(null!==(e=sQ(t,"colspan"))&&void 0!==e?e:1);return t.walkUp((t=>{const{data:e}=t;e.colspan-=s,e.colspan<=1?(e.colspan=1,e.isCollapsed=!0):lQ(t)&&(e.isCollapsed=sQ(t,"isCollapsed"))})),{rollbackModification:()=>aQ(t),affectedColumns:Array.from(r),colspanCompensation:s}}const cQ=new Map([["collapse",hQ],["expand",aQ],["hide-column",function(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Fp`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let i=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return i=!0,!1})),i||t.walkUp((t=>{const{data:n}=t;n.crossHiddenColumns.push(e),n.colspan>1?n.colspan-=1:n.isHidden=!0}))}],["show-column",function(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Fp`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let i=!1;t.walkUp((t=>{const{data:{collapsible:e}}=t;if(e)return i=!0,!1})),i||t.walkUp((t=>{const{data:n}=t;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(e),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1}))}]]);function uQ(t){const e=[];return Np(t,(t=>{t.walkDown((t=>{const n=t.data,{origColspan:i,columnIndex:o,headerLevel:r,crossHiddenColumns:s}=n,l=function(t,e){let n;Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n);return n}(e,r);let a=!1;for(let e=o;e<o+i;e++){if(s.includes(e)||a)l.push({label:"",isPlaceholder:!0});else{const t=dQ(n);t.isRoot=!0,l.push(t),a=!0}}}))})),e}function dQ(t){const e=VZ(t),{crossHiddenColumns:n}=e;return c(e,["crossHiddenColumns"])}function gQ(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function fQ(t,e,n){return t.set(pQ(t,e),n),n}function mQ(t,e){return t.get(pQ(t,e))}function pQ(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wQ=new WeakMap,vQ=new WeakMap,yQ=new WeakMap;class bQ{constructor(){gQ(this,wQ,new GZ),gQ(this,vQ,new oQ(mQ(wQ,this))),gQ(this,yQ,[[]])}setState(t){mQ(wQ,this).setData(t);let e=!1;try{mQ(vQ,this).buildTree()}catch(n){mQ(vQ,this).clear(),mQ(wQ,this).clear(),e=!0}return fQ(yQ,this,uQ(mQ(vQ,this).getRoots())),e}setColumnsLimit(t){mQ(wQ,this).setColumnsLimit(t)}mergeStateWith(t){const e=Pp(t,(t=>{let e=t,{row:n}=e,i=c(e,["row"]);return a({row:n<0?this.rowCoordsToLevel(n):n},i)}));mQ(wQ,this).mergeWith(e),mQ(vQ,this).buildTree(),fQ(yQ,this,uQ(mQ(vQ,this).getRoots()))}mapState(t){mQ(wQ,this).map(t),mQ(vQ,this).buildTree(),fQ(yQ,this,uQ(mQ(vQ,this).getRoots()))}mapNodes(t){return Ap(mQ(vQ,this).getRoots(),((e,n)=>(n.walkDown((n=>{const i=t(n.data);void 0!==i&&e.push(i)})),e)),[])}triggerNodeModification(t,e,n){e<0&&(e=this.rowCoordsToLevel(e));const i=mQ(vQ,this).getNode(e,n);let o;return i&&(o=function(t,e,n){if(!cQ.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return cQ.get(t)(e,n)}(t,i,n),fQ(yQ,this,uQ(mQ(vQ,this).getRoots()))),o}triggerColumnModification(t,e){return this.triggerNodeModification(t,-1,e)}rowCoordsToLevel(t){if(t>=0)return null;const e=t+Math.max(this.getLayersCount(),1);return e<0?null:e}levelToRowCoords(t){if(t<0)return null;const e=t-Math.max(this.getLayersCount(),1);return e>=0?null:e}getHeaderSettings(t,e){var n,i;return t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount()?null:null!==(n=null===(i=mQ(yQ,this)[t])||void 0===i?void 0:i[e])&&void 0!==n?n:null}getHeaderTreeNodeData(t,e){const n=this.getHeaderTreeNode(t,e);return n?a({},n.data):null}getHeaderTreeNode(t,e){if(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())return null;const n=mQ(vQ,this).getNode(t,e);return n||null}findTopMostEntireHeaderLevel(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;const i=n-t+1;let o=!1,r=null;for(let s=t;s<=n;s++){const e=mQ(vQ,this).getRootByColumn(s);if(!e)break;o=!0,e.walkDown((e=>{const{columnIndex:o,headerLevel:s,origColspan:l,isHidden:a}=e.data;a||l<=i&&o>=t&&o+l-1<=n&&(null===r||s<r)&&(r=s)}),XZ)}return o&&null===r?-1:this.levelToRowCoords(null!==(e=r)&&void 0!==e?e:0)}findLeftMostColumnIndex(t,e){var n;const{isRoot:i}=null!==(n=this.getHeaderSettings(t,e))&&void 0!==n?n:{isRoot:!0};if(i)return e;let o=e-1;for(;o>=0;){var r;const{isRoot:e}=null!==(r=this.getHeaderSettings(t,o))&&void 0!==r?r:{isRoot:!0};if(e)break;o-=1}return o}findRightMostColumnIndex(t,e){var n;const{isRoot:i,origColspan:o}=null!==(n=this.getHeaderSettings(t,e))&&void 0!==n?n:{isRoot:!0,origColspan:1};if(i)return e+o-1;let r=e+1;for(;r<this.getColumnsCount();){var s;const{isRoot:e}=null!==(s=this.getHeaderSettings(t,r))&&void 0!==s?s:{isRoot:!0};if(e)break;r+=1}return r-1}getLayersCount(){return mQ(wQ,this).getLayersCount()}getColumnsCount(){return mQ(wQ,this).getColumnsCount()}clear(){fQ(yQ,this,[]),mQ(wQ,this).clear(),mQ(vQ,this).clear()}}function CQ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const SQ=class{constructor(t,e){CQ(this,"hot",void 0),CQ(this,"nestedHeaderSettingsGetter",void 0),CQ(this,"layersCount",0),CQ(this,"container",void 0),CQ(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=e,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(t){return this.layersCount=t,this}getWidth(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length;this.widthsMap.clear();for(let n=0;n<e;n++){const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),i=this.hot.toPhysicalColumn(e);this.widthsMap.setValueAtIndex(i,t[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(t){const{rootDocument:e,columnIndexMapper:n}=this.hot,i=e.createDocumentFragment(),o=e.createElement("table"),r=!!this.hot.getSettings().dropdownMenu,s=n.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const t=e.createElement("tr");for(let i=0;i<s;i++){let o=n.getVisualFromRenderableIndex(i);null===o&&(o=i);const s=e.createElement("th"),a=this.nestedHeaderSettingsGetter(l,o);if(a&&(!a.isPlaceholder||a.isHidden)){let e=a.label;r&&(e+='<button class="changeType"></button>'),_w(s,e),s.colSpan=a.colspan,t.appendChild(s)}}o.appendChild(t)}i.appendChild(o),t.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}};function RQ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EQ(t,e,n){TQ(t,e),e.set(t,n)}function TQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MQ(t,e,n){return t.set(HQ(t,e),n),n}function xQ(t,e){return t.get(HQ(t,e))}function HQ(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const kQ="nestedHeaders";var IQ=new WeakMap,OQ=new WeakMap,AQ=new WeakMap,_Q=new WeakMap,PQ=new WeakMap,NQ=new WeakSet;class DQ extends xN{constructor(){var t,e;super(...arguments),TQ(t=this,e=NQ),e.add(t),EQ(this,IQ,new bQ),EQ(this,OQ,null),EQ(this,AQ,null),EQ(this,_Q,!1),EQ(this,PQ,null),RQ(this,"ghostTable",new SQ(this.hot,((t,e)=>this.getHeaderSettings(t,e)))),RQ(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return kQ}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[kQ]}enablePlugin(){var t=this;if(this.enabled)return;const{nestedHeaders:e}=this.hot.getSettings();Array.isArray(e)&&Array.isArray(e[0])||Ey(Fp`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",(()=>HQ(NQ,this,JQ).call(this))),this.addHook("afterLoadData",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return HQ(NQ,t,tJ).call(t,...n)})),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return HQ(NQ,t,jQ).call(t,...n)})),this.addHook("afterOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return HQ(NQ,t,BQ).call(t,...n)})),this.addHook("beforeOnCellMouseOver",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return HQ(NQ,t,zQ).call(t,...n)})),this.addHook("beforeOnCellMouseUp",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return HQ(NQ,t,UQ).call(t,...n)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return HQ(NQ,t,YQ).call(t,...n)})),this.addHook("modifyTransformStart",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return HQ(NQ,t,$Q).call(t,...n)})),this.addHook("afterSelection",(()=>HQ(NQ,this,LQ).call(this))),this.addHook("afterSelectionFocusSet",(()=>HQ(NQ,this,LQ).call(this))),this.addHook("beforeViewportScrollHorizontally",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return HQ(NQ,t,VQ).call(t,...n)})),this.addHook("afterGetColumnHeaderRenderers",(t=>HQ(NQ,this,KQ).call(this,t))),this.addHook("modifyColWidth",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return HQ(NQ,t,qQ).call(t,...n)})),this.addHook("modifyColumnHeaderValue",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return HQ(NQ,t,ZQ).call(t,...n)})),this.addHook("beforeHighlightingColumnHeader",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return HQ(NQ,t,FQ).call(t,...n)})),this.addHook("beforeCopy",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return HQ(NQ,t,WQ).call(t,...n)})),this.addHook("beforeSelectColumns",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return HQ(NQ,t,GQ).call(t,...n)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return HQ(NQ,t,XQ).call(t,...n)})),this.addHook("modifyFocusedElement",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return HQ(NQ,t,QQ).call(t,...n)})),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",(()=>HQ(NQ,this,LQ).call(this))),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",(()=>HQ(NQ,this,LQ).call(this))),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:t}=this.hot.getSettings();xQ(IQ,this).setColumnsLimit(this.hot.countCols()),Array.isArray(t)&&(this.detectedOverlappedHeaders=xQ(IQ,this).setState(t)),this.detectedOverlappedHeaders&&Ey(Fp`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(((t,e)=>{const n=!0===t?"hide-column":"show-column";xQ(IQ,this).triggerColumnModification(n,e)})),!xQ(OQ,this)&&this.enabled&&MQ(OQ,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((t=>{t.forEach((t=>{let{op:e,index:n,newValue:i}=t;if("replace"===e){const t=!0===i?"hide-column":"show-column";xQ(IQ,this).triggerColumnModification(t,n)}})),this.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),xQ(IQ,this).clear(),xQ(OQ,this).unsubscribe(),MQ(OQ,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return xQ(IQ,this)}getLayersCount(){return xQ(IQ,this).getLayersCount()}getHeaderSettings(t,e){return xQ(IQ,this).getHeaderSettings(t,e)}clearColspans(){if(!this.hot.view)return;const{_wt:t}=this.hot.view,e=t.getSetting("columnHeaders").length,n=t.wtTable.THEAD,i=t.wtOverlays.topOverlay.clone.wtTable.THEAD,o=t.wtOverlays.topInlineStartCornerOverlay?t.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let r=0;r<e;r++){const t=n.childNodes[r];if(!t)break;const e=i.childNodes[r],s=o?o.childNodes[r]:null;for(let n=0,i=t.childNodes.length;n<i;n++)t.childNodes[n].removeAttribute("colspan"),xw(t.childNodes[n],"hiddenHeader"),e&&e.childNodes[n]&&(e.childNodes[n].removeAttribute("colspan"),xw(e.childNodes[n],"hiddenHeader")),o&&s&&s.childNodes[n]&&(s.childNodes[n].removeAttribute("colspan"),xw(s.childNodes[n],"hiddenHeader"))}}headerRendererFactory(t){var e=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var r;const{columnIndexMapper:s,view:l}=this.hot;let a=s.getVisualFromRenderableIndex(i);null===a&&(a=i),o.removeAttribute("colspan"),xw(o,"hiddenHeader");const{colspan:h,isHidden:c,isPlaceholder:u,headerClassNames:d}=null!==(r=xQ(IQ,this).getHeaderSettings(t,a))&&void 0!==r?r:{label:""};if(u||c)Mw(o,"hiddenHeader");else if(h>1){var g,f;const{wtOverlays:t}=l._wt,e=null===(g=t.topInlineStartCornerOverlay)||void 0===g?void 0:g.clone.wtTable.THEAD.contains(o),r=null===(f=t.inlineStartOverlay)||void 0===f?void 0:f.clone.wtTable.THEAD.contains(o),s=e||r?Math.min(h,n-i):h;s>1&&o.setAttribute("colspan",s)}if(this.hot.view.appendColHeader(a,o,(function(){return e.getColumnHeaderValue(...arguments)}),t),!u&&!c){const t=o.querySelector("div.relative");t&&d&&d.length>0&&(xw(t,this.hot.getColumnMeta(a).headerClassName),Mw(t,d))}}}getColumnHeaderValue(t,e){var n;const{isHidden:i,isPlaceholder:o}=null!==(n=xQ(IQ,this).getHeaderSettings(e,t))&&void 0!==n?n:{};return o||i?"":this.hot.getColHeader(t,e)}destroy(){MQ(IQ,this,null),null!==xQ(OQ,this)&&(xQ(OQ,this).unsubscribe(),MQ(OQ,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(t){if(!(t.row>=0||t.col<0))return xQ(IQ,this).getHeaderTreeNodeData(t.row,t.col)}}function LQ(){var t;const e=null===(t=this.hot)||void 0===t?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const t=xQ(IQ,this).findLeftMostColumnIndex(n.row,n.col),e=this.hot.selection.highlight.getFocus();e.visualCellRange.highlight.col=t,e.visualCellRange.from.col=t,e.visualCellRange.to.col=t,e.commit()}}function VQ(t,e){var n;const i=this.hot.getSelectedRangeLast();if(!i)return t;const{highlight:o}=i,{navigableHeaders:r}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),l=r?o.row:null===(n=xQ(PQ,this))||void 0===n?void 0:n.row,a=s?t:o.col,h=l<0&&a>=0;if(MQ(PQ,this,null),!h)return t;const c=this.hot.getFirstFullyVisibleColumn(),u=this.hot.getLastFullyVisibleColumn(),d=u-c+1,g=xQ(IQ,this).findLeftMostColumnIndex(l,a),f=xQ(IQ,this).findRightMostColumnIndex(l,a),m=f-g+1;if(g<c&&f>u)return g;if(s){let t=null;return g>=c&&f>u?m>d?(e.value="start",t=g):(e.value="end",t=f):g<c&&f<=u&&(m>d?(e.value="end",t=f):(e.value="start",t=g)),t}return g<=c?g:f}function FQ(t,e,n){const i=xQ(IQ,this).getHeaderTreeNodeData(e,t);if(!i)return t;const{columnCursor:o,selectionType:r,selectionWidth:s}=n,{isRoot:l,colspan:a}=xQ(IQ,this).getHeaderSettings(e,t);if(r===KE){if(!l)return i.columnIndex}else if(r===GE&&(a>s-o||!l))return null;return t}function WQ(t,e,n){let{columnHeadersCount:i}=n;if(0!==i)for(let r=0;r<e.length;r++){const{startRow:n,startCol:i,endRow:s,endCol:l}=e[r],a=s-n+1;if(n>=0||1===i-l+1)break;for(let e=i;e<=l;e++)for(let r=n;r<=s;r++){var o;const n=a+r,s=e-i;if(0===s)continue;!1===(null===(o=xQ(IQ,this).getHeaderTreeNodeData(r,e))||void 0===o?void 0:o.isRoot)&&(t[n][s]="")}}}function jQ(t,e,n,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function BQ(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;MQ(AQ,this,e.clone()),MQ(_Q,this,!0);const{selection:i}=this.hot,o=i.isSelected()?i.getSelectedRange().current():null,r=[],{columnIndex:s,origColspan:l}=n,a=!i.inInSelection(e);t.shiftKey&&o?e.col<o.from.col?r.push(o.getTopEndCorner().col,s,e.row):e.col>o.from.col?r.push(o.getTopStartCorner().col,s+l-1,e.row):r.push(s,s+l-1,e.row):(Ry(t)||Sy(t)&&a||function(t){return t instanceof TouchEvent}(t))&&r.push(s,s+l-1,e.row),i.selectColumns(...r)}function zQ(t,e,n,i){if(!this.hot.view.isMouseDown()||i.column)return;const o=this._getHeaderTreeNodeDataByCoords(e);if(!o)return;const{columnIndex:r,origColspan:s}=o,l=this.hot.getSelectedRangeLast(),a=l.getTopStartCorner(),h=l.getBottomEndCorner(),{from:c}=l;i.column=!0,i.cell=!0;const u=[],d=jC(e.row,-Infinity,-1);e.col<c.col?u.push(h.col,r,d):e.col>c.col?u.push(a.col,r+s-1,d):u.push(r,r+s-1,d),this.hot.selection.selectColumns(...u)}function UQ(){MQ(_Q,this,!1)}function YQ(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!xQ(_Q,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:o,origColspan:r}=xQ(IQ,this).getHeaderTreeNodeData(xQ(AQ,this).row,xQ(AQ,this).col);if(e.setHighlight(xQ(AQ,this)),r>e.getWidth()||o<n||o+r-1>i){const t=xQ(IQ,this).findTopMostEntireHeaderLevel(jC(n,o,o+r-1),jC(i,o,o+r-1));e.highlight.row=t,e.highlight.col=e.from.col}}function $Q(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=xQ(IQ,this).findLeftMostColumnIndex(n.row,n.col),o=xQ(IQ,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const n=e.col>=i&&e.col<=o?i-1:o,r=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,-1);t.col=null===r?-this.hot.view.countRenderableColumnsInRange(0,e.col):-Math.max(this.hot.view.countRenderableColumnsInRange(r,e.col)-1,1)}else if(t.col>0){const n=e.col>=i&&e.col<=o?o+1:i,r=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,1);t.col=null===r?this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(e.col,r)-1,1)}}function GQ(t,e,n){const i=t.row,o=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),r=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});MQ(PQ,this,n.clone()),e.col<t.col?(o&&(t.col=o.columnIndex+o.origColspan-1),r&&(e.col=r.columnIndex)):e.col>=t.col&&(o&&(t.col=o.columnIndex),r&&(e.col=r.columnIndex+r.origColspan-1))}function KQ(t){t.length=0;for(let e=0;e<xQ(IQ,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function XQ(t){const e=xQ(IQ,this).getLayersCount();let n=t.startColumn,i=!!e;for(let o=0;o<e;o++){const e=xQ(IQ,this).findLeftMostColumnIndex(o,t.startColumn),r=this.hot.columnIndexMapper.getRenderableFromVisualIndex(e);if(e>=0&&(i=!1),LC(r)&&r<t.startColumn){n=r;break}}t.startColumn=i?xQ(IQ,this).getHeaderTreeNodeData(0,n).columnIndex:n}function qQ(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function ZQ(t,e,n){var i;const{label:o}=null!==(i=xQ(IQ,this).getHeaderTreeNodeData(n,e))&&void 0!==i?i:{label:""};return o}function QQ(t,e){if(t<0)return this.hot.getCell(t,xQ(IQ,this).findLeftMostColumnIndex(t,e),!0)}function JQ(){this.updatePlugin()}function tJ(t,e){e||this.updatePlugin()}function eJ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const nJ=class{constructor(t,e){eJ(this,"hot",void 0),eJ(this,"data",null),eJ(this,"plugin",void 0),eJ(this,"parentReference",new WeakMap),eJ(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=e,this.plugin=t}setData(t){this.data=t}getData(){return this.data}getRawSourceData(){let t=null;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}updateWithData(t){this.setData(t),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},VC(0,this.data.length-1,(t=>{this.cacheNode(this.data[t],0,null)}))}cacheNode(t,e,n){this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:n,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&Np(t.__children,(n=>{this.cacheNode(n,e+1,t)}))}getDataObject(t){return null==t?null:this.cache.rows[t]}readTreeNodes(t,e,n,i){let o=!1,r=e;if(isNaN(r)&&r.end)return r;let s=t;return s||(s={__children:this.data},o=!0,r-=1),null!=n&&r===n?{result:s,end:!0}:null!=i&&s===i?{result:r,end:!0}:(r+=1,s.__children&&Np(s.__children,(t=>{if(this.parentReference.set(t,o?null:s),r=this.readTreeNodes(t,r,n,i),isNaN(r)&&r.end)return!1})),r)}mockParent(){const t=this.mockNode();return t.__children=this.data,t}mockNode(){const t={};return qv(this.data[0],((e,n)=>{t[n]=null})),t}getRowIndex(t){return null==t?null:this.cache.nodeInfo.get(t).row}getRowIndexWithinParent(t){let e=null;e=isNaN(t)?t:this.getDataObject(t);const n=this.getRowParent(t);return null==n?this.data.indexOf(e):n.__children.indexOf(e)}countAllRows(){const t={__children:this.data};return this.countChildren(t)}countChildren(t){let e=0,n=t;return isNaN(n)||(n=this.getDataObject(n)),n&&n.__children?(Np(n.__children,(t=>{e+=1,t.__children&&(e+=this.countChildren(t))})),e):0}getRowParent(t){let e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}getRowObjectParent(t){return t&&"object"==typeof t?this.cache.nodeInfo.get(t).parent:null}getRowLevel(t){let e=null;return e=isNaN(t)?t:this.getDataObject(t),e?this.getRowObjectLevel(e):null}getRowObjectLevel(t){return null==t?null:this.cache.nodeInfo.get(t).level}hasChildren(t){let e=t;return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)}isChild(t){return null!==this.getRowParent(t)}getChild(t,e){var n;return(null===(n=t.__children)||void 0===n?void 0:n[e])||null}isRowHighestLevel(t){return!this.isChild(t)}isParent(t){var e;let n=t;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(e=n.__children)||void 0===e?void 0:e.length)}addChild(t,e){let n=e;this.hot.runHooks("beforeAddChild",t,n);let i=null;t&&(i=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(t)+1,1);let o=t;t||(o=this.mockParent()),o.__children||(o.__children=[]),n||(n=this.mockNode()),o.__children.push(n),this.rewriteCache();const r=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(r,1),this.hot.runHooks("afterCreateRow",r,1),this.hot.runHooks("afterAddChild",t,n)}addChildAtIndex(t,e,n){let i,o=n;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",t,o,e),t){const n=this.getRowIndex(t)+e+1;this.hot.runHooks("beforeCreateRow",n,1),t.__children.splice(e,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(n,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",n,1),i=n}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",e,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),i=this.getRowIndex(this.data[e]);o=this.getDataObject(i),this.hot.runHooks("afterAddChild",t,o,e)}addSibling(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const n=this.translateTrimmedRow(t),i=this.getRowParent(n),o=this.getRowIndexWithinParent(n);switch(e){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null)}}detachFromParent(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=null;const i=[];Array.isArray(t)?(VC(t[0],t[2],(t=>{const e=this.translateTrimmedRow(t);i.push(this.getDataObject(e))})),VC(0,i.length-2,(t=>{this.detachFromParent(i[t],!1)})),n=i[i.length-1]):n=t;const o=this.getRowIndex(n),r=this.countChildren(n),s=this.getRowIndexWithinParent(n),l=this.getRowParent(n),a=this.getRowParent(l),h=this.getRowIndex(a);let c=null;if(this.hot.runHooks("beforeDetachChild",l,n),null!=s){const t=Array.from(new Array(o+r+1).keys()).splice(-1*(r+1));if(this.hot.runHooks("beforeRemoveRow",o,r+1,t,this.plugin.pluginName),l.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,r+1,t,this.plugin.pluginName),a){c=h+this.countChildren(a);const t=this.getChild(a,this.countChildren(a)-1),e=this.getRowIndex(t);this.hot.runHooks("beforeCreateRow",e+1,r+1,this.plugin.pluginName),a.__children.push(n)}else c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c-2,r+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",c-2,r+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,n,this.getRowIndex(n)),e&&this.hot.render()}filterData(t,e,n){const i=[];Np(n,(t=>{i.push(this.getDataObject(t))})),Np(i,(t=>{const e=this.getRowIndexWithinParent(t),n=this.getRowParent(t);null===n?this.data.splice(e,1):n.__children.splice(e,1)})),this.rewriteCache()}spliceData(t,e,n){const i=this.getDataObject(t-1);let o=null,r=t;i&&i.__children&&0===i.__children.length?(o=i,r=0):t<this.countAllRows()&&(o=this.getRowParent(t),r=this.getRowIndexWithinParent(t)),o?n?o.__children.splice(r,e,...n):o.__children.splice(r,e):n?this.data.splice(r,e,...n):this.data.splice(r,e),this.rewriteCache()}syncRowWithRawSource(t){let e=t,n=null;do{n=this.getRowParent(n),null!==n&&(e=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(e),"__children",e.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(t,e,n,i){const o=e===this.hot.countRows(),r=this.getRowParent(t),s=this.getRowIndexWithinParent(t),l=r.__children.slice(s,s+1),a=t>e;let h=o?this.getRowParent(e-1):this.getRowParent(e);null==h&&(h=this.getRowParent(e-1)),null==h&&(h=this.getDataObject(e-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(e),h.__children=[]);const c=o||n||i?h.__children.length:this.getRowIndexWithinParent(e),u=r===h;h.__children.splice(c,0,l[0]),r.__children.splice(s+(a&&u?1:0),1),this.syncRowWithRawSource(r),u||this.syncRowWithRawSource(h)}translateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}untranslateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}};function iJ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const oJ=class{constructor(t,e){iJ(this,"hot",void 0),iJ(this,"plugin",void 0),this.hot=e,this.plugin=t}};class rJ extends oJ{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(t,e){super(t,e),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(t,e){const n=this.hot.toPhysicalRow(t),i=this.dataManager.getRowLevel(n),o=this.dataManager.getDataObject(n),r=e.getElementsByTagName("DIV")[0],s=r.querySelector("span.rowHeader"),l=r.querySelectorAll('[class^="ht_nesting"]'),a=this.hot.getSettings().ariaTags;if(Np(l,(t=>{t&&r.removeChild(t)})),Mw(e,rJ.CSS_CLASSES.indicatorContainer),i){const{rootDocument:t}=this.hot,e=s.cloneNode(!0);r.innerHTML="",VC(0,i-1,(()=>{const e=t.createElement("SPAN");Mw(e,rJ.CSS_CLASSES.emptyIndicator),r.appendChild(e)})),r.appendChild(e)}if(this.dataManager.hasChildren(o)){const t=this.hot.rootDocument.createElement("DIV");a&&Hw(t,[["aria-hidden","true"]]),Mw(e,rJ.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(Mw(t,`${rJ.CSS_CLASSES.button} ${rJ.CSS_CLASSES.expandButton}`),a&&Hw(e,[gw(!1)])):(Mw(t,`${rJ.CSS_CLASSES.button} ${rJ.CSS_CLASSES.collapseButton}`),a&&Hw(e,[gw(!0)])),r.appendChild(t)}}updateRowHeaderWidth(t){let e=t;e||(e=this.dataManager.cache.levelCount);const n=this.hot.view.getStylesHandler();let i=11;if(!n.isClassicTheme()){i=2*n.getCSSVariableValue("cell-horizontal-padding")}this.rowHeaderWidthCache=Math.max(50,i+10*e+25),this.hot.render()}}const sJ=rJ;const lJ=class extends oJ{constructor(t,e){var n;super(t,e),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,t)},shiftStash:function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==e&&(e=Infinity),Np(n.lastCollapsedRows,((o,r)=>{o>=t&&o<e&&(n.lastCollapsedRows[r]=o+i)}))},applyStash:function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.collapseMultipleChildren(n.lastCollapsedRows,t),n.lastCollapsedRows=void 0},trimStash:(t,e)=>{VC(t,t+e-1,(t=>{const e=this.lastCollapsedRows.indexOf(t);e>-1&&this.lastCollapsedRows.splice(e,1)}))}}}collapseChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=[];let o=null,r=null,s=null;return isNaN(t)?(o=t,r=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(t),r=t),this.dataManager.hasChildren(o)&&Np(o.__children,(t=>{i.push(this.dataManager.getRowIndex(t))})),s=this.collapseRows(i,!0,!1),n&&this.trimRows(s),e&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(r)&&this.collapsedRows.push(r),s}collapseMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=[];Np(t,(t=>{i.push(...this.collapseChildren(t,!1,!1))})),n&&this.trimRows(i),e&&this.renderAndAdjust()}collapseRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([t],e)}collapseRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=[];return Np(t,(t=>{i.push(t),e&&this.collapseChildRows(t,i)})),n&&this.trimRows(i),i}collapseChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){Np(this.dataManager.getDataObject(t).__children,(t=>{const n=this.dataManager.getRowIndex(t);e.push(n),this.collapseChildRows(n,e)}))}n&&this.trimRows(e)}expandRow(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([t],e)}expandRows(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=[];return Np(t,(t=>{i.push(t),e&&this.expandChildRows(t,i)})),n&&this.untrimRows(i),i}expandChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){Np(this.dataManager.getDataObject(t).__children,(t=>{if(!this.isAnyParentCollapsed(t)){const n=this.dataManager.getRowIndex(t);e.push(n),this.expandChildRows(n,e)}}))}n&&this.untrimRows(e)}expandChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=[];let o=null,r=null,s=null;return isNaN(t)?(o=t,r=this.dataManager.getRowIndex(t)):(o=this.dataManager.getDataObject(t),r=t),this.collapsedRows.splice(this.collapsedRows.indexOf(r),1),this.dataManager.hasChildren(o)&&Np(o.__children,(t=>{const e=this.dataManager.getRowIndex(t);i.push(e)})),s=this.expandRows(i,!0,!1),n&&this.untrimRows(s),e&&this.renderAndAdjust(),s}expandMultipleChildren(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=[];Np(t,(t=>{i.push(...this.expandChildren(t,!1,!1))})),n&&this.untrimRows(i),e&&this.renderAndAdjust()}collapseAll(){const t=this.dataManager.getData(),e=[];Np(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.collapseMultipleChildren(e),this.renderAndAdjust()}expandAll(){const t=this.dataManager.getData(),e=[];Np(t,(t=>{this.dataManager.hasChildren(t)&&e.push(t)})),this.expandMultipleChildren(e),this.renderAndAdjust()}trimRows(t){this.hot.batchExecution((()=>{Np(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)}))}),!0)}untrimRows(t){this.hot.batchExecution((()=>{Np(t,(t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)}))}),!0)}areChildrenCollapsed(t){let e=isNaN(t)?t:this.dataManager.getDataObject(t),n=!0;return null===e&&(e={__children:this.dataManager.data}),this.dataManager.hasChildren(e)&&Np(e.__children,(t=>{const e=this.dataManager.getRowIndex(t);if(!this.plugin.collapsedRowsMap.getValueAtIndex(e))return n=!1,!1})),n}isAnyParentCollapsed(t){let e=t;for(;null!==e;){e=this.dataManager.getRowParent(e);const t=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(t)>-1)return!0}return!1}toggleState(t,e){if(e.col>=0)return;const n=this.translateTrimmedRow(e.row);Tw(t.target,sJ.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),by(t))}translateTrimmedRow(t){return this.hot.toPhysicalRow(t)}untranslateTrimmedRow(t){return this.hot.toVisualRow(t)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}};function aJ(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function hJ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cJ(t,e){return t.get(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e))}var uJ=new WeakMap;const dJ=class extends oJ{constructor(){super(...arguments),hJ(this,"dataManager",this.plugin.dataManager),aJ(this,uJ,{row_above:(t,e)=>{const n=e[e.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(t,e)=>{const n=e[e.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(t){const e=[{key:"add_child",name(){return this.getTranslatedPhrase(HH)},callback:()=>{const t=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),e=this.dataManager.getDataObject(t);this.dataManager.addChild(e)},disabled:()=>{const t=this.hot.getSelectedLast();return!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(kH)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const t=this.hot.getSelectedLast(),e=this.dataManager.translateTrimmedRow(t[0]);return!this.dataManager.getRowParent(e)||!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return VC(0,t.items.length-1,(n=>{if(0===n)return Np(e,((e,i)=>{t.items.splice(n+i,0,e)})),!1})),this.modifyRowInsertingOptions(t)}modifyRowInsertingOptions(t){return VC(0,t.items.length-1,(e=>{const n=cJ(uJ,this)[t.items[e].key];null!=n&&(t.items[e].callback=n)})),t}};function gJ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class fJ{constructor(t){gJ(this,"plugin",void 0),gJ(this,"hot",void 0),gJ(this,"dataManager",void 0),gJ(this,"collapsingUI",void 0),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}onBeforeRowMove(t,e,n,i){if(this.displayAPICompatibilityWarning({rows:t,finalIndex:e,dropIndex:n,movePossible:i}))return!1;this.movedToCollapsed=!1;const o=n===this.hot.countRows(),r=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let s=!0;const l=t.map((t=>{if(!s)return!1;const e=this.dataManager.translateTrimmedRow(t);return s=this.shouldAllowMoving(e,r),e})),a=-1===l.indexOf(r);if(!s||!a)return!1;const h=this.getBaseParent(l),c=this.getTargetParent(o,r),u=h===c;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(c),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(l,r,u),this.moveRows(l,r,c),this.dataManager.rewriteCache(),this.moveCellsMeta(l,r),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,e,n,i,i&&this.isRowOrderChanged(t,e)),this.hot.render(),this.selectCells(t,n),!1}displayAPICompatibilityWarning(t){const{rows:e,finalIndex:n,dropIndex:i,movePossible:o}=t;let r=!1;return Bp(i)&&(Ey(Fp`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",e,n,i,o,!1),r=!0),r}shouldAllowMoving(t,e){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===e||0===e)}getBaseParent(t){return this.dataManager.getRowParent(t[0])}getTargetParent(t,e){let n=this.dataManager.getRowParent(t?e-1:e);return null==n&&(n=this.dataManager.getRowParent(e-1)),n}shiftCollapsibleParentsLocations(t,e,n){n||(Math.max(...t)<=e?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],e,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(e,t[0],t.length))}moveRows(t,e,n){const i=e===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender((()=>{t.forEach((t=>{this.dataManager.moveRow(t,e,this.movedToCollapsed,i)}))}))}moveCellsMeta(t,e){const n=[],i=Math.max(...t)<e;t.forEach((t=>{n.push(this.hot.getCellMetaAtRow(t))})),this.hot.spliceCellsMeta(t[0],t.length),this.hot.spliceCellsMeta(e-(i?n.length:0),0,...n)}selectCells(t,e){const n=t.length;let i=0,o=0,r=null,s=null;if(this.movedToCollapsed){let r=null;r=t[n-1]<e?this.dataManager.translateTrimmedRow(e-n):this.dataManager.translateTrimmedRow(e);const s=this.dataManager.getRowParent(null===r?this.hot.countSourceRows()-1:r-1),l=this.dataManager.getRowIndex(s);i=this.dataManager.untranslateTrimmedRow(l),o=i}else t[n-1]<e?(o=e-1,i=o-n+1):(i=e,o=i+n-1);r=this.hot.selection,s=this.hot.countCols()-1,r.setRangeStart(this.hot._createCellCoords(i,0)),r.setRangeEnd(this.hot._createCellCoords(o,s),!0)}isRowOrderChanged(t,e){return t.some(((t,n)=>t-n!==e))}}function mJ(t,e,n){pJ(t,e),e.set(t,n)}function pJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wJ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vJ(t,e){return t.get(bJ(t,e))}function yJ(t,e,n){return t.set(bJ(t,e),n),n}function bJ(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const CJ="nestedRows",SJ=CJ;var RJ=new WeakMap,EJ=new WeakMap,TJ=new WeakSet;class MJ extends xN{constructor(){var t,e;super(...arguments),pJ(t=this,e=TJ),e.add(t),wJ(this,"dataManager",null),wJ(this,"headersUI",null),wJ(this,"collapsedRowsMap",null),mJ(this,RJ,!1),mJ(this,EJ,!1)}static get PLUGIN_KEY(){return CJ}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings()[CJ]}enablePlugin(){var t=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new gx),this.dataManager=new nJ(this,this.hot),this.collapsingUI=new lJ(this,this.hot),this.headersUI=new sJ(this,this.hot),this.contextMenuUI=new dJ(this,this.hot),this.rowMoveController=new fJ(this),this.addHook("afterInit",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bJ(TJ,t,WJ).call(t,...n)})),this.addHook("beforeViewRender",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bJ(TJ,t,jJ).call(t,...n)})),this.addHook("modifyRowData",(function(){return t.onModifyRowData(...arguments)})),this.addHook("modifySourceLength",(function(){return t.onModifySourceLength(...arguments)})),this.addHook("beforeDataSplice",(function(){return t.onBeforeDataSplice(...arguments)})),this.addHook("filterData",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bJ(TJ,t,kJ).call(t,...n)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bJ(TJ,t,IJ).call(t,...n)})),this.addHook("afterGetRowHeader",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bJ(TJ,t,OJ).call(t,...n)})),this.addHook("beforeOnCellMouseDown",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bJ(TJ,t,HJ).call(t,...n)})),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bJ(TJ,t,PJ).call(t,...n)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bJ(TJ,t,_J).call(t,...n)})),this.addHook("beforeAddChild",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bJ(TJ,t,NJ).call(t,...n)})),this.addHook("afterAddChild",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bJ(TJ,t,DJ).call(t,...n)})),this.addHook("beforeDetachChild",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bJ(TJ,t,LJ).call(t,...n)})),this.addHook("afterDetachChild",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bJ(TJ,t,VJ).call(t,...n)})),this.addHook("modifyRowHeaderWidth",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bJ(TJ,t,AJ).call(t,...n)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bJ(TJ,t,FJ).call(t,...n)})),this.addHook("beforeRowMove",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bJ(TJ,t,xJ).call(t,...n)})),this.addHook("beforeLoadData",(t=>bJ(TJ,this,BJ).call(this,t))),this.addHook("beforeUpdateData",(t=>bJ(TJ,this,BJ).call(this,t))),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const t=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(t),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:t}=this.hot.getSelectedRangeLast(),e=this.collapsingUI.translateTrimmedRow(t.row);return this.collapsingUI.areChildrenCollapsed(e)?this.collapsingUI.expandChildren(e):this.collapsingUI.collapseChildren(e),!1},runOnlyIf:()=>{var t,e;const n=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return n&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(n)&&-1===n.col&&n.row>=0},group:SJ,relativeToGroup:mO,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SJ)}disableCoreAPIModifiers(){yJ(EJ,this,!0)}enableCoreAPIModifiers(){yJ(EJ,this,!1)}onModifyRowData(t){if(!vJ(EJ,this))return this.dataManager.getDataObject(t)}onModifySourceLength(){if(!vJ(EJ,this))return this.dataManager.countAllRows()}onBeforeDataSplice(t,e,n){return!(!vJ(EJ,this)&&!this.dataManager.isRowHighestLevel(t))||(this.dataManager.spliceData(t,e,n),!1)}destroy(){super.destroy()}}function xJ(t,e,n,i){return this.rowMoveController.onBeforeRowMove(t,e,n,i)}function HJ(t,e,n){this.collapsingUI.toggleState(t,e,n)}function kJ(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),yJ(RJ,this,!0),this.dataManager.getData().slice()}function IJ(t){return this.contextMenuUI.appendOptions(t)}function OJ(t,e){this.headersUI.appendLevelIndicators(t,e)}function AJ(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function _J(t,e,n,i){i!==this.pluginName&&this.hot._registerTimeout((()=>{yJ(RJ,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()}))}function PJ(t,e,n){const i=Array.from(n.reduce(((t,e)=>{if(this.dataManager.isParent(e)){const n=this.dataManager.getDataObject(e).__children;return t.add(e),Array.isArray(n)&&n.forEach((e=>t.add(this.dataManager.getRowIndex(e)))),t}return t.add(e)}),new Set));n.length=0,n.push(...i)}function NJ(){this.collapsingUI.collapsedRowsStash.stash()}function DJ(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function LJ(){this.collapsingUI.collapsedRowsStash.stash()}function VJ(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function FJ(){this.dataManager.rewriteCache()}function WJ(){this.headersUI.updateRowHeaderWidth()}function jJ(t,e){vJ(RJ,this)&&(e.skipRender=!0)}function BJ(t){if(!function(t){return!!(Array.isArray(t)&&t.length&&t.every((t=>"object"==typeof t&&!Array.isArray(t)&&null!==t)))}(t))return Ty("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[CJ]=!1,void this.disablePlugin();this.dataManager.setData(t),this.dataManager.rewriteCache()}function zJ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const UJ=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;zJ(this,"rootWindow",void 0),zJ(this,"prefix",void 0),zJ(this,"savedKeys",[]),this.rootWindow=e,this.prefix=t,this.loadSavedKeys()}saveValue(t,e){this.rootWindow.localStorage.setItem(`${this.prefix}_${t}`,JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}loadValue(t,e){const n=void 0===t?e:t,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return null===i?void 0:JSON.parse(i)}reset(t){this.rootWindow.localStorage.removeItem(`${this.prefix}_${t}`)}resetAll(){Np(this.savedKeys,((t,e)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[e]}`)})),this.clearSavedKeys()}loadSavedKeys(){const t=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),e="string"==typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}};function YJ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}lb.getSingleton().register("persistentStateSave"),lb.getSingleton().register("persistentStateLoad"),lb.getSingleton().register("persistentStateReset");const $J="persistentState";class GJ extends xN{constructor(){super(...arguments),YJ(this,"storage",void 0)}static get PLUGIN_KEY(){return $J}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings()[$J]}enablePlugin(){this.enabled||(this.storage||(this.storage=new UJ(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",((t,e)=>this.saveValue(t,e))),this.addHook("persistentStateLoad",((t,e)=>this.loadValue(t,e))),this.addHook("persistentStateReset",(()=>this.resetValue())),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(t,e){e.value=this.storage.loadValue(t)}saveValue(t,e){this.storage.saveValue(t,e)}resetValue(t){void 0===t?this.storage.resetAll():this.storage.reset(t)}destroy(){super.destroy()}}function KJ(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function XJ(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qJ(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ZJ="search",QJ=function(t,e,n,i,o){t.getCellMeta(e,n).isSearchResult=o},JJ=function(t,e,n){return!(Bp(t)||null===t||!t.toLocaleLowerCase||0===t.length)&&(!Bp(e)&&null!==e&&-1!==e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale)))};var t0=new WeakSet;class e0 extends xN{constructor(){super(...arguments),KJ(this,t0),XJ(this,"callback",QJ),XJ(this,"queryMethod",JJ),XJ(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return ZJ}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings()[ZJ]}enablePlugin(){var t=this;if(this.enabled)return;const e=this.hot.getSettings()[ZJ];this.updatePluginSettings(e),this.addHook("beforeRenderer",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return qJ(t0,t,n0).call(t,...n)})),super.enablePlugin()}disablePlugin(){var t=this;const e=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return qJ(t0,t,n0).call(t,...n)};this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("beforeRenderer",e)})),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),r=[],s=this.hot;return VC(0,i-1,(i=>{VC(0,o-1,(o=>{const l=this.hot.getDataAtCell(i,o),a=this.hot.getCellMeta(i,o),h=a.search.callback||e,c=(a.search.queryMethod||n)(t,l,a);if(c){const t={row:i,col:o,data:l};r.push(t)}h&&h(s,i,o,l,c)}))})),r}getCallback(){return this.callback}setCallback(t){this.callback=t}getQueryMethod(){return this.queryMethod}setQueryMethod(t){this.queryMethod=t}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(t){this.searchResultClass=t}updatePluginSettings(t){Kv(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}destroy(){super.destroy()}}function n0(t,e,n,i,o,r){const s=r.className||[];let l=[];"string"==typeof s?l=s.split(" "):l.push(...s),this.isEnabled()&&r.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),r.className=l.join(" ")}function i0(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class o0{constructor(t){i0(this,"viewportWidth",void 0),i0(this,"overwriteColumnWidthFn",void 0),i0(this,"baseWidths",new Map),i0(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=t}prepare(t){let{viewportWidth:e}=t;this.viewportWidth=e,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(t,e){this.baseWidths.set(t,e)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class r0 extends o0{calculate(){const t=Array.from(this.baseWidths).reduce(((t,e)=>{let[,n]=e;return t+n}),0);if(this.viewportWidth-t<0)return void this.stretchedWidths.clear();const e=this.viewportWidth/t,n=[],i=[];let o=this.viewportWidth,r=0;if(this.baseWidths.forEach(((t,s)=>{const l=Math.round(t*e),a=this.overwriteColumnWidthFn(l,s);l===a&&l>=US?(n.push([s,a]),r+=a):l!==a&&(n.push([s,a]),i.push(s),o-=a)})),o<=US)return void this.stretchedWidths.clear();const s=o/r;let l=-1,a=0;n.forEach(((t,e)=>{let[o,r]=t,h=r;i.includes(o)||(h=Math.round(r*s)),this.stretchedWidths.set(o,h),l=o,e<n.length-1&&(a+=h)})),this.stretchedWidths.size>1&&this.stretchedWidths.set(l,Math.round(this.viewportWidth-a))}}function s0(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function l0(t,e){return t.get(h0(t,e))}function a0(t,e,n){return t.set(h0(t,e),n),n}function h0(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var c0=new WeakMap,u0=new WeakMap;class d0 extends o0{constructor(){super(...arguments),s0(this,c0,0),s0(this,u0,-1)}prepare(t){super.prepare(t),a0(c0,this,0),a0(u0,this,-1)}setColumnBaseWidth(t,e){super.setColumnBaseWidth(t,e),a0(u0,this,t),a0(c0,this,e)}calculate(){if(-1===l0(u0,this))return;const t=Array.from(this.baseWidths).reduce(((t,e)=>{let[,n]=e;return t+n}),0),e=Math.max(this.viewportWidth-t+l0(c0,this),0);this.stretchedWidths.set(l0(u0,this),e)}}function g0(t,e,n){f0(t,e),e.set(t,n)}function f0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function m0(t,e){return t.get(w0(t,e))}function p0(t,e,n){return t.set(w0(t,e),n),n}function w0(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var v0=new WeakMap,y0=new WeakMap,b0=new WeakMap,C0=new WeakMap,S0=new WeakSet;class R0{constructor(t){var e,n;f0(e=this,n=S0),n.add(e),g0(this,v0,void 0),g0(this,y0,void 0),g0(this,b0,new Map([["all",new r0(w0(S0,this,M0).bind(this))],["last",new d0(w0(S0,this,M0).bind(this))]])),g0(this,C0,"none"),p0(v0,this,t),p0(y0,this,m0(v0,this).columnIndexMapper.createAndRegisterIndexMap("stretchColumns","physicalIndexToValue"))}useStrategy(t){p0(C0,this,m0(b0,this).has(t)?t:"none")}refreshStretching(){"none"!==m0(C0,this)?m0(v0,this).batchExecution((()=>{m0(y0,this).clear();const t=m0(b0,this).get(m0(C0,this));let e=m0(v0,this).view.getViewportWidth();w0(S0,this,E0).call(this)&&(e-=Qw(m0(v0,this).rootDocument)),t.prepare({viewportWidth:e});for(let n=0;n<m0(v0,this).countCols();n++)m0(v0,this).columnIndexMapper.isHidden(m0(v0,this).toPhysicalColumn(n))||t.setColumnBaseWidth(n,w0(S0,this,T0).call(this,n));t.calculate(),t.getWidths().forEach((t=>{let[e,n]=t;m0(y0,this).setValueAtIndex(m0(v0,this).toPhysicalColumn(e),n)}))}),!0):m0(y0,this).clear()}getStretchedWidth(t){return m0(y0,this).getValueAtIndex(m0(v0,this).toPhysicalColumn(t))}}function E0(){const{view:t}=m0(v0,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=m0(v0,this).countRows(),i=t.getStylesHandler().getDefaultRowHeight();let o=0,r=!1;for(let l=0;l<n;l++){var s;if(o+=(null!==(s=m0(v0,this).getRowHeight(l))&&void 0!==s?s:i)+(0===l?1:0),o>e){r=!0;break}}return r}function T0(t){var e;return null!==(e=m0(v0,this).getColWidth(t,"StretchColumns"))&&void 0!==e?e:US}function M0(t,e){return m0(v0,this).runHooks("beforeStretchingColumnWidth",t,e)}function x0(t,e,n){H0(t,e),e.set(t,n)}function H0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function k0(t,e,n){return t.set(O0(t,e),n),n}function I0(t,e){return t.get(O0(t,e))}function O0(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var A0=new WeakMap,_0=new WeakMap,P0=new WeakMap,N0=new WeakSet;class D0 extends xN{constructor(){var t,e;super(...arguments),H0(t=this,e=N0),e.add(t),x0(this,A0,new R0(this.hot)),x0(this,_0,null),x0(this,P0,new ResizeObserver((t=>{requestAnimationFrame((()=>{var e;null!==(e=this.hot)&&void 0!==e&&e.view.isHorizontallyScrollableByWindow()&&t.forEach((t=>{let{contentRect:e}=t;null!==I0(_0,this)&&I0(_0,this)!==e.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),k0(_0,this,e.width)}))}))})))}static get PLUGIN_KEY(){return"stretchColumns"}static get PLUGIN_PRIORITY(){return 155}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var t=this;this.enabled||(I0(A0,this).useStrategy(this.hot.getSettings().stretchH),I0(P0,this).observe(this.hot.rootElement),this.addHook("beforeRender",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return O0(N0,t,V0).call(t,...n)})),this.addHook("modifyColWidth",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return O0(N0,t,L0).call(t,...n)}),10),super.enablePlugin())}updatePlugin(){I0(A0,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),I0(P0,this).unobserve(this.hot.rootElement)}getColumnWidth(t){return I0(A0,this).getStretchedWidth(t)}destroy(){I0(P0,this).disconnect(),k0(P0,this,null),k0(A0,this,null),super.destroy()}}function L0(t,e,n){if(n===this.pluginName)return;const i=this.getColumnWidth(e);return"number"==typeof i?i:t}function V0(t){t&&I0(A0,this).refreshStretching()}function F0(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function W0(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j0(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var B0=new WeakSet;class z0 extends xN{constructor(){super(...arguments),F0(this,B0),W0(this,"scrollbars",[]),W0(this,"clones",[]),W0(this,"lockedCollection",!1),W0(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return iy()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",(()=>j0(B0,this,U0).call(this))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",(()=>j0(B0,this,Y0).call(this))),this.addHook("afterMomentumScroll",(()=>j0(B0,this,$0).call(this)))}}function U0(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),i&&this.scrollbars.push(i),o&&o.clone&&this.scrollbars.push(o),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),o&&o.clone&&this.clones.push(o.clone.wtTable.holder.parentNode)}function Y0(){this.freezeOverlays=!0,Np(this.clones,(t=>{Mw(t,"hide-tween")}))}function $0(){this.freezeOverlays=!1,Np(this.clones,(t=>{xw(t,"hide-tween"),Mw(t,"show-tween")})),this.hot._registerTimeout((()=>{Np(this.clones,(t=>{xw(t,"show-tween")}))}),400),Np(this.scrollbars,(t=>{t.refresh(),t.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function G0(t,e){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function K0(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const X0="trimRows";var q0=new WeakSet;class Z0 extends xN{constructor(){super(...arguments),G0(this,q0),K0(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return X0}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings()[X0]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new gx),this.trimmedRowsMap.addLocalHook("init",(()=>function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(q0,this,Q0).call(this))),super.enablePlugin())}updatePlugin(){const t=this.hot.getSettings()[X0];Array.isArray(t)&&this.hot.batchExecution((()=>{this.trimmedRowsMap.clear(),Np(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(t){const e=this.getTrimmedRows(),n=this.isValidConfig(t);let i=e;n&&(i=Array.from(new Set(e.concat(t))));!1!==this.hot.runHooks("beforeTrimRow",e,i,n)&&(n&&this.hot.batchExecution((()=>{Np(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0),this.hot.runHooks("afterTrimRow",e,i,n,n&&i.length>e.length))}trimRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.trimRows(e)}untrimRows(t){const e=this.getTrimmedRows(),n=this.isValidConfig(t);let i=e;const o=this.trimmedRowsMap.getValues().slice(),r=t.length>0;n&&r&&(Np(t,(t=>{o[t]=!1})),i=Ap(o,((t,e,n)=>(e&&t.push(n),t)),[]));!1!==this.hot.runHooks("beforeUntrimRow",e,i,n&&r)&&(n&&r&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",e,i,n&&r,n&&i.length<e.length))}untrimRow(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.untrimRows(e)}isTrimmed(t){return this.trimmedRowsMap.getValueAtIndex(t)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(t){const e=this.hot.countSourceRows();return t.every((t=>Number.isInteger(t)&&t>=0&&t<e))}destroy(){super.destroy()}}function Q0(){const t=this.hot.getSettings()[X0];Array.isArray(t)&&this.hot.batchExecution((()=>{Np(t,(t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)}))}),!0)}var J0=rc,t1=Yl;yo({target:"Object",stat:!0},{fromEntries:function(t){var e={};return J0(t,(function(t,n){t1(e,t,n)}),{AS_ENTRIES:!0}),e}});const e1="undoRedo";function n1(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",(function(n,i){const o=n&&n.length;if(!o)return;if(!n.find((t=>{const[,,e,n]=t;return e!==n})))return;e.done((()=>{const e=n.reduce(((t,e)=>(t.push([...e]),t)),[]);Np(e,(e=>{e[1]=t.propToCol(e[1])}));const i=o>1?this.getSelected():[[e[0][0],e[0][1]]];return new n1.ChangeAction(e,i)}),i)})),t.addHook("afterCreateRow",((t,n,i)=>{e.done((()=>new n1.CreateRowAction(t,n)),i)}));const n=(e,n,i,o)=>{const r=["visualRow","visualCol","row","col","prop"],s=r.length,l=[];return VC(i,o,(i=>{VC(e,n,(e=>{const n=t.getCellMeta(e,i);if(Object.keys(n).length!==s){const t=Object.fromEntries(Object.entries(n).filter((t=>{let[e]=t;return!1===r.includes(e)})));l.push([n.visualRow,n.visualCol,t])}}))})),l};t.addHook("beforeRemoveRow",((i,o,r,s)=>{e.done((()=>{const r=t.toPhysicalRow(i),s=r+o-1,l=Uv(e.instance.getSourceData(r,0,r+o-1,e.instance.countSourceCols()-1));return new n1.RemoveRowAction(r,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),n(r,s,0,t.countCols()-1))}),s)})),t.addHook("afterCreateCol",((t,n,i)=>{e.done((()=>new n1.CreateColumnAction(t,n)),i)})),t.addHook("beforeRemoveCol",((i,o,r,s)=>{e.done((()=>{const r=e.instance.getSourceDataArray(),s=(e.instance.countCols()+i)%e.instance.countCols(),l=s+o-1,a=[],h=[],c=[];VC(r.length-1,(e=>{const n=[],i=r[e];VC(s,l,(e=>{n.push(i[t.toPhysicalColumn(e)])})),a.push(n)})),VC(o-1,(e=>{c.push(t.toPhysicalColumn(s+e))})),Array.isArray(t.getSettings().colHeaders)&&VC(o-1,(e=>{h.push(t.getSettings().colHeaders[t.toPhysicalColumn(s+e)]||null)}));const u=t.columnIndexMapper.getIndexesSequence(),d=t.rowIndexMapper.getIndexesSequence();return new n1.RemoveColumnAction(s,c,a,h,u,d,t.getSettings().fixedColumnsStart,n(0,t.countRows(),s,l))}),s)})),t.addHook("beforeCellAlignment",((t,n,i,o)=>{e.done((()=>new n1.CellAlignmentAction(t,n,i,o)))})),t.addHook("beforeFilter",((t,n)=>{e.done((()=>new n1.FiltersAction(t,n)))})),t.addHook("beforeRowMove",((t,n)=>{!1!==t&&e.done((()=>new n1.RowMoveAction(t,n)))})),t.addHook("beforeColumnMove",((t,n)=>{!1!==t&&e.done((()=>new n1.ColumnMoveAction(t,n)))})),t.addHook("beforeMergeCells",((n,i)=>{i||e.done((()=>new n1.MergeCellsAction(t,n)))})),t.addHook("afterUnmergeCells",((n,i)=>{i||e.done((()=>new n1.UnmergeCellsAction(t,n)))})),t.addHook("beforeColumnSort",((t,n,i)=>{i&&e.done((()=>new n1.ColumnSortAction(t,n)))})),t.addHook("afterInit",(()=>{e.init()}))}n1.prototype.done=function(t,e){if(this.ignoreNewActions)return;if("UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e)return;const n=this.doneActions.slice();if(!1===this.instance.runHooks("beforeUndoStackChange",n,e))return;const i=t(),o=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())},n1.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=Uv(e);if(!1===this.instance.runHooks("beforeUndo",n))return;this.ignoreNewActions=!0;const i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,(()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)})),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}},n1.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=Uv(e);if(!1===this.instance.runHooks("beforeRedo",n))return;this.ignoreNewActions=!0;const i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,(()=>{i.ignoreNewActions=!1,i.doneActions.push(e)})),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}},n1.prototype.isUndoAvailable=function(){return this.doneActions.length>0},n1.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},n1.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},n1.prototype.isEnabled=function(){return this.enabled},n1.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;var e;this.enabled=!0,(e=t).undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()},this.registerShortcuts(),t.addHook("afterChange",r1)},n1.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;var e;this.enabled=!1,delete(e=t).undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo,this.unregisterShortcuts(),t.removeHook("afterChange",r1)},n1.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},n1.Action=function(){},n1.Action.prototype.undo=function(){},n1.Action.prototype.redo=function(){},n1.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},jv(n1.ChangeAction,n1.Action),n1.ChangeAction.prototype.undo=function(t,e){const n=Uv(this.changes),i=t.countEmptyRows(!0),o=t.countEmptyCols(!0);for(let s=0,l=n.length;s<l;s++)n[s].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let s=0,l=n.length;s<l;s++){const[e,r]=n[s];t.getSettings().minSpareRows&&e+1+t.getSettings().minSpareRows===t.countRows()&&i===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(e+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&r+1+t.getSettings().minSpareCols===t.countCols()&&o===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(r+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const r=t.getSelectedLast();if(void 0!==r){const[e,i]=n[0],[o,s]=r,l=e>=t.getFirstFullyVisibleRow(),a=i>=t.getFirstFullyVisibleColumn();if(!1===(l&&a)&&!0===(o!==e||s!==i)){const n={row:e,col:i};!1===l&&(n.verticalSnap="top"),!1===a&&(n.horizontalSnap="start"),t.scrollViewportTo(n)}}t.selectCells(this.selected,!1,!1)},n1.ChangeAction.prototype.redo=function(t,e){const n=Uv(this.changes);for(let i=0,o=n.length;i<o;i++)n[i].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},n1.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},jv(n1.CreateRowAction,n1.Action),n1.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),i=t.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},n1.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},n1.RemoveRowAction=function(t,e,n,i,o,r){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=i,this.rowIndexesSequence=o,this.removedCellMetas=r},jv(n1.RemoveRowAction,n1.Action),n1.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(((t,e)=>{Object.keys(t).forEach((n=>{const o=parseInt(n,10);i.push([this.index+e,isNaN(o)?n:o,t[n]])}))})),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach((e=>{let[n,i,o]=e;t.setCellMetaObject(n,i,o)})),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},n1.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},n1.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},jv(n1.CreateColumnAction,n1.Action),n1.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},n1.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},n1.RemoveColumnAction=function(t,e,n,i,o,r,s,l){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=i,this.columnPositions=o.slice(0),this.rowPositions=r.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=l},jv(n1.RemoveColumnAction,n1.Action),n1.RemoveColumnAction.prototype.undo=function(t,e){t.getSettings().fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),i=(t,e,i)=>i[this.indexes.indexOf(n[e])],o=this.data.length,r=[];for(let a=0;a<o;a++)r.push(Pp(this.data[a],i));const s=Pp(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Np(t.getSourceDataArray(),((t,e)=>{Np(n,((n,i)=>{t[n]=r[e][i],l.push([e,n,t[n]])}))})),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),void 0!==this.headers&&Np(s,((e,i)=>{t.getSettings().colHeaders[n[i]]=e})),this.removedCellMetas.forEach((e=>{let[n,i,o]=e;t.setCellMetaObject(n,i,o)})),t.batchExecution((()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)}),!0),t.addHookOnce("afterViewRender",e),t.render()},n1.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},n1.CellAlignmentAction=function(t,e,n,i){this.stateBefore=t,this.range=e,this.type=n,this.alignment=i},n1.CellAlignmentAction.prototype.undo=function(t,e){Np(this.range,(e=>{e.forAll(((e,n)=>{e>=0&&n>=0&&t.setCellMeta(e,n,"className",this.stateBefore[e][n]||" htLeft")}))})),t.addHookOnce("afterViewRender",e),t.render()},n1.CellAlignmentAction.prototype.redo=function(t,e){xV(this.range,this.type,this.alignment,((e,n)=>t.getCellMeta(e,n)),((e,n,i,o)=>t.setCellMeta(e,n,i,o))),t.addHookOnce("afterViewRender",e),t.render()},n1.FiltersAction=function(t,e){this.previousConditionsStack=e,this.conditionsStack=t,this.actionType="filter"},jv(n1.FiltersAction,n1.Action),n1.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),this.previousConditionsStack&&n.conditionCollection.importAllConditions(this.previousConditionsStack),n.filter()},n1.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class i1 extends n1.Action{constructor(t,e){super(),this.cellRange=e;const n=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=t.getData(n.row,n.col,i.row,i.col)}undo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();t.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.mergeRange(this.cellRange)}}n1.MergeCellsAction=i1;class o1 extends n1.Action{constructor(t,e){super(),this.cellRange=e}undo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.mergeRange(this.cellRange,!0)}redo(t,e){const n=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),n.unmergeRange(this.cellRange,!0),t.render()}}function r1(t,e){if("loadData"===e)return this.undoRedo.clear()}n1.UnmergeCellsAction=o1,n1.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalRowIndex=e,this.actionType="row_move"},jv(n1.RowMoveAction,n1.Action),n1.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e);AY(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes()).reverse().forEach((t=>{let{from:e,to:i}=t;e<i&&(i-=1),n.moveRow(i,e)})),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},n1.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)},n1.ColumnMoveAction=function(t,e){this.columns=t.slice(),this.finalColumnIndex=e,this.actionType="col_move"},jv(n1.ColumnMoveAction,n1.Action),n1.ColumnMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e);AY(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes()).reverse().forEach((t=>{let{from:e,to:i}=t;e<i&&(i-=1),n.moveColumn(i,e)})),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)},n1.ColumnMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),n.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)},n1.ColumnSortAction=function(t,e){this.previousSortState=t,this.nextSortState=e},jv(n1.ColumnSortAction,n1.Action),n1.ColumnSortAction.prototype.undo=function(t,e){const n=t.getPlugin("columnSorting"),i=t.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:n;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),e()},n1.ColumnSortAction.prototype.redo=function(t,e){const n=t.getPlugin("columnSorting"),i=t.getPlugin("multiColumnSorting");(i.isEnabled()?i:n).sort(this.nextSortState),e()},n1.prototype.init=function(){const t=this.instance.getSettings().undo,e=void 0===t||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},n1.prototype.registerShortcuts=function(){const t=this.instance.getShortcutManager().getContext("grid"),e={runOnlyIf:t=>!t.altKey,group:e1};t.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],e)},n1.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(e1)};const s1=lb.getSingleton();s1.add("afterUpdateSettings",(function(){var t;null===(t=this.getPlugin("undoRedo"))||void 0===t||t.init()})),s1.register("beforeUndo"),s1.register("afterUndo"),s1.register("beforeRedo"),s1.register("afterRedo"),n1.PLUGIN_KEY="undoRedo",n1.SETTING_KEYS=!0,bb(CO),bb(o_),bb(r_),bb(N_),bb(D_),bb(JA),bb(L_),bb(F_),bb(B_),bb(JO),bb(z_),aS(Y_),aS(tA),aS(J_),aS($_),aS(eP),aS(U_),aS(qP),aS(ZP),aS(QP),aS(eA),aS(JP),fS(tN),fS(iN),fS(nN),fS(oN),fS(sN),BI(lN),BI(aN),BI(cN),BI(uN),BI(dN),BI(gN),BI(fN),BI(mN),BI(nA),BI(pN),eS(UN),eS(rD),eS(vD),eS(DD),eS(qD),eS(NL),eS(KL),eS(gF),eS(vW),eS(rj),eS(Aj),eS(Wj),eS(Zj),eS(vB),eS(sY),eS(p$),eS(K$),eS(aG),eS(SG),eS(QG),eS(kK),eS(lX),eS(VX),eS(eZ),eS(NZ),eS(LZ),eS(DQ),eS(MJ),eS(GJ),eS(e0),eS(D0),eS(z0),eS(Z0),eS(n1),Mk(ZA);const l1={[m.ZH]:"zh-CN",[m.EN]:"en-US"},a1=()=>{},h1=[["","Tesla","Volvo","Toyota","Ford"],["2019",10,11,12,13],["2020",20,11,14,13],["2021",30,15,12,13]],c1=()=>{const t=p((t=>t.app.language)),[e,n]=d.useState(l1[t]||"zh-CN");return d.useEffect((()=>{n(l1[t]||"zh-CN")}),[t]),w.jsx(v,{children:w.jsxs("div",{className:KA,children:[w.jsx("div",{className:XA,children:w.jsxs(y,{align:"middle",gutter:8,children:[w.jsx(b,{children:w.jsx(C,{onClick:a1,children:"å¯¼å¥Excel"})}),w.jsx(b,{children:w.jsx(C,{onClick:a1,children:"å¯¼åºExcel"})})]})}),w.jsx("div",{className:qA,children:w.jsx(GA,{data:h1,rowHeaders:!0,colHeaders:!0,height:"100%",width:"100%",autoWrapRow:!0,autoWrapCol:!0,dropdownMenu:!0,language:e,contextMenu:!0,minSpareRows:50,minSpareCols:30,colWidths:100,rowHeights:30,autoRowSize:!0,licenseKey:"non-commercial-and-evaluation"})})]})})};export{c1 as default};
