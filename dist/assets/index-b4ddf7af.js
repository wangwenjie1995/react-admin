var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=(t,r,o)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o,l=(e,t)=>{for(var r in t||(t={}))n.call(t,r)&&s(e,r,t[r]);if(o)for(var r of o(t))i.call(t,r)&&s(e,r,t[r]);return e},a=(e,o)=>t(e,r(o)),c=(e,t)=>{var r={};for(var s in e)n.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&o)for(var s of o(e))t.indexOf(s)<0&&i.call(e,s)&&(r[s]=e[s]);return r};import{Q as h,r as u,n as d,V as f,j as g,P as m,R as p,C as w,B as y}from"./index-d2d7b15f.js";var v=function(e){return e&&e.Math===Math&&e},b=v("object"==typeof globalThis&&globalThis)||v("object"==typeof window&&window)||v("object"==typeof self&&self)||v("object"==typeof h&&h)||v("object"==typeof h&&h)||function(){return this}()||Function("return this")(),C={},S=function(e){try{return!!e()}catch(t){return!0}},R=!S((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),T=!S((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),E=T,O=Function.prototype.call,M=E?O.bind(O):function(){return O.apply(O,arguments)},H={},x={}.propertyIsEnumerable,_=Object.getOwnPropertyDescriptor,N=_&&!x.call({1:2},1);H.f=N?function(e){var t=_(this,e);return!!t&&t.enumerable}:x;var I,A,k=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},D=T,P=Function.prototype,L=P.call,V=D&&P.bind.bind(L,L),F=D?V:function(e){return function(){return L.apply(e,arguments)}},W=F,B=W({}.toString),j=W("".slice),z=function(e){return j(B(e),8,-1)},U=S,Y=z,$=Object,G=F("".split),X=U((function(){return!$("z").propertyIsEnumerable(0)}))?function(e){return"String"===Y(e)?G(e,""):$(e)}:$,q=function(e){return null==e},K=q,Z=TypeError,Q=function(e){if(K(e))throw new Z("Can't call method on "+e);return e},J=X,ee=Q,te=function(e){return J(ee(e))},re="object"==typeof document&&document.all,oe=void 0===re&&void 0!==re?function(e){return"function"==typeof e||e===re}:function(e){return"function"==typeof e},ne=oe,ie=function(e){return"object"==typeof e?null!==e:ne(e)},se=b,le=oe,ae=function(e,t){return arguments.length<2?(r=se[e],le(r)?r:void 0):se[e]&&se[e][t];var r},ce=F({}.isPrototypeOf),he=b.navigator,ue=he&&he.userAgent,de=ue?String(ue):"",fe=b,ge=de,me=fe.process,pe=fe.Deno,we=me&&me.versions||pe&&pe.version,ye=we&&we.v8;ye&&(A=(I=ye.split("."))[0]>0&&I[0]<4?1:+(I[0]+I[1])),!A&&ge&&(!(I=ge.match(/Edge\/(\d+)/))||I[1]>=74)&&(I=ge.match(/Chrome\/(\d+)/))&&(A=+I[1]);var ve=A,be=S,Ce=b.String,Se=!!Object.getOwnPropertySymbols&&!be((function(){var e=Symbol("symbol detection");return!Ce(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&ve&&ve<41})),Re=Se&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Te=ae,Ee=oe,Oe=ce,Me=Object,He=Re?function(e){return"symbol"==typeof e}:function(e){var t=Te("Symbol");return Ee(t)&&Oe(t.prototype,Me(e))},xe=String,_e=function(e){try{return xe(e)}catch(t){return"Object"}},Ne=oe,Ie=_e,Ae=TypeError,ke=function(e){if(Ne(e))return e;throw new Ae(Ie(e)+" is not a function")},De=ke,Pe=q,Le=function(e,t){var r=e[t];return Pe(r)?void 0:De(r)},Ve=M,Fe=oe,We=ie,Be=TypeError,je={exports:{}},ze=b,Ue=Object.defineProperty,Ye=function(e,t){try{Ue(ze,e,{value:t,configurable:!0,writable:!0})}catch(r){ze[e]=t}return t},$e=b,Ge=Ye,Xe="__core-js_shared__",qe=je.exports=$e[Xe]||Ge(Xe,{});(qe.versions||(qe.versions=[])).push({version:"3.39.0",mode:"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Ke=je.exports,Ze=Ke,Qe=function(e,t){return Ze[e]||(Ze[e]=t||{})},Je=Q,et=Object,tt=function(e){return et(Je(e))},rt=tt,ot=F({}.hasOwnProperty),nt=Object.hasOwn||function(e,t){return ot(rt(e),t)},it=F,st=0,lt=Math.random(),at=it(1..toString),ct=function(e){return"Symbol("+(void 0===e?"":e)+")_"+at(++st+lt,36)},ht=Qe,ut=nt,dt=ct,ft=Se,gt=Re,mt=b.Symbol,pt=ht("wks"),wt=gt?mt.for||mt:mt&&mt.withoutSetter||dt,yt=function(e){return ut(pt,e)||(pt[e]=ft&&ut(mt,e)?mt[e]:wt("Symbol."+e)),pt[e]},vt=M,bt=ie,Ct=He,St=Le,Rt=function(e,t){var r,o;if("string"===t&&Fe(r=e.toString)&&!We(o=Ve(r,e)))return o;if(Fe(r=e.valueOf)&&!We(o=Ve(r,e)))return o;if("string"!==t&&Fe(r=e.toString)&&!We(o=Ve(r,e)))return o;throw new Be("Can't convert object to primitive value")},Tt=TypeError,Et=yt("toPrimitive"),Ot=function(e,t){if(!bt(e)||Ct(e))return e;var r,o=St(e,Et);if(o){if(void 0===t&&(t="default"),r=vt(o,e,t),!bt(r)||Ct(r))return r;throw new Tt("Can't convert object to primitive value")}return void 0===t&&(t="number"),Rt(e,t)},Mt=He,Ht=function(e){var t=Ot(e,"string");return Mt(t)?t:t+""},xt=ie,_t=b.document,Nt=xt(_t)&&xt(_t.createElement),It=function(e){return Nt?_t.createElement(e):{}},At=It,kt=!R&&!S((function(){return 7!==Object.defineProperty(At("div"),"a",{get:function(){return 7}}).a})),Dt=R,Pt=M,Lt=H,Vt=k,Ft=te,Wt=Ht,Bt=nt,jt=kt,zt=Object.getOwnPropertyDescriptor;C.f=Dt?zt:function(e,t){if(e=Ft(e),t=Wt(t),jt)try{return zt(e,t)}catch(r){}if(Bt(e,t))return Vt(!Pt(Lt.f,e,t),e[t])};var Ut={},Yt=R&&S((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),$t=ie,Gt=String,Xt=TypeError,qt=function(e){if($t(e))return e;throw new Xt(Gt(e)+" is not an object")},Kt=R,Zt=kt,Qt=Yt,Jt=qt,er=Ht,tr=TypeError,rr=Object.defineProperty,or=Object.getOwnPropertyDescriptor,nr="enumerable",ir="configurable",sr="writable";Ut.f=Kt?Qt?function(e,t,r){if(Jt(e),t=er(t),Jt(r),"function"==typeof e&&"prototype"===t&&"value"in r&&sr in r&&!r[sr]){var o=or(e,t);o&&o[sr]&&(e[t]=r.value,r={configurable:ir in r?r[ir]:o[ir],enumerable:nr in r?r[nr]:o[nr],writable:!1})}return rr(e,t,r)}:rr:function(e,t,r){if(Jt(e),t=er(t),Jt(r),Zt)try{return rr(e,t,r)}catch(o){}if("get"in r||"set"in r)throw new tr("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var lr=Ut,ar=k,cr=R?function(e,t,r){return lr.f(e,t,ar(1,r))}:function(e,t,r){return e[t]=r,e},hr={exports:{}},ur=R,dr=nt,fr=Function.prototype,gr=ur&&Object.getOwnPropertyDescriptor,mr=dr(fr,"name"),pr={EXISTS:mr,PROPER:mr&&"something"===function(){}.name,CONFIGURABLE:mr&&(!ur||ur&&gr(fr,"name").configurable)},wr=oe,yr=Ke,vr=F(Function.toString);wr(yr.inspectSource)||(yr.inspectSource=function(e){return vr(e)});var br,Cr,Sr,Rr=yr.inspectSource,Tr=oe,Er=b.WeakMap,Or=Tr(Er)&&/native code/.test(String(Er)),Mr=ct,Hr=Qe("keys"),xr=function(e){return Hr[e]||(Hr[e]=Mr(e))},_r={},Nr=Or,Ir=b,Ar=ie,kr=cr,Dr=nt,Pr=Ke,Lr=xr,Vr=_r,Fr="Object already initialized",Wr=Ir.TypeError,Br=Ir.WeakMap;if(Nr||Pr.state){var jr=Pr.state||(Pr.state=new Br);jr.get=jr.get,jr.has=jr.has,jr.set=jr.set,br=function(e,t){if(jr.has(e))throw new Wr(Fr);return t.facade=e,jr.set(e,t),t},Cr=function(e){return jr.get(e)||{}},Sr=function(e){return jr.has(e)}}else{var zr=Lr("state");Vr[zr]=!0,br=function(e,t){if(Dr(e,zr))throw new Wr(Fr);return t.facade=e,kr(e,zr,t),t},Cr=function(e){return Dr(e,zr)?e[zr]:{}},Sr=function(e){return Dr(e,zr)}}var Ur={set:br,get:Cr,has:Sr,enforce:function(e){return Sr(e)?Cr(e):br(e,{})},getterFor:function(e){return function(t){var r;if(!Ar(t)||(r=Cr(t)).type!==e)throw new Wr("Incompatible receiver, "+e+" required");return r}}},Yr=F,$r=S,Gr=oe,Xr=nt,qr=R,Kr=pr.CONFIGURABLE,Zr=Rr,Qr=Ur.enforce,Jr=Ur.get,eo=String,to=Object.defineProperty,ro=Yr("".slice),oo=Yr("".replace),no=Yr([].join),io=qr&&!$r((function(){return 8!==to((function(){}),"length",{value:8}).length})),so=String(String).split("String"),lo=hr.exports=function(e,t,r){"Symbol("===ro(eo(t),0,7)&&(t="["+oo(eo(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Xr(e,"name")||Kr&&e.name!==t)&&(qr?to(e,"name",{value:t,configurable:!0}):e.name=t),io&&r&&Xr(r,"arity")&&e.length!==r.arity&&to(e,"length",{value:r.arity});try{r&&Xr(r,"constructor")&&r.constructor?qr&&to(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(n){}var o=Qr(e);return Xr(o,"source")||(o.source=no(so,"string"==typeof t?t:"")),e};Function.prototype.toString=lo((function(){return Gr(this)&&Jr(this).source||Zr(this)}),"toString");var ao=hr.exports,co=oe,ho=Ut,uo=ao,fo=Ye,go=function(e,t,r,o){o||(o={});var n=o.enumerable,i=void 0!==o.name?o.name:t;if(co(r)&&uo(r,i,o),o.global)n?e[t]=r:fo(t,r);else{try{o.unsafe?e[t]&&(n=!0):delete e[t]}catch(s){}n?e[t]=r:ho.f(e,t,{value:r,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return e},mo={},po=Math.ceil,wo=Math.floor,yo=Math.trunc||function(e){var t=+e;return(t>0?wo:po)(t)},vo=function(e){var t=+e;return t!=t||0===t?0:yo(t)},bo=vo,Co=Math.max,So=Math.min,Ro=vo,To=Math.min,Eo=function(e){var t=Ro(e);return t>0?To(t,9007199254740991):0},Oo=function(e){return Eo(e.length)},Mo=te,Ho=function(e,t){var r=bo(e);return r<0?Co(r+t,0):So(r,t)},xo=Oo,_o=function(e){return function(t,r,o){var n=Mo(t),i=xo(n);if(0===i)return!e&&-1;var s,l=Ho(o,i);if(e&&r!=r){for(;i>l;)if((s=n[l++])!=s)return!0}else for(;i>l;l++)if((e||l in n)&&n[l]===r)return e||l||0;return!e&&-1}},No={includes:_o(!0),indexOf:_o(!1)},Io=nt,Ao=te,ko=No.indexOf,Do=_r,Po=F([].push),Lo=function(e,t){var r,o=Ao(e),n=0,i=[];for(r in o)!Io(Do,r)&&Io(o,r)&&Po(i,r);for(;t.length>n;)Io(o,r=t[n++])&&(~ko(i,r)||Po(i,r));return i},Vo=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Fo=Lo,Wo=Vo.concat("length","prototype");mo.f=Object.getOwnPropertyNames||function(e){return Fo(e,Wo)};var Bo={};Bo.f=Object.getOwnPropertySymbols;var jo=ae,zo=mo,Uo=Bo,Yo=qt,$o=F([].concat),Go=jo("Reflect","ownKeys")||function(e){var t=zo.f(Yo(e)),r=Uo.f;return r?$o(t,r(e)):t},Xo=nt,qo=Go,Ko=C,Zo=Ut,Qo=function(e,t,r){for(var o=qo(t),n=Zo.f,i=Ko.f,s=0;s<o.length;s++){var l=o[s];Xo(e,l)||r&&Xo(r,l)||n(e,l,i(t,l))}},Jo=S,en=oe,tn=/#|\.prototype\./,rn=function(e,t){var r=nn[on(e)];return r===ln||r!==sn&&(en(t)?Jo(t):!!t)},on=rn.normalize=function(e){return String(e).replace(tn,".").toLowerCase()},nn=rn.data={},sn=rn.NATIVE="N",ln=rn.POLYFILL="P",an=rn,cn=b,hn=C.f,un=cr,dn=go,fn=Ye,gn=Qo,mn=an,pn=function(e,t){var r,o,n,i,s,l=e.target,a=e.global,c=e.stat;if(r=a?cn:c?cn[l]||fn(l,{}):cn[l]&&cn[l].prototype)for(o in t){if(i=t[o],n=e.dontCallGetSet?(s=hn(r,o))&&s.value:r[o],!mn(a?o:l+(c?".":"#")+o,e.forced)&&void 0!==n){if(typeof i==typeof n)continue;gn(i,n)}(e.sham||n&&n.sham)&&un(i,"sham",!0),dn(r,o,i,e)}},wn=T,yn=Function.prototype,vn=yn.apply,bn=yn.call,Cn="object"==typeof Reflect&&Reflect.apply||(wn?bn.bind(vn):function(){return bn.apply(vn,arguments)}),Sn=F,Rn=ke,Tn=function(e,t,r){try{return Sn(Rn(Object.getOwnPropertyDescriptor(e,t)[r]))}catch(o){}},En=ie,On=function(e){return En(e)||null===e},Mn=String,Hn=TypeError,xn=Tn,_n=ie,Nn=Q,In=function(e){if(On(e))return e;throw new Hn("Can't set "+Mn(e)+" as a prototype")},An=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=xn(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch(o){}return function(r,o){return Nn(r),In(o),_n(r)?(t?e(r,o):r.__proto__=o,r):r}}():void 0),kn=Ut.f,Dn=oe,Pn=ie,Ln=An,Vn={};Vn[yt("toStringTag")]="z";var Fn="[object z]"===String(Vn),Wn=oe,Bn=z,jn=yt("toStringTag"),zn=Object,Un="Arguments"===Bn(function(){return arguments}()),Yn=Fn?Bn:function(e){var t,r,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(r){}}(t=zn(e),jn))?r:Un?Bn(t):"Object"===(o=Bn(t))&&Wn(t.callee)?"Arguments":o},$n=Yn,Gn=String,Xn=function(e){if("Symbol"===$n(e))throw new TypeError("Cannot convert a Symbol value to a string");return Gn(e)},qn=Xn,Kn=ie,Zn=cr,Qn=Error,Jn=F("".replace),ei=String(new Qn("zxcasd").stack),ti=/\n\s*at [^:]*:[^\n]*/,ri=ti.test(ei),oi=k,ni=!S((function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",oi(1,7)),7!==e.stack)})),ii=cr,si=function(e,t){if(ri&&"string"==typeof e&&!Qn.prepareStackTrace)for(;t--;)e=Jn(e,ti,"");return e},li=ni,ai=Error.captureStackTrace,ci=ae,hi=nt,ui=cr,di=ce,fi=An,gi=Qo,mi=function(e,t,r){r in e||kn(e,r,{configurable:!0,get:function(){return t[r]},set:function(e){t[r]=e}})},pi=function(e,t,r){var o,n;return Ln&&Dn(o=t.constructor)&&o!==r&&Pn(n=o.prototype)&&n!==r.prototype&&Ln(e,n),e},wi=function(e,t){return void 0===e?arguments.length<2?"":t:qn(e)},yi=function(e,t){Kn(t)&&"cause"in t&&Zn(e,"cause",t.cause)},vi=function(e,t,r,o){li&&(ai?ai(e,t):ii(e,"stack",si(r,o)))},bi=R,Ci=pn,Si=Cn,Ri=function(e,t,r,o){var n="stackTraceLimit",i=o?2:1,s=e.split("."),l=s[s.length-1],a=ci.apply(null,s);if(a){var c=a.prototype;if(hi(c,"cause")&&delete c.cause,!r)return a;var h=ci("Error"),u=t((function(e,t){var r=wi(o?t:e,void 0),n=o?new a(e):new a;return void 0!==r&&ui(n,"message",r),vi(n,u,n.stack,2),this&&di(c,this)&&pi(n,this,u),arguments.length>i&&yi(n,arguments[i]),n}));u.prototype=c,"Error"!==l?fi?fi(u,h):gi(u,h,{name:!0}):bi&&n in a&&(mi(u,a,n),mi(u,a,"prepareStackTrace")),gi(u,a);try{c.name!==l&&ui(c,"name",l),c.constructor=u}catch(d){}return u}},Ti="WebAssembly",Ei=b[Ti],Oi=7!==new Error("e",{cause:7}).cause,Mi=function(e,t){var r={};r[e]=Ri(e,t,Oi),Ci({global:!0,constructor:!0,arity:1,forced:Oi},r)},Hi=function(e,t){if(Ei&&Ei[e]){var r={};r[e]=Ri(Ti+"."+e,t,Oi),Ci({target:Ti,stat:!0,constructor:!0,arity:1,forced:Oi},r)}};Mi("Error",(function(e){return function(t){return Si(e,this,arguments)}})),Mi("EvalError",(function(e){return function(t){return Si(e,this,arguments)}})),Mi("RangeError",(function(e){return function(t){return Si(e,this,arguments)}})),Mi("ReferenceError",(function(e){return function(t){return Si(e,this,arguments)}})),Mi("SyntaxError",(function(e){return function(t){return Si(e,this,arguments)}})),Mi("TypeError",(function(e){return function(t){return Si(e,this,arguments)}})),Mi("URIError",(function(e){return function(t){return Si(e,this,arguments)}})),Hi("CompileError",(function(e){return function(t){return Si(e,this,arguments)}})),Hi("LinkError",(function(e){return function(t){return Si(e,this,arguments)}})),Hi("RuntimeError",(function(e){return function(t){return Si(e,this,arguments)}}));var xi=z,_i=Array.isArray||function(e){return"Array"===xi(e)},Ni=R,Ii=_i,Ai=TypeError,ki=Object.getOwnPropertyDescriptor,Di=Ni&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),Pi=TypeError,Li=tt,Vi=Oo,Fi=Di?function(e,t){if(Ii(e)&&!ki(e,"length").writable)throw new Ai("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},Wi=function(e){if(e>9007199254740991)throw Pi("Maximum allowed index exceeded");return e};pn({target:"Array",proto:!0,arity:1,forced:S((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}()},{push:function(e){var t=Li(this),r=Vi(t),o=arguments.length;Wi(r+o);for(var n=0;n<o;n++)t[r]=arguments[n],r++;return Fi(t,r),r}});var Bi=F,ji=Set.prototype,zi={Set:Set,add:Bi(ji.add),has:Bi(ji.has),remove:Bi(ji.delete),proto:ji},Ui=zi.has,Yi=function(e){return Ui(e),e},$i=M,Gi=function(e,t,r){for(var o,n,i=r?e:e.iterator,s=e.next;!(o=$i(s,i)).done;)if(void 0!==(n=t(o.value)))return n},Xi=F,qi=Gi,Ki=zi.Set,Zi=zi.proto,Qi=Xi(Zi.forEach),Ji=Xi(Zi.keys),es=Ji(new Ki).next,ts=function(e,t,r){return r?qi({iterator:Ji(e),next:es},t):Qi(e,t)},rs=ts,os=zi.Set,ns=zi.add,is=function(e){var t=new os;return rs(e,(function(e){ns(t,e)})),t},ss=Tn(zi.proto,"size","get")||function(e){return e.size},ls=function(e){return{iterator:e,next:e.next,done:!1}},as=ke,cs=qt,hs=M,us=vo,ds=ls,fs="Invalid size",gs=RangeError,ms=TypeError,ps=Math.max,ws=function(e,t){this.set=e,this.size=ps(t,0),this.has=as(e.has),this.keys=as(e.keys)};ws.prototype={getIterator:function(){return ds(cs(hs(this.keys,this.set)))},includes:function(e){return hs(this.has,this.set,e)}};var ys=function(e){cs(e);var t=+e.size;if(t!=t)throw new ms(fs);var r=us(t);if(r<0)throw new gs(fs);return new ws(e,r)},vs=Yi,bs=is,Cs=ss,Ss=ys,Rs=ts,Ts=Gi,Es=zi.has,Os=zi.remove,Ms=ae,Hs=function(e){return{size:e,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},xs=function(e){var t=Ms("Set");try{(new t)[e](Hs(0));try{return(new t)[e](Hs(-1)),!1}catch(r){return!0}}catch(r){return!1}},_s=function(e){var t=vs(this),r=Ss(e),o=bs(t);return Cs(t)<=r.size?Rs(t,(function(e){r.includes(e)&&Os(o,e)})):Ts(r.getIterator(),(function(e){Es(t,e)&&Os(o,e)})),o};pn({target:"Set",proto:!0,real:!0,forced:!xs("difference")},{difference:_s});var Ns=Yi,Is=ss,As=ys,ks=ts,Ds=Gi,Ps=zi.Set,Ls=zi.add,Vs=zi.has,Fs=S,Ws=function(e){var t=Ns(this),r=As(e),o=new Ps;return Is(t)>r.size?Ds(r.getIterator(),(function(e){Vs(t,e)&&Ls(o,e)})):ks(t,(function(e){r.includes(e)&&Ls(o,e)})),o};pn({target:"Set",proto:!0,real:!0,forced:!xs("intersection")||Fs((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}))},{intersection:Ws});var Bs=M,js=qt,zs=Le,Us=function(e,t,r){var o,n;js(e);try{if(!(o=zs(e,"return"))){if("throw"===t)throw r;return r}o=Bs(o,e)}catch(i){n=!0,o=i}if("throw"===t)throw r;if(n)throw o;return js(o),r},Ys=Yi,$s=zi.has,Gs=ss,Xs=ys,qs=ts,Ks=Gi,Zs=Us,Qs=function(e){var t=Ys(this),r=Xs(e);if(Gs(t)<=r.size)return!1!==qs(t,(function(e){if(r.includes(e))return!1}),!0);var o=r.getIterator();return!1!==Ks(o,(function(e){if($s(t,e))return Zs(o,"normal",!1)}))};pn({target:"Set",proto:!0,real:!0,forced:!xs("isDisjointFrom")},{isDisjointFrom:Qs});var Js=Yi,el=ss,tl=ts,rl=ys,ol=function(e){var t=Js(this),r=rl(e);return!(el(t)>r.size)&&!1!==tl(t,(function(e){if(!r.includes(e))return!1}),!0)};pn({target:"Set",proto:!0,real:!0,forced:!xs("isSubsetOf")},{isSubsetOf:ol});var nl=Yi,il=zi.has,sl=ss,ll=ys,al=Gi,cl=Us,hl=function(e){var t=nl(this),r=ll(e);if(sl(t)<r.size)return!1;var o=r.getIterator();return!1!==al(o,(function(e){if(!il(t,e))return cl(o,"normal",!1)}))};pn({target:"Set",proto:!0,real:!0,forced:!xs("isSupersetOf")},{isSupersetOf:hl});var ul=Yi,dl=is,fl=ys,gl=Gi,ml=zi.add,pl=zi.has,wl=zi.remove,yl=function(e){var t=ul(this),r=fl(e).getIterator(),o=dl(t);return gl(r,(function(e){pl(t,e)?wl(o,e):ml(o,e)})),o};pn({target:"Set",proto:!0,real:!0,forced:!xs("symmetricDifference")},{symmetricDifference:yl});var vl=Yi,bl=zi.add,Cl=is,Sl=ys,Rl=Gi,Tl=function(e){var t=vl(this),r=Sl(e).getIterator(),o=Cl(t);return Rl(r,(function(e){bl(o,e)})),o};pn({target:"Set",proto:!0,real:!0,forced:!xs("union")},{union:Tl});var El=ce,Ol=TypeError,Ml=!S((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Hl=nt,xl=oe,_l=tt,Nl=Ml,Il=xr("IE_PROTO"),Al=Object,kl=Al.prototype,Dl=Nl?Al.getPrototypeOf:function(e){var t=_l(e);if(Hl(t,Il))return t[Il];var r=t.constructor;return xl(r)&&t instanceof r?r.prototype:t instanceof Al?kl:null},Pl=ao,Ll=Ut,Vl=R,Fl=Ut,Wl=k,Bl={},jl=Lo,zl=Vo,Ul=Object.keys||function(e){return jl(e,zl)},Yl=R,$l=Yt,Gl=Ut,Xl=qt,ql=te,Kl=Ul;Bl.f=Yl&&!$l?Object.defineProperties:function(e,t){Xl(e);for(var r,o=ql(t),n=Kl(t),i=n.length,s=0;i>s;)Gl.f(e,r=n[s++],o[r]);return e};var Zl,Ql=ae("document","documentElement"),Jl=qt,ea=Bl,ta=Vo,ra=_r,oa=Ql,na=It,ia="prototype",sa="script",la=xr("IE_PROTO"),aa=function(){},ca=function(e){return"<"+sa+">"+e+"</"+sa+">"},ha=function(e){e.write(ca("")),e.close();var t=e.parentWindow.Object;return e=null,t},ua=function(){try{Zl=new ActiveXObject("htmlfile")}catch(n){}var e,t,r;ua="undefined"!=typeof document?document.domain&&Zl?ha(Zl):(t=na("iframe"),r="java"+sa+":",t.style.display="none",oa.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(ca("document.F=Object")),e.close(),e.F):ha(Zl);for(var o=ta.length;o--;)delete ua[ia][ta[o]];return ua()};ra[la]=!0;var da,fa,ga,ma=Object.create||function(e,t){var r;return null!==e?(aa[ia]=Jl(e),r=new aa,aa[ia]=null,r[la]=e):r=ua(),void 0===t?r:ea.f(r,t)},pa=S,wa=oe,ya=ie,va=Dl,ba=go,Ca=yt("iterator"),Sa=!1;[].keys&&("next"in(ga=[].keys())?(fa=va(va(ga)))!==Object.prototype&&(da=fa):Sa=!0),(!ya(da)||pa((function(){var e={};return da[Ca].call(e)!==e})))&&(da={}),wa(da[Ca])||ba(da,Ca,(function(){return this}));var Ra={IteratorPrototype:da,BUGGY_SAFARI_ITERATORS:Sa},Ta=pn,Ea=b,Oa=function(e,t){if(El(t,e))return e;throw new Ol("Incorrect invocation")},Ma=qt,Ha=oe,xa=Dl,_a=function(e,t,r){return r.get&&Pl(r.get,t,{getter:!0}),r.set&&Pl(r.set,t,{setter:!0}),Ll.f(e,t,r)},Na=function(e,t,r){Vl?Fl.f(e,t,Wl(0,r)):e[t]=r},Ia=S,Aa=nt,ka=Ra.IteratorPrototype,Da=R,Pa="constructor",La="Iterator",Va=yt("toStringTag"),Fa=TypeError,Wa=Ea[La],Ba=!Ha(Wa)||Wa.prototype!==ka||!Ia((function(){Wa({})})),ja=function(){if(Oa(this,ka),xa(this)===ka)throw new Fa("Abstract class Iterator not directly constructable")},za=function(e,t){Da?_a(ka,e,{configurable:!0,get:function(){return t},set:function(t){if(Ma(this),this===ka)throw new Fa("You can't redefine this property");Aa(this,e)?this[e]=t:Na(this,e,t)}}):ka[e]=t};Aa(ka,Va)||za(Va,La),!Ba&&Aa(ka,Pa)&&ka[Pa]!==Object||za(Pa,ja),ja.prototype=ka,Ta({global:!0,constructor:!0,forced:Ba},{Iterator:ja});var Ua=go,Ya=M,$a=ma,Ga=cr,Xa=function(e,t,r){for(var o in t)Ua(e,o,t[o],r);return e},qa=Ur,Ka=Le,Za=Ra.IteratorPrototype,Qa=function(e,t){return{value:e,done:t}},Ja=Us,ec=yt("toStringTag"),tc="IteratorHelper",rc="WrapForValidIterator",oc=qa.set,nc=function(e){var t=qa.getterFor(e?rc:tc);return Xa($a(Za),{next:function(){var r=t(this);if(e)return r.nextHandler();try{var o=r.done?void 0:r.nextHandler();return Qa(o,r.done)}catch(n){throw r.done=!0,n}},return:function(){var r=t(this),o=r.iterator;if(r.done=!0,e){var n=Ka(o,"return");return n?Ya(n,o):Qa(void 0,!0)}if(r.inner)try{Ja(r.inner.iterator,"normal")}catch(i){return Ja(o,"throw",i)}return o&&Ja(o,"normal"),Qa(void 0,!0)}})},ic=nc(!0),sc=nc(!1);Ga(sc,ec,"Iterator Helper");var lc=function(e,t){var r=function(r,o){o?(o.iterator=r.iterator,o.next=r.next):o=r,o.type=t?rc:tc,o.nextHandler=e,o.counter=0,o.done=!1,oc(this,o)};return r.prototype=t?ic:sc,r},ac=qt,cc=Us,hc=function(e,t,r,o){try{return o?t(ac(r)[0],r[1]):t(r)}catch(n){cc(e,"throw",n)}},uc=pn,dc=M,fc=ke,gc=qt,mc=ls,pc=hc,wc=lc((function(){for(var e,t,r=this.iterator,o=this.predicate,n=this.next;;){if(e=gc(dc(n,r)),this.done=!!e.done)return;if(t=e.value,pc(r,o,[t,this.counter++],!0))return t}}));uc({target:"Iterator",proto:!0,real:!0,forced:false},{filter:function(e){return gc(this),fc(e),new wc(mc(this),{predicate:e})}});var yc=z,vc=F,bc=function(e){if("Function"===yc(e))return vc(e)},Cc=ke,Sc=T,Rc=bc(bc.bind),Tc=function(e,t){return Cc(e),void 0===t?e:Sc?Rc(e,t):function(){return e.apply(t,arguments)}},Ec={},Oc=Ec,Mc=yt("iterator"),Hc=Array.prototype,xc=Yn,_c=Le,Nc=q,Ic=Ec,Ac=yt("iterator"),kc=function(e){if(!Nc(e))return _c(e,Ac)||_c(e,"@@iterator")||Ic[xc(e)]},Dc=M,Pc=ke,Lc=qt,Vc=_e,Fc=kc,Wc=TypeError,Bc=Tc,jc=M,zc=qt,Uc=_e,Yc=function(e){return void 0!==e&&(Oc.Array===e||Hc[Mc]===e)},$c=Oo,Gc=ce,Xc=function(e,t){var r=arguments.length<2?Fc(e):t;if(Pc(r))return Lc(Dc(r,e));throw new Wc(Vc(e)+" is not iterable")},qc=kc,Kc=Us,Zc=TypeError,Qc=function(e,t){this.stopped=e,this.result=t},Jc=Qc.prototype,eh=function(e,t,r){var o,n,i,s,l,a,c,h=r&&r.that,u=!(!r||!r.AS_ENTRIES),d=!(!r||!r.IS_RECORD),f=!(!r||!r.IS_ITERATOR),g=!(!r||!r.INTERRUPTED),m=Bc(t,h),p=function(e){return o&&Kc(o,"normal",e),new Qc(!0,e)},w=function(e){return u?(zc(e),g?m(e[0],e[1],p):m(e[0],e[1])):g?m(e,p):m(e)};if(d)o=e.iterator;else if(f)o=e;else{if(!(n=qc(e)))throw new Zc(Uc(e)+" is not iterable");if(Yc(n)){for(i=0,s=$c(e);s>i;i++)if((l=w(e[i]))&&Gc(Jc,l))return l;return new Qc(!1)}o=Xc(e,n)}for(a=d?e.next:o.next;!(c=jc(a,o)).done;){try{l=w(c.value)}catch(y){Kc(o,"throw",y)}if("object"==typeof l&&l&&Gc(Jc,l))return l}return new Qc(!1)},th=eh,rh=ke,oh=qt,nh=ls;pn({target:"Iterator",proto:!0,real:!0},{forEach:function(e){oh(this),rh(e);var t=nh(this),r=0;th(t,(function(t){e(t,r++)}),{IS_RECORD:!0})}});var ih=M,sh=ke,lh=qt,ah=ls,ch=hc,hh=lc((function(){var e=this.iterator,t=lh(ih(this.next,e));if(!(this.done=!!t.done))return ch(e,this.mapper,[t.value,this.counter++],!0)}));pn({target:"Iterator",proto:!0,real:!0,forced:false},{map:function(e){return lh(this),sh(e),new hh(ah(this),{mapper:e})}});var uh,dh,fh,gh,mh=F([].slice),ph=TypeError,wh=function(e,t){if(e<t)throw new ph("Not enough arguments");return e},yh=/(?:ipad|iphone|ipod).*applewebkit/i.test(de),vh=b,bh=de,Ch=z,Sh=function(e){return bh.slice(0,e.length)===e},Rh=Sh("Bun/")?"BUN":Sh("Cloudflare-Workers")?"CLOUDFLARE":Sh("Deno/")?"DENO":Sh("Node.js/")?"NODE":vh.Bun&&"string"==typeof Bun.version?"BUN":vh.Deno&&"object"==typeof Deno.version?"DENO":"process"===Ch(vh.process)?"NODE":vh.window&&vh.document?"BROWSER":"REST",Th=b,Eh=Cn,Oh=Tc,Mh=oe,Hh=nt,xh=S,_h=Ql,Nh=mh,Ih=It,Ah=wh,kh=yh,Dh="NODE"===Rh,Ph=Th.setImmediate,Lh=Th.clearImmediate,Vh=Th.process,Fh=Th.Dispatch,Wh=Th.Function,Bh=Th.MessageChannel,jh=Th.String,zh=0,Uh={},Yh="onreadystatechange";xh((function(){uh=Th.location}));var $h=function(e){if(Hh(Uh,e)){var t=Uh[e];delete Uh[e],t()}},Gh=function(e){return function(){$h(e)}},Xh=function(e){$h(e.data)},qh=function(e){Th.postMessage(jh(e),uh.protocol+"//"+uh.host)};Ph&&Lh||(Ph=function(e){Ah(arguments.length,1);var t=Mh(e)?e:Wh(e),r=Nh(arguments,1);return Uh[++zh]=function(){Eh(t,void 0,r)},dh(zh),zh},Lh=function(e){delete Uh[e]},Dh?dh=function(e){Vh.nextTick(Gh(e))}:Fh&&Fh.now?dh=function(e){Fh.now(Gh(e))}:Bh&&!kh?(gh=(fh=new Bh).port2,fh.port1.onmessage=Xh,dh=Oh(gh.postMessage,gh)):Th.addEventListener&&Mh(Th.postMessage)&&!Th.importScripts&&uh&&"file:"!==uh.protocol&&!xh(qh)?(dh=qh,Th.addEventListener("message",Xh,!1)):dh=Yh in Ih("script")?function(e){_h.appendChild(Ih("script"))[Yh]=function(){_h.removeChild(this),$h(e)}}:function(e){setTimeout(Gh(e),0)});var Kh={set:Ph,clear:Lh},Zh=Kh.clear;pn({global:!0,bind:!0,enumerable:!0,forced:b.clearImmediate!==Zh},{clearImmediate:Zh});var Qh,Jh=b,eu=Cn,tu=oe,ru=Rh,ou=de,nu=mh,iu=wh,su=Jh.Function,lu=/MSIE .\./.test(ou)||"BUN"===ru&&((Qh=Jh.Bun.version.split(".")).length<3||"0"===Qh[0]&&(Qh[1]<3||"3"===Qh[1]&&"0"===Qh[2])),au=pn,cu=b,hu=Kh.set,uu=function(e,t){var r=t?2:1;return lu?function(o,n){var i=iu(arguments.length,1)>r,s=tu(o)?o:su(o),l=i?nu(arguments,r):[],a=i?function(){eu(s,this,l)}:s;return t?e(a,n):e(a)}:e},du=cu.setImmediate?uu(hu,!1):hu;au({global:!0,bind:!0,enumerable:!0,forced:cu.setImmediate!==du},{setImmediate:du});
/*! @license DOMPurify 3.2.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.3/LICENSE */
const{entries:fu,setPrototypeOf:gu,isFrozen:mu,getPrototypeOf:pu,getOwnPropertyDescriptor:wu}=Object;let{freeze:yu,seal:vu,create:bu}=Object,{apply:Cu,construct:Su}="undefined"!=typeof Reflect&&Reflect;yu||(yu=function(e){return e}),vu||(vu=function(e){return e}),Cu||(Cu=function(e,t,r){return e.apply(t,r)}),Su||(Su=function(e,t){return new e(...t)});const Ru=Pu(Array.prototype.forEach),Tu=Pu(Array.prototype.pop),Eu=Pu(Array.prototype.push),Ou=Pu(String.prototype.toLowerCase),Mu=Pu(String.prototype.toString),Hu=Pu(String.prototype.match),xu=Pu(String.prototype.replace),_u=Pu(String.prototype.indexOf),Nu=Pu(String.prototype.trim),Iu=Pu(Object.prototype.hasOwnProperty),Au=Pu(RegExp.prototype.test),ku=(Du=TypeError,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Su(Du,t)});var Du;function Pu(e){return function(t){for(var r=arguments.length,o=new Array(r>1?r-1:0),n=1;n<r;n++)o[n-1]=arguments[n];return Cu(e,t,o)}}function Lu(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ou;gu&&gu(e,null);let o=t.length;for(;o--;){let n=t[o];if("string"==typeof n){const e=r(n);e!==n&&(mu(t)||(t[o]=e),n=e)}e[n]=!0}return e}function Vu(e){for(let t=0;t<e.length;t++){Iu(e,t)||(e[t]=null)}return e}function Fu(e){const t=bu(null);for(const[r,o]of fu(e)){Iu(e,r)&&(Array.isArray(o)?t[r]=Vu(o):o&&"object"==typeof o&&o.constructor===Object?t[r]=Fu(o):t[r]=o)}return t}function Wu(e,t){for(;null!==e;){const r=wu(e,t);if(r){if(r.get)return Pu(r.get);if("function"==typeof r.value)return Pu(r.value)}e=pu(e)}return function(){return null}}const Bu=yu(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ju=yu(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),zu=yu(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Uu=yu(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Yu=yu(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),$u=yu(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Gu=yu(["#text"]),Xu=yu(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),qu=yu(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ku=yu(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Zu=yu(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Qu=vu(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ju=vu(/<%[\w\W]*|[\w\W]*%>/gm),ed=vu(/\$\{[\w\W]*}/gm),td=vu(/^data-[\-\w.\u00B7-\uFFFF]+$/),rd=vu(/^aria-[\-\w]+$/),od=vu(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),nd=vu(/^(?:\w+script|data):/i),id=vu(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),sd=vu(/^html$/i),ld=vu(/^[a-z][.\w]*(-[.\w]+)+$/i);var ad=Object.freeze({__proto__:null,ARIA_ATTR:rd,ATTR_WHITESPACE:id,CUSTOM_ELEMENT:ld,DATA_ATTR:td,DOCTYPE_NAME:sd,ERB_EXPR:Ju,IS_ALLOWED_URI:od,IS_SCRIPT_OR_DATA:nd,MUSTACHE_EXPR:Qu,TMPLIT_EXPR:ed});const cd=1,hd=3,ud=7,dd=8,fd=9;var gd,md,pd=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window;const r=t=>e(t);if(r.version="3.2.3",r.removed=[],!t||!t.document||t.document.nodeType!==fd)return r.isSupported=!1,r;let{document:o}=t;const n=o,i=n.currentScript,{DocumentFragment:s,HTMLTemplateElement:l,Node:a,Element:c,NodeFilter:h,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:d,DOMParser:f,trustedTypes:g}=t,m=c.prototype,p=Wu(m,"cloneNode"),w=Wu(m,"remove"),y=Wu(m,"nextSibling"),v=Wu(m,"childNodes"),b=Wu(m,"parentNode");if("function"==typeof l){const e=o.createElement("template");e.content&&e.content.ownerDocument&&(o=e.content.ownerDocument)}let C,S="";const{implementation:R,createNodeIterator:T,createDocumentFragment:E,getElementsByTagName:O}=o,{importNode:M}=n;let H={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};r.isSupported="function"==typeof fu&&"function"==typeof b&&R&&void 0!==R.createHTMLDocument;const{MUSTACHE_EXPR:x,ERB_EXPR:_,TMPLIT_EXPR:N,DATA_ATTR:I,ARIA_ATTR:A,IS_SCRIPT_OR_DATA:k,ATTR_WHITESPACE:D,CUSTOM_ELEMENT:P}=ad;let{IS_ALLOWED_URI:L}=ad,V=null;const F=Lu({},[...Bu,...ju,...zu,...Yu,...Gu]);let W=null;const B=Lu({},[...Xu,...qu,...Ku,...Zu]);let j=Object.seal(bu(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),z=null,U=null,Y=!0,$=!0,G=!1,X=!0,q=!1,K=!0,Z=!1,Q=!1,J=!1,ee=!1,te=!1,re=!1,oe=!0,ne=!1,ie=!0,se=!1,le={},ae=null;const ce=Lu({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let he=null;const ue=Lu({},["audio","video","img","source","image","track"]);let de=null;const fe=Lu({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ge="http://www.w3.org/1998/Math/MathML",me="http://www.w3.org/2000/svg",pe="http://www.w3.org/1999/xhtml";let we=pe,ye=!1,ve=null;const be=Lu({},[ge,me,pe],Mu);let Ce=Lu({},["mi","mo","mn","ms","mtext"]),Se=Lu({},["annotation-xml"]);const Re=Lu({},["title","style","font","a","script"]);let Te=null;const Ee=["application/xhtml+xml","text/html"];let Oe=null,Me=null;const He=o.createElement("form"),xe=function(e){return e instanceof RegExp||e instanceof Function},_e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Me||Me!==e){if(e&&"object"==typeof e||(e={}),e=Fu(e),Te=-1===Ee.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,Oe="application/xhtml+xml"===Te?Mu:Ou,V=Iu(e,"ALLOWED_TAGS")?Lu({},e.ALLOWED_TAGS,Oe):F,W=Iu(e,"ALLOWED_ATTR")?Lu({},e.ALLOWED_ATTR,Oe):B,ve=Iu(e,"ALLOWED_NAMESPACES")?Lu({},e.ALLOWED_NAMESPACES,Mu):be,de=Iu(e,"ADD_URI_SAFE_ATTR")?Lu(Fu(fe),e.ADD_URI_SAFE_ATTR,Oe):fe,he=Iu(e,"ADD_DATA_URI_TAGS")?Lu(Fu(ue),e.ADD_DATA_URI_TAGS,Oe):ue,ae=Iu(e,"FORBID_CONTENTS")?Lu({},e.FORBID_CONTENTS,Oe):ce,z=Iu(e,"FORBID_TAGS")?Lu({},e.FORBID_TAGS,Oe):{},U=Iu(e,"FORBID_ATTR")?Lu({},e.FORBID_ATTR,Oe):{},le=!!Iu(e,"USE_PROFILES")&&e.USE_PROFILES,Y=!1!==e.ALLOW_ARIA_ATTR,$=!1!==e.ALLOW_DATA_ATTR,G=e.ALLOW_UNKNOWN_PROTOCOLS||!1,X=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,q=e.SAFE_FOR_TEMPLATES||!1,K=!1!==e.SAFE_FOR_XML,Z=e.WHOLE_DOCUMENT||!1,ee=e.RETURN_DOM||!1,te=e.RETURN_DOM_FRAGMENT||!1,re=e.RETURN_TRUSTED_TYPE||!1,J=e.FORCE_BODY||!1,oe=!1!==e.SANITIZE_DOM,ne=e.SANITIZE_NAMED_PROPS||!1,ie=!1!==e.KEEP_CONTENT,se=e.IN_PLACE||!1,L=e.ALLOWED_URI_REGEXP||od,we=e.NAMESPACE||pe,Ce=e.MATHML_TEXT_INTEGRATION_POINTS||Ce,Se=e.HTML_INTEGRATION_POINTS||Se,j=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&xe(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(j.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&xe(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(j.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(j.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),q&&($=!1),te&&(ee=!0),le&&(V=Lu({},Gu),W=[],!0===le.html&&(Lu(V,Bu),Lu(W,Xu)),!0===le.svg&&(Lu(V,ju),Lu(W,qu),Lu(W,Zu)),!0===le.svgFilters&&(Lu(V,zu),Lu(W,qu),Lu(W,Zu)),!0===le.mathMl&&(Lu(V,Yu),Lu(W,Ku),Lu(W,Zu))),e.ADD_TAGS&&(V===F&&(V=Fu(V)),Lu(V,e.ADD_TAGS,Oe)),e.ADD_ATTR&&(W===B&&(W=Fu(W)),Lu(W,e.ADD_ATTR,Oe)),e.ADD_URI_SAFE_ATTR&&Lu(de,e.ADD_URI_SAFE_ATTR,Oe),e.FORBID_CONTENTS&&(ae===ce&&(ae=Fu(ae)),Lu(ae,e.FORBID_CONTENTS,Oe)),ie&&(V["#text"]=!0),Z&&Lu(V,["html","head","body"]),V.table&&(Lu(V,["tbody"]),delete z.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw ku('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw ku('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=e.TRUSTED_TYPES_POLICY,S=C.createHTML("")}else void 0===C&&(C=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let r=null;const o="data-tt-policy-suffix";t&&t.hasAttribute(o)&&(r=t.getAttribute(o));const n="dompurify"+(r?"#"+r:"");try{return e.createPolicy(n,{createHTML:e=>e,createScriptURL:e=>e})}catch(i){return null}}(g,i)),null!==C&&"string"==typeof S&&(S=C.createHTML(""));yu&&yu(e),Me=e}},Ne=Lu({},[...ju,...zu,...Uu]),Ie=Lu({},[...Yu,...$u]),Ae=function(e){Eu(r.removed,{element:e});try{b(e).removeChild(e)}catch(t){w(e)}},ke=function(e,t){try{Eu(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(o){Eu(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(ee||te)try{Ae(t)}catch(o){}else try{t.setAttribute(e,"")}catch(o){}},De=function(e){let t=null,r=null;if(J)e="<remove></remove>"+e;else{const t=Hu(e,/^[\r\n\t ]+/);r=t&&t[0]}"application/xhtml+xml"===Te&&we===pe&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const n=C?C.createHTML(e):e;if(we===pe)try{t=(new f).parseFromString(n,Te)}catch(s){}if(!t||!t.documentElement){t=R.createDocument(we,"template",null);try{t.documentElement.innerHTML=ye?S:n}catch(s){}}const i=t.body||t.documentElement;return e&&r&&i.insertBefore(o.createTextNode(r),i.childNodes[0]||null),we===pe?O.call(t,Z?"html":"body")[0]:Z?t.documentElement:i},Pe=function(e){return T.call(e.ownerDocument||e,e,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},Le=function(e){return e instanceof d&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof u)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},Ve=function(e){return"function"==typeof a&&e instanceof a};function Fe(e,t,o){Ru(e,(e=>{e.call(r,t,o,Me)}))}const We=function(e){let t=null;if(Fe(H.beforeSanitizeElements,e,null),Le(e))return Ae(e),!0;const o=Oe(e.nodeName);if(Fe(H.uponSanitizeElement,e,{tagName:o,allowedTags:V}),e.hasChildNodes()&&!Ve(e.firstElementChild)&&Au(/<[/\w]/g,e.innerHTML)&&Au(/<[/\w]/g,e.textContent))return Ae(e),!0;if(e.nodeType===ud)return Ae(e),!0;if(K&&e.nodeType===dd&&Au(/<[/\w]/g,e.data))return Ae(e),!0;if(!V[o]||z[o]){if(!z[o]&&je(o)){if(j.tagNameCheck instanceof RegExp&&Au(j.tagNameCheck,o))return!1;if(j.tagNameCheck instanceof Function&&j.tagNameCheck(o))return!1}if(ie&&!ae[o]){const t=b(e)||e.parentNode,r=v(e)||e.childNodes;if(r&&t){for(let o=r.length-1;o>=0;--o){const n=p(r[o],!0);n.__removalCount=(e.__removalCount||0)+1,t.insertBefore(n,y(e))}}}return Ae(e),!0}return e instanceof c&&!function(e){let t=b(e);t&&t.tagName||(t={namespaceURI:we,tagName:"template"});const r=Ou(e.tagName),o=Ou(t.tagName);return!!ve[e.namespaceURI]&&(e.namespaceURI===me?t.namespaceURI===pe?"svg"===r:t.namespaceURI===ge?"svg"===r&&("annotation-xml"===o||Ce[o]):Boolean(Ne[r]):e.namespaceURI===ge?t.namespaceURI===pe?"math"===r:t.namespaceURI===me?"math"===r&&Se[o]:Boolean(Ie[r]):e.namespaceURI===pe?!(t.namespaceURI===me&&!Se[o])&&!(t.namespaceURI===ge&&!Ce[o])&&!Ie[r]&&(Re[r]||!Ne[r]):!("application/xhtml+xml"!==Te||!ve[e.namespaceURI]))}(e)?(Ae(e),!0):"noscript"!==o&&"noembed"!==o&&"noframes"!==o||!Au(/<\/no(script|embed|frames)/i,e.innerHTML)?(q&&e.nodeType===hd&&(t=e.textContent,Ru([x,_,N],(e=>{t=xu(t,e," ")})),e.textContent!==t&&(Eu(r.removed,{element:e.cloneNode()}),e.textContent=t)),Fe(H.afterSanitizeElements,e,null),!1):(Ae(e),!0)},Be=function(e,t,r){if(oe&&("id"===t||"name"===t)&&(r in o||r in He))return!1;if($&&!U[t]&&Au(I,t));else if(Y&&Au(A,t));else if(!W[t]||U[t]){if(!(je(e)&&(j.tagNameCheck instanceof RegExp&&Au(j.tagNameCheck,e)||j.tagNameCheck instanceof Function&&j.tagNameCheck(e))&&(j.attributeNameCheck instanceof RegExp&&Au(j.attributeNameCheck,t)||j.attributeNameCheck instanceof Function&&j.attributeNameCheck(t))||"is"===t&&j.allowCustomizedBuiltInElements&&(j.tagNameCheck instanceof RegExp&&Au(j.tagNameCheck,r)||j.tagNameCheck instanceof Function&&j.tagNameCheck(r))))return!1}else if(de[t]);else if(Au(L,xu(r,D,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==_u(r,"data:")||!he[e]){if(G&&!Au(k,xu(r,D,"")));else if(r)return!1}else;return!0},je=function(e){return"annotation-xml"!==e&&Hu(e,P)},ze=function(e){Fe(H.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||Le(e))return;const o={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:W,forceKeepAttr:void 0};let n=t.length;for(;n--;){const s=t[n],{name:l,namespaceURI:a,value:c}=s,h=Oe(l);let u="value"===l?c:Nu(c);if(o.attrName=h,o.attrValue=u,o.keepAttr=!0,o.forceKeepAttr=void 0,Fe(H.uponSanitizeAttribute,e,o),u=o.attrValue,!ne||"id"!==h&&"name"!==h||(ke(l,e),u="user-content-"+u),K&&Au(/((--!?|])>)|<\/(style|title)/i,u)){ke(l,e);continue}if(o.forceKeepAttr)continue;if(ke(l,e),!o.keepAttr)continue;if(!X&&Au(/\/>/i,u)){ke(l,e);continue}q&&Ru([x,_,N],(e=>{u=xu(u,e," ")}));const d=Oe(e.nodeName);if(Be(d,h,u)){if(C&&"object"==typeof g&&"function"==typeof g.getAttributeType)if(a);else switch(g.getAttributeType(d,h)){case"TrustedHTML":u=C.createHTML(u);break;case"TrustedScriptURL":u=C.createScriptURL(u)}try{a?e.setAttributeNS(a,l,u):e.setAttribute(l,u),Le(e)?Ae(e):Tu(r.removed)}catch(i){}}}Fe(H.afterSanitizeAttributes,e,null)},Ue=function e(t){let r=null;const o=Pe(t);for(Fe(H.beforeSanitizeShadowDOM,t,null);r=o.nextNode();)Fe(H.uponSanitizeShadowNode,r,null),We(r),ze(r),r.content instanceof s&&e(r.content);Fe(H.afterSanitizeShadowDOM,t,null)};return r.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=null,i=null,l=null,c=null;if(ye=!e,ye&&(e="\x3c!--\x3e"),"string"!=typeof e&&!Ve(e)){if("function"!=typeof e.toString)throw ku("toString is not a function");if("string"!=typeof(e=e.toString()))throw ku("dirty is not a string, aborting")}if(!r.isSupported)return e;if(Q||_e(t),r.removed=[],"string"==typeof e&&(se=!1),se){if(e.nodeName){const t=Oe(e.nodeName);if(!V[t]||z[t])throw ku("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof a)o=De("\x3c!----\x3e"),i=o.ownerDocument.importNode(e,!0),i.nodeType===cd&&"BODY"===i.nodeName||"HTML"===i.nodeName?o=i:o.appendChild(i);else{if(!ee&&!q&&!Z&&-1===e.indexOf("<"))return C&&re?C.createHTML(e):e;if(o=De(e),!o)return ee?null:re?S:""}o&&J&&Ae(o.firstChild);const h=Pe(se?e:o);for(;l=h.nextNode();)We(l),ze(l),l.content instanceof s&&Ue(l.content);if(se)return e;if(ee){if(te)for(c=E.call(o.ownerDocument);o.firstChild;)c.appendChild(o.firstChild);else c=o;return(W.shadowroot||W.shadowrootmode)&&(c=M.call(n,c,!0)),c}let u=Z?o.outerHTML:o.innerHTML;return Z&&V["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&Au(sd,o.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+u),q&&Ru([x,_,N],(e=>{u=xu(u,e," ")})),C&&re?C.createHTML(u):u},r.setConfig=function(){_e(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Q=!0},r.clearConfig=function(){Me=null,Q=!1},r.isValidAttribute=function(e,t,r){Me||_e({});const o=Oe(e),n=Oe(t);return Be(o,n,r)},r.addHook=function(e,t){"function"==typeof t&&Eu(H[e],t)},r.removeHook=function(e){return Tu(H[e])},r.removeHooks=function(e){H[e]=[]},r.removeAllHooks=function(){H={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},r}();
//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
function wd(){return gd.apply(null,arguments)}function yd(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function vd(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function bd(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Cd(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(bd(e,t))return!1;return!0}function Sd(e){return void 0===e}function Rd(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function Td(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function Ed(e,t){var r,o=[],n=e.length;for(r=0;r<n;++r)o.push(t(e[r],r));return o}function Od(e,t){for(var r in t)bd(t,r)&&(e[r]=t[r]);return bd(t,"toString")&&(e.toString=t.toString),bd(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Md(e,t,r,o){return Xg(e,t,r,o,!0).utc()}function Hd(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function xd(e){var t=null,r=!1,o=e._d&&!isNaN(e._d.getTime());return o&&(t=Hd(e),r=md.call(t.parsedDateParts,(function(e){return null!=e})),o=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r),e._strict&&(o=o&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)),null!=Object.isFrozen&&Object.isFrozen(e)?o:(e._isValid=o,e._isValid)}function _d(e){var t=Md(NaN);return null!=e?Od(Hd(t),e):Hd(t).userInvalidated=!0,t}md=Array.prototype.some?Array.prototype.some:function(e){var t,r=Object(this),o=r.length>>>0;for(t=0;t<o;t++)if(t in r&&e.call(this,r[t],t,r))return!0;return!1};var Nd=wd.momentProperties=[],Id=!1;function Ad(e,t){var r,o,n,i=Nd.length;if(Sd(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),Sd(t._i)||(e._i=t._i),Sd(t._f)||(e._f=t._f),Sd(t._l)||(e._l=t._l),Sd(t._strict)||(e._strict=t._strict),Sd(t._tzm)||(e._tzm=t._tzm),Sd(t._isUTC)||(e._isUTC=t._isUTC),Sd(t._offset)||(e._offset=t._offset),Sd(t._pf)||(e._pf=Hd(t)),Sd(t._locale)||(e._locale=t._locale),i>0)for(r=0;r<i;r++)Sd(n=t[o=Nd[r]])||(e[o]=n);return e}function kd(e){Ad(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===Id&&(Id=!0,wd.updateOffset(this),Id=!1)}function Dd(e){return e instanceof kd||null!=e&&null!=e._isAMomentObject}function Pd(e){!1===wd.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn}function Ld(e,t){var r=!0;return Od((function(){if(null!=wd.deprecationHandler&&wd.deprecationHandler(null,e),r){var o,n,i,s=[],l=arguments.length;for(n=0;n<l;n++){if(o="","object"==typeof arguments[n]){for(i in o+="\n["+n+"] ",arguments[0])bd(arguments[0],i)&&(o+=i+": "+arguments[0][i]+", ");o=o.slice(0,-2)}else o=arguments[n];s.push(o)}Pd((Array.prototype.slice.call(s).join(""),(new Error).stack)),r=!1}return t.apply(this,arguments)}),t)}var Vd,Fd={};function Wd(e,t){null!=wd.deprecationHandler&&wd.deprecationHandler(e,t),Fd[e]||(Pd(),Fd[e]=!0)}function Bd(e){return"undefined"!=typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function jd(e,t){var r,o=Od({},e);for(r in t)bd(t,r)&&(vd(e[r])&&vd(t[r])?(o[r]={},Od(o[r],e[r]),Od(o[r],t[r])):null!=t[r]?o[r]=t[r]:delete o[r]);for(r in e)bd(e,r)&&!bd(t,r)&&vd(e[r])&&(o[r]=Od({},o[r]));return o}function zd(e){null!=e&&this.set(e)}wd.suppressDeprecationWarnings=!1,wd.deprecationHandler=null,Vd=Object.keys?Object.keys:function(e){var t,r=[];for(t in e)bd(e,t)&&r.push(t);return r};function Ud(e,t,r){var o=""+Math.abs(e),n=t-o.length;return(e>=0?r?"+":"":"-")+Math.pow(10,Math.max(0,n)).toString().substr(1)+o}var Yd=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,$d=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Gd={},Xd={};function qd(e,t,r,o){var n=o;"string"==typeof o&&(n=function(){return this[o]()}),e&&(Xd[e]=n),t&&(Xd[t[0]]=function(){return Ud(n.apply(this,arguments),t[1],t[2])}),r&&(Xd[r]=function(){return this.localeData().ordinal(n.apply(this,arguments),e)})}function Kd(e,t){return e.isValid()?(t=Zd(t,e.localeData()),Gd[t]=Gd[t]||function(e){var t,r,o,n=e.match(Yd);for(t=0,r=n.length;t<r;t++)Xd[n[t]]?n[t]=Xd[n[t]]:n[t]=(o=n[t]).match(/\[[\s\S]/)?o.replace(/^\[|\]$/g,""):o.replace(/\\/g,"");return function(t){var o,i="";for(o=0;o<r;o++)i+=Bd(n[o])?n[o].call(t,e):n[o];return i}}(t),Gd[t](e)):e.localeData().invalidDate()}function Zd(e,t){var r=5;function o(e){return t.longDateFormat(e)||e}for($d.lastIndex=0;r>=0&&$d.test(e);)e=e.replace($d,o),$d.lastIndex=0,r-=1;return e}var Qd={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Jd(e){return"string"==typeof e?Qd[e]||Qd[e.toLowerCase()]:void 0}function ef(e){var t,r,o={};for(r in e)bd(e,r)&&(t=Jd(r))&&(o[t]=e[r]);return o}var tf={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};var rf,of=/\d/,nf=/\d\d/,sf=/\d{3}/,lf=/\d{4}/,af=/[+-]?\d{6}/,cf=/\d\d?/,hf=/\d\d\d\d?/,uf=/\d\d\d\d\d\d?/,df=/\d{1,3}/,ff=/\d{1,4}/,gf=/[+-]?\d{1,6}/,mf=/\d+/,pf=/[+-]?\d+/,wf=/Z|[+-]\d\d:?\d\d/gi,yf=/Z|[+-]\d\d(?::?\d\d)?/gi,vf=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,bf=/^[1-9]\d?/,Cf=/^([1-9]\d|\d)/;function Sf(e,t,r){rf[e]=Bd(t)?t:function(e,o){return e&&r?r:t}}function Rf(e,t){return bd(rf,e)?rf[e](t._strict,t._locale):new RegExp(Tf(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,r,o,n){return t||r||o||n}))))}function Tf(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Ef(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Of(e){var t=+e,r=0;return 0!==t&&isFinite(t)&&(r=Ef(t)),r}rf={};var Mf={};function Hf(e,t){var r,o,n=t;for("string"==typeof e&&(e=[e]),Rd(t)&&(n=function(e,r){r[t]=Of(e)}),o=e.length,r=0;r<o;r++)Mf[e[r]]=n}function xf(e,t){Hf(e,(function(e,r,o,n){o._w=o._w||{},t(e,o._w,o,n)}))}function _f(e,t,r){null!=t&&bd(Mf,e)&&Mf[e](t,r._a,r,e)}function Nf(e){return e%4==0&&e%100!=0||e%400==0}var If=0,Af=1,kf=2,Df=3,Pf=4,Lf=5,Vf=6,Ff=7,Wf=8;function Bf(e){return Nf(e)?366:365}qd("Y",0,0,(function(){var e=this.year();return e<=9999?Ud(e,4):"+"+e})),qd(0,["YY",2],0,(function(){return this.year()%100})),qd(0,["YYYY",4],0,"year"),qd(0,["YYYYY",5],0,"year"),qd(0,["YYYYYY",6,!0],0,"year"),Sf("Y",pf),Sf("YY",cf,nf),Sf("YYYY",ff,lf),Sf("YYYYY",gf,af),Sf("YYYYYY",gf,af),Hf(["YYYYY","YYYYYY"],If),Hf("YYYY",(function(e,t){t[If]=2===e.length?wd.parseTwoDigitYear(e):Of(e)})),Hf("YY",(function(e,t){t[If]=wd.parseTwoDigitYear(e)})),Hf("Y",(function(e,t){t[If]=parseInt(e,10)})),wd.parseTwoDigitYear=function(e){return Of(e)+(Of(e)>68?1900:2e3)};var jf,zf=Uf("FullYear",!0);function Uf(e,t){return function(r){return null!=r?($f(this,e,r),wd.updateOffset(this,t),this):Yf(this,e)}}function Yf(e,t){if(!e.isValid())return NaN;var r=e._d,o=e._isUTC;switch(t){case"Milliseconds":return o?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return o?r.getUTCSeconds():r.getSeconds();case"Minutes":return o?r.getUTCMinutes():r.getMinutes();case"Hours":return o?r.getUTCHours():r.getHours();case"Date":return o?r.getUTCDate():r.getDate();case"Day":return o?r.getUTCDay():r.getDay();case"Month":return o?r.getUTCMonth():r.getMonth();case"FullYear":return o?r.getUTCFullYear():r.getFullYear();default:return NaN}}function $f(e,t,r){var o,n,i,s,l;if(e.isValid()&&!isNaN(r)){switch(o=e._d,n=e._isUTC,t){case"Milliseconds":return void(n?o.setUTCMilliseconds(r):o.setMilliseconds(r));case"Seconds":return void(n?o.setUTCSeconds(r):o.setSeconds(r));case"Minutes":return void(n?o.setUTCMinutes(r):o.setMinutes(r));case"Hours":return void(n?o.setUTCHours(r):o.setHours(r));case"Date":return void(n?o.setUTCDate(r):o.setDate(r));case"FullYear":break;default:return}i=r,s=e.month(),l=29!==(l=e.date())||1!==s||Nf(i)?l:28,n?o.setUTCFullYear(i,s,l):o.setFullYear(i,s,l)}}function Gf(e,t){if(isNaN(e)||isNaN(t))return NaN;var r,o=(t%(r=12)+r)%r;return e+=(t-o)/12,1===o?Nf(e)?29:28:31-o%7%2}jf=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},qd("M",["MM",2],"Mo",(function(){return this.month()+1})),qd("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),qd("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),Sf("M",cf,bf),Sf("MM",cf,nf),Sf("MMM",(function(e,t){return t.monthsShortRegex(e)})),Sf("MMMM",(function(e,t){return t.monthsRegex(e)})),Hf(["M","MM"],(function(e,t){t[Af]=Of(e)-1})),Hf(["MMM","MMMM"],(function(e,t,r,o){var n=r._locale.monthsParse(e,o,r._strict);null!=n?t[Af]=n:Hd(r).invalidMonth=e}));var Xf="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),qf="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Kf=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Zf=vf,Qf=vf;function Jf(e,t,r){var o,n,i,s=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],o=0;o<12;++o)i=Md([2e3,o]),this._shortMonthsParse[o]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[o]=this.months(i,"").toLocaleLowerCase();return r?"MMM"===t?-1!==(n=jf.call(this._shortMonthsParse,s))?n:null:-1!==(n=jf.call(this._longMonthsParse,s))?n:null:"MMM"===t?-1!==(n=jf.call(this._shortMonthsParse,s))||-1!==(n=jf.call(this._longMonthsParse,s))?n:null:-1!==(n=jf.call(this._longMonthsParse,s))||-1!==(n=jf.call(this._shortMonthsParse,s))?n:null}function eg(e,t){if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=Of(t);else if(!Rd(t=e.localeData().monthsParse(t)))return e;var r=t,o=e.date();return o=o<29?o:Math.min(o,Gf(e.year(),r)),e._isUTC?e._d.setUTCMonth(r,o):e._d.setMonth(r,o),e}function tg(e){return null!=e?(eg(this,e),wd.updateOffset(this,!0),this):Yf(this,"Month")}function rg(){function e(e,t){return t.length-e.length}var t,r,o,n,i=[],s=[],l=[];for(t=0;t<12;t++)r=Md([2e3,t]),o=Tf(this.monthsShort(r,"")),n=Tf(this.months(r,"")),i.push(o),s.push(n),l.push(n),l.push(o);i.sort(e),s.sort(e),l.sort(e),this._monthsRegex=new RegExp("^("+l.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function og(e,t,r,o,n,i,s){var l;return e<100&&e>=0?(l=new Date(e+400,t,r,o,n,i,s),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,r,o,n,i,s),l}function ng(e){var t,r;return e<100&&e>=0?((r=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function ig(e,t,r){var o=7+t-r;return-((7+ng(e,0,o).getUTCDay()-t)%7)+o-1}function sg(e,t,r,o,n){var i,s,l=1+7*(t-1)+(7+r-o)%7+ig(e,o,n);return l<=0?s=Bf(i=e-1)+l:l>Bf(e)?(i=e+1,s=l-Bf(e)):(i=e,s=l),{year:i,dayOfYear:s}}function lg(e,t,r){var o,n,i=ig(e.year(),t,r),s=Math.floor((e.dayOfYear()-i-1)/7)+1;return s<1?o=s+ag(n=e.year()-1,t,r):s>ag(e.year(),t,r)?(o=s-ag(e.year(),t,r),n=e.year()+1):(n=e.year(),o=s),{week:o,year:n}}function ag(e,t,r){var o=ig(e,t,r),n=ig(e+1,t,r);return(Bf(e)-o+n)/7}qd("w",["ww",2],"wo","week"),qd("W",["WW",2],"Wo","isoWeek"),Sf("w",cf,bf),Sf("ww",cf,nf),Sf("W",cf,bf),Sf("WW",cf,nf),xf(["w","ww","W","WW"],(function(e,t,r,o){t[o.substr(0,1)]=Of(e)}));function cg(e,t){return e.slice(t,7).concat(e.slice(0,t))}qd("d",0,"do","day"),qd("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),qd("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),qd("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),qd("e",0,0,"weekday"),qd("E",0,0,"isoWeekday"),Sf("d",cf),Sf("e",cf),Sf("E",cf),Sf("dd",(function(e,t){return t.weekdaysMinRegex(e)})),Sf("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),Sf("dddd",(function(e,t){return t.weekdaysRegex(e)})),xf(["dd","ddd","dddd"],(function(e,t,r,o){var n=r._locale.weekdaysParse(e,o,r._strict);null!=n?t.d=n:Hd(r).invalidWeekday=e})),xf(["d","e","E"],(function(e,t,r,o){t[o]=Of(e)}));var hg="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),ug="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),dg="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),fg=vf,gg=vf,mg=vf;function pg(e,t,r){var o,n,i,s=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],o=0;o<7;++o)i=Md([2e3,1]).day(o),this._minWeekdaysParse[o]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[o]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[o]=this.weekdays(i,"").toLocaleLowerCase();return r?"dddd"===t?-1!==(n=jf.call(this._weekdaysParse,s))?n:null:"ddd"===t?-1!==(n=jf.call(this._shortWeekdaysParse,s))?n:null:-1!==(n=jf.call(this._minWeekdaysParse,s))?n:null:"dddd"===t?-1!==(n=jf.call(this._weekdaysParse,s))||-1!==(n=jf.call(this._shortWeekdaysParse,s))||-1!==(n=jf.call(this._minWeekdaysParse,s))?n:null:"ddd"===t?-1!==(n=jf.call(this._shortWeekdaysParse,s))||-1!==(n=jf.call(this._weekdaysParse,s))||-1!==(n=jf.call(this._minWeekdaysParse,s))?n:null:-1!==(n=jf.call(this._minWeekdaysParse,s))||-1!==(n=jf.call(this._weekdaysParse,s))||-1!==(n=jf.call(this._shortWeekdaysParse,s))?n:null}function wg(){function e(e,t){return t.length-e.length}var t,r,o,n,i,s=[],l=[],a=[],c=[];for(t=0;t<7;t++)r=Md([2e3,1]).day(t),o=Tf(this.weekdaysMin(r,"")),n=Tf(this.weekdaysShort(r,"")),i=Tf(this.weekdays(r,"")),s.push(o),l.push(n),a.push(i),c.push(o),c.push(n),c.push(i);s.sort(e),l.sort(e),a.sort(e),c.sort(e),this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function yg(){return this.hours()%12||12}function vg(e,t){qd(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function bg(e,t){return t._meridiemParse}qd("H",["HH",2],0,"hour"),qd("h",["hh",2],0,yg),qd("k",["kk",2],0,(function(){return this.hours()||24})),qd("hmm",0,0,(function(){return""+yg.apply(this)+Ud(this.minutes(),2)})),qd("hmmss",0,0,(function(){return""+yg.apply(this)+Ud(this.minutes(),2)+Ud(this.seconds(),2)})),qd("Hmm",0,0,(function(){return""+this.hours()+Ud(this.minutes(),2)})),qd("Hmmss",0,0,(function(){return""+this.hours()+Ud(this.minutes(),2)+Ud(this.seconds(),2)})),vg("a",!0),vg("A",!1),Sf("a",bg),Sf("A",bg),Sf("H",cf,Cf),Sf("h",cf,bf),Sf("k",cf,bf),Sf("HH",cf,nf),Sf("hh",cf,nf),Sf("kk",cf,nf),Sf("hmm",hf),Sf("hmmss",uf),Sf("Hmm",hf),Sf("Hmmss",uf),Hf(["H","HH"],Df),Hf(["k","kk"],(function(e,t,r){var o=Of(e);t[Df]=24===o?0:o})),Hf(["a","A"],(function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e})),Hf(["h","hh"],(function(e,t,r){t[Df]=Of(e),Hd(r).bigHour=!0})),Hf("hmm",(function(e,t,r){var o=e.length-2;t[Df]=Of(e.substr(0,o)),t[Pf]=Of(e.substr(o)),Hd(r).bigHour=!0})),Hf("hmmss",(function(e,t,r){var o=e.length-4,n=e.length-2;t[Df]=Of(e.substr(0,o)),t[Pf]=Of(e.substr(o,2)),t[Lf]=Of(e.substr(n)),Hd(r).bigHour=!0})),Hf("Hmm",(function(e,t,r){var o=e.length-2;t[Df]=Of(e.substr(0,o)),t[Pf]=Of(e.substr(o))})),Hf("Hmmss",(function(e,t,r){var o=e.length-4,n=e.length-2;t[Df]=Of(e.substr(0,o)),t[Pf]=Of(e.substr(o,2)),t[Lf]=Of(e.substr(n))}));var Cg=Uf("Hours",!0);var Sg,Rg={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Xf,monthsShort:qf,week:{dow:0,doy:6},weekdays:hg,weekdaysMin:dg,weekdaysShort:ug,meridiemParse:/[ap]\.?m?\.?/i},Tg={},Eg={};function Og(e,t){var r,o=Math.min(e.length,t.length);for(r=0;r<o;r+=1)if(e[r]!==t[r])return r;return o}function Mg(e){return e?e.toLowerCase().replace("_","-"):e}function Hg(e){var t=null;if(void 0===Tg[e]&&"undefined"!=typeof module&&module&&module.exports&&function(e){return!(!e||!e.match("^[^/\\\\]*$"))}(e))try{t=Sg._abbr,require("./locale/"+e),xg(t)}catch(r){Tg[e]=null}return Tg[e]}function xg(e,t){var r;return e&&((r=Sd(t)?Ng(e):_g(e,t))?Sg=r:"undefined"!=typeof console&&console.warn),Sg._abbr}function _g(e,t){if(null!==t){var r,o=Rg;if(t.abbr=e,null!=Tg[e])Wd("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),o=Tg[e]._config;else if(null!=t.parentLocale)if(null!=Tg[t.parentLocale])o=Tg[t.parentLocale]._config;else{if(null==(r=Hg(t.parentLocale)))return Eg[t.parentLocale]||(Eg[t.parentLocale]=[]),Eg[t.parentLocale].push({name:e,config:t}),null;o=r._config}return Tg[e]=new zd(jd(o,t)),Eg[e]&&Eg[e].forEach((function(e){_g(e.name,e.config)})),xg(e),Tg[e]}return delete Tg[e],null}function Ng(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Sg;if(!yd(e)){if(t=Hg(e))return t;e=[e]}return function(e){for(var t,r,o,n,i=0;i<e.length;){for(t=(n=Mg(e[i]).split("-")).length,r=(r=Mg(e[i+1]))?r.split("-"):null;t>0;){if(o=Hg(n.slice(0,t).join("-")))return o;if(r&&r.length>=t&&Og(n,r)>=t-1)break;t--}i++}return Sg}(e)}function Ig(e){var t,r=e._a;return r&&-2===Hd(e).overflow&&(t=r[Af]<0||r[Af]>11?Af:r[kf]<1||r[kf]>Gf(r[If],r[Af])?kf:r[Df]<0||r[Df]>24||24===r[Df]&&(0!==r[Pf]||0!==r[Lf]||0!==r[Vf])?Df:r[Pf]<0||r[Pf]>59?Pf:r[Lf]<0||r[Lf]>59?Lf:r[Vf]<0||r[Vf]>999?Vf:-1,Hd(e)._overflowDayOfYear&&(t<If||t>kf)&&(t=kf),Hd(e)._overflowWeeks&&-1===t&&(t=Ff),Hd(e)._overflowWeekday&&-1===t&&(t=Wf),Hd(e).overflow=t),e}var Ag=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,kg=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Dg=/Z|[+-]\d\d(?::?\d\d)?/,Pg=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Lg=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Vg=/^\/?Date\((-?\d+)/i,Fg=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Wg={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Bg(e){var t,r,o,n,i,s,l=e._i,a=Ag.exec(l)||kg.exec(l),c=Pg.length,h=Lg.length;if(a){for(Hd(e).iso=!0,t=0,r=c;t<r;t++)if(Pg[t][1].exec(a[1])){n=Pg[t][0],o=!1!==Pg[t][2];break}if(null==n)return void(e._isValid=!1);if(a[3]){for(t=0,r=h;t<r;t++)if(Lg[t][1].exec(a[3])){i=(a[2]||" ")+Lg[t][0];break}if(null==i)return void(e._isValid=!1)}if(!o&&null!=i)return void(e._isValid=!1);if(a[4]){if(!Dg.exec(a[4]))return void(e._isValid=!1);s="Z"}e._f=n+(i||"")+(s||""),$g(e)}else e._isValid=!1}function jg(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function zg(e){var t,r,o,n,i,s,l,a,c=Fg.exec(e._i.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(c){if(r=c[4],o=c[3],n=c[2],i=c[5],s=c[6],l=c[7],a=[jg(r),qf.indexOf(o),parseInt(n,10),parseInt(i,10),parseInt(s,10)],l&&a.push(parseInt(l,10)),t=a,!function(e,t,r){return!e||ug.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(Hd(r).weekdayMismatch=!0,r._isValid=!1,!1)}(c[1],t,e))return;e._a=t,e._tzm=function(e,t,r){if(e)return Wg[e];if(t)return 0;var o=parseInt(r,10),n=o%100;return(o-n)/100*60+n}(c[8],c[9],c[10]),e._d=ng.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Hd(e).rfc2822=!0}else e._isValid=!1}function Ug(e,t,r){return null!=e?e:null!=t?t:r}function Yg(e){var t,r,o,n,i,s=[];if(!e._d){for(o=function(e){var t=new Date(wd.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}(e),e._w&&null==e._a[kf]&&null==e._a[Af]&&function(e){var t,r,o,n,i,s,l,a,c;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(i=1,s=4,r=Ug(t.GG,e._a[If],lg(qg(),1,4).year),o=Ug(t.W,1),((n=Ug(t.E,1))<1||n>7)&&(a=!0)):(i=e._locale._week.dow,s=e._locale._week.doy,c=lg(qg(),i,s),r=Ug(t.gg,e._a[If],c.year),o=Ug(t.w,c.week),null!=t.d?((n=t.d)<0||n>6)&&(a=!0):null!=t.e?(n=t.e+i,(t.e<0||t.e>6)&&(a=!0)):n=i);o<1||o>ag(r,i,s)?Hd(e)._overflowWeeks=!0:null!=a?Hd(e)._overflowWeekday=!0:(l=sg(r,o,n,i,s),e._a[If]=l.year,e._dayOfYear=l.dayOfYear)}(e),null!=e._dayOfYear&&(i=Ug(e._a[If],o[If]),(e._dayOfYear>Bf(i)||0===e._dayOfYear)&&(Hd(e)._overflowDayOfYear=!0),r=ng(i,0,e._dayOfYear),e._a[Af]=r.getUTCMonth(),e._a[kf]=r.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=s[t]=o[t];for(;t<7;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[Df]&&0===e._a[Pf]&&0===e._a[Lf]&&0===e._a[Vf]&&(e._nextDay=!0,e._a[Df]=0),e._d=(e._useUTC?ng:og).apply(null,s),n=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Df]=24),e._w&&void 0!==e._w.d&&e._w.d!==n&&(Hd(e).weekdayMismatch=!0)}}function $g(e){if(e._f!==wd.ISO_8601)if(e._f!==wd.RFC_2822){e._a=[],Hd(e).empty=!0;var t,r,o,n,i,s,l,a=""+e._i,c=a.length,h=0;for(l=(o=Zd(e._f,e._locale).match(Yd)||[]).length,t=0;t<l;t++)n=o[t],(r=(a.match(Rf(n,e))||[])[0])&&((i=a.substr(0,a.indexOf(r))).length>0&&Hd(e).unusedInput.push(i),a=a.slice(a.indexOf(r)+r.length),h+=r.length),Xd[n]?(r?Hd(e).empty=!1:Hd(e).unusedTokens.push(n),_f(n,r,e)):e._strict&&!r&&Hd(e).unusedTokens.push(n);Hd(e).charsLeftOver=c-h,a.length>0&&Hd(e).unusedInput.push(a),e._a[Df]<=12&&!0===Hd(e).bigHour&&e._a[Df]>0&&(Hd(e).bigHour=void 0),Hd(e).parsedDateParts=e._a.slice(0),Hd(e).meridiem=e._meridiem,e._a[Df]=function(e,t,r){var o;if(null==r)return t;return null!=e.meridiemHour?e.meridiemHour(t,r):null!=e.isPM?((o=e.isPM(r))&&t<12&&(t+=12),o||12!==t||(t=0),t):t}(e._locale,e._a[Df],e._meridiem),null!==(s=Hd(e).era)&&(e._a[If]=e._locale.erasConvertYear(s,e._a[If])),Yg(e),Ig(e)}else zg(e);else Bg(e)}function Gg(e){var t=e._i,r=e._f;return e._locale=e._locale||Ng(e._l),null===t||void 0===r&&""===t?_d({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),Dd(t)?new kd(Ig(t)):(Td(t)?e._d=t:yd(r)?function(e){var t,r,o,n,i,s,l=!1,a=e._f.length;if(0===a)return Hd(e).invalidFormat=!0,void(e._d=new Date(NaN));for(n=0;n<a;n++)i=0,s=!1,t=Ad({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[n],$g(t),xd(t)&&(s=!0),i+=Hd(t).charsLeftOver,i+=10*Hd(t).unusedTokens.length,Hd(t).score=i,l?i<o&&(o=i,r=t):(null==o||i<o||s)&&(o=i,r=t,s&&(l=!0));Od(e,r||t)}(e):r?$g(e):function(e){var t=e._i;Sd(t)?e._d=new Date(wd.now()):Td(t)?e._d=new Date(t.valueOf()):"string"==typeof t?function(e){var t=Vg.exec(e._i);null===t?(Bg(e),!1===e._isValid&&(delete e._isValid,zg(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:wd.createFromInputFallback(e)))):e._d=new Date(+t[1])}(e):yd(t)?(e._a=Ed(t.slice(0),(function(e){return parseInt(e,10)})),Yg(e)):vd(t)?function(e){if(!e._d){var t=ef(e._i),r=void 0===t.day?t.date:t.day;e._a=Ed([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),Yg(e)}}(e):Rd(t)?e._d=new Date(t):wd.createFromInputFallback(e)}(e),xd(e)||(e._d=null),e))}function Xg(e,t,r,o,n){var i,s={};return!0!==t&&!1!==t||(o=t,t=void 0),!0!==r&&!1!==r||(o=r,r=void 0),(vd(e)&&Cd(e)||yd(e)&&0===e.length)&&(e=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=n,s._l=r,s._i=e,s._f=t,s._strict=o,(i=new kd(Ig(Gg(s))))._nextDay&&(i.add(1,"d"),i._nextDay=void 0),i}function qg(e,t,r,o){return Xg(e,t,r,o,!1)}wd.createFromInputFallback=Ld("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),wd.ISO_8601=function(){},wd.RFC_2822=function(){};var Kg=Ld("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=qg.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:_d()})),Zg=Ld("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=qg.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:_d()}));function Qg(e,t){var r,o;if(1===t.length&&yd(t[0])&&(t=t[0]),!t.length)return qg();for(r=t[0],o=1;o<t.length;++o)t[o].isValid()&&!t[o][e](r)||(r=t[o]);return r}var Jg=["year","quarter","month","week","day","hour","minute","second","millisecond"];function em(e){var t=ef(e),r=t.year||0,o=t.quarter||0,n=t.month||0,i=t.week||t.isoWeek||0,s=t.day||0,l=t.hour||0,a=t.minute||0,c=t.second||0,h=t.millisecond||0;this._isValid=function(e){var t,r,o=!1,n=Jg.length;for(t in e)if(bd(e,t)&&(-1===jf.call(Jg,t)||null!=e[t]&&isNaN(e[t])))return!1;for(r=0;r<n;++r)if(e[Jg[r]]){if(o)return!1;parseFloat(e[Jg[r]])!==Of(e[Jg[r]])&&(o=!0)}return!0}(t),this._milliseconds=+h+1e3*c+6e4*a+1e3*l*60*60,this._days=+s+7*i,this._months=+n+3*o+12*r,this._data={},this._locale=Ng(),this._bubble()}function tm(e){return e instanceof em}function rm(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function om(e,t){qd(e,0,0,(function(){var e=this.utcOffset(),r="+";return e<0&&(e=-e,r="-"),r+Ud(~~(e/60),2)+t+Ud(~~e%60,2)}))}om("Z",":"),om("ZZ",""),Sf("Z",yf),Sf("ZZ",yf),Hf(["Z","ZZ"],(function(e,t,r){r._useUTC=!0,r._tzm=im(yf,e)}));var nm=/([\+\-]|\d\d)/gi;function im(e,t){var r,o,n=(t||"").match(e);return null===n?null:0===(o=60*(r=((n[n.length-1]||[])+"").match(nm)||["-",0,0])[1]+Of(r[2]))?0:"+"===r[0]?o:-o}function sm(e,t){var r,o;return t._isUTC?(r=t.clone(),o=(Dd(e)||Td(e)?e.valueOf():qg(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+o),wd.updateOffset(r,!1),r):qg(e).local()}function lm(e){return-Math.round(e._d.getTimezoneOffset())}function am(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}wd.updateOffset=function(){};var cm=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,hm=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function um(e,t){var r,o,n,i=e,s=null;return tm(e)?i={ms:e._milliseconds,d:e._days,M:e._months}:Rd(e)||!isNaN(+e)?(i={},t?i[t]=+e:i.milliseconds=+e):(s=cm.exec(e))?(r="-"===s[1]?-1:1,i={y:0,d:Of(s[kf])*r,h:Of(s[Df])*r,m:Of(s[Pf])*r,s:Of(s[Lf])*r,ms:Of(rm(1e3*s[Vf]))*r}):(s=hm.exec(e))?(r="-"===s[1]?-1:1,i={y:dm(s[2],r),M:dm(s[3],r),w:dm(s[4],r),d:dm(s[5],r),h:dm(s[6],r),m:dm(s[7],r),s:dm(s[8],r)}):null==i?i={}:"object"==typeof i&&("from"in i||"to"in i)&&(n=function(e,t){var r;if(!e.isValid()||!t.isValid())return{milliseconds:0,months:0};t=sm(t,e),e.isBefore(t)?r=fm(e,t):((r=fm(t,e)).milliseconds=-r.milliseconds,r.months=-r.months);return r}(qg(i.from),qg(i.to)),(i={}).ms=n.milliseconds,i.M=n.months),o=new em(i),tm(e)&&bd(e,"_locale")&&(o._locale=e._locale),tm(e)&&bd(e,"_isValid")&&(o._isValid=e._isValid),o}function dm(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function fm(e,t){var r={};return r.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function gm(e,t){return function(r,o){var n;return null===o||isNaN(+o)||(Wd(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=r,r=o,o=n),mm(this,um(r,o),e),this}}function mm(e,t,r,o){var n=t._milliseconds,i=rm(t._days),s=rm(t._months);e.isValid()&&(o=null==o||o,s&&eg(e,Yf(e,"Month")+s*r),i&&$f(e,"Date",Yf(e,"Date")+i*r),n&&e._d.setTime(e._d.valueOf()+n*r),o&&wd.updateOffset(e,i||s))}um.fn=em.prototype,um.invalid=function(){return um(NaN)};var pm=gm(1,"add"),wm=gm(-1,"subtract");function ym(e){return"string"==typeof e||e instanceof String}function vm(e){return Dd(e)||Td(e)||ym(e)||Rd(e)||function(e){var t=yd(e),r=!1;t&&(r=0===e.filter((function(t){return!Rd(t)&&ym(e)})).length);return t&&r}(e)||function(e){var t,r,o=vd(e)&&!Cd(e),n=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s=i.length;for(t=0;t<s;t+=1)r=i[t],n=n||bd(e,r);return o&&n}(e)||null==e}function bm(e,t){if(e.date()<t.date())return-bm(t,e);var r=12*(t.year()-e.year())+(t.month()-e.month()),o=e.clone().add(r,"months");return-(r+(t-o<0?(t-o)/(o-e.clone().add(r-1,"months")):(t-o)/(e.clone().add(r+1,"months")-o)))||0}function Cm(e){var t;return void 0===e?this._locale._abbr:(null!=(t=Ng(e))&&(this._locale=t),this)}wd.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",wd.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Sm=Ld("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function Rm(){return this._locale}var Tm=1e3,Em=6e4,Om=36e5,Mm=126227808e5;function Hm(e,t){return(e%t+t)%t}function xm(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-Mm:new Date(e,t,r).valueOf()}function _m(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-Mm:Date.UTC(e,t,r)}function Nm(e,t){return t.erasAbbrRegex(e)}function Im(){var e,t,r,o,n,i=[],s=[],l=[],a=[],c=this.eras();for(e=0,t=c.length;e<t;++e)r=Tf(c[e].name),o=Tf(c[e].abbr),n=Tf(c[e].narrow),s.push(r),i.push(o),l.push(n),a.push(r),a.push(o),a.push(n);this._erasRegex=new RegExp("^("+a.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+s.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+l.join("|")+")","i")}function Am(e,t){qd(0,[e,e.length],0,t)}function km(e,t,r,o,n){var i;return null==e?lg(this,o,n).year:(t>(i=ag(e,o,n))&&(t=i),Dm.call(this,e,t,r,o,n))}function Dm(e,t,r,o,n){var i=sg(e,t,r,o,n),s=ng(i.year,0,i.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}qd("N",0,0,"eraAbbr"),qd("NN",0,0,"eraAbbr"),qd("NNN",0,0,"eraAbbr"),qd("NNNN",0,0,"eraName"),qd("NNNNN",0,0,"eraNarrow"),qd("y",["y",1],"yo","eraYear"),qd("y",["yy",2],0,"eraYear"),qd("y",["yyy",3],0,"eraYear"),qd("y",["yyyy",4],0,"eraYear"),Sf("N",Nm),Sf("NN",Nm),Sf("NNN",Nm),Sf("NNNN",(function(e,t){return t.erasNameRegex(e)})),Sf("NNNNN",(function(e,t){return t.erasNarrowRegex(e)})),Hf(["N","NN","NNN","NNNN","NNNNN"],(function(e,t,r,o){var n=r._locale.erasParse(e,o,r._strict);n?Hd(r).era=n:Hd(r).invalidEra=e})),Sf("y",mf),Sf("yy",mf),Sf("yyy",mf),Sf("yyyy",mf),Sf("yo",(function(e,t){return t._eraYearOrdinalRegex||mf})),Hf(["y","yy","yyy","yyyy"],If),Hf(["yo"],(function(e,t,r,o){var n;r._locale._eraYearOrdinalRegex&&(n=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[If]=r._locale.eraYearOrdinalParse(e,n):t[If]=parseInt(e,10)})),qd(0,["gg",2],0,(function(){return this.weekYear()%100})),qd(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),Am("gggg","weekYear"),Am("ggggg","weekYear"),Am("GGGG","isoWeekYear"),Am("GGGGG","isoWeekYear"),Sf("G",pf),Sf("g",pf),Sf("GG",cf,nf),Sf("gg",cf,nf),Sf("GGGG",ff,lf),Sf("gggg",ff,lf),Sf("GGGGG",gf,af),Sf("ggggg",gf,af),xf(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,r,o){t[o.substr(0,2)]=Of(e)})),xf(["gg","GG"],(function(e,t,r,o){t[o]=wd.parseTwoDigitYear(e)})),qd("Q",0,"Qo","quarter"),Sf("Q",of),Hf("Q",(function(e,t){t[Af]=3*(Of(e)-1)})),qd("D",["DD",2],"Do","date"),Sf("D",cf,bf),Sf("DD",cf,nf),Sf("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),Hf(["D","DD"],kf),Hf("Do",(function(e,t){t[kf]=Of(e.match(cf)[0])}));var Pm=Uf("Date",!0);qd("DDD",["DDDD",3],"DDDo","dayOfYear"),Sf("DDD",df),Sf("DDDD",sf),Hf(["DDD","DDDD"],(function(e,t,r){r._dayOfYear=Of(e)})),qd("m",["mm",2],0,"minute"),Sf("m",cf,Cf),Sf("mm",cf,nf),Hf(["m","mm"],Pf);var Lm=Uf("Minutes",!1);qd("s",["ss",2],0,"second"),Sf("s",cf,Cf),Sf("ss",cf,nf),Hf(["s","ss"],Lf);var Vm,Fm,Wm=Uf("Seconds",!1);for(qd("S",0,0,(function(){return~~(this.millisecond()/100)})),qd(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),qd(0,["SSS",3],0,"millisecond"),qd(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),qd(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),qd(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),qd(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),qd(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),qd(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),Sf("S",df,of),Sf("SS",df,nf),Sf("SSS",df,sf),Vm="SSSS";Vm.length<=9;Vm+="S")Sf(Vm,mf);function Bm(e,t){t[Vf]=Of(1e3*("0."+e))}for(Vm="S";Vm.length<=9;Vm+="S")Hf(Vm,Bm);Fm=Uf("Milliseconds",!1),qd("z",0,0,"zoneAbbr"),qd("zz",0,0,"zoneName");var jm=kd.prototype;function zm(e){return e}jm.add=pm,jm.calendar=function(e,t){1===arguments.length&&(arguments[0]?vm(arguments[0])?(e=arguments[0],t=void 0):function(e){var t,r=vd(e)&&!Cd(e),o=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<n.length;t+=1)o=o||bd(e,n[t]);return r&&o}(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||qg(),o=sm(r,this).startOf("day"),n=wd.calendarFormat(this,o)||"sameElse",i=t&&(Bd(t[n])?t[n].call(this,r):t[n]);return this.format(i||this.localeData().calendar(n,this,qg(r)))},jm.clone=function(){return new kd(this)},jm.diff=function(e,t,r){var o,n,i;if(!this.isValid())return NaN;if(!(o=sm(e,this)).isValid())return NaN;switch(n=6e4*(o.utcOffset()-this.utcOffset()),t=Jd(t)){case"year":i=bm(this,o)/12;break;case"month":i=bm(this,o);break;case"quarter":i=bm(this,o)/3;break;case"second":i=(this-o)/1e3;break;case"minute":i=(this-o)/6e4;break;case"hour":i=(this-o)/36e5;break;case"day":i=(this-o-n)/864e5;break;case"week":i=(this-o-n)/6048e5;break;default:i=this-o}return r?i:Ef(i)},jm.endOf=function(e){var t,r;if(void 0===(e=Jd(e))||"millisecond"===e||!this.isValid())return this;switch(r=this._isUTC?_m:xm,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=Om-Hm(t+(this._isUTC?0:this.utcOffset()*Em),Om)-1;break;case"minute":t=this._d.valueOf(),t+=Em-Hm(t,Em)-1;break;case"second":t=this._d.valueOf(),t+=Tm-Hm(t,Tm)-1}return this._d.setTime(t),wd.updateOffset(this,!0),this},jm.format=function(e){e||(e=this.isUtc()?wd.defaultFormatUtc:wd.defaultFormat);var t=Kd(this,e);return this.localeData().postformat(t)},jm.from=function(e,t){return this.isValid()&&(Dd(e)&&e.isValid()||qg(e).isValid())?um({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},jm.fromNow=function(e){return this.from(qg(),e)},jm.to=function(e,t){return this.isValid()&&(Dd(e)&&e.isValid()||qg(e).isValid())?um({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},jm.toNow=function(e){return this.to(qg(),e)},jm.get=function(e){return Bd(this[e=Jd(e)])?this[e]():this},jm.invalidAt=function(){return Hd(this).overflow},jm.isAfter=function(e,t){var r=Dd(e)?e:qg(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=Jd(t)||"millisecond")?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf())},jm.isBefore=function(e,t){var r=Dd(e)?e:qg(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=Jd(t)||"millisecond")?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf())},jm.isBetween=function(e,t,r,o){var n=Dd(e)?e:qg(e),i=Dd(t)?t:qg(t);return!!(this.isValid()&&n.isValid()&&i.isValid())&&(("("===(o=o||"()")[0]?this.isAfter(n,r):!this.isBefore(n,r))&&(")"===o[1]?this.isBefore(i,r):!this.isAfter(i,r)))},jm.isSame=function(e,t){var r,o=Dd(e)?e:qg(e);return!(!this.isValid()||!o.isValid())&&("millisecond"===(t=Jd(t)||"millisecond")?this.valueOf()===o.valueOf():(r=o.valueOf(),this.clone().startOf(t).valueOf()<=r&&r<=this.clone().endOf(t).valueOf()))},jm.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},jm.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},jm.isValid=function(){return xd(this)},jm.lang=Sm,jm.locale=Cm,jm.localeData=Rm,jm.max=Zg,jm.min=Kg,jm.parsingFlags=function(){return Od({},Hd(this))},jm.set=function(e,t){if("object"==typeof e){var r,o=function(e){var t,r=[];for(t in e)bd(e,t)&&r.push({unit:t,priority:tf[t]});return r.sort((function(e,t){return e.priority-t.priority})),r}(e=ef(e)),n=o.length;for(r=0;r<n;r++)this[o[r].unit](e[o[r].unit])}else if(Bd(this[e=Jd(e)]))return this[e](t);return this},jm.startOf=function(e){var t,r;if(void 0===(e=Jd(e))||"millisecond"===e||!this.isValid())return this;switch(r=this._isUTC?_m:xm,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=Hm(t+(this._isUTC?0:this.utcOffset()*Em),Om);break;case"minute":t=this._d.valueOf(),t-=Hm(t,Em);break;case"second":t=this._d.valueOf(),t-=Hm(t,Tm)}return this._d.setTime(t),wd.updateOffset(this,!0),this},jm.subtract=wm,jm.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},jm.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},jm.toDate=function(){return new Date(this.valueOf())},jm.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?Kd(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Bd(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",Kd(r,"Z")):Kd(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},jm.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,r,o="moment",n="";return this.isLocal()||(o=0===this.utcOffset()?"moment.utc":"moment.parseZone",n="Z"),e="["+o+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r=n+'[")]',this.format(e+t+"-MM-DD[T]HH:mm:ss.SSS"+r)},"undefined"!=typeof Symbol&&null!=Symbol.for&&(jm[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),jm.toJSON=function(){return this.isValid()?this.toISOString():null},jm.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},jm.unix=function(){return Math.floor(this.valueOf()/1e3)},jm.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},jm.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},jm.eraName=function(){var e,t,r,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e){if(r=this.clone().startOf("day").valueOf(),o[e].since<=r&&r<=o[e].until)return o[e].name;if(o[e].until<=r&&r<=o[e].since)return o[e].name}return""},jm.eraNarrow=function(){var e,t,r,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e){if(r=this.clone().startOf("day").valueOf(),o[e].since<=r&&r<=o[e].until)return o[e].narrow;if(o[e].until<=r&&r<=o[e].since)return o[e].narrow}return""},jm.eraAbbr=function(){var e,t,r,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e){if(r=this.clone().startOf("day").valueOf(),o[e].since<=r&&r<=o[e].until)return o[e].abbr;if(o[e].until<=r&&r<=o[e].since)return o[e].abbr}return""},jm.eraYear=function(){var e,t,r,o,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=n[e].since<=n[e].until?1:-1,o=this.clone().startOf("day").valueOf(),n[e].since<=o&&o<=n[e].until||n[e].until<=o&&o<=n[e].since)return(this.year()-wd(n[e].since).year())*r+n[e].offset;return this.year()},jm.year=zf,jm.isLeapYear=function(){return Nf(this.year())},jm.weekYear=function(e){return km.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)},jm.isoWeekYear=function(e){return km.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},jm.quarter=jm.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},jm.month=tg,jm.daysInMonth=function(){return Gf(this.year(),this.month())},jm.week=jm.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},jm.isoWeek=jm.isoWeeks=function(e){var t=lg(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},jm.weeksInYear=function(){var e=this.localeData()._week;return ag(this.year(),e.dow,e.doy)},jm.weeksInWeekYear=function(){var e=this.localeData()._week;return ag(this.weekYear(),e.dow,e.doy)},jm.isoWeeksInYear=function(){return ag(this.year(),1,4)},jm.isoWeeksInISOWeekYear=function(){return ag(this.isoWeekYear(),1,4)},jm.date=Pm,jm.day=jm.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t=Yf(this,"Day");return null!=e?(e=function(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}(e,this.localeData()),this.add(e-t,"d")):t},jm.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},jm.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=function(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7},jm.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},jm.hour=jm.hours=Cg,jm.minute=jm.minutes=Lm,jm.second=jm.seconds=Wm,jm.millisecond=jm.milliseconds=Fm,jm.utcOffset=function(e,t,r){var o,n=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=im(yf,e)))return this}else Math.abs(e)<16&&!r&&(e*=60);return!this._isUTC&&t&&(o=lm(this)),this._offset=e,this._isUTC=!0,null!=o&&this.add(o,"m"),n!==e&&(!t||this._changeInProgress?mm(this,um(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,wd.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?n:lm(this)},jm.utc=function(e){return this.utcOffset(0,e)},jm.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(lm(this),"m")),this},jm.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=im(wf,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},jm.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?qg(e).utcOffset():0,(this.utcOffset()-e)%60==0)},jm.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},jm.isLocal=function(){return!!this.isValid()&&!this._isUTC},jm.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},jm.isUtc=am,jm.isUTC=am,jm.zoneAbbr=function(){return this._isUTC?"UTC":""},jm.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},jm.dates=Ld("dates accessor is deprecated. Use date instead.",Pm),jm.months=Ld("months accessor is deprecated. Use month instead",tg),jm.years=Ld("years accessor is deprecated. Use year instead",zf),jm.zone=Ld("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()})),jm.isDSTShifted=Ld("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!Sd(this._isDSTShifted))return this._isDSTShifted;var e,t={};return Ad(t,this),(t=Gg(t))._a?(e=t._isUTC?Md(t._a):qg(t._a),this._isDSTShifted=this.isValid()&&function(e,t,r){var o,n=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),s=0;for(o=0;o<n;o++)(r&&e[o]!==t[o]||!r&&Of(e[o])!==Of(t[o]))&&s++;return s+i}(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}));var Um=zd.prototype;function Ym(e,t,r,o){var n=Ng(),i=Md().set(o,t);return n[r](i,e)}function $m(e,t,r){if(Rd(e)&&(t=e,e=void 0),e=e||"",null!=t)return Ym(e,t,r,"month");var o,n=[];for(o=0;o<12;o++)n[o]=Ym(e,o,r,"month");return n}function Gm(e,t,r,o){"boolean"==typeof e?(Rd(t)&&(r=t,t=void 0),t=t||""):(r=t=e,e=!1,Rd(t)&&(r=t,t=void 0),t=t||"");var n,i=Ng(),s=e?i._week.dow:0,l=[];if(null!=r)return Ym(t,(r+s)%7,o,"day");for(n=0;n<7;n++)l[n]=Ym(t,(n+s)%7,o,"day");return l}Um.calendar=function(e,t,r){var o=this._calendar[e]||this._calendar.sameElse;return Bd(o)?o.call(t,r):o},Um.longDateFormat=function(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(Yd).map((function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e})).join(""),this._longDateFormat[e])},Um.invalidDate=function(){return this._invalidDate},Um.ordinal=function(e){return this._ordinal.replace("%d",e)},Um.preparse=zm,Um.postformat=zm,Um.relativeTime=function(e,t,r,o){var n=this._relativeTime[r];return Bd(n)?n(e,t,r,o):n.replace(/%d/i,e)},Um.pastFuture=function(e,t){var r=this._relativeTime[e>0?"future":"past"];return Bd(r)?r(t):r.replace(/%s/i,t)},Um.set=function(e){var t,r;for(r in e)bd(e,r)&&(Bd(t=e[r])?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},Um.eras=function(e,t){var r,o,n,i=this._eras||Ng("en")._eras;for(r=0,o=i.length;r<o;++r){if("string"==typeof i[r].since)n=wd(i[r].since).startOf("day"),i[r].since=n.valueOf();switch(typeof i[r].until){case"undefined":i[r].until=Infinity;break;case"string":n=wd(i[r].until).startOf("day").valueOf(),i[r].until=n.valueOf()}}return i},Um.erasParse=function(e,t,r){var o,n,i,s,l,a=this.eras();for(e=e.toUpperCase(),o=0,n=a.length;o<n;++o)if(i=a[o].name.toUpperCase(),s=a[o].abbr.toUpperCase(),l=a[o].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(s===e)return a[o];break;case"NNNN":if(i===e)return a[o];break;case"NNNNN":if(l===e)return a[o]}else if([i,s,l].indexOf(e)>=0)return a[o]},Um.erasConvertYear=function(e,t){var r=e.since<=e.until?1:-1;return void 0===t?wd(e.since).year():wd(e.since).year()+(t-e.offset)*r},Um.erasAbbrRegex=function(e){return bd(this,"_erasAbbrRegex")||Im.call(this),e?this._erasAbbrRegex:this._erasRegex},Um.erasNameRegex=function(e){return bd(this,"_erasNameRegex")||Im.call(this),e?this._erasNameRegex:this._erasRegex},Um.erasNarrowRegex=function(e){return bd(this,"_erasNarrowRegex")||Im.call(this),e?this._erasNarrowRegex:this._erasRegex},Um.months=function(e,t){return e?yd(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Kf).test(t)?"format":"standalone"][e.month()]:yd(this._months)?this._months:this._months.standalone},Um.monthsShort=function(e,t){return e?yd(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Kf.test(t)?"format":"standalone"][e.month()]:yd(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},Um.monthsParse=function(e,t,r){var o,n,i;if(this._monthsParseExact)return Jf.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),o=0;o<12;o++){if(n=Md([2e3,o]),r&&!this._longMonthsParse[o]&&(this._longMonthsParse[o]=new RegExp("^"+this.months(n,"").replace(".","")+"$","i"),this._shortMonthsParse[o]=new RegExp("^"+this.monthsShort(n,"").replace(".","")+"$","i")),r||this._monthsParse[o]||(i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[o]=new RegExp(i.replace(".",""),"i")),r&&"MMMM"===t&&this._longMonthsParse[o].test(e))return o;if(r&&"MMM"===t&&this._shortMonthsParse[o].test(e))return o;if(!r&&this._monthsParse[o].test(e))return o}},Um.monthsRegex=function(e){return this._monthsParseExact?(bd(this,"_monthsRegex")||rg.call(this),e?this._monthsStrictRegex:this._monthsRegex):(bd(this,"_monthsRegex")||(this._monthsRegex=Qf),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},Um.monthsShortRegex=function(e){return this._monthsParseExact?(bd(this,"_monthsRegex")||rg.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(bd(this,"_monthsShortRegex")||(this._monthsShortRegex=Zf),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},Um.week=function(e){return lg(e,this._week.dow,this._week.doy).week},Um.firstDayOfYear=function(){return this._week.doy},Um.firstDayOfWeek=function(){return this._week.dow},Um.weekdays=function(e,t){var r=yd(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?cg(r,this._week.dow):e?r[e.day()]:r},Um.weekdaysMin=function(e){return!0===e?cg(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin},Um.weekdaysShort=function(e){return!0===e?cg(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort},Um.weekdaysParse=function(e,t,r){var o,n,i;if(this._weekdaysParseExact)return pg.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),o=0;o<7;o++){if(n=Md([2e3,1]).day(o),r&&!this._fullWeekdaysParse[o]&&(this._fullWeekdaysParse[o]=new RegExp("^"+this.weekdays(n,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[o]=new RegExp("^"+this.weekdaysShort(n,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[o]=new RegExp("^"+this.weekdaysMin(n,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[o]||(i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[o]=new RegExp(i.replace(".",""),"i")),r&&"dddd"===t&&this._fullWeekdaysParse[o].test(e))return o;if(r&&"ddd"===t&&this._shortWeekdaysParse[o].test(e))return o;if(r&&"dd"===t&&this._minWeekdaysParse[o].test(e))return o;if(!r&&this._weekdaysParse[o].test(e))return o}},Um.weekdaysRegex=function(e){return this._weekdaysParseExact?(bd(this,"_weekdaysRegex")||wg.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(bd(this,"_weekdaysRegex")||(this._weekdaysRegex=fg),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},Um.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(bd(this,"_weekdaysRegex")||wg.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(bd(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=gg),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},Um.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(bd(this,"_weekdaysRegex")||wg.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(bd(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=mg),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},Um.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},Um.meridiem=function(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"},xg("en",{eras:[{since:"0001-01-01",until:Infinity,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-Infinity,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===Of(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),wd.lang=Ld("moment.lang is deprecated. Use moment.locale instead.",xg),wd.langData=Ld("moment.langData is deprecated. Use moment.localeData instead.",Ng);var Xm=Math.abs;function qm(e,t,r,o){var n=um(t,r);return e._milliseconds+=o*n._milliseconds,e._days+=o*n._days,e._months+=o*n._months,e._bubble()}function Km(e){return e<0?Math.floor(e):Math.ceil(e)}function Zm(e){return 4800*e/146097}function Qm(e){return 146097*e/4800}function Jm(e){return function(){return this.as(e)}}var ep=Jm("ms"),tp=Jm("s"),rp=Jm("m"),op=Jm("h"),np=Jm("d"),ip=Jm("w"),sp=Jm("M"),lp=Jm("Q"),ap=Jm("y"),cp=ep;function hp(e){return function(){return this.isValid()?this._data[e]:NaN}}var up=hp("milliseconds"),dp=hp("seconds"),fp=hp("minutes"),gp=hp("hours"),mp=hp("days"),pp=hp("months"),wp=hp("years");var yp=Math.round,vp={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function bp(e,t,r,o,n){return n.relativeTime(t||1,!!r,e,o)}var Cp=Math.abs;function Sp(e){return(e>0)-(e<0)||+e}function Rp(){if(!this.isValid())return this.localeData().invalidDate();var e,t,r,o,n,i,s,l,a=Cp(this._milliseconds)/1e3,c=Cp(this._days),h=Cp(this._months),u=this.asSeconds();return u?(e=Ef(a/60),t=Ef(e/60),a%=60,e%=60,r=Ef(h/12),h%=12,o=a?a.toFixed(3).replace(/\.?0+$/,""):"",n=u<0?"-":"",i=Sp(this._months)!==Sp(u)?"-":"",s=Sp(this._days)!==Sp(u)?"-":"",l=Sp(this._milliseconds)!==Sp(u)?"-":"",n+"P"+(r?i+r+"Y":"")+(h?i+h+"M":"")+(c?s+c+"D":"")+(t||e||a?"T":"")+(t?l+t+"H":"")+(e?l+e+"M":"")+(a?l+o+"S":"")):"P0D"}var Tp=em.prototype;function Ep(e,t){const r=t.length;let o=0;for(;o<r;)e.push(t[o]),o+=1}function Op(e){const t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;const r=e.length,o=e[0].length;for(let n=0;n<r;n++)for(let r=0;r<o;r++)t[r]||(t[r]=[]),t[r][n]=e[n][r];return t}function Mp(e,t,r,o){let n=-1,i=e,s=r;Array.isArray(e)||(i=Array.from(e));const l=i.length;for(o&&l&&(n+=1,s=i[n]),n+=1;n<l;)s=t(s,i[n],n,i),n+=1;return s}function Hp(e,t){let r=0,o=e;Array.isArray(e)||(o=Array.from(e));const n=o.length,i=[];let s=-1;for(;r<n;){const e=o[r];t(e,r,o)&&(s+=1,i[s]=e),r+=1}return i}function xp(e,t){let r=0,o=e;Array.isArray(e)||(o=Array.from(e));const n=o.length,i=[];let s=-1;for(;r<n;){const e=o[r];s+=1,i[s]=t(e,r,o),r+=1}return i}function _p(e,t){let r=0,o=e;Array.isArray(e)||(o=Array.from(e));const n=o.length;for(;r<n&&!1!==t(o[r],r,o);)r+=1;return e}function Np(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[o,...n]=[...t];let i=o;return _p(n,(e=>{i=i.filter((t=>!e.includes(t)))})),i}function Ip(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}function Ap(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return Mp(e,((e,t,o)=>e+t.replace(/\r?\n\s*/g,"")+(r[o]?r[o]:"")),"").trim()}function kp(e){let t;switch(typeof e){case"string":case"number":t=`${e}`;break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function Dp(e){return void 0!==e}function Pp(e){return void 0===e}function Lp(e){return null===e||""===e||Pp(e)}Tp.isValid=function(){return this._isValid},Tp.abs=function(){var e=this._data;return this._milliseconds=Xm(this._milliseconds),this._days=Xm(this._days),this._months=Xm(this._months),e.milliseconds=Xm(e.milliseconds),e.seconds=Xm(e.seconds),e.minutes=Xm(e.minutes),e.hours=Xm(e.hours),e.months=Xm(e.months),e.years=Xm(e.years),this},Tp.add=function(e,t){return qm(this,e,t,1)},Tp.subtract=function(e,t){return qm(this,e,t,-1)},Tp.as=function(e){if(!this.isValid())return NaN;var t,r,o=this._milliseconds;if("month"===(e=Jd(e))||"quarter"===e||"year"===e)switch(t=this._days+o/864e5,r=this._months+Zm(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(Qm(this._months)),e){case"week":return t/7+o/6048e5;case"day":return t+o/864e5;case"hour":return 24*t+o/36e5;case"minute":return 1440*t+o/6e4;case"second":return 86400*t+o/1e3;case"millisecond":return Math.floor(864e5*t)+o;default:throw new Error("Unknown unit "+e)}},Tp.asMilliseconds=ep,Tp.asSeconds=tp,Tp.asMinutes=rp,Tp.asHours=op,Tp.asDays=np,Tp.asWeeks=ip,Tp.asMonths=sp,Tp.asQuarters=lp,Tp.asYears=ap,Tp.valueOf=cp,Tp._bubble=function(){var e,t,r,o,n,i=this._milliseconds,s=this._days,l=this._months,a=this._data;return i>=0&&s>=0&&l>=0||i<=0&&s<=0&&l<=0||(i+=864e5*Km(Qm(l)+s),s=0,l=0),a.milliseconds=i%1e3,e=Ef(i/1e3),a.seconds=e%60,t=Ef(e/60),a.minutes=t%60,r=Ef(t/60),a.hours=r%24,s+=Ef(r/24),l+=n=Ef(Zm(s)),s-=Km(Qm(n)),o=Ef(l/12),l%=12,a.days=s,a.months=l,a.years=o,this},Tp.clone=function(){return um(this)},Tp.get=function(e){return e=Jd(e),this.isValid()?this[e+"s"]():NaN},Tp.milliseconds=up,Tp.seconds=dp,Tp.minutes=fp,Tp.hours=gp,Tp.days=mp,Tp.weeks=function(){return Ef(this.days()/7)},Tp.months=pp,Tp.years=wp,Tp.humanize=function(e,t){if(!this.isValid())return this.localeData().invalidDate();var r,o,n=!1,i=vp;return"object"==typeof e&&(t=e,e=!1),"boolean"==typeof e&&(n=e),"object"==typeof t&&(i=Object.assign({},vp,t),null!=t.s&&null==t.ss&&(i.ss=t.s-1)),o=function(e,t,r,o){var n=um(e).abs(),i=yp(n.as("s")),s=yp(n.as("m")),l=yp(n.as("h")),a=yp(n.as("d")),c=yp(n.as("M")),h=yp(n.as("w")),u=yp(n.as("y")),d=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||s<=1&&["m"]||s<r.m&&["mm",s]||l<=1&&["h"]||l<r.h&&["hh",l]||a<=1&&["d"]||a<r.d&&["dd",a];return null!=r.w&&(d=d||h<=1&&["w"]||h<r.w&&["ww",h]),(d=d||c<=1&&["M"]||c<r.M&&["MM",c]||u<=1&&["y"]||["yy",u])[2]=t,d[3]=+e>0,d[4]=o,bp.apply(null,d)}(this,!n,i,r=this.localeData()),n&&(o=r.pastFuture(+this,o)),r.postformat(o)},Tp.toISOString=Rp,Tp.toString=Rp,Tp.toJSON=Rp,Tp.locale=Cm,Tp.localeData=Rm,Tp.toIsoString=Ld("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Rp),Tp.lang=Sm,qd("X",0,0,"unix"),qd("x",0,0,"valueOf"),Sf("x",pf),Sf("X",/[+-]?\d+(\.\d{1,3})?/),Hf("X",(function(e,t,r){r._d=new Date(1e3*parseFloat(e))})),Hf("x",(function(e,t,r){r._d=new Date(Of(e))})),
//! moment.js
wd.version="2.30.1",gd=qg,wd.fn=jm,wd.min=function(){return Qg("isBefore",[].slice.call(arguments,0))},wd.max=function(){return Qg("isAfter",[].slice.call(arguments,0))},wd.now=function(){return Date.now?Date.now():+new Date},wd.utc=Md,wd.unix=function(e){return qg(1e3*e)},wd.months=function(e,t){return $m(e,t,"months")},wd.isDate=Td,wd.locale=xg,wd.invalid=_d,wd.duration=um,wd.isMoment=Dd,wd.weekdays=function(e,t,r){return Gm(e,t,r,"weekdays")},wd.parseZone=function(){return qg.apply(null,arguments).parseZone()},wd.localeData=Ng,wd.isDuration=tm,wd.monthsShort=function(e,t){return $m(e,t,"monthsShort")},wd.weekdaysMin=function(e,t,r){return Gm(e,t,r,"weekdaysMin")},wd.defineLocale=_g,wd.updateLocale=function(e,t){if(null!=t){var r,o,n=Rg;null!=Tg[e]&&null!=Tg[e].parentLocale?Tg[e].set(jd(Tg[e]._config,t)):(null!=(o=Hg(e))&&(n=o._config),t=jd(n,t),null==o&&(t.abbr=e),(r=new zd(t)).parentLocale=Tg[e],Tg[e]=r),xg(e)}else null!=Tg[e]&&(null!=Tg[e].parentLocale?(Tg[e]=Tg[e].parentLocale,e===xg()&&xg(e)):null!=Tg[e]&&delete Tg[e]);return Tg[e]},wd.locales=function(){return Vd(Tg)},wd.weekdaysShort=function(e,t,r){return Gm(e,t,r,"weekdaysShort")},wd.normalizeUnits=Jd,wd.relativeTimeRounding=function(e){return void 0===e?yp:"function"==typeof e&&(yp=e,!0)},wd.relativeTimeThreshold=function(e,t){return void 0!==vp[e]&&(void 0===t?vp[e]:(vp[e]=t,"s"===e&&(vp.ss=t-1),!0))},wd.calendarFormat=function(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"},wd.prototype=jm,wd.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Vp="length",Fp=e=>parseInt(e,16),Wp=e=>parseInt(e,10),Bp=(e,t,r)=>e.substr(t,r),jp=e=>e.codePointAt(0)-65,zp=e=>`${e}`.replace(/\-/g,"");let Up=!1;const Yp={invalid:()=>Ap`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:e=>{let{keyValidityDate:t,hotVersion:r}=e;return Ap`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${t}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Ap`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},$p={invalid:()=>Ap`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:e=>{let{keyValidityDate:t,hotVersion:r}=e;return Ap`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${t}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Ap`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function Gp(e,t){const r=!Lp(e),o="string"==typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),n="15.0.0";let i,s="invalid",l="invalid";const a=function(e){let t=[][Vp],r=t;if(e[Vp]!==jp("Z"))return!1;for(let o="",n="B<H4P+".split(""),i=jp(n.shift());i;i=jp(n.shift()||"A"))--i<""[Vp]?r|=(Wp(`${Wp(Fp(o)+(Fp(Bp(e,Math.abs(i),2))+[]).padStart(2,"0"))}`)%97||2)>>1:o=Bp(e,i,i?1===n[Vp]?9:8:6);return r===t}(e=zp(e||""));if(r||o||a)if(a){const t=wd("16/12/2024","DD/MM/YYYY"),r=Math.floor(t.toDate().getTime()/864e5),o=Fp(Bp(zp(c=e),Fp("12"),jp("F")))/(Fp(Bp(zp(c),jp("B"),~~![][Vp]))||9);i=wd(864e5*(o+1),"x").format("MMMM DD, YYYY"),r>o?(s="expired",l="expired"):(s="valid",l="valid")}else o?(s="non_commercial",l="valid"):(s="invalid",l="invalid");else s="missing",l="missing";var c;if("undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)&&(s="valid",l="valid"),!Up&&"valid"!==s){Yp[s]({keyValidityDate:i,hotVersion:n});Up=!0}if("valid"!==l&&t.parentNode){if($p[l]({keyValidityDate:i,hotVersion:n})){const e=document.createElement("div");e.className="handsontable hot-display-license-info",e.innerHTML=$p[l]({keyValidityDate:i,hotVersion:n}),t.parentNode.insertBefore(e,t.nextSibling)}}}function Xp(e){return e[0].toUpperCase()+e.substr(1)}function qp(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}const Kp=e=>["tabindex",e],Zp=e=>["aria-rowcount",e],Qp=e=>["aria-colcount",e],Jp=e=>["aria-rowindex",e],ew=e=>["aria-colindex",e];function tw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=-1,o=null,n=e;for(;null!==n;){if(r===t){o=n;break}n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n=n.host:(r+=1,n=n.parentNode)}return o}function rw(e){return function(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}(e)&&e.parent}function ow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:o,DOCUMENT_FRAGMENT_NODE:n}=Node;let i=e;for(;null!=i&&i!==r;){const{nodeType:e,nodeName:r}=i;if(e===o&&(t.includes(r)||t.includes(i)))return i;const{host:s}=i;i=s&&e===n?s:i.parentNode}return null}function nw(e,t,r){const o=[];let n=e;for(;n&&(n=ow(n,t,r),n&&(!r||r.contains(n)));)o.push(n),n=n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.host:n.parentNode;const i=o.length;return i?o[i-1]:null}function iw(e,t){let r=e.parentNode,o=[];for("string"==typeof t?o=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):o.push(t);null!==r;){if(o.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function sw(e,t,r){const o=r.parentElement.querySelector(`.ht_clone_${e}`);return o?o.contains(t):null}function lw(e){return e&&e.length?e.filter((e=>!!e)):[]}function aw(e,t){if(!e||!e.length)return t?{regexFree:[],regexes:[]}:[];const r=[],o=[];return o.push(...e.filter((e=>{const o=e instanceof RegExp;return o&&t&&r.push(e),!o}))),t?{regexFree:o,regexes:r}:o}function cw(e,t){return void 0!==e.classList&&"string"==typeof t&&""!==t&&e.classList.contains(t)}function hw(e,t){"string"==typeof t&&(t=t.split(" ")),(t=lw(t)).length>0&&e.classList.add(...t)}function uw(e,t){"string"==typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);let{regexFree:r,regexes:o}=aw(t,!0);r=lw(r),r.length>0&&e.classList.remove(...r),o.forEach((t=>{e.classList.forEach((r=>{t.test(r)&&e.classList.remove(r)}))}))}function dw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(t)||(t=[[t,r]]),t.forEach((t=>{Array.isArray(t)&&""!==t[0]&&e.setAttribute(...t)}))}function fw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);const{regexFree:r,regexes:o}=aw(t,!0);r.forEach((t=>{""!==t&&e.removeAttribute(t)})),o.forEach((t=>{e.getAttributeNames().forEach((r=>{t.test(r)&&e.removeAttribute(r)}))}))}function gw(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){const t=e.childNodes;for(let e=t.length-1;e>=0;e--)gw(t[e])}}function mw(e){let t;for(;t=e.lastChild;)e.removeChild(t)}const pw=/(<(.*)>|&(.*);)/;function ww(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var o,n;pw.test(t)?e.innerHTML=r?(o=t,pd.sanitize(o,n)):t:yw(e,t)}function yw(e,t){const r=e.firstChild;r&&3===r.nodeType&&null===r.nextSibling?r.textContent=t:(mw(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function vw(e){const t=e.ownerDocument.documentElement,r=e.ownerDocument.defaultView;let o=e;for(;o!==t;){if(null===o)return!1;if(o.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(o.host){if(o.host.impl)return vw(o.host.impl);if(o.host)return vw(o.host);throw new Error("Lost in Web Components world")}return!1}if("none"===r.getComputedStyle(o).display)return!1;o=o.parentNode}return!0}function bw(e){const t=e.ownerDocument,r=t.defaultView,o=t.documentElement;let n,i,s,l=e;for(n=l.offsetLeft,i=l.offsetTop,s=l;(l=l.offsetParent)&&l!==t.body&&"offsetLeft"in l;)n+=l.offsetLeft,i+=l.offsetTop,s=l;return s&&"fixed"===s.style.position&&(n+=r.pageXOffset||o.scrollLeft,i+=r.pageYOffset||o.scrollTop),{left:n,top:i}}function Cw(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollY}function Sw(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollX}function Rw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?Cw(t):e.scrollTop}function Tw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?Sw(t):e.scrollLeft}function Ew(e){let t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);const o=["auto","scroll"];let n=e.parentNode;for(;n&&n.style&&t.body!==n;){let{overflow:e,overflowX:t,overflowY:i}=n.style;if([e,t,i].includes("scroll"))return n;if(({overflow:e,overflowX:t,overflowY:i}=r.getComputedStyle(n)),o.includes(e)||o.includes(t)||o.includes(i))return n;if(n.clientHeight<=n.scrollHeight+1&&(o.includes(i)||o.includes(e)))return n;if(n.clientWidth<=n.scrollWidth+1&&(o.includes(t)||o.includes(e)))return n;n=n.parentNode}return r}function Ow(e){const t=e.ownerDocument,r=t.defaultView;let o=e.parentNode;for(;o&&o.style&&t.body!==o;){if("visible"!==o.style.overflow&&""!==o.style.overflow)return o;const e=r.getComputedStyle(o),t=["scroll","hidden","auto"],n=e.getPropertyValue("overflow"),i=e.getPropertyValue("overflow-y"),s=e.getPropertyValue("overflow-x");if(t.includes(n)||t.includes(i)||t.includes(s))return o;o=o.parentNode}return r}function Mw(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!e)return;if(e===r)return"width"===t?`${r.innerWidth}px`:"height"===t?`${r.innerHeight}px`:void 0;const o=e.style[t];if(""!==o&&void 0!==o)return o;const n=r.getComputedStyle(e);return""!==n[t]&&void 0!==n[t]?n[t]:void 0}function Hw(e){return e.offsetWidth}function xw(e){return e.offsetHeight}function _w(e){return e.clientHeight||e.innerHeight}function Nw(e){return e.clientWidth||e.innerWidth}function Iw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;e.getSelection&&(e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges())}function Aw(e,t,r){if(void 0===r&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch(o){const n=e.parentNode,i=n.style.display;n.style.display="block",e.setSelectionRange(t,r),n.style.display=i}}}let kw;function Dw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===kw&&(kw=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const t=e.createElement("div");t.style.height="200px",t.style.width="100%";const r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);const o=t.offsetWidth;r.style.overflow="scroll";let n=t.offsetWidth;return o===n&&(n=r.clientWidth),(e.body||e.documentElement).removeChild(r),o-n}(e)),kw}function Pw(e,t,r){e.style.transform=`translate3d(${t},${r},0)`}function Lw(e){e.style.transform&&""!==e.style.transform&&(e.style.transform="")}function Vw(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function Fw(e){return Vw(e)&&!1===e.hasAttribute("data-hot-input")}function Ww(e){return"function"==typeof e}function Bw(e,t,r,o,n,i,s,l){return Dp(l)?e.call(t,r,o,n,i,s,l):Dp(s)?e.call(t,r,o,n,i,s):Dp(i)?e.call(t,r,o,n,i):Dp(n)?e.call(t,r,o,n):Dp(o)?e.call(t,r,o):Dp(r)?e.call(t,r):e.call(t)}var jw=_i,zw=oe,Uw=z,Yw=Xn,$w=F([].push),Gw=pn,Xw=ae,qw=Cn,Kw=M,Zw=F,Qw=S,Jw=oe,ey=He,ty=mh,ry=function(e){if(zw(e))return e;if(jw(e)){for(var t=e.length,r=[],o=0;o<t;o++){var n=e[o];"string"==typeof n?$w(r,n):"number"!=typeof n&&"Number"!==Uw(n)&&"String"!==Uw(n)||$w(r,Yw(n))}var i=r.length,s=!0;return function(e,t){if(s)return s=!1,t;if(jw(this))return t;for(var o=0;o<i;o++)if(r[o]===e)return t}}},oy=Se,ny=String,iy=Xw("JSON","stringify"),sy=Zw(/./.exec),ly=Zw("".charAt),ay=Zw("".charCodeAt),cy=Zw("".replace),hy=Zw(1..toString),uy=/[\uD800-\uDFFF]/g,dy=/^[\uD800-\uDBFF]$/,fy=/^[\uDC00-\uDFFF]$/,gy=!oy||Qw((function(){var e=Xw("Symbol")("stringify detection");return"[null]"!==iy([e])||"{}"!==iy({a:e})||"{}"!==iy(Object(e))})),my=Qw((function(){return'"\\udf06\\ud834"'!==iy("\udf06\ud834")||'"\\udead"'!==iy("\udead")})),py=function(e,t){var r=ty(arguments),o=ry(t);if(Jw(o)||void 0!==e&&!ey(e))return r[1]=function(e,t){if(Jw(o)&&(t=Kw(o,this,ny(e),t)),!ey(t))return t},qw(iy,null,r)},wy=function(e,t,r){var o=ly(r,t-1),n=ly(r,t+1);return sy(dy,e)&&!sy(fy,n)||sy(fy,e)&&!sy(dy,o)?"\\u"+hy(ay(e,0),16):e};function yy(e){let t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},Oy(e,((e,r)=>{"__children"!==r&&(e&&"object"==typeof e&&!Array.isArray(e)?t[r]=yy(e):Array.isArray(e)?e.length&&"object"==typeof e[0]&&!Array.isArray(e[0])?t[r]=[yy(e[0])]:t[r]=[]:t[r]=null)}))),t}function vy(e,t,r){const o=Array.isArray(r);return Oy(t,((t,n)=>{(!1===o||r.includes(n))&&(e[n]=t)})),e}function by(e,t){Oy(t,((r,o)=>{t[o]&&"object"==typeof t[o]?(e[o]||(Array.isArray(t[o])?e[o]=[]:"[object Date]"===Object.prototype.toString.call(t[o])?e[o]=t[o]:e[o]={}),by(e[o],t[o])):e[o]=t[o]}))}function Cy(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}function Sy(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return _p(r,(t=>{e.MIXINS.push(t.MIXIN_NAME),Oy(t,((t,r)=>{if(void 0!==e.prototype[r])throw new Error(`Mixin conflict. Property '${r}' already exist and cannot be overwritten.`);if("function"==typeof t)e.prototype[r]=t;else{const o=function(e,t){const r=`_${e}`;return function(){return void 0===this[r]&&(this[r]=(e=>{let t=e;return(Array.isArray(t)||Ty(t))&&(t=Cy(t)),t})(t)),this[r]}},n=function(e){const t=`_${e}`;return function(e){this[t]=e}};Object.defineProperty(e.prototype,r,{get:o(r,t),set:n(r),configurable:!0})}}))})),e}function Ry(e,t){return JSON.stringify(e)===JSON.stringify(t)}function Ty(e){return"[object Object]"===Object.prototype.toString.call(e)}function Ey(e,t,r,o){o.value=r,o.writable=!1!==o.writable,o.enumerable=!1!==o.enumerable,o.configurable=!1!==o.configurable,Object.defineProperty(e,t,o)}function Oy(e,t){for(const r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&!1===t(e[r],r,e))break;return e}function My(e,t,r){const o=t.split(".");let n=e;o.forEach(((e,t)=>{t!==o.length-1?(_y(n,e)||(n[e]={}),n=n[e]):n[e]=r}))}function Hy(e){if(!Ty(e))return 0;const t=function(e){let r=0;return Ty(e)?Oy(e,((e,o)=>{"__children"!==o&&(r+=t(e))})):r+=1,r};return t(e)}function xy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const r=`_${t}`,o={_touched:!1,[r]:e,isTouched(){return this._touched}};return Object.defineProperty(o,t,{get(){return this[r]},set(e){this._touched=!0,this[r]=e},enumerable:!0,configurable:!0}),o}function _y(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ny(e){return window.requestAnimationFrame(e)}iy&&Gw({target:"JSON",stat:!0,arity:3,forced:gy||my},{stringify:function(e,t,r){var o=ty(arguments),n=qw(gy?py:iy,null,o);return my&&"string"==typeof n?cy(n,uy,wy):n}});const Iy=e=>{const t={value:!1,test:(r,o)=>{t.value=e(r,o)}};return t},Ay={chrome:Iy(((e,t)=>/Chrome/.test(e)&&/Google/.test(t))),chromeWebKit:Iy((e=>/CriOS/.test(e))),edge:Iy((e=>/Edge/.test(e))),edgeWebKit:Iy((e=>/EdgiOS/.test(e))),firefox:Iy((e=>/Firefox/.test(e))),firefoxWebKit:Iy((e=>/FxiOS/.test(e))),mobile:Iy((e=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e))),safari:Iy(((e,t)=>/Safari/.test(e)&&/Apple Computer/.test(t)))},ky={mac:Iy((e=>/^Mac/.test(e))),win:Iy((e=>/^Win/.test(e))),linux:Iy((e=>/^Linux/.test(e))),ios:Iy((e=>/iPhone|iPad|iPod/i.test(e)))};function Dy(){return Ay.firefox.value}function Py(){return Ay.mobile.value}function Ly(){return ky.ios.value}function Vy(){return ky.mac.value}"undefined"!=typeof window&&(function(){let{userAgent:e=navigator.userAgent,vendor:t=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Oy(Ay,(r=>{let{test:o}=r;o(e,t)}))}(),function(){let{platform:e=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Oy(ky,(t=>{let{test:r}=t;r(e)}))}());const Fy={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Dy()?182:174,AUDIO_MUTE:Dy()?181:173,AUDIO_UP:Dy()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Wy=[Fy.ALT,Fy.ARROW_DOWN,Fy.ARROW_LEFT,Fy.ARROW_RIGHT,Fy.ARROW_UP,Fy.AUDIO_DOWN,Fy.AUDIO_MUTE,Fy.AUDIO_UP,Fy.BACKSPACE,Fy.CAPS_LOCK,Fy.DELETE,Fy.END,Fy.ENTER,Fy.ESCAPE,Fy.F1,Fy.F2,Fy.F3,Fy.F4,Fy.F5,Fy.F6,Fy.F7,Fy.F8,Fy.F9,Fy.F10,Fy.F11,Fy.F12,Fy.F13,Fy.F14,Fy.F15,Fy.F16,Fy.F17,Fy.F18,Fy.F19,Fy.HOME,Fy.INSERT,Fy.MEDIA_NEXT,Fy.MEDIA_PLAY_PAUSE,Fy.MEDIA_PREV,Fy.MEDIA_STOP,Fy.NULL,Fy.NUM_LOCK,Fy.PAGE_DOWN,Fy.PAGE_UP,Fy.PAUSE,Fy.SCROLL_LOCK,Fy.SHIFT,Fy.TAB];function By(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function jy(e){return!1===e.isImmediatePropagationEnabled}function zy(e){return 2===e.button}function Uy(e){return 0===e.button}function Yy(){Dp(console)}const $y=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Gy=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Xy=new Map([[]]);var qy=Oo,Ky=b,Zy=yt,Qy=ma,Jy=Ut.f,ev=Zy("unscopables"),tv=Array.prototype;void 0===tv[ev]&&Jy(tv,ev,{configurable:!0,value:Qy(null)});var rv=function(e){tv[ev][e]=!0},ov=pn,nv=ke,iv=te,sv=function(e,t,r){for(var o=0,n=arguments.length>2?r:qy(t),i=new e(n);n>o;)i[o]=t[o++];return i},lv=rv,av=Array,cv=F(function(e,t){var r=Ky[e],o=r&&r.prototype;return o&&o[t]}("Array","sort"));ov({target:"Array",proto:!0},{toSorted:function(e){void 0!==e&&nv(e);var t=iv(this),r=sv(av,t);return cv(r,e)}}),lv("toSorted");var hv=eh,uv=ke,dv=qt,fv=ls;function gv(e,t,r){mv(e,t),t.set(e,r)}function mv(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pv(e,t,r){return e.set(yv(e,t),r),r}function wv(e,t){return e.get(yv(e,t))}function yv(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}pn({target:"Iterator",proto:!0,real:!0},{find:function(e){dv(this),uv(e);var t=fv(this),r=0;return hv(t,(function(t,o){if(e(t,r++))return o(t)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}});var vv=new WeakMap,bv=new WeakMap,Cv=new WeakMap,Sv=new WeakSet;class Rv{constructor(){var e,t;mv(e=this,t=Sv),t.add(e),gv(this,vv,new Map),gv(this,bv,new Map),gv(this,Cv,new Set),$y.forEach((e=>yv(Sv,this,Tv).call(this,e)))}getHooks(e){var t;return null!==(t=wv(vv,this).get(e))&&void 0!==t?t:[]}add(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};wv(vv,this).has(e)||(yv(Sv,this,Tv).call(this,e),$y.push(e));const o=wv(vv,this).get(e);if(o.find((e=>e.callback===t)))return;const n=Number.isInteger(r.orderIndex)?r.orderIndex:0,i=!!r.runOnce,s=!!r.initialHook;let l=!1;if(s){const e=o.find((e=>e.initialHook));e&&(e.callback=t,l=!0)}if(!l){o.push({callback:t,orderIndex:n,runOnce:i,initialHook:s,skip:!1});let r=wv(Cv,this).has(e);r||0===n||(r=!0,wv(Cv,this).add(e)),r&&o.length>1&&wv(vv,this).set(e,o.toSorted(((e,t)=>e.orderIndex-t.orderIndex)))}}has(e){return wv(vv,this).has(e)&&wv(vv,this).get(e).length>0}remove(e,t){if(!wv(vv,this).has(e))return!1;const r=wv(vv,this).get(e),o=r.find((e=>e.callback===t));if(o){let t=wv(bv,this).get(e);return o.skip=!0,t+=1,t>100&&(wv(vv,this).set(e,r.filter((e=>!e.skip))),t=0),wv(bv,this).set(e,t),!0}return!1}destroy(){wv(vv,this).clear(),wv(bv,this).clear(),pv(vv,this,null),pv(bv,this,null)}}function Tv(e){wv(vv,this).set(e,[]),wv(bv,this).set(e,0)}function Ev(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Ov=Ap`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class Mv{constructor(){Ev(this,"globalBucket",new Rv)}static getSingleton(){return Hv}getBucket(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new Rv),e.pluginHookBucket):this.globalBucket}add(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?_p(t,(t=>this.add(e,t,r))):(Gy.has(e)&&Yy(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${e}`.replace(/(?:\\)?\[([^[\]]+)]/g,((e,r)=>"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[r]?"":t[r]))}(Ov,{hookName:e,removedInVersion:Gy.get(e)})),Xy.has(e)&&Yy(Xy.get(e)),this.getBucket(r).add(e,t,{orderIndex:o,runOnce:!1})),this}once(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?_p(t,(t=>this.once(e,t,r))):this.getBucket(r).add(e,t,{orderIndex:o,runOnce:!0}),this}addAsFixed(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.isArray(t)?_p(t,(t=>this.addAsFixed(e,t,r))):this.getBucket(r).add(e,t,{initialHook:!0}),this}remove(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.getBucket(r).remove(e,t)}has(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getBucket(t).has(e)}run(e,t,r,o,n,i,s,l){{const a=this.getBucket().getHooks(t),c=a?a.length:0;let h=0;if(c)for(;h<c;){if(!a[h]||a[h].skip){h+=1;continue}const c=Bw(a[h].callback,e,r,o,n,i,s,l);void 0!==c&&(r=c),a[h]&&a[h].runOnce&&this.remove(t,a[h].callback),h+=1}}{const a=this.getBucket(e).getHooks(t),c=a?a.length:0;let h=0;if(c)for(;h<c;){if(!a[h]||a[h].skip){h+=1;continue}const c=Bw(a[h].callback,e,r,o,n,i,s,l);void 0!==c&&(r=c),a[h]&&a[h].runOnce&&this.remove(t,a[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||$y.push(e)}deregister(e){this.isRegistered(e)&&$y.splice($y.indexOf(e),1)}isDeprecated(e){return Xy.has(e)||Gy.has(e)}isRegistered(e){return $y.indexOf(e)>=0}getRegistered(){return $y}}const Hv=new Mv;const xv=new Map;function _v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";xv.has(e)||xv.set(e,new Map);const t=xv.get(e);return{register:function(e,r){t.set(e,r)},getItem:function(e){return t.get(e)},hasItem:function(e){return t.has(e)},getNames:function(){return[...t.keys()]},getValues:function(){return[...t.values()]}}}const Nv=new WeakMap,{register:Iv,getItem:Av,hasItem:kv,getNames:Dv,getValues:Pv}=_v("editors");function Lv(e){const t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new r(e)),t[e.guid]},Mv.getSingleton().add("afterDestroy",(function(){t[this.guid]=null}))}function Vv(e){if("function"==typeof e)return e;if(!kv(e))throw Error(`No registered editor found under "${e}" name`);return Av(e).getConstructor()}function Fv(e,t){e&&"string"!=typeof e&&(e=(t=e).EDITOR_TYPE);const r=new Lv(t);"string"==typeof e&&Iv(e,r),Nv.set(t,r)}function Wv(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Bv=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Wv(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function n(e){r.call(this,function(e){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),By(this)},e}(e))}return this.context.eventListeners.push({element:e,event:t,callback:r,callbackProxy:n,options:o,eventManager:this}),e.addEventListener(t,n,o),()=>{this.removeEventListener(e,t,r)}}removeEventListener(e,t,r){let o,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.context.eventListeners.length;for(;i;)if(i-=1,o=this.context.eventListeners[i],o.event===t&&o.element===e){if(r&&r!==o.callback)continue;if(n&&o.eventManager!==this)continue;this.context.eventListeners.splice(i,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options)}}clearEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const r=this.context.eventListeners[t];e&&r.eventManager!==this||(this.context.eventListeners.splice(t,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let r=e.document,o=e;r||(r=e.ownerDocument?e.ownerDocument:e,o=r.defaultView);const n={bubbles:!0,cancelable:"mousemove"!==t,view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let i;r.createEvent?(i=r.createEvent("MouseEvents"),i.initMouseEvent(t,n.bubbles,n.cancelable,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,r.body.parentNode)):i=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(i):e.fireEvent(`on${t}`,i)}};function jv(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function zv(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uv(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var Yv=new WeakSet;class $v{constructor(e,t,r){jv(this,Yv),zv(this,"hot",void 0),zv(this,"tableMeta",void 0),zv(this,"selection",void 0),zv(this,"eventManager",void 0),zv(this,"destroyed",!1),zv(this,"activeEditor",void 0),zv(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=r,this.eventManager=new Bv(e),this.hot.addHook("afterDocumentKeyDown",(e=>Uv(Yv,this,Gv).call(this,e))),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",(e=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",e)})),this.hot.view._wt.update("onCellDblClick",((e,t,r)=>Uv(Yv,this,Xv).call(this,e,t,r)))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,(e=>{e&&this.prepareEditor()}));const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!t||t.isHeader())return;const{row:r,col:o}=t,n=this.hot.runHooks("modifyGetCellCoords",r,o,!1,"meta");let i=r,s=o;if(Array.isArray(n)&&([i,s]=n),this.cellProperties=this.hot.getCellMeta(i,s),!this.isCellEditable())return void this.clearActiveEditor();const l=this.hot.getCell(r,o,!0);if(l){const e=this.hot.getCellEditor(this.cellProperties),t=this.hot.colToProp(s),n=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(i),s);this.activeEditor=function(e,t){let r;if("function"==typeof e)Nv.get(e)||Fv(null,e),r=Nv.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');r=Av(e)}if(!r)throw Error(`No editor registered under name "${e}"`);return r.getInstance(t)}(e,this.hot),this.activeEditor.prepare(r,o,t,l,n,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable())return void this.clearActiveEditor();const o=this.hot.getSelectedRangeLast();let n=this.hot.runHooks("beforeBeginEditing",o.highlight.row,o.highlight.col,e,t,r);t instanceof MouseEvent&&"boolean"!=typeof n&&(n=0===this.hot.selection.getLayerLevel()&&o.isSingle()),!1!==n?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))):this.clearActiveEditor()}closeEditor(e,t,r){this.activeEditor?this.activeEditor.finishEditing(e,t,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:r,col:o}=e.highlight,{rowIndexMapper:n,columnIndexMapper:i}=this.hot,s=n.isHidden(this.hot.toPhysicalRow(r))||i.isHidden(this.hot.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!t||s)}moveSelectionAfterEnter(e){const t=l({},"function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves);e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function Gv(e){const t=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!t||t.highlight.isHeader()||jy(e))return;const{keyCode:r}=e,o=(e.ctrlKey||e.metaKey)&&!e.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&(function(e){return Wy.includes(e)}(r)||function(e){return[Fy.CONTROL,Fy.COMMAND_LEFT,Fy.COMMAND_RIGHT,Fy.COMMAND_FIREFOX].includes(e)}(r)||o||this.isEditorOpened()||this.openEditor("",e))}function Xv(e,t){t.isCell()&&this.openEditor(null,e,!0)}const qv=new WeakMap;$v.getInstance=function(e,t,r){let o=qv.get(e);return o||(o=new $v(e,t,r),qv.set(e,o)),o};const Kv=$v;function Zv(e,t,r){Qv(e,t),t.set(e,r)}function Qv(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jv(e,t){return e.get(tb(e,t))}function eb(e,t,r){return e.set(tb(e,t),r),r}function tb(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const rb=Object.freeze({CELL:"cell",MIXED:"mixed"});var ob=new WeakMap,nb=new WeakMap,ib=new WeakMap,sb=new WeakMap,lb=new WeakMap,ab=new WeakSet;class cb{constructor(e){var t,r,o=this;Qv(t=this,r=ab),r.add(t),Zv(this,ob,void 0),Zv(this,nb,void 0),Zv(this,ib,1),Zv(this,sb,null),Zv(this,lb,new Map);const n=e.getSettings();eb(ob,this,e),eb(nb,this,n.imeFastEdit?rb.MIXED:rb.CELL),Jv(ob,this).addHook("afterUpdateSettings",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return tb(ab,o,fb).call(o,...t)})),Jv(ob,this).addHook("afterSelection",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return tb(ab,o,ub).call(o,...t)})),Jv(ob,this).addHook("afterSelectionFocusSet",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return tb(ab,o,ub).call(o,...t)})),Jv(ob,this).addHook("afterSelectionEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return tb(ab,o,db).call(o,...t)}))}getFocusMode(){return Jv(nb,this)}setFocusMode(e){Object.values(rb).includes(e)?eb(nb,this,e):Yy(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Jv(ib,this)}setRefocusDelay(e){eb(ib,this,e)}setRefocusElementGetter(e){eb(sb,this,e)}getRefocusElement(){var e;return"function"==typeof Jv(sb,this)?Jv(sb,this).call(this):null===(e=Jv(ob,this).getActiveEditor())||void 0===e?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=e=>{var t,r;const o=null===(t=Jv(ob,this).getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!o)return;let n=Jv(ob,this).runHooks("modifyFocusedElement",o.row,o.col,e);n instanceof HTMLElement||(n=e),!n||null!==(r=Jv(ob,this).getActiveEditor())&&void 0!==r&&r.isOpened()||n.focus({preventScroll:!0})};e?t(e):tb(ab,this,hb).call(this,(e=>t(e)))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jv(ib,this);!Jv(ob,this).getSettings().imeFastEdit||null!==(e=Jv(ob,this).getActiveEditor())&&void 0!==e&&e.isOpened()||(Jv(lb,this).has(t)||Jv(lb,this).set(t,function(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=null;return function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return o&&clearTimeout(o),o=setTimeout((()=>{t=e.apply(this,i)}),r),t}}((()=>{var e;null===(e=this.getRefocusElement())||void 0===e||e.select()}),t)),Jv(lb,this).get(t)())}}function hb(e){var t;const r=null===(t=Jv(ob,this).getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!r||!Jv(ob,this).selection.isCellVisible(r))return void e(null);const o=Jv(ob,this).getCell(r.row,r.col,!0);null===o?Jv(ob,this).addHookOnce("afterScroll",(()=>{e(Jv(ob,this).getCell(r.row,r.col,!0))})):e(o)}function ub(){tb(ab,this,hb).call(this,(e=>{const{activeElement:t}=Jv(ob,this).rootDocument;t&&Fw(t)&&t.blur(),this.focusOnHighlightedCell(e)}))}function db(){tb(ab,this,hb).call(this,(e=>{this.getFocusMode()===rb.MIXED&&"TD"===e.nodeName&&this.refocusToEditorTextarea()}))}function fb(e){"boolean"==typeof e.imeFastEdit&&this.setFocusMode(e.imeFastEdit?rb.MIXED:rb.CELL)}var gb=ie,mb=z,pb=yt("match"),wb=qt,yb=M,vb=nt,bb=ce,Cb=function(){var e=wb(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},Sb=RegExp.prototype,Rb=F,Tb=tt,Eb=Math.floor,Ob=Rb("".charAt),Mb=Rb("".replace),Hb=Rb("".slice),xb=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,_b=/\$([$&'`]|\d{1,2})/g,Nb=pn,Ib=M,Ab=F,kb=Q,Db=oe,Pb=q,Lb=function(e){var t;return gb(e)&&(void 0!==(t=e[pb])?!!t:"RegExp"===mb(e))},Vb=Xn,Fb=Le,Wb=function(e){var t=e.flags;return void 0!==t||"flags"in Sb||vb(e,"flags")||!bb(Sb,e)?t:yb(Cb,e)},Bb=function(e,t,r,o,n,i){var s=r+e.length,l=o.length,a=_b;return void 0!==n&&(n=Tb(n),a=xb),Mb(i,a,(function(i,a){var c;switch(Ob(a,0)){case"$":return"$";case"&":return e;case"`":return Hb(t,0,r);case"'":return Hb(t,s);case"<":c=n[Hb(a,1,-1)];break;default:var h=+a;if(0===h)return i;if(h>l){var u=Eb(h/10);return 0===u?i:u<=l?void 0===o[u-1]?Ob(a,1):o[u-1]+Ob(a,1):i}c=o[h-1]}return void 0===c?"":c}))},jb=yt("replace"),zb=TypeError,Ub=Ab("".indexOf);Ab("".replace);var Yb=Ab("".slice),$b=Math.max;Nb({target:"String",proto:!0},{replaceAll:function(e,t){var r,o,n,i,s,l,a,c,h,u=kb(this),d=0,f="";if(!Pb(e)){if(Lb(e)&&(r=Vb(kb(Wb(e))),!~Ub(r,"g")))throw new zb("`.replaceAll` does not allow non-global regexes");if(o=Fb(e,jb))return Ib(o,e,u,t)}for(n=Vb(u),i=Vb(e),(s=Db(t))||(t=Vb(t)),l=i.length,a=$b(1,l),c=Ub(n,i);-1!==c;)h=s?Vb(t(i,c,n)):Bb(i,n,c,[],void 0,t),f+=Yb(n,d,c)+h,d=c+l,c=c+a>n.length?-1:Ub(n,i,c+a);return d<n.length&&(f+=Yb(n,d)),f}});var Gb=eh,Xb=ke,qb=qt,Kb=ls,Zb=TypeError;pn({target:"Iterator",proto:!0,real:!0},{reduce:function(e){qb(this),Xb(e);var t=Kb(this),r=arguments.length<2,o=r?void 0:arguments[1],n=0;if(Gb(t,(function(t){r?(r=!1,o=t):o=e(o,t,n),n++}),{IS_RECORD:!0}),r)throw new Zb("Reduce of empty iterator with no initial value");return o}});function Qb(e){const t=e.hasColHeaders(),r=e.hasRowHeaders(),o=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],n=e.getData(...o),i=n.length,s=i>0?n[0].length:0,l=["<table>","</table>"],a=t?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],h=r?1:0,u=t?1:0;for(let d=0;d<i;d+=1){const o=t&&0===d,i=[];for(let t=0;t<s;t+=1){const s=!o&&r&&0===t;let l="";if(o)l=`<th>${e.getColHeader(t-h)}</th>`;else if(s)l=`<th>${e.getRowHeader(d-u)}</th>`;else{const r=n[d][t],{hidden:o,rowspan:i,colspan:s}=e.getCellMeta(d-u,t-h);if(!o){const e=[];if(i&&e.push(`rowspan="${i}"`),s&&e.push(`colspan="${s}"`),Lp(r))l=`<td ${e.join(" ")}></td>`;else{const t=r.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");l=`<td ${e.join(" ")}>${t}</td>`}}}i.push(l)}const l=["<tr>",...i,"</tr>"].join("");o?a.splice(1,0,l):c.splice(-1,0,l)}return l.splice(1,0,a.join(""),c.join("")),l.join("")}function Jb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const r=typeof e;if("number"===r)return!isNaN(e)&&isFinite(e);if("string"===r){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);const r=Array.from(new Set([".",...t])).map((e=>`\\${e}`)).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(e.trim())}return"object"===r&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}function eC(e,t,r){let o=-1;for("function"==typeof t?(r=t,t=e):o=e-1;++o<=t&&!1!==r(o););}function tC(e,t,r){let o=e+1;for("function"==typeof t&&(r=t,t=0);--o>=t&&!1!==r(o););}function rC(e,t,r){return Math.min(e,t)===e?t:Math.max(e,r)===e?r:e}new RegExp(Object.keys({"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"}).map((e=>`(${e})`)).join("|"),"gi");const oC="asc",nC=new Map([[oC,[-1,1]],["desc",[1,-1]]]),iC=e=>`The priority '${e}' is already declared in a map.`,sC=e=>`The priority '${e}' is not a number.`;const lC=e=>`The id '${e}' is already declared in a map.`;function aC(){let{errorIdExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Map;function r(){return[...t]}function o(e){return t.has(e)}return e=Ww(e)?e:lC,{addItem:function(r,n){if(o(r))throw new Error(e(r));t.set(r,n)},clear:function(){t.clear()},getId:function(e){const[t]=r().find((t=>{let[r,o]=t;return e===o&&r}))||[null];return t},getItem:function(e){return t.get(e)},getItems:r,hasItem:o,removeItem:function(e){return t.delete(e)}}}const cC=e=>`'${e}' value is already declared in a unique set.`;const hC=e=>`There is already registered "${e}" plugin.`,uC=function(){let{errorPriorityExists:e,errorPriorityNaN:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=new Map;return e=Ww(e)?e:iC,t=Ww(t)?t:sC,{addItem:function(o,n){if(!Jb(o))throw new Error(t(o));if(r.has(o))throw new Error(e(o));r.set(o,n)},getItems:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oC;const[t,o]=nC.get(e)||nC.get(oC);return[...r].sort(((e,r)=>e[0]<r[0]?t:o)).map((e=>e[1]))}}}({errorPriorityExists:e=>`There is already registered plugin on priority "${e}".`,errorPriorityNaN:e=>`The priority "${e}" is not a number.`}),dC=function(){let{errorItemExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Set;return e=Ww(e)?e:cC,{addItem:function(r){if(t.has(r))throw new Error(e(r));t.add(r)},clear:function(){t.clear()},getItems:function(){return[...t]}}}({errorItemExists:hC}),fC=aC({errorIdExists:hC});const{register:gC,getItem:mC,hasItem:pC,getNames:wC,getValues:yC}=_v("renderers");function vC(e){if("function"==typeof e)return e;if(!pC(e))throw Error(`No registered renderer found under "${e}" name`);return mC(e)}const{register:bC,getItem:CC,hasItem:SC,getNames:RC,getValues:TC}=_v("validators");var EC=tt,OC=Oo,MC=vo,HC=rv;pn({target:"Array",proto:!0},{at:function(e){var t=EC(this),r=OC(t),o=MC(e),n=o>=0?o:r+o;return n<0||n>=r?void 0:t[n]}}),HC("at");var xC=pn,_C=Q,NC=vo,IC=Xn,AC=S,kC=F("".charAt);function DC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}xC({target:"String",proto:!0,forced:AC((function(){return"\ud842"!=="ð ®·".at(-2)}))},{at:function(e){var t=IC(_C(this)),r=t.length,o=NC(e),n=o>=0?o:r+o;return n<0||n>=r?void 0:kC(t,n)}});class PC{constructor(){DC(this,"count",0),DC(this,"startColumn",null),DC(this,"endColumn",null),DC(this,"startPosition",null),DC(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:o,viewportWidth:n,columnWidth:i}=t;r>=o&&r+i<=o+(o>0?n+1:n)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:r,viewportWidth:o,inlineStartOffset:n,zeroBasedScrollOffset:i,totalColumns:s,needReverse:l,startPositions:a,columnWidth:c}=e;if(this.endColumn===s-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=a[this.endColumn]+c-a[this.startColumn-1];if(e<=o&&(this.startColumn-=1),e>=o)break}this.startPosition=null!==(t=a[this.startColumn])&&void 0!==t?t:null;const h=r+o-(i>0?o+1:o),u=null===this.startColumn?0:e.getColumnWidth(this.startColumn);h<-1*n||r>a.at(-1)||-1*r-o>-1*u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function LC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class VC{constructor(){LC(this,"count",0),LC(this,"startRow",null),LC(this,"endRow",null),LC(this,"startPosition",null),LC(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:o,innerViewportHeight:n,rowHeight:i}=t;r>=o&&r+i<=n&&(null===this.startRow&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:r,viewportHeight:o,horizontalScrollbarHeight:n,totalRows:i,needReverse:s,startPositions:l,rowHeight:a}=e;if(this.endRow===i-1&&s)for(this.startRow=this.endRow;this.startRow>0;){const e=l[this.endRow]+a-l[this.startRow-1];if(e<=o-n&&(this.startRow-=1),e>=o-n)break}this.startPosition=null!==(t=l[this.startRow])&&void 0!==t?t:null;r+o-n<(null===this.startRow?0:e.getRowHeight(this.startRow))||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,i<this.endRow&&(this.endRow=i-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function FC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class WC{constructor(){FC(this,"count",0),FC(this,"startColumn",null),FC(this,"endColumn",null),FC(this,"startPosition",null),FC(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:o,viewportWidth:n}=t;r<=o&&(this.startColumn=e);r>=o&&r<=o+(o>0?n+1:n)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e)),this.endColumn=e}finalize(e){var t;const{scrollOffset:r,viewportWidth:o,inlineStartOffset:n,zeroBasedScrollOffset:i,totalColumns:s,needReverse:l,startPositions:a,columnWidth:c}=e;if(this.endColumn===s-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=a[this.endColumn]+c-a[this.startColumn-1];if(this.startColumn-=1,e>o)break}this.startPosition=null!==(t=a[this.startColumn])&&void 0!==t?t:null;r+o-(i>0?o+1:o)<-1*n||r>a.at(-1)+c||-1*r-o>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function BC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class jC{constructor(){BC(this,"count",0),BC(this,"startRow",null),BC(this,"endRow",null),BC(this,"startPosition",null),BC(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:o,innerViewportHeight:n}=t;r<=o&&(this.startRow=e),r>=o&&r<=n&&null===this.startRow&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:r,viewportHeight:o,horizontalScrollbarHeight:n,totalRows:i,needReverse:s,startPositions:l,rowHeight:a}=e;if(this.endRow===i-1&&s)for(this.startRow=this.endRow;this.startRow>0;){const e=l[this.endRow]+a-l[this.startRow-1];if(this.startRow-=1,e>=o-n)break}this.startPosition=null!==(t=l[this.startRow])&&void 0!==t?t:null;r+o-n<0||r>l.at(-1)+a?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,i<this.endRow&&(this.endRow=i-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function zC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class UC{constructor(){zC(this,"count",0),zC(this,"startColumn",0),zC(this,"endColumn",0),zC(this,"startPosition",0),zC(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function YC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class $C{constructor(){YC(this,"count",0),YC(this,"startRow",0),YC(this,"endRow",0),YC(this,"startPosition",0),YC(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}function GC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class XC extends WC{constructor(){super(...arguments),GC(this,"columnStartOffset",0),GC(this,"columnEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:r,totalColumns:o,startPositions:n}=e;if(null!==this.startColumn&&"function"==typeof r){const e=this.startColumn,t=this.endColumn;r(this),this.columnStartOffset=e-this.startColumn,this.columnEndOffset=this.endColumn-t}this.startColumn<0&&(this.startColumn=0),this.startPosition=null!==(t=n[this.startColumn])&&void 0!==t?t:null,o<this.endColumn&&(this.endColumn=o-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function qC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class KC extends jC{constructor(){super(...arguments),qC(this,"rowStartOffset",0),qC(this,"rowEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:r,totalRows:o,startPositions:n}=e;if(null!==this.startRow&&"function"==typeof r){const e=this.startRow,t=this.endRow;r(this),this.rowStartOffset=e-this.startRow,this.rowEndOffset=this.endRow-t}this.startRow<0&&(this.startRow=0),this.startPosition=null!==(t=n[this.startRow])&&void 0!==t?t:null,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function ZC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class QC{constructor(e){ZC(this,"calculationTypes",[]),ZC(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach((t=>{let[r,o]=t;this.calculationResults.set(r,o),o.initialize(e)}))}_process(e,t){this.calculationTypes.forEach((r=>{let[,o]=r;return o.process(e,t)}))}_finalize(e){this.calculationTypes.forEach((t=>{let[,r]=t;return r.finalize(e)}))}getResultsFor(e){return this.calculationResults.get(e)}}function JC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class eS extends QC{constructor(e){let{calculationTypes:t,viewportWidth:r,scrollOffset:o,totalColumns:n,columnWidthFn:i,overrideFn:s,inlineStartOffset:l}=e;super(t),JC(this,"viewportWidth",0),JC(this,"scrollOffset",0),JC(this,"zeroBasedScrollOffset",0),JC(this,"totalColumns",0),JC(this,"columnWidthFn",null),JC(this,"columnWidth",0),JC(this,"overrideFn",null),JC(this,"inlineStartOffset",0),JC(this,"totalCalculatedWidth",0),JC(this,"startPositions",[]),JC(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=o,this.zeroBasedScrollOffset=Math.max(o,0),this.totalColumns=n,this.columnWidthFn=i,this.overrideFn=s,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?50:t}}function tS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class rS extends QC{constructor(e){let{calculationTypes:t,viewportHeight:r,scrollOffset:o,totalRows:n,defaultRowHeight:i,rowHeightFn:s,overrideFn:l,horizontalScrollbarHeight:a}=e;super(t),tS(this,"viewportHeight",0),tS(this,"scrollOffset",0),tS(this,"zeroBasedScrollOffset",0),tS(this,"totalRows",0),tS(this,"rowHeightFn",null),tS(this,"rowHeight",0),tS(this,"overrideFn",null),tS(this,"horizontalScrollbarHeight",0),tS(this,"innerViewportHeight",0),tS(this,"totalCalculatedHeight",0),tS(this,"startPositions",[]),tS(this,"needReverse",!0),this.defaultHeight=i,this.viewportHeight=r,this.scrollOffset=o,this.zeroBasedScrollOffset=Math.max(o,0),this.totalRows=n,this.rowHeightFn=s,this.overrideFn=l,this.horizontalScrollbarHeight=null!=a?a:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?this.defaultHeight:t}}function oS(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function nS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iS(e,t){return e.get(lS(e,t))}function sS(e,t,r){return e.set(lS(e,t),r),r}function lS(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var aS=new WeakMap;class cS{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];nS(this,"row",null),nS(this,"col",null),oS(this,aS,!1),sS(aS,this,r),void 0!==e&&void 0!==t&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:r,countRowHeaders:o,countColHeaders:n}=l({countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0},e);return!(!Number.isInteger(this.row)||!Number.isInteger(this.col))&&(!(this.row<-n||this.col<-o)&&!(this.row>=t||this.col>=r))}isEqual(e){return e===this||this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return iS(aS,this)}isSouthEastOf(e){return this.row>=e.row&&(iS(aS,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(iS(aS,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(iS(aS,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(iS(aS,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(null==e?void 0:e.row)&&(this.row=e.row),Number.isInteger(null==e?void 0:e.col)&&(this.col=e.col),e instanceof cS&&sS(aS,this,e.isRtl()),this}clone(){return new cS(this.row,this.col,iS(aS,this))}toObject(){return{row:this.row,col:this.col}}}const hS=cS;function uS(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function dS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fS(e,t){return e.get(gS(e,t))}function gS(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var mS=new WeakMap;class pS{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];var n,i,s;dS(this,"highlight",null),dS(this,"from",null),dS(this,"to",null),uS(this,mS,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=r.clone(),i=this,s=o,(n=mS).set(gS(n,i),s)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!(!this.from.isHeader()||!this.to.isHeader())||(this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0)}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:r}=e,o=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return o.row<=t&&n.row>=t&&o.col<=r&&n.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>r.row||e.col>r.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0)}expandByRange(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner(),n=this.getDirection(),i=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),l=Math.min(r.row,i.row),a=Math.min(r.col,i.col),c=Math.max(o.row,s.row),h=Math.max(o.col,s.col),u=this._createCellCoords(l,a),d=this._createCellCoords(c,h);return this.from=u,this.to=d,this.setDirection(n),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return fS(mS,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return fS(mS,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return fS(mS,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return fS(mS,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return fS(mS,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return fS(mS,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return fS(mS,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return fS(mS,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){return e instanceof hS&&(e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t=Math.min(this.from.row,this.to.row),r=Math.max(this.from.row,this.to.row),o=Math.min(this.from.col,this.to.col),n=Math.max(this.from.col,this.to.col),i=Math.min(e.from.row,e.to.row),s=Math.max(e.from.row,e.to.row),l=Math.min(e.from.col,e.to.col),a=Math.max(e.from.col,e.to.col),c=[];return t===i&&c.push("top"),n===a&&c.push(fS(mS,this)?"left":"right"),r===s&&c.push("bottom"),o===l&&c.push(fS(mS,this)?"right":"left"),c}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let o=e.row;o<=t.row;o++)for(let n=e.col;n<=t.col;n++)this.from.row===o&&this.from.col===n||this.to.row===o&&this.to.col===n||r.push(this._createCellCoords(o,n));return r}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let o=e.row;o<=t.row;o++)for(let n=e.col;n<=t.col;n++)e.row===o&&e.col===n?r.push(e):t.row===o&&t.col===n?r.push(t):r.push(this._createCellCoords(o,n));return r}forAll(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let o=t.row;o<=r.row;o++)for(let n=t.col;n<=r.col;n++){if(!1===e(o,n))return}}clone(){return new pS(this.highlight,this.from,this.to,fS(mS,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new hS(e,t,fS(mS,this))}}const wS=pS;function yS(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function vS(e,t){return e.get(CS(e,t))}function bS(e,t,r){return e.set(CS(e,t),r),r}function CS(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var SS=new WeakMap,RS=new WeakMap,TS=new WeakMap,ES=new WeakMap,OS=new WeakMap,MS=new WeakMap,HS=new WeakMap,xS=new WeakMap,_S=new WeakMap,NS=new WeakMap;const IS=class{constructor(e,t,r,o,n,i){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;yS(this,SS,void 0),yS(this,RS,void 0),yS(this,TS,void 0),yS(this,ES,void 0),yS(this,OS,void 0),yS(this,MS,void 0),yS(this,HS,void 0),yS(this,xS,void 0),yS(this,_S,[null,null]),yS(this,NS,[null,null]),bS(SS,this,r),bS(RS,this,t),bS(TS,this,n),bS(ES,this,i),bS(OS,this,s),bS(MS,this,o),bS(HS,this,e),this.registerEvents()}registerEvents(){vS(MS,this).addEventListener(vS(TS,this).holder,"contextmenu",(e=>this.onContextMenu(e))),vS(MS,this).addEventListener(vS(TS,this).TABLE,"mouseover",(e=>this.onMouseOver(e))),vS(MS,this).addEventListener(vS(TS,this).TABLE,"mouseout",(e=>this.onMouseOut(e)));const e=()=>{vS(MS,this).addEventListener(vS(TS,this).holder,"touchstart",(e=>this.onTouchStart(e))),vS(MS,this).addEventListener(vS(TS,this).holder,"touchend",(e=>this.onTouchEnd(e))),this.momentumScrolling||(this.momentumScrolling={}),vS(MS,this).addEventListener(vS(TS,this).holder,"scroll",(()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||vS(SS,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout((()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,vS(SS,this).getSetting("onAfterMomentumScroll"))}),200)}))},t=()=>{vS(MS,this).addEventListener(vS(TS,this).holder,"mouseup",(e=>this.onMouseUp(e))),vS(MS,this).addEventListener(vS(TS,this).holder,"mousedown",(e=>this.onMouseDown(e)))};Py()?e():("ontouchstart"in window&&e(),t())}selectedCellWasTouched(e){const t=this.parentCell(e).coords;if(vS(xS,this)&&t){const[e,r]=[t.row,vS(xS,this).from.row],[o,n]=[t.col,vS(xS,this).from.col];return e===r&&o===n}return!1}parentCell(e){const t={},r=nw(e,["TD","TH"],vS(TS,this).TABLE);return r?(t.coords=vS(TS,this).getCoords(r),t.TD=r):cw(e,"wtBorder")&&cw(e,"current")?(t.coords=vS(ES,this).getFocusSelection().cellRange.highlight,t.TD=vS(TS,this).getCell(t.coords)):cw(e,"wtBorder")&&cw(e,"area")&&vS(ES,this).getAreaSelection().cellRange&&(t.coords=vS(ES,this).getAreaSelection().cellRange.to,t.TD=vS(TS,this).getCell(t.coords)),t}onMouseDown(e){const t=vS(RS,this).rootDocument.activeElement,r=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return e.apply(this,r.concat(o))}}(tw,e.target),o=e.target;if(!["TD","TH"].includes(t.nodeName)&&(o===t||r(0)===t||r(1)===t))return;const n=this.parentCell(o);cw(o,"corner")?vS(SS,this).getSetting("onCellCornerMouseDown",e,o):n.TD&&vS(SS,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,n.coords,n.TD),(0===e.button||this.touchApplied)&&n.TD&&(vS(NS,this)[0]=n.TD,clearTimeout(vS(_S,this)[0]),vS(_S,this)[0]=setTimeout((()=>{vS(NS,this)[0]=null}),1e3))}onContextMenu(e){if(vS(SS,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!vS(SS,this).has("onCellMouseOver"))return;const t=vS(TS,this).TABLE,r=nw(e.target,["TD","TH"],t),o=vS(OS,this)||this;r&&r!==o.lastMouseOver&&iw(r,t)&&(o.lastMouseOver=r,this.callListener("onCellMouseOver",e,vS(TS,this).getCoords(r),r))}onMouseOut(e){if(!vS(SS,this).has("onCellMouseOut"))return;const t=vS(TS,this).TABLE,r=nw(e.target,["TD","TH"],t),o=nw(e.relatedTarget,["TD","TH"],t),n=vS(OS,this)||this;r&&r!==o&&iw(r,t)&&(this.callListener("onCellMouseOut",e,vS(TS,this).getCoords(r),r),null===o&&(n.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&vS(SS,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),(0===e.button||this.touchApplied)&&(t.TD===vS(NS,this)[0]&&t.TD===vS(NS,this)[1]?(cw(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),vS(NS,this)[0]=null,vS(NS,this)[1]=null):t.TD===vS(NS,this)[0]&&(vS(NS,this)[1]=t.TD,clearTimeout(vS(_S,this)[1]),vS(_S,this)[1]=setTimeout((()=>{vS(NS,this)[1]=null}),500)))}onTouchStart(e){bS(xS,this,vS(ES,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const r=e.target,o=null===(t=this.parentCell(r))||void 0===t?void 0:t.coords,n=Dp(o)&&o.row>=0&&o.col>=0;if(e.cancelable&&n&&vS(SS,this).getSetting("isDataViewInstance")){const t=["A","BUTTON","INPUT"];Ly()&&(Ay.chromeWebKit.value||Ay.firefoxWebKit.value)&&this.selectedCellWasTouched(r)&&!t.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,r,o){const n=vS(SS,this).getSettingPure(e);n&&n(t,r,o,vS(HS,this).call(this))}destroy(){clearTimeout(vS(_S,this)[0]),clearTimeout(vS(_S,this)[1]),vS(MS,this).destroy()}};function AS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const kS=class{constructor(e,t,r){AS(this,"offset",void 0),AS(this,"total",void 0),AS(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}};function DS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const PS=class{constructor(e,t,r){DS(this,"offset",void 0),DS(this,"total",void 0),DS(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}};function LS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class VS{constructor(){LS(this,"currentSize",0),LS(this,"nextSize",0),LS(this,"currentOffset",0),LS(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function FS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class WS{constructor(){FS(this,"size",new VS),FS(this,"workingSpace",0),FS(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof VS}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}function BS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class jS{constructor(e,t,r){BS(this,"rootNode",void 0),BS(this,"nodesPool",void 0),BS(this,"sizeSet",new WS),BS(this,"childNodeType",void 0),BS(this,"visualIndex",0),BS(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let r=0;if(this.isSharedViewSet()){let o=e.firstElementChild;for(;o;){if(o.tagName===this.childNodeType)r+=1;else if(t.isPlaceOn(1))break;o=o.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,r=this.isSharedViewSet(),{nextSize:o}=t.getViewSize();let n=this.getRenderedChildCount();for(;n<o;){const o=this.nodesPool();!r||r&&t.isPlaceOn(2)?e.appendChild(o):e.insertBefore(o,e.firstChild),n+=1}const i=r&&t.isPlaceOn(1);for(;n>o;)e.removeChild(i?e.firstChild:e.lastChild),n-=1}render(){const{rootNode:e,sizeSet:t}=this;let r=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(2)&&(r+=t.sharedSize.nextSize);let o=e.childNodes[r];if(o.tagName!==this.childNodeType){const t=this.nodesPool();e.replaceChild(t,o),o=t}this.collectedNodes.push(o),this.visualIndex+=1}end(){}}class zS extends jS{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function US(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class YS{constructor(e){US(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function $S(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class GS{constructor(e,t){$S(this,"nodesPool",null),$S(this,"nodeType",void 0),$S(this,"rootNode",void 0),$S(this,"table",null),$S(this,"renderedNodes",0),this.nodesPool="string"==typeof e?new YS(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function XS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class qS extends GS{constructor(){super("TH"),XS(this,"orderViews",new WeakMap),XS(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new zS(e,(e=>this.nodesPool.obtain(this.sourceRowIndex,e)),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:r,rows:o,cells:n}=this.table;for(let i=0;i<e;i++){const e=this.table.renderedRowToSource(i),s=o.getRenderedNode(i);this.sourceRowIndex=e;const l=this.obtainOrderView(s),a=n.obtainOrderView(s);l.appendView(a).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let o=0;o<r;o++){l.render();const r=l.getCurrentNode();r.className="",r.removeAttribute("style"),fw(r,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&dw(r,[["role","rowheader"],["scope","row"],ew(o+1),Kp(-1)]),t[o](e,r,o)}l.end()}}}class KS extends GS{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:o}=this.table,n=o+t;for(let t=0,s=e;t<s;t++){for(r=this.rootNode.childNodes[t],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<n;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>n;)r.removeChild(r.lastChild),this.renderedNodes-=1}const i=this.rootNode.childNodes.length;if(i>e)for(let t=e;t<i;t++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&mw(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&dw(this.rootNode,[["role","rowgroup"]]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:e,columnsToRender:r,rowHeadersCount:o}=this.table,n=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&dw(n,[["role","row"],Jp(t+1)]);for(let i=-1*o;i<r;i+=1){const r=this.table.renderedColumnToSource(i),s=n.childNodes[i+o];s.className="",s.removeAttribute("style"),fw(s,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&dw(s,[ew(i+1+this.table.rowHeadersCount),Kp(-1),["role","columnheader"],...i>=0?[["scope","col"]]:[["role","row"]]]),e[t](r,s,t)}}}}let ZS=!1;class QS extends GS{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,r=e+t;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!ZS&&e>1e3&&(ZS=!0,Yy(Ap`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let o=0;o<t;o++){const e=this.table.renderedColumnToSource(o),t=this.table.columnUtils.getHeaderWidth(e);this.rootNode.childNodes[o].style.width=`${t}px`}for(let o=0;o<e;o++){const e=this.table.renderedColumnToSource(o),r=this.table.columnUtils.getWidth(e);this.rootNode.childNodes[o+t].style.width=`${r}px`}const r=this.rootNode.firstChild;r&&hw(r,"rowHeader")}}function JS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const eR="ht__row_even",tR="ht__row_odd";let rR=!1;class oR extends GS{constructor(e){super("TR",e),JS(this,"orderView",void 0),this.orderView=new jS(e,(e=>this.nodesPool.obtain(e)),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!rR&&e>1e3&&(rR=!0,Yy(Ap`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&dw(this.rootNode,[["role","rowgroup"]]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let o=0;o<e;o++){this.orderView.render();const e=this.orderView.getCurrentNode(),n=this.table.renderedRowToSource(o);var t,r;if(this.table.isAriaEnabled())dw(e,[["role","row"],Jp(n+(null!==(t=null===(r=this.table.rowUtils)||void 0===r||null===(r=r.dataAccessObject)||void 0===r?void 0:r.columnHeaders.length)&&void 0!==t?t:0)+1)]);uw(e,[eR,tR]),hw(e,(n+1)%2==0?eR:tR)}this.orderView.end()}}function nR(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class iR extends GS{constructor(){super("TD"),nR(this,"orderViews",new WeakMap),nR(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new zS(e,(e=>this.nodesPool.obtain(this.sourceRowIndex,e)),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:r,rowHeaders:o}=this.table;for(let s=0;s<e;s++){const e=this.table.renderedRowToSource(s),l=r.getRenderedNode(s);this.sourceRowIndex=e;const a=this.obtainOrderView(l),c=o.obtainOrderView(l);a.prependView(c).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let r=0;r<t;r++){a.render();const t=a.getCurrentNode(),o=this.table.renderedColumnToSource(r);var n,i;if(cw(t,"hide")||(t.className=""),t.removeAttribute("style"),t.removeAttribute("dir"),fw(t,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(e,o,t),this.table.isAriaEnabled())dw(t,[...t.hasAttribute("role")?[]:[["role","gridcell"]],Kp(-1),ew(o+(null!==(n=null===(i=this.table.rowUtils)||void 0===i||null===(i=i.dataAccessObject)||void 0===i?void 0:i.rowHeaders.length)&&void 0!==n?n:0)+1)])}a.end()}}}function sR(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class lR{constructor(e){let{cellRenderer:t,stylesHandler:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};sR(this,"rootNode",void 0),sR(this,"rootDocument",void 0),sR(this,"rowHeaders",null),sR(this,"columnHeaders",null),sR(this,"colGroup",null),sR(this,"rows",null),sR(this,"cells",null),sR(this,"rowFilter",null),sR(this,"columnFilter",null),sR(this,"rowUtils",null),sR(this,"columnUtils",null),sR(this,"rowsToRender",0),sR(this,"columnsToRender",0),sR(this,"rowHeaderFunctions",[]),sR(this,"rowHeadersCount",0),sR(this,"columnHeaderFunctions",[]),sR(this,"columnHeadersCount",0),sR(this,"cellRenderer",void 0),sR(this,"activeOverlayName",void 0),sR(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:r,rows:o,cells:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.setTable(this),t.setTable(this),r.setTable(this),o.setTable(this),n.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=r,this.rows=o,this.cells=n}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let r=0;r<e;r++){const e=t.getRenderedNode(r),o=this.rowUtils;if(e.firstChild){const t=this.renderedRowToSource(r),n=o.getHeightByOverlayName(t,this.activeOverlayName),i=this.stylesHandler.areCellsBorderBox()?0:1;e.firstChild.style.height=n?n-i+"px":""}}}}class aR{constructor(){let{TABLE:e,THEAD:t,COLGROUP:r,TBODY:o,rowUtils:n,columnUtils:i,cellRenderer:s,stylesHandler:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new lR(e,{cellRenderer:s,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new qS,columnHeaders:new KS(t),colGroup:new QS(r),rows:new oR(o),cells:new iR}),this.renderer.setAxisUtils(n,i)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function cR(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class hR{constructor(e,t){cR(this,"dataAccessObject",void 0),cR(this,"wtSettings",void 0),cR(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=t}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let t=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==r&&(t=t?Math.max(t,r):r),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(t=e.getSetting("onModifyRowHeaderWidth",t),null!=t){const r=e.getSetting("rowHeaders").length,o=e.getSetting("defaultColumnWidth");for(let e=0;e<r;e++){let r=Array.isArray(t)?t[e]:t;r=null==r?o:r,this.headerWidths.set(e,r)}}}}function uR(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class dR{constructor(e,t){uR(this,"dataAccessObject",void 0),uR(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==r&&(t=void 0===t?r:Math.max(t,r)),t}getHeightByOverlayName(e,t){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const o=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==o&&(r=void 0===r?o:Math.max(r,o)),r}}function fR(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const gR=class{constructor(e,t,r,o,n){fR(this,"wtSettings",null),fR(this,"domBindings",void 0),fR(this,"TBODY",null),fR(this,"THEAD",null),fR(this,"COLGROUP",null),fR(this,"hasTableHeight",!0),fR(this,"hasTableWidth",!0),fR(this,"isTableVisible",!1),fR(this,"tableOffset",0),fR(this,"holderOffset",0),this.domBindings=r,this.isMaster="master"===n,this.name=n,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,gw(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const i=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(()=>this._modifyRowHeaderWidth(i))),this.rowUtils=new dR(this.dataAccessObject,this.wtSettings),this.columnUtils=new hR(this.dataAccessObject,this.wtSettings),this.tableRenderer=new aR({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let r;return t&&t.nodeType===Node.ELEMENT_NODE&&cw(t,"wtHolder")||(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",t&&t.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&dw(r,[["role","presentation"]]),r}createHider(e){const t=e.parentNode;let r;return t&&t.nodeType===Node.ELEMENT_NODE&&cw(t,"wtHolder")||(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",t&&t.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&dw(r,[["role","presentation"]]),r}createHolder(e){const t=e.parentNode;let r;return t&&t.nodeType===Node.ELEMENT_NODE&&cw(t,"wtHolder")||(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",t&&t.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&dw(r.parentNode,[["role","presentation"]])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&dw(r,[["role","presentation"]]),r}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,{wtOverlays:r,wtViewport:o}=this.dataAccessObject,n=t.getSetting("totalRows"),i=t.getSetting("totalColumns"),s=t.getSetting("rowHeaders"),l=s.length,a=t.getSetting("columnHeaders"),c=a.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=bw(this.holder),h=o.createCalculators(h),l&&!t.getSetting("fixedColumnsStart"))){const e=r.inlineStartOverlay.getScrollPosition(),t=this.correctHeaderWidth;this.correctHeaderWidth=0!==e,t!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=bw(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const e=n>0?this.getFirstRenderedRow():0,t=i>0?this.getFirstRenderedColumn():0;this.rowFilter=new PS(e,n,c),this.columnFilter=new kS(t,i,l);let h=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const e={};this.wtSettings.getSetting("beforeDraw",!0,e),h=!0!==e.skipRender}h&&(this.tableRenderer.setHeaderContentRenderers(s,a),(this.is(SR)||this.is(ER))&&this.tableRenderer.setHeaderContentRenderers(s,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(SR))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||o.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(SR)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let u=!1;return this.isMaster&&(u=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(u=r.bottomOverlay.resetFixedPosition()||u),u=r.inlineStartOverlay.resetFixedPosition()||u,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),u?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const o=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let n,i,s;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,n=this.getColumnHeaderHeight(r),i=this.getColumnHeader(t,r),i&&(s=_w(i),(!n&&o<s||n<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=s),Array.isArray(l)?null!==l[r]&&void 0!==l[r]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders;for(let o=0,n=e.getSetting("columnHeaders").length;o<n;o++)if(r[o]){if(!t[o]||0===t[o].childNodes.length)return;t[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if((this.isMaster||this.is(SR))&&!e.getSetting("externalRowCalculator")){const e=this.getRenderedRowsCount();for(let r=0;r<e;r++){const e=this.rowFilter.renderedToSource(r);t.oversizedRows&&t.oversizedRows[e]&&(t.oversizedRows[e]=void 0)}}}getCell(e){let t=e.row,r=e.col;const o=this.wtSettings.getSetting("onModifyGetCellCoords",t,r,!this.isMaster,"render");if(o&&Array.isArray(o)&&([t,r]=o),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const n=this.getRow(t);if(!n&&t>=0)throw new Error("TR was expected to be rendered but is not");const i=n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!i&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return i}getRow(e){let t=null,r=null;var o,n;e<0?(t=null===(o=this.rowFilter)||void 0===o?void 0:o.sourceRowToVisibleColHeadedRow(e),r=this.THEAD):(t=null===(n=this.rowFilter)||void 0===n?void 0:n.sourceToRendered(e),r=this.TBODY);return void 0!==t&&void 0!==r&&(!(r.childNodes.length<t+1)&&r.childNodes[t])}getColumnHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=this.THEAD.childNodes[t];return null==r?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach((e=>{const o=e.childNodes[r];o&&t.push(o)})),t}getRowHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t>=this.wtSettings.getSetting("rowHeaders").length)return;const r=this.rowFilter.sourceToRendered(e),o=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,n=(r<0?this.THEAD:this.TBODY).childNodes[o];return null==n?void 0:n.childNodes[t]}getRowHeaders(e){const t=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let o=0;o<r;o++){const r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],n=null==r?void 0:r.childNodes[o];n&&t.push(n)}return t}getCoords(e){let t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=ow(t,["TD","TH"])),null===t)return null;const r=t.parentNode,o=r.parentNode;let n=function(e){let t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}(r),i=t.cellIndex;if(sw(TR,t,this.wtRootElement)||sw(CR,t,this.wtRootElement))"THEAD"===o.nodeName&&(n-=o.childNodes.length);else if(sw(ER,t,this.wtRootElement)||sw(SR,t,this.wtRootElement)){n=this.wtSettings.getSetting("totalRows")-o.childNodes.length+n}else n=o===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(n):this.rowFilter.renderedToSource(n);i=sw(TR,t,this.wtRootElement)||sw(RR,t,this.wtRootElement)||sw(ER,t,this.wtRootElement)?this.columnFilter.offsettedTH(i):this.columnFilter.visibleRowHeadedColumnToSourceColumn(i);const s=this.wtSettings.getSetting("onModifyGetCoordsElement",n,i);return s&&Array.isArray(s)&&([n,i]=s),this.wot.createCellCoords(n,i)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),r=_w(this.TBODY)-1,o=this.wot.stylesHandler.areCellsBorderBox(),n=o?xw:_w,i=o?0:1,s=o?1:0;let l,a,c,h,u;if(t!==r||this.wtSettings.getSetting("fixedRowsBottom"))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),u=h.querySelector("th");const t=0===c?s:0;a=u?n(u):n(h)-i,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<a-t||l<a)&&(o||(a+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=a)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=t}isRowHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=t}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Hw(this.TABLE)}getHeight(){return xw(this.TABLE)}getTotalWidth(){const e=Hw(this.hider);return 0!==e?e:this.getWidth()}getTotalHeight(){const e=xw(this.hider);return 0!==e?e:this.getHeight()}isVisible(){return vw(this.TABLE)}_modifyRowHeaderWidth(e){let t=Ww(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return"number"!=typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}},mR={getFirstRenderedRow(){const e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),r=e-t;return 0===e||0===t?-1:r<0?0:r},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};Ey(mR,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});const pR=mR,wR={getFirstRenderedColumn(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ey(wR,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});const yR=wR;class vR extends gR{constructor(e,t,r,o){super(e,t,r,o,ER)}}Sy(vR,pR),Sy(vR,yR);const bR=vR,CR="top",SR="bottom",RR="inline_start",TR="top_inline_start_corner",ER="bottom_inline_start_corner",OR=[CR,SR,RR,TR,ER],MR=new Map([[CR,`ht_clone_${CR}`],[SR,`ht_clone_${SR}`],[RR,`ht_clone_${RR} ht_clone_left`],[TR,`ht_clone_${TR} ht_clone_top_left_corner`],[ER,`ht_clone_${ER} ht_clone_bottom_left_corner`]]);function HR(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function xR(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _R(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var NR=new WeakSet;function IR(e){const{wtSettings:t,inlineStartOverlay:r,wtTable:o,wtViewport:n,totalColumns:i,rootWindow:s}=this.dataAccessObject;if(r.mainTableScrollableElement===s){let l=null;if(t.getSetting("rtlMode")){const e=o.TABLE.getBoundingClientRect(),t=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(e.right-t)}else{l=bw(o.wtRootElement).left}const a=Math.abs(Tw(s,s));if(l>a){const t=Nw(s);let o=n.getRowHeaderWidth();for(let n=1;n<=i;n++)if(o+=r.sumCellSizes(n-1,n),l+o-a>=t){e=n-2;break}}}return e}function AR(e){const{topOverlay:t,wtTable:r,wtViewport:o,totalRows:n,rootWindow:i}=this.dataAccessObject;if(t.mainTableScrollableElement===i){const s=bw(r.wtRootElement),l=Rw(i,i);if(s.top>l){const r=_w(i);let a=o.getColumnHeaderHeight();for(let o=1;o<=n;o++)if(a+=t.sumCellSizes(o-1,o),s.top+a-l>=r){e=o-2;break}}}return e}const kR=class{constructor(e){HR(this,NR),xR(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,r){if(e.col<0||e.row<0)return!1;const o=this.scrollViewportHorizontally(e.col,t),n=this.scrollViewportVertically(e.row,r);return o||n}scrollViewportHorizontally(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn:r,totalColumns:o}=this.dataAccessObject;if(!r)return!1;const n=xy(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,n),!Number.isInteger(e)||e<0||e>o)return!1;t=n.value;const{fixedColumnsStart:i,inlineStartOverlay:s}=this.dataAccessObject,l="auto"===t;if(l&&e<i)return!1;const a=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<a||e>c)||!l)&&(h=s.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():"end"===t)),h}scrollViewportVertically(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn:r,totalRows:o}=this.dataAccessObject;if(!r)return!1;const n=xy(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,n),!Number.isInteger(e)||e<0||e>o)return!1;t=n.value;const{fixedRowsBottom:i,fixedRowsTop:s,topOverlay:l}=this.dataAccessObject,a="auto"===t;if(a&&(e<s||e>o-i-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let u=!1;return(a&&(e<c||e>h)||!a)&&(u=l.scrollTo(e,a?e>=this.getLastPartiallyVisibleRow():"bottom"===t)),u}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return _R(NR,this,AR).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return _R(NR,this,AR).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return _R(NR,this,IR).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return _R(NR,this,IR).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function DR(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class PR{get eventManager(){return new Bv(this)}constructor(e,t){DR(this,"wtTable",void 0),DR(this,"wtScroll",void 0),DR(this,"wtViewport",void 0),DR(this,"wtOverlays",void 0),DR(this,"selectionManager",void 0),DR(this,"wtEvent",void 0),DR(this,"guid",`wt_${qp()}`),DR(this,"drawInterrupted",!1),DR(this,"drawn",!1),DR(this,"activeOverlayName","master"),DR(this,"domBindings",void 0),DR(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new kR(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;t<r;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,r){yw(r,e[t])}])}}createCellCoords(e,t){return new hS(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,r){return new wS(e,t,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(e);const t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),n=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<n)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<n&&e.row>=t-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<n)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<t&&e.row>=t-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,r){return this.wtScroll.scrollViewport(e,t,r)}scrollViewportHorizontally(e,t){return this.wtScroll.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this.wtScroll.scrollViewportVertically(e,t)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function LR(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class VR extends PR{constructor(e,t,r){super(e,t),LR(this,"cloneSource",void 0),LR(this,"cloneOverlay",void 0);const o=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.stylesHandler=r.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new IS(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function FR(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class WR{constructor(e,t,r,o,n){FR(this,"wtSettings",null),Ey(this,"wot",e,{writable:!1}),this.domBindings=n,this.facadeGetter=t,this.wtSettings=o;const{TABLE:i,hider:s,spreader:l,holder:a,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=i,this.hider=s,this.spreader=l,this.holder=a,this.wtRootElement=c,this.trimmingContainer=Ow(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){"before"===e&&this.shouldBeRendered()?this.needFullRender=!0:"after"!==e||this.shouldBeRendered()||(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Ow(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Ew(e.TABLE)}getRelativeCellPosition(e,t,r){if(!1===this.clone.wtTable.holder.contains(e))return void Yy(`The provided element is not a child of the ${this.type} overlay`);const o=this.mainTableScrollableElement===this.domBindings.rootWindow,n=r<this.wtSettings.getSetting("fixedColumnsStart"),i=t<this.wtSettings.getSetting("fixedRowsTop"),s=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,a={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return h=o?this.getRelativeCellPositionWithinWindow(i,n,c,a):this.getRelativeCellPositionWithinHolder(i,s,n,c,a),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,r,o){const n=this.wot.wtTable.wtRootElement.getBoundingClientRect();let i=0,s=0;if(t){let e=n.left;this.isRtl()&&(e=this.domBindings.rootWindow.innerWidth-(n.left+n.width+Dw())),i=e<=0?-1*e:0}else i=o.start;if(e){s=this.clone.wtTable.TABLE.getBoundingClientRect().top-n.top}else s=o.top;return{start:r.start+i,top:r.top+s}}getRelativeCellPositionWithinHolder(e,t,r,o,n){const i=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),s=this.wot.wtOverlays.topOverlay.getScrollPosition();let l=0,a=0;if(r||(l=i-n.start),t){const e=this.wot.wtTable.wtRootElement.getBoundingClientRect();a=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+e.top}else e||(a=s-n.top);return{start:o.start-l,top:o.top-a}}makeClone(){if(-1===OR.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:r,rootWindow:o}=this.domBindings,n=r.createElement("div"),i=r.createElement("table"),s=e.wtRootElement.parentNode;n.className=`${MR.get(this.type)} handsontable`,n.setAttribute("dir",this.isRtl()?"rtl":"ltr"),n.style.position="absolute",n.style.top=0,n.style.overflow="visible",this.isRtl()?n.style.right=0:n.style.left=0,t.getSetting("ariaTags")&&dw(n,[["role","presentation"]]),i.className=e.TABLE.className;e.TABLE.getAttribute("role")&&i.setAttribute("role",e.TABLE.getAttribute("role")),n.appendChild(i),s.appendChild(n);const l=this.wtSettings.getSetting("preventOverflow");return!0===l||"horizontal"===l&&this.type===CR||"vertical"===l&&this.type===RR?this.mainTableScrollableElement=o:"hidden"===o.getComputedStyle(s).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Ew(e.TABLE),new VR(i,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needFullRender){const t=this.clone.cloneSource;t.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),t.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider;[e.style,t.style,e.parentNode.style].forEach((e=>{e.width="",e.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class BR extends WR{constructor(e,t,r,o,n,i){super(e,t,ER,r,o),this.bottomOverlay=n,this.inlineStartOverlay=i}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new bR(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const e=this.inlineStartOverlay.getOverlayOffset(),r=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${e}px`,t.style.bottom=`${r}px`}else Lw(t),this.repositionOverlay();let r=xw(this.clone.wtTable.TABLE);const o=Hw(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),t.style.height=`${r}px`,t.style.width=`${o}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let n=0;t.hasVerticalScroll()||(n+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(n+=Dw(r)),o.style.bottom=`${n}px`}}const jR={getFirstRenderedColumn(){const e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn(){const e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getFirstPartiallyVisibleColumn(){const e=this.dataAccessObject.startColumnPartiallyVisible;return null===e?-1:e},getLastRenderedColumn(){const e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn(){const e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getLastPartiallyVisibleColumn(){const e=this.dataAccessObject.endColumnPartiallyVisible;return null===e?-1:e},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ey(jR,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});const zR=jR;class UR extends gR{constructor(e,t,r,o){super(e,t,r,o,SR)}}Sy(UR,pR),Sy(UR,zR);const YR=UR;function $R(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class GR extends WR{constructor(e,t,r,o){super(e,t,SR,r,o),$R(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new YR(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let r=0;const o=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||o&&"vertical"===o?(r=this.getScrollPosition(),this.repositionOverlay()):(r=this.getOverlayOffset(),t.style.bottom=`${r}px`);const n=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),n}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let n=0;t.hasVerticalScroll()||(n+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(n+=Dw(r)),o.style.bottom=`${n}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.mainTableScrollableElement===t?(t.scrollTo(Sw(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:r,stylesHandler:o}=this.wot,n=o.getDefaultRowHeight();let i=e,s=0;for(;i<t;){const e=r.getRowHeight(i);s+=void 0===e?n:e,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:o}=this.domBindings,n=this.clone.wtTable.holder.parentNode.style,i=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===i){let o=t.getWorkspaceWidth();t.hasVerticalScroll()&&(o-=Dw(r)),o=Math.min(o,e.wtRootElement.scrollWidth),n.width=`${o}px`}else n.width="";this.clone.wtTable.holder.style.width=n.width;let s=xw(this.clone.wtTable.TABLE);e.hasDefinedSize()||(s=0),n.height=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let n=0;t&&o.offsetHeight!==o.clientHeight&&(n=Dw(this.domBindings.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=n,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Rw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight(),t=e-this.clone.wtTable.getTotalHeight(),o=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-o+e,0),r>t&&(r=0)}return r}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==t,o=this.wtSettings.getSetting("columnHeaders");let n=!1;if((r||0===t)&&o.length>0){const t=this.wot.wtTable.holder.parentNode,r=cw(t,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?(hw(t,"innerBorderBottom"),n=!r):(uw(t,"innerBorderBottom"),n=r)}return n}}const XR={getFirstRenderedRow(){const e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow(){const e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getFirstPartiallyVisibleRow(){const e=this.dataAccessObject.startRowPartiallyVisible;return null===e?-1:e},getLastRenderedRow(){const e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow(){const e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getLastPartiallyVisibleRow(){const e=this.dataAccessObject.endRowPartiallyVisible;return null===e?-1:e},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ey(XR,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});const qR=XR;class KR extends gR{constructor(e,t,r,o){super(e,t,r,o,RR)}}Sy(KR,qR),Sy(KR,yR);const ZR=KR,QR={_localHooks:Object.create(null),addLocalHook(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks(e,t,r,o,n,i,s){if(this._localHooks[e]){const l=this._localHooks[e].length;for(let a=0;a<l;a++)Bw(this._localHooks[e][a],this,t,r,o,n,i,s)}},clearLocalHooks(){return this._localHooks={},this}};Ey(QR,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});const JR=QR;let eT=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return null===this.cellRange}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};Sy(eT,JR);const tT=eT,rT="header",oT="area",nT="focus",iT=e=>{const t=e.stylesHandler;if(t.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=t.getCSSVariableValue("cell-autofill-size"),o=t.getCSSVariableValue("cell-autofill-border-width"),n=t.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:o,borderStyle:"solid",borderColor:n})};function sT(e,t,r){lT(e,t),t.set(e,r)}function lT(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aT(e,t){return e.get(hT(e,t))}function cT(e,t,r){return e.set(hT(e,t),r),r}function hT(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}rv("flat");var uT=new WeakMap,dT=new WeakMap,fT=new WeakSet;class gT{constructor(){var e,t;lT(e=this,t=fT),t.add(e),sT(this,uT,void 0),sT(this,dT,void 0)}setActiveOverlay(e){return cT(dT,this,e),this}setActiveSelection(e){return cT(uT,this,e),this}scan(){const e=aT(uT,this).settings.selectionType,t=new Set;return"active-header"===e?(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanRowsInHeadersRange((e=>t.add(e)))):"area"===e?this.scanCellsRange((e=>t.add(e))):"focus"===e?(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanRowsInHeadersRange((e=>t.add(e))),this.scanCellsRange((e=>t.add(e)))):"fill"===e?this.scanCellsRange((e=>t.add(e))):"header"===e?(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanRowsInHeadersRange((e=>t.add(e)))):"row"===e?(this.scanRowsInHeadersRange((e=>t.add(e))),this.scanRowsInCellsRange((e=>t.add(e)))):"column"===e&&(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanColumnsInCellsRange((e=>t.add(e)))),t}scanColumnsInHeadersRange(e){const[t,r,o,n]=aT(uT,this).getCorners(),{wtTable:i}=aT(dT,this),s=i.getRenderedColumnsCount(),l=i.getColumnHeadersCount();let a=0;for(let c=-i.getRowHeadersCount();c<s;c++){const s=i.columnFilter.renderedToSource(c);if(!(s<r||s>n)){for(let c=-l;c<0;c++){if(c<t||c>o)continue;const h=c+l;let u=i.getColumnHeader(s,h);const d=aT(dT,this).getSetting("onBeforeHighlightingColumnHeader",s,h,{selectionType:aT(uT,this).settings.selectionType,columnCursor:a,selectionWidth:n-r+1});null!==d&&(d!==s&&(u=i.getColumnHeader(d,h)),e(u))}a+=1}}}scanRowsInHeadersRange(e){const[t,r,o,n]=aT(uT,this).getCorners(),{wtTable:i}=aT(dT,this),s=i.getRenderedRowsCount(),l=i.getRowHeadersCount();let a=0;for(let c=-i.getColumnHeadersCount();c<s;c++){const s=i.rowFilter.renderedToSource(c);if(!(s<t||s>o)){for(let c=-l;c<0;c++){if(c<r||c>n)continue;const h=c+l;let u=i.getRowHeader(s,h);const d=aT(dT,this).getSetting("onBeforeHighlightingRowHeader",s,h,{selectionType:aT(uT,this).settings.selectionType,rowCursor:a,selectionHeight:o-t+1});null!==d&&(d!==s&&(u=i.getRowHeader(d,h)),e(u))}a+=1}}}scanCellsRange(e){const{wtTable:t}=aT(dT,this);hT(fT,this,mT).call(this,((r,o)=>{const n=t.getCell(aT(dT,this).createCellCoords(r,o)),i=aT(dT,this).getSetting("onAfterDrawSelection",r,o,aT(uT,this).settings.layerLevel);"string"==typeof i&&hw(n,i),e(n)}))}scanRowsInCellsRange(e){const[t,,r]=aT(uT,this).getCorners(),{wtTable:o}=aT(dT,this);hT(fT,this,pT).call(this,((n,i)=>{if(n>=t&&n<=r){const t=o.getCell(aT(dT,this).createCellCoords(n,i));e(t)}}))}scanColumnsInCellsRange(e){const[,t,,r]=aT(uT,this).getCorners(),{wtTable:o}=aT(dT,this);hT(fT,this,pT).call(this,((n,i)=>{if(i>=t&&i<=r){const t=o.getCell(aT(dT,this).createCellCoords(n,i));e(t)}}))}}function mT(e){let[t,r,o,n]=aT(uT,this).getCorners();if(t<0&&o<0||r<0&&n<0)return;const{wtTable:i}=aT(dT,this),s=t!==o||r!==n;if(r=Math.max(r,0),n=Math.max(n,0),t=Math.max(t,0),o=Math.max(o,0),s){if(r=Math.max(r,i.getFirstRenderedColumn()),n=Math.min(n,i.getLastRenderedColumn()),t=Math.max(t,i.getFirstRenderedRow()),o=Math.min(o,i.getLastRenderedRow()),n<r||o<t)return}else{if(!(i.getCell(aT(dT,this).createCellCoords(t,r))instanceof HTMLElement))return}for(let l=t;l<=o;l+=1)for(let t=r;t<=n;t+=1)e(l,t)}function pT(e){const{wtTable:t}=aT(dT,this),r=t.getRenderedRowsCount(),o=t.getRenderedColumnsCount();for(let n=0;n<r;n+=1){const r=t.rowFilter.renderedToSource(n);for(let n=0;n<o;n+=1)e(r,t.columnFilter.renderedToSource(n))}}const wT=class{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=iT(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",(()=>this.onMouseDown())),this.eventManager.addEventListener(e,"mouseup",(()=>this.onMouseUp()));for(let t=0,r=this.main.childNodes.length;t<r;t++){const e=this.main.childNodes[t];this.eventManager.addEventListener(e,"mouseenter",(e=>this.onMouseEnter(e,this.main.childNodes[t])))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),By(e);const r=this,o=this.wot.rootDocument.body,n=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(o,"mousemove",(function e(i){var s;((s=i).clientY<Math.floor(n.top)||s.clientY>Math.ceil(n.top+n.height)||s.clientX<Math.floor(n.left)||s.clientX>Math.ceil(n.left+n.width))&&(r.eventManager.removeEventListener(o,"mousemove",e),t.style.display="block")}))}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const r=["top","start","bottom","end","corner"];let o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(let s=0;s<5;s++){const n=r[s],i=t.createElement("div");i.className=`wtBorder ${this.settings.className||""}`,this.settings[n]&&this.settings[n].hide&&(i.className+=" hidden"),o=i.style,o.backgroundColor=this.settings[n]&&this.settings[n].color?this.settings[n].color:e.border.color,o.height=this.settings[n]&&this.settings[n].width?`${this.settings[n].width}px`:`${e.border.width}px`,o.width=this.settings[n]&&this.settings[n].width?`${this.settings[n].width}px`:`${e.border.width}px`,this.main.appendChild(i)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Py()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:n}=this.wot;let i=n.bordersHolder;i||(i=t.createElement("div"),i.className="htBorders",n.bordersHolder=i,n.spreader.appendChild(i)),i.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};Oy({position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`},((e,t)=>{this.selectionHandles.styles.bottomHitArea[t]=e,this.selectionHandles.styles.topHitArea[t]=e}));Oy({position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"},((e,t)=>{this.selectionHandles.styles.bottom[t]=e,this.selectionHandles.styles.top[t]=e})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const r=this.wot.selectionManager.getAreaSelection();return!(!r.cellRange||e===r.cellRange.to.row&&t===r.cellRange.to.col)}updateMultipleSelectionHandlesPosition(e,t,r,o,n,i){const s=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:l,topHitArea:a,bottom:c,bottomHitArea:h}=this.selectionHandles.styles,u=parseInt(l.borderWidth,10),d=parseInt(l.width,10),f=parseInt(a.width,10),g=this.wot.wtTable.getWidth(),m=this.wot.wtTable.getHeight();l.top=`${parseInt(r-d-1,10)}px`,l[s]=`${parseInt(o-d-1,10)}px`,a.top=`${parseInt(r-f/4*3,10)}px`,a[s]=`${parseInt(o-f/4*3,10)}px`;const p=Math.min(parseInt(o+n,10),g-d-2*u),w=Math.min(parseInt(o+n-f/4,10),g-f-2*u);c[s]=`${p}px`,h[s]=`${w}px`;const y=Math.min(parseInt(r+i,10),m-d-2*u),v=Math.min(parseInt(r+i-f/4,10),m-f-2*u);c.top=`${y}px`,h.top=`${v}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(l.display="block",a.display="block",this.isPartRange(e,t)?(c.display="none",h.display="none"):(c.display="block",h.display="block")):(l.display="none",c.display="none",a.display="none",h.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(l.zIndex="9999",a.zIndex="9999"):(l.zIndex="",a.zIndex="")}appear(e){if(this.disabled)return;let[t,r,o,n]=e;if(t<0&&o<0||r<0&&n<0)return void this.disappear();const{wtTable:i,rootDocument:s,rootWindow:l}=this.wot,a=t!==o||r!==n,c=i.getFirstRenderedRow(),h=i.getLastRenderedRow(),u=i.getFirstRenderedColumn(),d=i.getLastRenderedColumn();let f;if(a){if(r=Math.max(r,u),n=Math.min(n,d),t=Math.max(t,c),o=Math.min(o,h),n<r||o<t)return void this.disappear();f=i.getCell(this.wot.createCellCoords(t,r))}else if(f=i.getCell(this.wot.createCellCoords(t,r)),!(f instanceof HTMLElement))return void this.disappear();const g=a?i.getCell(this.wot.createCellCoords(o,n)):f,m=bw(f),p=a?bw(g):m,w=bw(i.TABLE),y=m.top,v=m.left,b=this.wot.wtSettings.getSetting("rtlMode");let C=0,S=0;if(b){const e=Hw(i.TABLE),t=Hw(f),r=l.innerWidth-w.left-e;S=v+t-p.left,C=l.innerWidth-v-t-r-1}else S=p.left+Hw(g)-v,C=v-w.left-1;if(this.isEntireColumnSelected(t,o)){const e=t,o=this.getDimensionsFromHeader("columns",r,n,e,w);let i=null;o&&([i,C,S]=o),i&&(f=i)}let R=y-w.top-1,T=p.top+xw(g)-y;if(this.isEntireRowSelected(r,n)){const e=r,n=this.getDimensionsFromHeader("rows",t,o,e,w);let i=null;n&&([i,R,T]=n),i&&(f=i)}const E=l.getComputedStyle(f);parseInt(E.borderTopWidth,10)>0&&(R+=1,T=T>0?T-1:0),parseInt(E[b?"borderRightWidth":"borderLeftWidth"],10)>0&&(C+=1,S=S>0?S-1:0);const O=b?"right":"left";this.topStyle.top=`${R}px`,this.topStyle[O]=`${C}px`,this.topStyle.width=`${S}px`,this.topStyle.display="block",this.startStyle.top=`${R}px`,this.startStyle[O]=`${C}px`,this.startStyle.height=`${T}px`,this.startStyle.display="block";const M=Math.floor(this.settings.border.width/2);this.bottomStyle.top=R+T-M+"px",this.bottomStyle[O]=`${C}px`,this.bottomStyle.width=`${S}px`,this.bottomStyle.display="block",this.endStyle.top=`${R}px`,this.endStyle[O]=C+S-M+"px",this.endStyle.height=`${T+1}px`,this.endStyle.display="block";let H=this.settings.border.cornerVisible;H="function"==typeof H?H(this.settings.layerLevel):H;const x=this.wot.getSetting("onModifyGetCellCoords",o,n,!1,"render");let[_,N]=[o,n];if(x&&Array.isArray(x)&&([,,_,N]=x),Py()||!H||this.isPartRange(_,N))this.cornerStyle.display="none";else{this.cornerStyle.top=R+T+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth+"px",this.cornerStyle[O]=C+S+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth+"px",this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let e=Ow(i.TABLE);const t=e===l;t&&(e=s.documentElement);const r=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,a=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),c=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(n===this.wot.getSetting("totalColumns")-1){const o=t?g.getBoundingClientRect().left:g.offsetLeft;let n=!1,i=0;b?(i=o-parseInt(this.cornerDefaultStyle.width,10)/2,n=i<0):(i=o+Hw(g)+parseInt(this.cornerDefaultStyle.width,10)/2,n=i>=Nw(e)),n&&(this.cornerStyle[O]=`${Math.floor(C+S+this.cornerCenterPointOffset-a-r)}px`,this.cornerStyle[b?"borderLeftWidth":"borderRightWidth"]=0)}if(o===this.wot.getSetting("totalRows")-1){(t?g.getBoundingClientRect().top:g.offsetTop)+xw(g)+parseInt(this.cornerDefaultStyle.height,10)/2>=_w(e)&&(this.cornerStyle.top=`${Math.floor(R+T+this.cornerCenterPointOffset-c-r)}px`,this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Py()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(o,n,R,C,S,T)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,r,o,n){const{wtTable:i}=this.wot,s=i.wtRootElement.parentNode;let l=null,a=null,c=null,h=null,u=null,d=null,f=null,g=null;switch(e){case"rows":l=function(){return i.getRowHeader(...arguments)},a=function(){return xw(...arguments)},c="ht__selection--rows",d="top";break;case"columns":l=function(){return i.getColumnHeader(...arguments)},a=function(){return Hw(...arguments)},c="ht__selection--columns",d="left"}if(s.classList.contains(c)){const e=this.wot.getSetting("columnHeaders").length;if(f=l(t,e-o),g=l(r,e-o),!f||!g)return!1;const i=bw(f),s=bw(g);return f&&g&&(h=i[d]-n[d]-1,u=s[d]+a(g)-i[d]),[f,h,u]}return!1}changeBorderStyle(e,t){const r=this[e].style,o=t[e];!o||o.hide?hw(this[e],"hidden"):(cw(this[e],"hidden")&&uw(this[e],"hidden"),r.backgroundColor=o.color,"top"!==e&&"bottom"!==e||(r.height=`${o.width}px`),"start"!==e&&"end"!==e||(r.width=`${o.width}px`))}changeBorderToDefaultStyle(e){const t=1,r="#000",o=this[e].style;o.backgroundColor=r,o.width=`${t}px`,o.height=`${t}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?hw(this[e],"hidden"):uw(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Py()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};function yT(e,t,r){vT(e,t),t.set(e,r)}function vT(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bT(e,t){return e.get(ST(e,t))}function CT(e,t,r){return e.set(ST(e,t),r),r}function ST(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var RT=new WeakMap,TT=new WeakMap,ET=new WeakMap,OT=new WeakMap,MT=new WeakMap,HT=new WeakMap,xT=new WeakSet;class _T{constructor(e){var t,r;vT(t=this,r=xT),r.add(t),yT(this,RT,void 0),yT(this,TT,void 0),yT(this,ET,new gT),yT(this,OT,new WeakMap),yT(this,MT,new WeakSet),yT(this,HT,new Map),CT(TT,this,e)}setActiveOverlay(e){return CT(RT,this,e),bT(ET,this).setActiveOverlay(bT(RT,this)),bT(OT,this).has(bT(RT,this))||bT(OT,this).set(bT(RT,this),new Set),this}getFocusSelection(){return null!==bT(TT,this)?bT(TT,this).getFocus():null}getAreaSelection(){return null!==bT(TT,this)?bT(TT,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(bT(HT,this).has(e)){const t=bT(HT,this).get(e);if(t.has(bT(RT,this)))return t.get(bT(RT,this));const r=new wT(bT(RT,this),e.settings);return t.set(bT(RT,this),r),r}const t=new wT(bT(RT,this),e.settings);return bT(HT,this).set(e,new Map([[bT(RT,this),t]])),t}getBorderInstances(e){var t,r;return Array.from(null!==(t=null===(r=bT(HT,this).get(e))||void 0===r?void 0:r.values())&&void 0!==t?t:[])}destroyBorders(e){bT(HT,this).get(e).forEach((e=>e.destroy())),bT(HT,this).delete(e)}render(e){if(null===bT(TT,this))return;e&&ST(xT,this,NT).call(this);const t=Array.from(bT(TT,this)),r=new Map,o=new Map;for(let n=0;n<t.length;n++){const e=t[n],{className:i,headerAttributes:s,createLayers:l,selectionType:a}=e.settings;bT(MT,this).has(e)||(bT(MT,this).add(e),e.addLocalHook("destroy",(()=>this.destroyBorders(e))));const c=this.getBorderInstance(e);if(e.isEmpty()){null==c||c.disappear();continue}if(i){bT(ET,this).setActiveSelection(e).scan().forEach((e=>{if(r.has(e)){const t=r.get(e);t.has(i)&&!0===l?t.set(i,t.get(i)+1):t.set(i,1)}else r.set(e,new Map([[i,1]]));s&&(o.has(e)||o.set(e,[]),"TH"===e.nodeName&&o.get(e).push(...s))}))}const h=e.getCorners();bT(RT,this).getSetting("onBeforeDrawBorders",h,a),null==c||c.appear(h)}r.forEach(((e,t)=>{var r;const o=Array.from(e).map((e=>{let[t,r]=e;return 1===r?t:[t,...Array.from({length:r-1},((e,r)=>`${t}-${r+1}`))]})).flat();o.forEach((e=>bT(OT,this).get(bT(RT,this)).add(e))),hw(t,o),"TD"===t.nodeName&&Array.isArray(null===(r=bT(TT,this).options)||void 0===r?void 0:r.cellAttributes)&&dw(t,bT(TT,this).options.cellAttributes)})),Array.from(o.keys()).forEach((e=>{dw(e,[...o.get(e)])}))}}function NT(){const e=bT(OT,this).get(bT(RT,this)),t=bT(RT,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(t))for(let r=0;r<t.length;r++)e.add(t[r]);e.forEach((e=>{var t,r;const o=bT(RT,this).wtTable.TABLE.querySelectorAll(`.${e}`);let n=[];Array.isArray(null===(t=bT(TT,this).options)||void 0===t?void 0:t.cellAttributes)&&(n=bT(TT,this).options.cellAttributes.map((e=>e[0]))),Array.isArray(null===(r=bT(TT,this).options)||void 0===r?void 0:r.headerAttributes)&&(n=[...n,...bT(TT,this).options.headerAttributes.map((e=>e[0]))]);for(let i=0,s=o.length;i<s;i++)uw(o[i],e),fw(o[i],n)})),e.clear()}class IT extends WR{constructor(e,t,r,o){super(e,t,RR,r,o)}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new ZR(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,r=this.clone.wtTable.holder.parentNode,o=this.wtSettings.getSetting("preventOverflow");let n=0;this.trimmingContainer!==t||o&&"horizontal"===o?(n=this.getScrollPosition(),Lw(r)):(n=this.getOverlayOffset()*(this.isRtl()?-1:1),Pw(r,`${n}px`,"0px"));const i=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),i}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,Cw(t)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultColumnWidth");let o=e,n=0;for(;o<t;)n+=this.wot.wtTable.getColumnWidth(o)||r,o+=1;return n}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:o}=this.domBindings,n=this.clone.wtTable.holder.parentNode.style,i=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"vertical"===i){let o=t.getWorkspaceHeight();t.hasHorizontalScroll()&&(o-=Dw(r)),o=Math.min(o,e.wtRootElement.scrollHeight),n.height=`${o}px`}else n.height="";this.clone.wtTable.holder.style.height=n.height;const s=Hw(this.clone.wtTable.TABLE);n.width=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=iT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(t.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:r}=this,o=r.getSetting("rowHeaders"),n=r.getSetting("fixedColumnsStart"),i=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,s=0===n&&o.length>0&&!cw(i.parentNode,"innerBorderInlineStart")?1:0;let l=this.getTableParentOffset(),a=0;if(t){this.wot.wtTable.getColumnWidth(e)>this.wot.wtViewport.getViewportWidth()&&(t=!1)}var c;return t&&i.offsetWidth!==i.clientWidth&&(a=Dw(this.domBindings.rootDocument)),t?(l+=this.sumCellSizes(0,e+1),l-=this.wot.wtViewport.getViewportWidth(),l+=s):l+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),l+=a,(c=this.mainTableScrollableElement).scrollWidth-c.clientWidth==l-s&&s>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(s),this.setScrollPosition(l)}getTableParentOffset(){let e=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs(Tw(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||"horizontal"!==t)){r=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);r>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,r=this.wot.wtTable.holder.parentNode,o=t.getSetting("rowHeaders"),n=t.getSetting("fixedColumnsStart"),i=t.getSetting("totalRows"),s="vertical"===t.getSetting("preventOverflow");i?uw(r,"emptyRows"):hw(r,"emptyRows");let l=!1;if(!s)if(n&&!o.length)hw(r,"innerBorderLeft innerBorderInlineStart");else if(!n&&o.length){const t=cw(r,"innerBorderInlineStart");e?(hw(r,"innerBorderLeft innerBorderInlineStart"),l=!t):(uw(r,"innerBorderLeft innerBorderInlineStart"),l=t)}return l}}const AT={getFirstRenderedRow(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ey(AT,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});const kT=AT;class DT extends gR{constructor(e,t,r,o){super(e,t,r,o,TR)}}Sy(DT,kT),Sy(DT,yR);const PT=DT;function LT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class VT extends WR{constructor(e,t,r,o,n,i){super(e,t,TR,r,o),LT(this,"topOverlay",void 0),LT(this,"inlineStartOverlay",void 0),this.topOverlay=n,this.inlineStartOverlay=i}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new PT(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){Pw(e,`${this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1)}px`,`${this.topOverlay.getOverlayOffset()}px`)}else Lw(e);let t=xw(this.clone.wtTable.TABLE);const r=Hw(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${r}px`,!1}}class FT extends gR{constructor(e,t,r,o){super(e,t,r,o,CR)}}Sy(FT,kT),Sy(FT,zR);const WT=FT;function BT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class jT extends WR{constructor(e,t,r,o){super(e,t,CR,r,o),BT(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new WT(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let o=0,n=!1;if(this.trimmingContainer!==t||r&&"vertical"===r)o=this.getScrollPosition(),Lw(e);else{const{wtTable:t}=this.wot,r=t.hider.getBoundingClientRect();n=Math.ceil(r.bottom)===e.offsetHeight,o=this.getOverlayOffset(),Pw(e,"0px",`${o}px`)}const i=this.adjustHeaderBordersPosition(o,n);return this.adjustElementsSize(),i}setScrollPosition(e){const t=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(Sw(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const r=this.wot.stylesHandler.getDefaultRowHeight();let o=e,n=0;for(;o<t;){const e=this.wot.wtTable.getRowHeight(o);n+=void 0===e?r:e,o+=1}return n}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:o}=this.domBindings,n=this.clone.wtTable.holder.parentNode.style,i=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===i){let o=t.getWorkspaceWidth();t.hasVerticalScroll()&&(o-=Dw(r)),o=Math.min(o,e.wtRootElement.scrollWidth),n.width=`${o}px`}else n.width="";this.clone.wtTable.holder.style.width=n.width;let s=xw(this.clone.wtTable.TABLE);e.hasDefinedSize()||(s=0),n.height=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=iT(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(t.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:r,wtSettings:o}=this,n=(r.cloneSource?r.cloneSource:r).wtTable.holder,i=o.getSetting("columnHeaders"),s=0===o.getSetting("fixedRowsTop")&&i.length>0&&!cw(n.parentNode,"innerBorderTop")?1:0;let l=this.getTableParentOffset(),a=0;if(t){this.wot.wtTable.getRowHeight(e)>this.wot.wtViewport.getViewportHeight()&&(t=!1)}if(t&&n.offsetHeight!==n.clientHeight&&(a=Dw(this.domBindings.rootDocument)),t){const t=o.getSetting("fixedRowsBottom"),n=o.getSetting("totalRows");l+=this.sumCellSizes(0,e+1),l-=r.wtViewport.getViewportHeight()-this.sumCellSizes(n-t,n),l+=1,l+=s}else l+=this.sumCellSizes(o.getSetting("fixedRowsTop"),e);var c;return l+=a,(c=this.mainTableScrollableElement).scrollHeight-c.clientHeight==l-s&&s>0&&this.wot.wtOverlays.expandHiderVerticallyBy(s),this.setScrollPosition(l)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Rw(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>e&&(r=0)}return r}adjustHeaderBordersPosition(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{wtSettings:r}=this,o=this.wot.wtTable.holder.parentNode,n=r.getSetting("totalColumns"),i="horizontal"===r.getSetting("preventOverflow");n?uw(o,"emptyColumns"):hw(o,"emptyColumns");let s=!1;if(!t&&!i){const t=r.getSetting("fixedRowsTop"),n=this.cachedFixedRowsTop!==t,i=r.getSetting("columnHeaders");if((n||0===t)&&i.length>0){const t=cw(o,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||0===r.getSetting("totalRows")?(hw(o,"innerBorderTop"),s=!t):(uw(o,"innerBorderTop"),s=t)}}return s}}function zT(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function UT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YT(e,t,r){return e.set(GT(e,t),r),r}function $T(e,t){return e.get(GT(e,t))}function GT(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var XT=new WeakMap,qT=new WeakMap,KT=new WeakMap,ZT=new WeakMap;const QT=class{constructor(e,t,r,o,n,i){UT(this,"wot",null),zT(this,XT,[]),UT(this,"topOverlay",null),UT(this,"bottomOverlay",null),UT(this,"inlineStartOverlay",null),UT(this,"topInlineStartCornerOverlay",null),UT(this,"bottomInlineStartCornerOverlay",null),UT(this,"browserLineHeight",void 0),UT(this,"wtSettings",null),zT(this,qT,!1),zT(this,KT,0),zT(this,ZT,null),UT(this,"resizeObserver",new ResizeObserver((e=>{Ny((()=>{Array.isArray(e)&&e.length&&(YT(KT,this,$T(KT,this)+1),100===$T(KT,this)&&(Yy("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),null!==$T(ZT,this)&&clearTimeout($T(ZT,this)),YT(ZT,this,setTimeout((()=>{YT(KT,this,0)}),100)),this.wtSettings.getSetting("onContainerElementResize"))}))}))),this.wot=e,this.wtSettings=o,this.domBindings=r,this.facadeGetter=t,this.wtTable=i;const{rootDocument:s,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=n,this.scrollbarSize=Dw(s);const a="hidden"===l.getComputedStyle(i.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=a?i.holder:Ew(i.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[...$T(XT,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,r=e.getComputedStyle(t.body),o=parseInt(r.lineHeight,10),n=1.2*parseInt(r.fontSize,10);this.browserLineHeight=o||n}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new jT(...e),this.bottomOverlay=new GR(...e),this.inlineStartOverlay=new IT(...e),this.topInlineStartCornerOverlay=new VT(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new BR(...e,this.bottomOverlay,this.inlineStartOverlay),YT(XT,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){YT(qT,this,$T(XT,this).reduce(((e,t)=>t.hasRenderingStateChanged()||e),!1)),$T(XT,this).forEach((e=>e.updateStateOfRendering("before")))}afterDraw(){this.syncScrollWithMaster(),$T(XT,this).forEach((e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()}))}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:o}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",(e=>this.onKeyDown(e))),this.eventManager.addEventListener(e.documentElement,"keyup",(()=>this.onKeyUp())),this.eventManager.addEventListener(e,"visibilitychange",(()=>this.onKeyUp())),this.eventManager.addEventListener(r,"scroll",(e=>this.onTableScroll(e)),{passive:!0}),r!==o&&this.eventManager.addEventListener(o,"scroll",(e=>this.onTableScroll(e)),{passive:!0});const n=t.devicePixelRatio&&t.devicePixelRatio>1,i=this.scrollableElement===t,s=this.wtSettings.getSetting("preventWheel"),l={passive:i};(s||n||!Ay.chrome.value)&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(e=>this.onCloneWheel(e,s)),l);let a;[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((e=>{if(e&&e.needFullRender){const{holder:t}=e.clone.wtTable;this.eventManager.addEventListener(t,"wheel",(e=>this.onCloneWheel(e,s)),l)}})),this.eventManager.addEventListener(t,"resize",(()=>{Ny((()=>{clearTimeout(a),this.wtSettings.getSetting("onWindowResize"),a=setTimeout((()=>{YT(KT,this,0)}),200)}))})),i||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,n=e.target;this.keyPressed&&(o!==t&&n!==t&&!e.target.contains(o)||r!==t&&n!==t&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:r}=this.domBindings,o=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,i=e.target,s=n!==r&&i!==r&&!i.contains(n),l=o!==r&&i!==r&&!i.contains(o);if(this.keyPressed&&(s||l)||this.scrollableElement===r)return;const a=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==r&&a)&&e.preventDefault()}onKeyDown(e){this.keyPressed=function(e,t){const r=t.split("|");let o=!1;return _p(r,(t=>{if(e===Fy[t])return o=!0,!1})),o}(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(r+=r*this.browserLineHeight,t+=t*this.browserLineHeight);const o=this.scrollVertically(t),n=this.scrollHorizontally(r);return o||n}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[o,n]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==o||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==n||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=o;const e=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;e&&(e.scrollLeft=o)}this.verticalScrolling&&(r.scrollTop=n),this.refreshAll()}syncScrollWithMaster(){if(!$T(qT,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),YT(qT,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=Ew(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,r=e.clientHeight,o=t!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=r),o}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:r}=this.domBindings,o=this.scrollableElement===r,n=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),s=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,i)+1,a=s+this.inlineStartOverlay.sumCellSizes(0,n),c=t.hider.style,h=(()=>!o&&this.scrollableElement.scrollTop>Math.max(0,l-t.holder.clientHeight))()?1:0,u=(()=>!o&&this.scrollableElement.scrollLeft>Math.max(0,a-t.holder.clientWidth))()?1:0;c.width=`${a+u}px`,c.height=`${l+h}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return _p(t,(t=>{t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(r=t.clone)})),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE;_p([this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],(t=>{t&&(t.clone.wtTable.TABLE.className=e.className)}))}};function JT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class eE{constructor(e){JT(this,"settings",{}),JT(this,"defaults",Object.freeze(this.getDefaults())),Oy(this.defaults,((t,r)=>{if(void 0!==e[r])this.settings[r]=e[r];else{if(void 0===t)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=t}}))}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,r)=>{const o=this.getSetting("data",e,t);yw(r,null==o?"":o)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return void 0===t?Oy(e,((e,t)=>{this.settings[t]=e})):this.settings[e]=t,this}getSetting(e,t,r,o,n){return"function"==typeof this.settings[e]?this.settings[e](t,r,o,n):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class tE extends gR{constructor(e,t,r,o){super(e,t,r,o,"master")}alignOverlaysWithTrimmingContainer(){const e=Ow(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t){this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const r=e.parentElement,o=Mw(e,"height",t),n=Mw(e,"overflow",t),i=this.holder.style,{scrollWidth:s,scrollHeight:l}=e;let a=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(n)){const o=e.cloneNode(!1);o.style.overflow="auto",o.style.position="absolute",e.nextElementSibling?r.insertBefore(o,e.nextElementSibling):r.appendChild(o);const n=parseInt(t.getComputedStyle(o).height,10);r.removeChild(o),0===n&&(c=0)}c=Math.min(c,l),i.height="auto"===o?"auto":`${c}px`,a=Math.min(a,s),i.width=`${a}px`,i.overflow="",this.hasTableHeight="auto"===i.height||c>0,this.hasTableWidth=a>0}this.isTableVisible=vw(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!t.hasOversizedColumnHeadersMarked[r]){const n=e.getSetting("rowHeaders").length,i=this.getRenderedColumnsCount();for(let e=0;e<o;e++)for(let t=-1*n;t<i;t++)this.markIfOversizedColumnHeader(t);t.hasOversizedColumnHeadersMarked[r]=!0}}}Sy(tE,qR),Sy(tE,zR);const rE=tE;const oE=class{constructor(e,t,r,o,n){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=r,this.wtTable=n,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new $C:new KC],["fullyVisible",()=>new VC],["partiallyVisible",()=>new jC]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new UC:new XC],["fullyVisible",()=>new PC],["partiallyVisible",()=>new WC]]),this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(()=>{this.clientHeight=this.getWorkspaceHeight()}))}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;if(t===this.domBindings.rootWindow)r=e.documentElement.clientHeight;else{r=xw(t)>0&&t.clientHeight>0?t.clientHeight:Infinity}return r}getViewportHeight(){let e=this.getWorkspaceHeight();if(Infinity===e)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:t}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let o;if(r===t){const t=this.wtSettings.getSetting("totalColumns");o=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,t)>o&&(o=e.documentElement.clientWidth)}else o=r.clientWidth;return o}getViewportWidth(){const e=this.getWorkspaceWidth();if(Infinity===e)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,t){let r=0,o=e;for(;o<t;)r+=this.wtTable.getColumnWidth(o),o+=1;return r}getWorkspaceOffset(){return bw(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=xw(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,o=t.length;r<o;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let e=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,o=t.length;r<o;r++)e?(this.rowHeaderWidth+=Hw(e),e=e.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let o,n,i=this.getViewportHeight();this.rowHeaderWidth=NaN;let s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=t.getSetting("fixedRowsTop"),a=t.getSetting("fixedRowsBottom"),c=t.getSetting("totalRows");return l&&s>=0&&(n=this.dataAccessObject.topOverlay.sumCellSizes(0,l),s+=n,i-=n),a&&this.dataAccessObject.bottomOverlay.clone&&(n=this.dataAccessObject.bottomOverlay.sumCellSizes(c-a,c),i-=n),o=r.holder.clientHeight===r.holder.offsetHeight?0:Dw(this.domBindings.rootDocument),new rS({calculationTypes:e.map((e=>[e,this.rowsCalculatorTypes.get(e)()])),viewportHeight:i,scrollOffset:s,totalRows:t.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:e=>r.getRowHeight(e),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let o=this.getViewportWidth(),n=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const i=t.getSetting("fixedColumnsStart");if(i&&n>=0){const e=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,i);n+=e,o-=e}return r.holder.clientWidth!==r.holder.offsetWidth&&(o-=Dw(this.domBindings.rootDocument)),new eS({calculationTypes:e.map((e=>[e,this.columnsCalculatorTypes.get(e)()])),viewportWidth:o,scrollOffset:n,totalColumns:t.getSetting("totalColumns"),columnWidthFn:e=>r.getColumnWidth(e),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,r=this.createRowsCalculator(),o=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const t=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(t)}if(e&&!t.getSetting("renderAllColumns")){const t=o.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(t)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=o.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=o.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=o.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:r}=e;if(null===t&&null===r){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:o,endRow:n,rowStartOffset:i,rowEndOffset:s}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,a=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(a)&&a>0?(t=Math.max(0,t-Math.min(i,a)),r=Math.min(l,r+Math.min(s,a))):"auto"===a&&(t=Math.max(0,t-Math.ceil(i/2)),r=Math.min(l,r+Math.ceil(s/2))),!(t<o||t===o&&t>0)&&!(r>n||r===n&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:r}=e;if(null===t&&null===r){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:o,endColumn:n,columnStartOffset:i,columnEndOffset:s}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,a=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(a)&&a>0?(t=Math.max(0,t-Math.min(i,a)),r=Math.min(l,r+Math.min(s,a))):"auto"===a&&(t=Math.max(0,t-Math.ceil(i/2)),r=Math.min(l,r+Math.ceil(s/2))),!(t<o||t===o&&t>0)&&!(r>n||r===n&&r<l)}resetHasOversizedColumnHeadersMarked(){Oy(this.hasOversizedColumnHeadersMarked,((e,t,r)=>{r[t]=void 0}))}};function nE(e,t,r){iE(e,t),t.set(e,r)}function iE(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sE(e,t){return e.get(aE(e,t))}function lE(e,t,r){return e.set(aE(e,t),r),r}function aE(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var cE=new WeakMap,hE=new WeakMap,uE=new WeakMap,dE=new WeakMap,fE=new WeakMap,gE=new WeakMap,mE=new WeakMap,pE=new WeakSet;class wE{constructor(e){var t,r;iE(t=this,r=pE),r.add(t),nE(this,cE,void 0),nE(this,hE,void 0),nE(this,uE,void 0),nE(this,dE,void 0),nE(this,fE,!0),nE(this,gE,{}),nE(this,mE,{}),lE(hE,this,e.rootTable.parentElement.parentElement),lE(dE,this,e.rootDocument)}isClassicTheme(){return sE(fE,this)}getCSSVariableValue(e){var t;if(sE(fE,this))return null;if(sE(gE,this)[`--ht-${e}`])return sE(gE,this)[`--ht-${e}`];const r=null!==(t=aE(pE,this,SE).call(this,`--ht-${e}`))&&void 0!==t?t:aE(pE,this,RE).call(this,`--ht-${e}`);return null!==r?(sE(gE,this)[`--ht-${e}`]=r,r):void 0}getStyleForTD(e){var t;return null===(t=sE(mE,this))||void 0===t?void 0:t.td[e]}getDefaultRowHeight(){if(sE(fE,this))return 23;const e=aE(pE,this,yE).call(this);return!e&&cw(sE(hE,this),"ht-wrapper")?(Yy(`The "${sE(cE,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),lE(fE,this,!0),this.useTheme(),23):e}areCellsBorderBox(){return"border-box"===this.getStyleForTD("box-sizing")}useTheme(e){if(!e)return aE(pE,this,bE).call(this),lE(fE,this,!0),void lE(cE,this,e||void 0);e&&e!==sE(cE,this)&&(sE(cE,this)&&aE(pE,this,TE).call(this),lE(cE,this,e),lE(fE,this,!1),aE(pE,this,vE).call(this),aE(pE,this,bE).call(this))}getThemeName(){return sE(cE,this)}removeClassNames(){cw(sE(hE,this),sE(cE,this))&&uw(sE(hE,this),sE(cE,this))}}function yE(){const e=this.getCSSVariableValue("line-height"),t=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return null===e||null===t||isNaN(r)?null:e+2*t+r}function vE(){uw(sE(hE,this),/ht-theme-.*/g),hw(sE(hE,this),sE(cE,this))}function bE(){this.isClassicTheme()||lE(uE,this,getComputedStyle(sE(hE,this)));const e=aE(pE,this,CE).call(this,["box-sizing","border-bottom-width"]);sE(mE,this).td=l(l({},sE(mE,this).td),{"box-sizing":e["box-sizing"],"border-bottom-width":e["border-bottom-width"]})}function CE(e){const t=sE(dE,this),r=sE(hE,this),o=t.createElement("table"),n=t.createElement("tbody"),i=t.createElement("tr"),s=t.createElement("tr"),l=t.createElement("td");s.appendChild(l),n.appendChild(i),n.appendChild(s),o.appendChild(n),r.appendChild(o);const a=getComputedStyle(l),c={};return e.forEach((e=>{c[e]=a.getPropertyValue(e)})),r.removeChild(o),c}function SE(e){const t=Math.ceil(parseFloat(aE(pE,this,RE).call(this,e)));return Number.isNaN(t)?null:t}function RE(e){const t=sE(uE,this).getPropertyValue(e);return""===t?null:t}function TE(){lE(mE,this,{}),lE(gE,this,{}),lE(fE,this,!0)}class EE extends PR{constructor(e,t){super(e,new eE(t)),this.stylesHandler=new wE(this.domBindings);const r=this.wtSettings.getSetting("facade",this);this.wtTable=new rE(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new oE(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new _T(this.wtSettings.getSetting("selections")),this.wtEvent=new IS(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new QT(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e=[],t=[];Oy({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},((r,o)=>{this.wtSettings.getSetting(o).length&&t.push(r),e.push(r)})),uw(this.wtTable.wtRootElement.parentNode,e),hw(this.wtTable.wtRootElement.parentNode,t)}getOverlayByName(e){var t;if(!OR.includes(e))return null;const r=e.replace(/_([a-z])/g,(e=>e[1].toUpperCase()));return null!==(t=this.wtOverlays[`${r}Overlay`])&&void 0!==t?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class OE{constructor(e){e instanceof PR?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=e=>{const t=new OE(e);return()=>t},this._wot=new EE(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,r){return this._wot.createCellRange(e,t,r)}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(e,t)}scrollViewport(e,t,r){return this._wot.scrollViewport(e,t,r)}scrollViewportHorizontally(e,t){return this._wot.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wot.scrollViewportVertically(e,t)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,r,o,n){return this._wot.wtSettings.getSetting(e,t,r,o,n)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function ME(e){let{isShiftKey:t,isLeftClick:r,isRightClick:o,coords:n,selection:i,controller:s,cellCoordsFactory:l}=e;const a=i.isSelected()?i.getSelectedRange().current():null,c=i.isSelectedByCorner(),h=i.isSelectedByRowHeader();if(i.markSource("mouse"),t&&a)n.row>=0&&n.col>=0&&!s.cell?i.setRangeEnd(n):(c||h)&&n.row>=0&&n.col>=0&&!s.cell?i.setRangeEnd(l(n.row,n.col)):c&&n.row<0&&!s.column?i.setRangeEnd(l(a.to.row,n.col)):h&&n.col<0&&!s.row?i.setRangeEnd(l(n.row,a.to.col)):(!c&&!h&&n.col<0||c&&n.col<0)&&!s.row?i.selectRows(Math.max(a.from.row,0),n.row,n.col):(!c&&!h&&n.row<0||h&&n.row<0)&&!s.column&&i.selectColumns(Math.max(a.from.col,0),n.col,n.row);else{const e=!i.inInSelection(n),t=r||o&&e;n.row<0&&n.col>=0&&!s.column?t&&i.selectColumns(n.col,n.col,n.row):n.col<0&&n.row>=0&&!s.row?t&&i.selectRows(n.row,n.row,n.col):n.col>=0&&n.row>=0&&!s.cell?t&&i.setRangeStart(n):n.col<0&&n.row<0&&i.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}i.markEndSource()}const HE=new Map([["mousedown",ME],["mouseover",function(e){let{isLeftClick:t,coords:r,selection:o,controller:n,cellCoordsFactory:i}=e;if(!t)return;const s=o.isSelectedByRowHeader(),l=o.isSelectedByColumnHeader(),a=o.tableProps.countCols(),c=o.tableProps.countRows();o.markSource("mouse"),l&&!n.column?o.setRangeEnd(i(c-1,r.col)):s&&!n.row?o.setRangeEnd(i(r.row,a-1)):n.cell||o.setRangeEnd(r),o.markEndSource()}],["touchstart",ME]]);function xE(e,t){let{coords:r,selection:o,controller:n,cellCoordsFactory:i}=t;HE.get(e.type)({coords:r,selection:o,controller:n,cellCoordsFactory:i,isShiftKey:e.shiftKey,isLeftClick:Uy(e)||"touchstart"===e.type,isRightClick:zy(e)})}const _E=new WeakMap,NE=Symbol("rootInstance");function IE(e){return _E.has(e)}function AE(e,t,r){kE(e,t),t.set(e,r)}function kE(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DE(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PE(e,t){return e.get(VE(e,t))}function LE(e,t,r){return e.set(VE(e,t),r),r}function VE(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var FE=new WeakMap,WE=new WeakMap,BE=new WeakMap,jE=new WeakMap,zE=new WeakMap,UE=new WeakMap,YE=new WeakMap,$E=new WeakSet;function GE(){return parseInt(this.hot.rootElement.getAttribute(Qp()[0]),10)}function XE(e){const t=VE($E,this,GE).call(this)+e;dw(this.hot.rootElement,...Qp(t))}function qE(){const e=this.hot.rootElement;this.hasVerticalScroll()?hw(e,"htHasScrollY"):uw(e,"htHasScrollY"),this.hasHorizontalScroll()?hw(e,"htHasScrollX"):uw(e,"htHasScrollX")}const KE=class{constructor(e){var t,r;kE(t=this,r=$E),r.add(t),DE(this,"hot",void 0),DE(this,"eventManager",void 0),DE(this,"settings",void 0),DE(this,"THEAD",void 0),DE(this,"TBODY",void 0),DE(this,"_wt",void 0),DE(this,"activeWt",void 0),AE(this,FE,0),AE(this,WE,0),DE(this,"postponedAdjustElementsSize",!1),AE(this,BE,!1),AE(this,jE,void 0),AE(this,zE,void 0),AE(this,UE,0),AE(this,YE,0),this.hot=e,this.eventManager=new Bv(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),VE($E,this,qE).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const r=this._wt.getCell(e,t);return r<0?null:r}scrollViewport(e,t,r){return this._wt.scrollViewport(e,t,r)}scrollViewportHorizontally(e,t){return this._wt.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wt.scrollViewportVertically(e,t)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),hw(e,"handsontable"),LE(zE,this,t.createElement("TABLE")),hw(PE(zE,this),"htCore"),this.hot.getSettings().tableClassName&&hw(PE(zE,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(dw(PE(zE,this),[["role","presentation"]]),dw(e,[["role","treegrid"],Zp(-1),Qp(this.hot.countCols()),["aria-multiselectable","true"]])),this.THEAD=t.createElement("THEAD"),PE(zE,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),PE(zE,this).appendChild(this.TBODY),this.hot.table=PE(zE,this),this.hot.container.insertBefore(PE(zE,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:r,rootWindow:o}=this.hot,n=t.documentElement;this.eventManager.addEventListener(e,"mousedown",(e=>{LE(BE,this,!0),this.isTextSelectionAllowed(e.target)||(Iw(o),e.preventDefault(),o.focus())})),this.eventManager.addEventListener(e,"mouseup",(()=>{LE(BE,this,!1)})),this.eventManager.addEventListener(e,"mousemove",(e=>{PE(BE,this)&&!this.isTextSelectionAllowed(e.target)&&(this.settings.fragmentSelection&&Iw(o),e.preventDefault())})),this.eventManager.addEventListener(n,"keyup",(e=>{r.isInProgress()&&!e.shiftKey&&r.finish()})),this.eventManager.addEventListener(n,"mouseup",(o=>{r.isInProgress()&&Uy(o)&&r.finish(),LE(jE,this,!1);const n=Fw(t.activeElement);Vw(t.activeElement)&&!n||!n&&(r.isSelected()||r.isSelectedByAnyHeader()||e.contains(o.target)||zy(o))||this.hot.unlisten()})),this.eventManager.addEventListener(n,"contextmenu",(e=>{r.isInProgress()&&zy(e)&&(r.finish(),LE(jE,this,!1))})),this.eventManager.addEventListener(n,"touchend",(()=>{r.isInProgress()&&r.finish(),LE(jE,this,!1)})),this.eventManager.addEventListener(n,"mousedown",(r=>{const o=r.target,i=r.x||r.clientX,s=r.y||r.clientY;let l=r.target;if(PE(jE,this)||!e||!this.hot.view)return;const{holder:a}=this._wt.wtTable;if(l===a){const e=Dw(t);if(t.elementFromPoint(i+e,s)!==a||t.elementFromPoint(i,s+e)!==a)return}else for(;l!==n;){if(null===l){if(r.isTargetWebComponent)break;return}if(l===e)return;l=l.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(o):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}));let i=rw(o);for(;null!==i;)this.eventManager.addEventListener(i.document.documentElement,"click",(()=>{this.hot.unlisten()})),i=rw(i);this.eventManager.addEventListener(PE(zE,this),"selectstart",(e=>{this.settings.fragmentSelection||Vw(e.target)||e.preventDefault()}))}translateFromRenderableToVisualCoords(e){let{row:t,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,r))}translateFromRenderableToVisualIndex(e,t){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,o=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===r&&(r=e),null===o&&(o=t),[r,o]}countRenderableIndexes(e,t){const r=Math.min(e.getNotTrimmedIndexesLength(),t),o=e.getNearestNotHiddenIndex(r-1,-1);return null===o?0:e.getRenderableFromVisualIndex(o)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,r,o){if(isNaN(e)||e<0)return 0;const n=r.getNearestNotHiddenIndex(e,t),i=r.getRenderableFromVisualIndex(n);if(!Number.isInteger(i))return 0;let s=0;return t<0?s=i+1:t>0&&(s=o-i),s}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let r=0;for(let o=e;o<=t;o++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(o)&&(r+=1);return r}countRenderableRowsInRange(e,t){let r=0;for(let o=e;o<=t;o++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(o)&&(r+=1);return r}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var t;const r=null===(t=this.hot.rootElement.parentNode)||void 0===t?void 0:t.querySelector(".hot-display-license-info");r&&hw(r,e)}removeClassNameFromLicenseElement(e){var t;const r=null===(t=this.hot.rootElement.parentNode)||void 0===t?void 0:t.querySelector(".hot-display-license-info");r&&uw(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:PE(zE,this),isDataViewInstance:()=>IE(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(e,t)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(e,t)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const e=[];return this.hot.hasRowHeaders()&&e.push(((e,t)=>{const r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e;this.appendRowHeader(r,t)})),this.hot.runHooks("afterGetRowHeaderRenderers",e),LE(WE,this,e.length),this.hot.getSettings().ariaTags&&VE($E,this,GE).call(this)===this.hot.countCols()&&VE($E,this,XE).call(this,PE(WE,this)),e},columnHeaders:()=>{const e=[];return this.hot.hasColHeaders()&&e.push(((e,t)=>{const r=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;this.appendColHeader(r,t)})),this.hot.runHooks("afterGetColumnHeaderRenderers",e),LE(FE,this,e.length),e},columnWidth:e=>{const t=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getColWidth(null===t?e:t)},rowHeight:e=>{const t=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getRowHeight(null===t?e:t)},rowHeightByOverlayName:(e,t)=>{const r=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e),o=null===r?e:r;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(o),o,t)},cellRenderer:(e,t,r)=>{const[o,n]=this.translateFromRenderableToVisualIndex(e,t),i=this.hot.runHooks("modifyGetCellCoords",o,n,!1,"meta");let s=o,l=n;Array.isArray(i)&&([s,l]=i);const a=this.hot.getCellMeta(s,l),c=this.hot.colToProp(l);let h=this.hot.getDataAtRowProp(s,c);this.hot.hasHook("beforeValueRender")&&(h=this.hot.runHooks("beforeValueRender",h,a)),this.hot.runHooks("beforeRenderer",r,o,n,c,h,a),this.hot.getCellRenderer(a)(this.hot,r,o,n,c,h,a),this.hot.runHooks("afterRenderer",r,o,n,c,h,a)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&vw(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(e,t,r,o)=>{const n=this.translateFromRenderableToVisualCoords(t),i={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=o,LE(jE,this,!0),this.hot.runHooks("beforeOnCellMouseDown",e,n,r,i),jy(e)||(xE(e,{coords:n,selection:this.hot.selection,controller:i,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseDown",e,n,r),this.activeWt=this._wt)},onCellContextMenu:(e,t,r,o)=>{const n=this.translateFromRenderableToVisualCoords(t);this.activeWt=o,LE(jE,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",e,n,r),jy(e)||(this.hot.runHooks("afterOnCellContextMenu",e,n,r),this.activeWt=this._wt)},onCellMouseOut:(e,t,r,o)=>{const n=this.translateFromRenderableToVisualCoords(t);this.activeWt=o,this.hot.runHooks("beforeOnCellMouseOut",e,n,r),jy(e)||(this.hot.runHooks("afterOnCellMouseOut",e,n,r),this.activeWt=this._wt)},onCellMouseOver:(e,t,r,o)=>{const n=this.translateFromRenderableToVisualCoords(t),i={row:!1,column:!1,cell:!1};this.activeWt=o,this.hot.runHooks("beforeOnCellMouseOver",e,n,r,i),jy(e)||(PE(jE,this)&&xE(e,{coords:n,selection:this.hot.selection,controller:i,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseOver",e,n,r),this.activeWt=this._wt)},onCellMouseUp:(e,t,r,o)=>{const n=this.translateFromRenderableToVisualCoords(t);this.activeWt=o,this.hot.runHooks("beforeOnCellMouseUp",e,n,r),jy(e)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",e,n,r),this.activeWt=this._wt)},onCellCornerMouseDown:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:(e,t)=>this.beforeRender(e,t),onDraw:e=>this.afterRender(e),onBeforeViewportScrollVertically:(e,t)=>{const r=this.hot.rowIndexMapper,o=e<0;let n=e;return o||(n=r.getVisualFromRenderableIndex(e),null!==n)?(n=this.hot.runHooks("beforeViewportScrollVertically",n,t),this.hot.runHooks("beforeViewportScroll"),o?n:r.getRenderableFromVisualIndex(n)):e},onBeforeViewportScrollHorizontally:(e,t)=>{const r=this.hot.columnIndexMapper,o=e<0;let n=e;return o||(n=r.getVisualFromRenderableIndex(e),null!==n)?(n=this.hot.runHooks("beforeViewportScrollHorizontally",n,t),this.hot.runHooks("beforeViewportScroll"),o?n:r.getRenderableFromVisualIndex(n)):e},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(e,t,r)=>{const o=this.hot.rowIndexMapper,n=e<0;let i=e;n||(i=o.getVisualFromRenderableIndex(e));const s=this.hot.runHooks("beforeHighlightingRowHeader",i,t,r);return n?s:o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(e,t,r)=>{const o=this.hot.columnIndexMapper,n=e<0;let i=e;n||(i=o.getVisualFromRenderableIndex(e));const s=this.hot.runHooks("beforeHighlightingColumnHeader",i,t,r);return n?s:o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(e,t,r)=>{let o;const[n,i]=this.translateFromRenderableToVisualIndex(e,t),s=this.hot.selection.getSelectedRange();if(s.size()>0){const e=s.peekByIndex(null!=r?r:0);o=[e.from.row,e.from.col,e.to.row,e.to.col]}return this.hot.runHooks("afterDrawSelection",n,i,o,r)},onBeforeDrawBorders:(e,t)=>{const[r,o,n,i]=e,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(r),this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)];return this.hot.runHooks("beforeDrawBorders",s,t)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:e=>this.hot.runHooks("modifyRowHeaderWidth",e),onModifyGetCellCoords:(e,t,r,o)=>{const n=this.hot.rowIndexMapper,i=this.hot.columnIndexMapper,s=t>=0?i.getVisualFromRenderableIndex(t):t,l=e>=0?n.getVisualFromRenderableIndex(e):e,a=this.hot.runHooks("modifyGetCellCoords",l,s,r,o);if(Array.isArray(a)){const[e,t,r,o]=a;return[e>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(e,1)):e,t>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(t,1)):t,r>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1)):r,o>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1)):o]}},onModifyGetCoordsElement:(e,t)=>{const r=this.hot.rowIndexMapper,o=this.hot.columnIndexMapper,n=t>=0?o.getVisualFromRenderableIndex(t):t,i=e>=0?r.getVisualFromRenderableIndex(e):e,s=this.hot.runHooks("modifyGetCoordsElement",i,n);if(Array.isArray(s)){const[e,t]=s;return[e>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(e,1)):e,t>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(t,1)):t]}},viewportRowCalculatorOverride:e=>{let t=this.settings.viewportRowRenderingOffset;if("auto"===t&&this.settings.fixedRowsTop&&(t=10),t>0||"auto"===t){const r=this.countRenderableRows(),o=e.startRow,n=e.endRow;if("number"==typeof t)e.startRow=Math.max(o-t,0),e.endRow=Math.min(n+t,r-1);else if("auto"===t){const t=Math.max(1,Math.ceil(n/r*12));e.startRow=Math.max(o-t,0),e.endRow=Math.min(n+t,r-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:e=>{let t=this.settings.viewportColumnRenderingOffset;if("auto"===t&&this.settings.fixedColumnsStart&&(t=10),t>0||"auto"===t){const r=this.countRenderableColumns(),o=e.startColumn,n=e.endColumn;if("number"==typeof t&&(e.startColumn=Math.max(o-t,0),e.endColumn=Math.min(n+t,r-1)),"auto"===t){const t=Math.max(1,Math.ceil(n/r*6));e.startColumn=Math.max(o-t,0),e.endColumn=Math.min(n+t,r-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const e=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||e}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new OE(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:r,height:o}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,o),this.eventManager.addEventListener(t,"mousedown",(e=>{e.target===t&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(t,"contextmenu",(e=>{e.target===t&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",(()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())}))}isTextSelectionAllowed(e){if(Vw(e))return!0;const t=iw(e,this._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return PE(jE,this)}isSelectedOnlyCell(){var e,t;return null!==(e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingleCell())&&void 0!==e&&e}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const r=t.firstChild;if(!cw(r,"relative"))return mw(t),void this.appendRowHeader(e,t);this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:o}=this.hot,n=r.createElement("div"),i=r.createElement("span");n.className="relative",i.className="rowHeader",this.updateCellHeader(i,e,o),n.appendChild(i),t.appendChild(n)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const n=()=>{const t=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return t?t.split(" "):[]};if(t.firstChild){const i=t.firstChild;cw(i,"relative")?(this.updateCellHeader(i.querySelector(".colHeader"),e,r,o),i.className="",hw(i,["relative",...n()])):(mw(t),this.appendColHeader(e,t,r,o))}else{const{rootDocument:i}=this.hot,s=i.createElement("div"),l=i.createElement("span"),a=n();s.classList.add("relative",...a),l.className="colHeader",this.settings.ariaTags&&(dw(s,"role","presentation"),dw(l,"role","presentation")),this.updateCellHeader(l,e,r,o),s.appendChild(l),t.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,t,o)}updateCellHeader(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=t;const i=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(cw(e,"colHeader")?n=i.wtTable.columnFilter.sourceToRendered(t):cw(e,"rowHeader")&&(n=i.wtTable.rowFilter.sourceToRendered(t))),n>-1?ww(e,r(t,o)):(yw(e,String.fromCharCode(160)),hw(e,"cornerHeader"))}maximumVisibleElementWidth(e){const t=this._wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}maximumVisibleElementHeight(e){const t=this._wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}setLastSize(e,t){LE(UE,this,e),LE(YE,this,t)}getLastSize(){return{width:PE(UE,this),height:PE(YE,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(null!=t?t:0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(null!=t?t:this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(null!=t?t:0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(null!=t?t:this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return PE(FE,this)}getRowHeadersCount(){return PE(WE,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return(null!==(t=this._wt.wtOverlays.getParentOverlay(e))&&void 0!==t?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}};var ZE=eh,QE=ke,JE=qt,eO=ls;pn({target:"Iterator",proto:!0,real:!0},{every:function(e){JE(this),QE(e);var t=eO(this),r=0;return!ZE(t,(function(t,o){if(!e(t,r++))return o()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function tO(e){let t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Ty(e[0])&&(t=Hy(e[0]))),t}function rO(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const oO=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];rO(this,"hot",void 0),rO(this,"data",void 0),rO(this,"dataType","array"),rO(this,"colToProp",(()=>{})),rO(this,"propToCol",(()=>{})),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}getData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}setData(e){this.data=e}getAtColumn(e){const t=[];return _p(this.data,((r,o)=>{const n=this.getAtCell(o,e);t.push(n)})),t}getAtRow(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const n=void 0===t&&void 0===r,{dataDotNotation:i}=this.hot.getSettings();let s=null,l=null;if(s=this.modifyRowData(e),Array.isArray(s))l=[],n?s.forEach(((t,r)=>{l[r]=this.getAtPhysicalCell(e,r,s)})):eC(t,r,(r=>{l[r-t]=this.getAtPhysicalCell(e,r,s)}));else if(Ty(s)||Ww(s))if(l=o?[]:{},!n||o){const n=0,a=this.countFirstRowKeys()-1;eC(n,a,(c=>{const h=this.colToProp(c);if(c>=(t||n)&&c<=(r||a)&&!Number.isInteger(h)){const t=this.getAtPhysicalCell(e,h,s);o?l.push(t):i?My(l,h,t):l[h]=t}}))}else Oy(s,((t,r)=>{const o=this.getAtPhysicalCell(e,r,s);i?My(l,r,o):l[r]=o}));return l}setAtCell(e,t,r){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const o=xy(r);this.hot.runHooks("modifySourceData",e,t,o,"set"),o.isTouched()&&(r=o.value)}Number.isInteger(t)?this.data[e][t]=r:My(this.data[e],t,r)}}getAtPhysicalCell(e,t,r){let o=null;if(r)if("string"==typeof t){const{dataDotNotation:e}=this.hot.getSettings();o=e?function(e,t){const r=t.split(".");let o=e;return Oy(r,(e=>{if(o=o[e],void 0===o)return o=void 0,!1})),o}(r,t):r[t]}else o="function"==typeof t?t(r):r[t];if(this.hot.hasHook("modifySourceData")){const r=xy(o);this.hot.runHooks("modifySourceData",e,t,r,"get"),r.isTouched()&&(o=r.value)}return o}getAtCell(e,t){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),r)}getByRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,n=null,i=null,s=null,l=null;null===e||null===t?(o=!0,n=0,s=this.countRows()-1):(n=Math.min(e.row,t.row),i=Math.min(e.col,t.col),s=Math.max(e.row,t.row),l=Math.max(e.col,t.col));const a=[];return eC(n,s,(e=>{a.push(o?this.getAtRow(e,void 0,void 0,r):this.getAtRow(e,i,l,r))})),a}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return tO(this.data)}destroy(){this.data=null,this.hot=null}};var nO=eh,iO=ke,sO=qt,lO=ls;function aO(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}pn({target:"Iterator",proto:!0,real:!0},{some:function(e){sO(this),iO(e);var t=lO(this),r=0;return nO(t,(function(t,o){if(e(t,r++))return o()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});class cO{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;aO(this,"indexedValues",[]),aO(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Ww(this.initValueOrFn)?eC(e-1,(e=>this.indexedValues.push(this.initValueOrFn(e)))):eC(e-1,(()=>this.indexedValues.push(this.initValueOrFn))),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function hO(e,t,r,o){const n=r.length?r[0]:void 0;return[...e.slice(0,n),...r.map(((e,t)=>Ww(o)?o(e,t):o)),...void 0===n?[]:e.slice(n)]}function uO(e,t){return Hp(e,((e,r)=>!1===t.includes(r)))}Sy(cO,JR);class dO extends cO{insert(e,t){this.indexedValues=hO(this.indexedValues,0,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=uO(this.indexedValues,e),super.remove(e)}}class fO extends dO{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getHiddenIndexes(){return Mp(this.getValues(),((e,t,r)=>(t&&e.push(r),e)),[])}}function gO(e,t,r){return[...e.slice(0,t),...r,...e.slice(t)]}function mO(e,t){return Hp(e,(e=>!1===t.includes(e)))}function pO(e,t){return xp(e,(e=>e-t.filter((t=>t<e)).length))}function wO(e,t){const r=t[0],o=t.length;return xp(e,(e=>e>=r?e+o:e))}function yO(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class vO extends dO{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getTrimmedIndexes(){return Mp(this.getValues(),((e,t,r)=>(t&&e.push(r),e)),[])}}class bO extends cO{constructor(){super((e=>e))}insert(e,t){const r=wO(this.indexedValues,t);this.indexedValues=gO(r,e,t),super.insert(e,t)}remove(e){const t=mO(this.indexedValues,e);this.indexedValues=pO(t,e),super.remove(e)}}const CO=new Map([["hiding",fO],["index",cO],["linkedPhysicalIndexToValue",class extends cO{constructor(){super(...arguments),yO(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map((e=>this.indexedValues[e]))}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0)}clearValue(e){this.orderOfIndexes=mO(this.orderOfIndexes,[e]),Ww(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=hO(this.indexedValues,0,t,this.initValueOrFn),this.orderOfIndexes=wO(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=uO(this.indexedValues,e),this.orderOfIndexes=mO(this.orderOfIndexes,e),this.orderOfIndexes=pO(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map((e=>[e,this.getValueAtIndex(e)]))}}],["physicalIndexToValue",dO],["trimming",vO]]);function SO(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class RO{constructor(){SO(this,"collection",new Map)}register(e,t){!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",(()=>this.runLocalHooks("change",t))))}unregister(e){const t=this.collection.get(e);Dp(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t))}unregisterAll(){this.collection.forEach(((e,t)=>this.unregister(t))),this.collection.clear()}get(e){return Pp(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach((t=>{t.remove(e)}))}insertToEvery(e,t){this.collection.forEach((r=>{r.insert(e,t)}))}initEvery(e){this.collection.forEach((t=>{t.init(e)}))}}function TO(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Sy(RO,JR);class EO extends RO{constructor(e,t){super(),TO(this,"mergedValuesCache",[]),TO(this,"aggregationFunction",void 0),TO(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];const e=xp(this.get(),(e=>e.getValues())),t=[],r=Dp(e[0])&&e[0].length||0;for(let o=0;o<r;o+=1){const r=[];for(let t=0;t<this.getLength();t+=1)r.push(e[t][o]);t.push(r)}return xp(t,this.aggregationFunction)}getMergedValueAtIndex(e,t){const r=this.getMergedValues(t)[e];return Dp(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function OO(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function MO(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var HO=new WeakMap;class xO{constructor(){OO(this,HO,[])}subscribe(e){var t,r;return this.addLocalHook("change",e),this._write((r=this,(t=HO).get(MO(t,r)))),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){var t,r,o;r=this,o=e,(t=HO).set(MO(t,r),o)}}function _O(e,t){const r=[];let o=0,n=0;for(;o<e.length&&n<t.length;o++,n++)e[o]!==t[n]&&r.push({op:"replace",index:n,oldValue:e[o],newValue:t[n]});for(;o<t.length;o++)r.push({op:"insert",index:o,oldValue:void 0,newValue:t[o]});for(;n<e.length;n++)r.push({op:"remove",index:n,oldValue:e[n],newValue:void 0});return r}function NO(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function IO(e,t){return e.get(kO(e,t))}function AO(e,t,r){return e.set(kO(e,t),r),r}function kO(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}Sy(xO,JR);var DO=new WeakMap,PO=new WeakMap,LO=new WeakMap,VO=new WeakMap,FO=new WeakMap;class WO{constructor(){let{initialIndexValue:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};NO(this,DO,new Set),NO(this,PO,[]),NO(this,LO,[]),NO(this,VO,!1),NO(this,FO,!1),AO(FO,this,null!=e&&e)}createObserver(){const e=new xO;return IO(DO,this).add(e),e.addLocalHook("unsubscribe",(()=>{IO(DO,this).delete(e)})),e._writeInitialChanges(_O(IO(PO,this),IO(LO,this))),e}emit(e){let t=IO(LO,this);IO(VO,this)&&IO(PO,this).length===e.length||(0===e.length?e=new Array(t.length).fill(IO(FO,this)):AO(PO,this,new Array(e.length).fill(IO(FO,this))),IO(VO,this)||(AO(VO,this,!0),t=IO(PO,this)));const r=_O(t,e);IO(DO,this).forEach((e=>e._write(r))),AO(LO,this,e)}}function BO(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class jO{constructor(){BO(this,"indexesSequence",new bO),BO(this,"trimmingMapsCollection",new EO((e=>e.some((e=>!0===e))),!1)),BO(this,"hidingMapsCollection",new EO((e=>e.some((e=>!0===e))),!1)),BO(this,"variousMapsCollection",new RO),BO(this,"hidingChangesObservable",new WO({initialIndexValue:!1})),BO(this,"notTrimmedIndexesCache",[]),BO(this,"notHiddenIndexesCache",[]),BO(this,"isBatched",!1),BO(this,"indexesSequenceChanged",!1),BO(this,"indexesChangeSource",void 0),BO(this,"trimmedIndexesChanged",!1),BO(this,"hiddenIndexesChanged",!1),BO(this,"renderablePhysicalIndexesCache",[]),BO(this,"fromPhysicalToVisualIndexesCache",new Map),BO(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",(()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(e=>{this.runLocalHooks("change",e,this.variousMapsCollection)}))}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if("hiding"!==e)throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,r){return this.registerMap(e,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!CO.has(e))throw new Error(`The provided map type ("${e}") does not exist.`);return new(CO.get(e))(t)}(t,r))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof vO?this.trimmingMapsCollection.register(e,t):t instanceof fO?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const r=this.getNumberOfIndexes();return r>0&&t.init(r),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return Dp(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return Dp(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return Dp(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return Dp(t)?t:null}getNearestNotHiddenIndex(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(e))return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let n=-1;return n=t>0?o.findIndex((t=>t>e)):o.reverse().findIndex((t=>t<e)),-1===n?r?this.getNearestNotHiddenIndex(e,-t,!1):null:o[n]}initToLength(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const t=[...Array(this.getNumberOfIndexes()-e).keys()].map((t=>t+e));this.removeIndexes(t)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notTrimmedIndexesCache;return this.getIndexesSequence().filter((e=>!1===this.isTrimmed(e)))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notHiddenIndexesCache;return this.getIndexesSequence().filter((e=>!1===this.isHidden(e)))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.renderablePhysicalIndexesCache;return this.getNotTrimmedIndexes().filter((e=>!1===this.isHidden(e)))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){"number"==typeof e&&(e=[e]);const r=xp(e,(e=>this.getPhysicalFromVisualIndex(e))),o=this.getNotTrimmedIndexesLength(),n=e.length,i=mO(this.getIndexesSequence(),r),s=i.filter((e=>!1===this.isTrimmed(e)));let l=i.indexOf(s[s.length-1])+1;if(t+n<o){const e=s[t];l=i.indexOf(e)}this.indexesChangeSource="move",this.setIndexesSequence(gO(i,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const r=this.getNotTrimmedIndexes()[e],o=Dp(r)?r:this.getNumberOfIndexes(),n=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),i=xp(new Array(t).fill(o),((e,t)=>e+t));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(n,i),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(n,i),this.hidingMapsCollection.insertToEvery(n,i),this.variousMapsCollection.insertToEvery(n,i),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(e,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromRenderableIndex(t),r=this.getVisualFromPhysicalIndex(e);this.fromVisualToRenderableIndexesCache.set(r,t)}}}function zO(e){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:e}function UO(e){Dp(e)&&(Ap`Language with code "${e}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`,Dp(console))}Sy(jO,JR);const{register:YO,getValues:$O}=_v("phraseFormatters");YO("pluralize",(function(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}));const GO="ContextMenu:items",XO=`${GO}.noItems`,qO=`${GO}.insertRowAbove`,KO=`${GO}.insertRowBelow`,ZO=`${GO}.insertColumnOnTheLeft`,QO=`${GO}.insertColumnOnTheRight`,JO=`${GO}.removeRow`,eM=`${GO}.removeColumn`,tM=`${GO}.undo`,rM=`${GO}.redo`,oM=`${GO}.readOnly`,nM=`${GO}.clearColumn`,iM=`${GO}.copy`,sM=`${GO}.copyWithHeaders`,lM=`${GO}.copyWithGroupHeaders`,aM=`${GO}.copyHeadersOnly`,cM=`${GO}.cut`,hM=`${GO}.freezeColumn`,uM=`${GO}.unfreezeColumn`,dM=`${GO}.mergeCells`,fM=`${GO}.unmergeCells`,gM=`${GO}.addComment`,mM=`${GO}.editComment`,pM=`${GO}.removeComment`,wM=`${GO}.readOnlyComment`,yM=`${GO}.align`,vM=`${GO}.align.left`,bM=`${GO}.align.center`,CM=`${GO}.align.right`,SM=`${GO}.align.justify`,RM=`${GO}.align.top`,TM=`${GO}.align.middle`,EM=`${GO}.align.bottom`,OM=`${GO}.borders`,MM=`${GO}.borders.top`,HM=`${GO}.borders.right`,xM=`${GO}.borders.bottom`,_M=`${GO}.borders.left`,NM=`${GO}.borders.remove`,IM=`${GO}.nestedHeaders.insertChildRow`,AM=`${GO}.nestedHeaders.detachFromParent`,kM=`${GO}.hideColumn`,DM=`${GO}.showColumn`,PM=`${GO}.hideRow`,LM=`${GO}.showRow`,VM="Filters:",FM=`${VM}conditions`,WM=`${FM}.none`,BM=`${FM}.isEmpty`,jM=`${FM}.isNotEmpty`,zM=`${FM}.isEqualTo`,UM=`${FM}.isNotEqualTo`,YM=`${FM}.beginsWith`,$M=`${FM}.endsWith`,GM=`${FM}.contains`,XM=`${FM}.doesNotContain`,qM=`${FM}.byValue`,KM=`${FM}.greaterThan`,ZM=`${FM}.greaterThanOrEqualTo`,QM=`${FM}.lessThan`,JM=`${FM}.lessThanOrEqualTo`,eH=`${FM}.isBetween`,tH=`${FM}.isNotBetween`,rH=`${FM}.after`,oH=`${FM}.before`,nH=`${FM}.today`,iH=`${FM}.tomorrow`,sH=`${FM}.yesterday`,lH=`${VM}labels.filterByCondition`,aH=`${VM}labels.filterByValue`,cH=`${VM}labels.conjunction`,hH=`${VM}labels.disjunction`,uH=`${VM}values.blankCells`,dH=`${VM}buttons.selectAll`,fH=`${VM}buttons.clear`,gH=`${VM}buttons.ok`,mH=`${VM}buttons.cancel`,pH=`${VM}buttons.placeholder.search`,wH=`${VM}buttons.placeholder.value`,yH=`${VM}buttons.placeholder.secondValue`,vH="CheckboxRenderer:",bH=`${vH}checked`,CH=`${vH}unchecked`,SH=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:bH,CHECKBOX_RENDERER_NAMESPACE:vH,CHECKBOX_UNCHECKED:CH,CONTEXTMENU_ITEMS_ADD_COMMENT:gM,CONTEXTMENU_ITEMS_ALIGNMENT:yM,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:EM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:bM,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:SM,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:vM,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:TM,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:CM,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:RM,CONTEXTMENU_ITEMS_BORDERS:OM,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:xM,CONTEXTMENU_ITEMS_BORDERS_LEFT:_M,CONTEXTMENU_ITEMS_BORDERS_RIGHT:HM,CONTEXTMENU_ITEMS_BORDERS_TOP:MM,CONTEXTMENU_ITEMS_CLEAR_COLUMN:nM,CONTEXTMENU_ITEMS_COPY:iM,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:aM,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:lM,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:sM,CONTEXTMENU_ITEMS_CUT:cM,CONTEXTMENU_ITEMS_EDIT_COMMENT:mM,CONTEXTMENU_ITEMS_FREEZE_COLUMN:hM,CONTEXTMENU_ITEMS_HIDE_COLUMN:kM,CONTEXTMENU_ITEMS_HIDE_ROW:PM,CONTEXTMENU_ITEMS_INSERT_LEFT:ZO,CONTEXTMENU_ITEMS_INSERT_RIGHT:QO,CONTEXTMENU_ITEMS_MERGE_CELLS:dM,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:AM,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:IM,CONTEXTMENU_ITEMS_NO_ITEMS:XO,CONTEXTMENU_ITEMS_READ_ONLY:oM,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:wM,CONTEXTMENU_ITEMS_REDO:rM,CONTEXTMENU_ITEMS_REMOVE_BORDERS:NM,CONTEXTMENU_ITEMS_REMOVE_COLUMN:eM,CONTEXTMENU_ITEMS_REMOVE_COMMENT:pM,CONTEXTMENU_ITEMS_REMOVE_ROW:JO,CONTEXTMENU_ITEMS_ROW_ABOVE:qO,CONTEXTMENU_ITEMS_ROW_BELOW:KO,CONTEXTMENU_ITEMS_SHOW_COLUMN:DM,CONTEXTMENU_ITEMS_SHOW_ROW:LM,CONTEXTMENU_ITEMS_UNDO:tM,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:uM,CONTEXTMENU_ITEMS_UNMERGE_CELLS:fM,CONTEXT_MENU_ITEMS_NAMESPACE:GO,FILTERS_BUTTONS_CANCEL:mH,FILTERS_BUTTONS_CLEAR:fH,FILTERS_BUTTONS_OK:gH,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:pH,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:yH,FILTERS_BUTTONS_PLACEHOLDER_VALUE:wH,FILTERS_BUTTONS_SELECT_ALL:dH,FILTERS_CONDITIONS_AFTER:rH,FILTERS_CONDITIONS_BEFORE:oH,FILTERS_CONDITIONS_BEGINS_WITH:YM,FILTERS_CONDITIONS_BETWEEN:eH,FILTERS_CONDITIONS_BY_VALUE:qM,FILTERS_CONDITIONS_CONTAINS:GM,FILTERS_CONDITIONS_EMPTY:BM,FILTERS_CONDITIONS_ENDS_WITH:$M,FILTERS_CONDITIONS_EQUAL:zM,FILTERS_CONDITIONS_GREATER_THAN:KM,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:ZM,FILTERS_CONDITIONS_LESS_THAN:QM,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:JM,FILTERS_CONDITIONS_NAMESPACE:FM,FILTERS_CONDITIONS_NONE:WM,FILTERS_CONDITIONS_NOT_BETWEEN:tH,FILTERS_CONDITIONS_NOT_CONTAIN:XM,FILTERS_CONDITIONS_NOT_EMPTY:jM,FILTERS_CONDITIONS_NOT_EQUAL:UM,FILTERS_CONDITIONS_TODAY:nH,FILTERS_CONDITIONS_TOMORROW:iH,FILTERS_CONDITIONS_YESTERDAY:sH,FILTERS_DIVS_FILTER_BY_CONDITION:lH,FILTERS_DIVS_FILTER_BY_VALUE:aH,FILTERS_LABELS_CONJUNCTION:cH,FILTERS_LABELS_DISJUNCTION:hH,FILTERS_NAMESPACE:VM,FILTERS_VALUES_BLANK_CELLS:uH},Symbol.toStringTag,{value:"Module"})),RH={languageCode:"en-US",[XO]:"No available options",[qO]:"Insert row above",[KO]:"Insert row below",[ZO]:"Insert column left",[QO]:"Insert column right",[JO]:["Remove row","Remove rows"],[eM]:["Remove column","Remove columns"],[tM]:"Undo",[rM]:"Redo",[oM]:"Read only",[nM]:"Clear column",[yM]:"Alignment",[vM]:"Left",[bM]:"Center",[CM]:"Right",[SM]:"Justify",[RM]:"Top",[TM]:"Middle",[EM]:"Bottom",[hM]:"Freeze column",[uM]:"Unfreeze column",[OM]:"Borders",[MM]:"Top",[HM]:"Right",[xM]:"Bottom",[_M]:"Left",[NM]:"Remove border(s)",[gM]:"Add comment",[mM]:"Edit comment",[pM]:"Delete comment",[wM]:"Read-only comment",[dM]:"Merge cells",[fM]:"Unmerge cells",[iM]:"Copy",[sM]:["Copy with header","Copy with headers"],[lM]:["Copy with group header","Copy with group headers"],[aM]:["Copy header only","Copy headers only"],[cM]:"Cut",[IM]:"Insert child row",[AM]:"Detach from parent",[kM]:["Hide column","Hide columns"],[DM]:["Show column","Show columns"],[PM]:["Hide row","Hide rows"],[LM]:["Show row","Show rows"],[WM]:"None",[BM]:"Is empty",[jM]:"Is not empty",[zM]:"Is equal to",[UM]:"Is not equal to",[YM]:"Begins with",[$M]:"Ends with",[GM]:"Contains",[XM]:"Does not contain",[KM]:"Greater than",[ZM]:"Greater than or equal to",[QM]:"Less than",[JM]:"Less than or equal to",[eH]:"Is between",[tH]:"Is not between",[rH]:"After",[oH]:"Before",[nH]:"Today",[iH]:"Tomorrow",[sH]:"Yesterday",[uH]:"Blank cells",[lH]:"Filter by condition",[aH]:"Filter by value",[cH]:"And",[hH]:"Or",[dH]:"Select all",[fH]:"Clear",[gH]:"OK",[mH]:"Cancel",[pH]:"Search",[wH]:"Value",[yH]:"Second value",[bH]:"Checked",[CH]:"Unchecked"},TH=SH,EH=RH.languageCode,{register:OH,getItem:MH,hasItem:HH,getValues:xH}=_v("languagesDictionaries");function _H(e,t){let r=e,o=t;return Ty(e)&&(o=e,r=o.languageCode),function(e,t){e!==EH&&(r=t,Oy(MH(EH),((e,t)=>{Pp(r[t])&&(r[t]=e)})));var r}(r,o),OH(r,Cy(o)),Cy(o)}function NH(e){return IH(e)?Cy(MH(e)):null}function IH(e){return HH(e)}function AH(e,t,r){const o=NH(e);if(null===o)return null;const n=o[t];if(Pp(n))return null;const i=function(e,t){let r=e;return _p(function(){return $O()}(),(o=>{r=o(e,t)})),r}(n,r);return Array.isArray(i)?i[0]:i}function kH(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}_H(RH);const DH=class extends tT{constructor(e,t){super(e,null),kH(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:r}=e,o=this.getNearestNotHiddenCoords(t,1),n=this.getNearestNotHiddenCoords(r,-1);return null===o||null===n?null:((o.row>n.row||o.col>n.col)&&(o=t,n=r),this.settings.createCellRange(o,o,n))}getNearestNotHiddenCoords(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const o=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(null===o)return null;const n=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return null===n?null:this.settings.createCellCoords(o,n)}getNearestNotHiddenIndex(e,t,r){return t<0?t:e.getNearestNotHiddenIndex(t,r)}commit(){if(null===this.visualCellRange)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===e?null:this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),r="N-S"===e.getVerticalDirection()?1:-1,o="W-E"===e.getHorizontalDirection()?1:-1,n=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let i=null;if(null!==n&&null!==n.col&&null!==n.row||(i=this.getNearestNotHiddenCoords(t,r,o)),null!==i&&e.overlaps(i)){const t=e.highlight.clone();if(t.row>=0&&(t.row=i.row),t.col>=0&&(t.col=i.col),null===this.cellRange){const e=this.settings.visualToRenderableCoords(t);this.cellRange=this.settings.createCellRange(e)}e.setHighlight(t)}return"focus"===this.settings.selectionType&&null!==n&&null===i&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const r=this.settings.visualToRenderableCoords(e),o=this.settings.visualToRenderableCoords(t);return null===r.row||null===r.col||null===o.row||null===o.col?null:this.settings.createCellRange(r,r,o)}};function PH(e){let t=e,{activeHeaderClassName:r}=t,o=c(t,["activeHeaderClassName"]);return new DH(a(l({className:r},o),{selectionType:"active-header"}))}function LH(e){let t=e,{areaCornerVisible:r}=t,o=c(t,["areaCornerVisible"]);return new DH(a(l({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:r}},o),{selectionType:oT}))}function VH(e){let t=c(e,[]);return new DH(a(l({className:"highlight"},t),{selectionType:oT}))}function FH(e){let t=e,{columnClassName:r}=t,o=c(t,["columnClassName"]);return new DH(a(l({className:r},o),{selectionType:"column"}))}function WH(e){let t=e,{headerClassName:r}=t,o=c(t,["headerClassName"]);return new DH(a(l({className:r},o),{selectionType:rT}))}function BH(e){let t=e,{rowClassName:r}=t,o=c(t,["rowClassName"]);return new DH(a(l({className:r},o),{selectionType:"row"}))}function jH(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function zH(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UH(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var YH=new WeakSet;class $H{constructor(e){jH(this,YH),zH(this,"options",void 0),zH(this,"layerLevel",0),zH(this,"focus",void 0),zH(this,"fill",void 0),zH(this,"layeredAreas",new Map),zH(this,"areas",new Map),zH(this,"rowHeaders",new Map),zH(this,"columnHeaders",new Map),zH(this,"activeRowHeaders",new Map),zH(this,"activeColumnHeaders",new Map),zH(this,"activeCornerHeaders",new Map),zH(this,"rowHighlights",new Map),zH(this,"columnHighlights",new Map),zH(this,"customSelections",[]),this.options=e,this.focus=function(e){let t=e,{cellCornerVisible:r}=t,o=c(t,["cellCornerVisible"]);return new DH(a(l({className:"current",headerAttributes:[["aria-selected","true"]],border:{width:2,color:"#4b89ff",cornerVisible:r}},o),{selectionType:nT}))}(e),this.fill=function(e){let t=c(e,[]);return new DH(a(l({className:"fill",border:{width:1,color:"#ff0000"}},t),{selectionType:"fill"}))}(e)}isEnabledFor(e,t){let r=e;e===nT&&(r="current");let o=this.options.disabledCellSelection(t.row,t.col);return"string"==typeof o&&(o=[o]),!1===o||Array.isArray(o)&&!o.includes(r)}useLayerLevel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return UH(YH,this,GH).call(this,this.layeredAreas,LH)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return UH(YH,this,GH).call(this,this.areas,VH)}getAreas(){return[...this.areas.values()]}createRowHeader(){return UH(YH,this,GH).call(this,this.rowHeaders,WH)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return UH(YH,this,GH).call(this,this.columnHeaders,WH)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return UH(YH,this,GH).call(this,this.activeRowHeaders,PH)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return UH(YH,this,GH).call(this,this.activeColumnHeaders,PH)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return UH(YH,this,GH).call(this,this.activeCornerHeaders,PH)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return UH(YH,this,GH).call(this,this.rowHighlights,BH)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return UH(YH,this,GH).call(this,this.columnHighlights,FH)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(function(e){let t=e,{border:r,visualCellRange:o}=t,n=c(t,["border","visualCellRange"]);return new DH(a(l(l({},r),n),{selectionType:"custom-selection"}),o)}(l(l({},this.options),e)))}clear(){this.focus.clear(),this.fill.clear(),_p(this.areas.values(),(e=>{e.clear()})),_p(this.layeredAreas.values(),(e=>{e.clear()})),_p(this.rowHeaders.values(),(e=>{e.clear()})),_p(this.columnHeaders.values(),(e=>{e.clear()})),_p(this.activeRowHeaders.values(),(e=>{e.clear()})),_p(this.activeColumnHeaders.values(),(e=>{e.clear()})),_p(this.activeCornerHeaders.values(),(e=>{e.clear()})),_p(this.rowHighlights.values(),(e=>{e.clear()})),_p(this.columnHighlights.values(),(e=>{e.clear()}))}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function GH(e,t){const r=this.layerLevel;if(e.has(r))return e.get(r);const o=t(l({layerLevel:r},this.options));return e.set(r,o),o}const XH=$H;function qH(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class KH{constructor(e){qH(this,"ranges",[]),qH(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return 0===this.size()}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some((t=>t.includes(e)))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t>=0&&t<this.size()&&(e=this.ranges[t]),e}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const ZH=KH;function QH(e,t,r){JH(e,t),t.set(e,r)}function JH(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ex(e,t){return e.get(rx(e,t))}function tx(e,t,r){return e.set(rx(e,t),r),r}function rx(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var ox=new WeakMap,nx=new WeakMap,ix=new WeakMap,sx=new WeakSet;class lx{constructor(e,t){var r,o;JH(r=this,o=sx),o.add(r),QH(this,ox,void 0),QH(this,nx,void 0),QH(this,ix,{x:0,y:0}),tx(ox,this,e),tx(nx,this,t)}transformStart(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=ex(nx,this).createCellCoords(e,t);let n=ex(ox,this).current().highlight;const i=ex(nx,this).visualToRenderableCoords(n);let s=0,l=0;if(this.runLocalHooks("beforeTransformStart",o),null!==i.row&&null!==i.col){const{width:e,height:t}=rx(sx,this,cx).call(this),{row:i,col:a}=rx(sx,this,dx).call(this,n),c=ex(nx,this).fixedRowsBottom(),h=ex(nx,this).minSpareRows(),u=ex(nx,this).minSpareCols(),d=ex(nx,this).autoWrapRow(),f=ex(nx,this).autoWrapCol(),g=ex(nx,this).createCellCoords(i+o.row,a+o.col);if(g.row>=t){const o=xy(r&&h>0&&0===c),n=g.col+1,i=ex(nx,this).createCellCoords(g.row-t,n>=e?n-e:n);this.runLocalHooks("beforeColumnWrap",o,rx(sx,this,fx).call(this,i),n>=e),o.value?this.runLocalHooks("insertRowRequire",ex(nx,this).countRenderableRows()):f&&g.assign(i)}else if(g.row<0){const r=xy(f),o=g.col-1,n=ex(nx,this).createCellCoords(t+g.row,o<0?e+o:o);this.runLocalHooks("beforeColumnWrap",r,rx(sx,this,fx).call(this,n),o<0),f&&g.assign(n)}if(g.col>=e){const o=xy(r&&u>0),n=g.row+1,i=ex(nx,this).createCellCoords(n>=t?n-t:n,g.col-e);this.runLocalHooks("beforeRowWrap",o,rx(sx,this,fx).call(this,i),n>=t),o.value?this.runLocalHooks("insertColRequire",ex(nx,this).countRenderableColumns()):d&&g.assign(i)}else if(g.col<0){const r=xy(d),o=g.row-1,n=ex(nx,this).createCellCoords(o<0?t+o:o,e+g.col);this.runLocalHooks("beforeRowWrap",r,rx(sx,this,fx).call(this,n),o<0),d&&g.assign(n)}const{rowDir:m,colDir:p}=rx(sx,this,ax).call(this,g);s=m,l=p,n=rx(sx,this,fx).call(this,g)}return this.runLocalHooks("afterTransformStart",n,s,l),n}transformEnd(e,t){const r=ex(nx,this).createCellCoords(e,t),o=ex(ox,this).current(),n=ex(nx,this).visualToRenderableCoords(o.highlight),i=rx(sx,this,hx).call(this,o.to.row,o.from.row),s=rx(sx,this,ux).call(this,o.to.col,o.from.col),l=o.to.clone();let a=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),null!==n.row&&null!==n.col&&null!==i&&null!==s){const{row:e,col:t}=rx(sx,this,dx).call(this,o.highlight),n=ex(nx,this).createCellCoords(i+r.row,s+r.col),h=o.getTopStartCorner(),u=o.getTopEndCorner(),d=o.getBottomEndCorner();if(r.col<0&&s>=t&&n.col<t){const e=n.col-t;n.col=rx(sx,this,ux).call(this,h.col,u.col)+e}else if(r.col>0&&s<=t&&n.col>t){const e=rx(sx,this,ux).call(this,u.col,h.col),t=Math.max(n.col-e,1);n.col=e+t}if(r.row<0&&i>=e&&n.row<e){const t=n.row-e;n.row=rx(sx,this,hx).call(this,h.row,d.row)+t}else if(r.row>0&&i<=e&&n.row>e){const e=rx(sx,this,hx).call(this,d.row,h.row),t=Math.max(n.row-e,1);n.row=e+t}const{rowDir:f,colDir:g}=rx(sx,this,ax).call(this,n);a=f,c=g;const m=rx(sx,this,fx).call(this,n);0===r.row&&0!==r.col?l.col=m.col:0!==r.row&&0===r.col?l.row=m.row:(l.row=m.row,l.col=m.col)}return this.runLocalHooks("afterTransformEnd",l,a,c),l}setOffsetSize(e){let{x:t,y:r}=e;tx(ix,this,{x:t,y:r})}resetOffsetSize(){tx(ix,this,{x:0,y:0})}}function ax(e){const{width:t,height:r}=rx(sx,this,cx).call(this);let o=0,n=0;return e.row<0?(o=-1,e.row=0):e.row>0&&e.row>=r&&(o=1,e.row=r-1),e.col<0?(n=-1,e.col=0):e.col>0&&e.col>=t&&(n=1,e.col=t-1),{rowDir:o,colDir:n}}function cx(){return{width:ex(ix,this).x+ex(nx,this).countRenderableColumns(),height:ex(ix,this).y+ex(nx,this).countRenderableRows()}}function hx(e,t){const r=ex(nx,this).findFirstNonHiddenRenderableRow(e,t);return null===r?null:ex(ix,this).y+r}function ux(e,t){const r=ex(nx,this).findFirstNonHiddenRenderableColumn(e,t);return null===r?null:ex(ix,this).x+r}function dx(e){const{row:t,col:r}=ex(nx,this).visualToRenderableCoords(e);if(null===t||null===r)throw new Error("Renderable coords are not visible.");return ex(nx,this).createCellCoords(ex(ix,this).y+t,ex(ix,this).x+r)}function fx(e){const t=e.clone();return t.col=e.col-ex(ix,this).x,t.row=e.row-ex(ix,this).y,ex(nx,this).renderableToVisualCoords(t)}Sy(lx,JR);const gx=lx,mx=[3,2],px=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],wx=Symbol("root"),yx=Symbol("child");function vx(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:wx;if(t!==wx&&t!==yx)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(e),o=t===wx;let n=0;if(r){const t=e[0];if(0===e.length)n=1;else if(o&&t instanceof wS)n=3;else if(o&&Array.isArray(t))n=vx(t,yx);else if(e.length>=2&&e.length<=4){!e.some(((e,t)=>!px[t].includes(typeof e)))&&(n=2)}}return n}function bx(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function Cx(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sx(e,t){return e.get(Tx(e,t))}function Rx(e,t,r){return e.set(Tx(e,t),r),r}function Tx(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var Ex=new WeakMap,Ox=new WeakMap,Mx=new WeakMap,Hx=new WeakMap,xx=new WeakMap,_x=new WeakMap;class Nx{constructor(e,t){var r=this;Cx(this,"settings",void 0),Cx(this,"tableProps",void 0),Cx(this,"inProgress",!1),Cx(this,"selectedRange",new ZH(((e,t,r)=>this.tableProps.createCellRange(e,t,r)))),Cx(this,"highlight",void 0),bx(this,Ex,void 0),bx(this,Ox,void 0),Cx(this,"selectedByRowHeader",new Set),Cx(this,"selectedByColumnHeader",new Set),bx(this,Mx,!1),bx(this,Hx,!1),bx(this,xx,"unknown"),bx(this,_x,-1),this.settings=e,this.tableProps=t,this.highlight=new XH({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[["aria-selected","true"]],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(e,t)=>this.tableProps.isDisabledCellSelection(e,t),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),createCellRange:(e,t,r)=>this.tableProps.createCellRange(e,t,r)}),Rx(Ex,this,new gx(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Rx(Ox,this,new gx(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const e=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const e=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Sx(Ex,this).addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformStart",...t)})),Sx(Ex,this).addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return r.runLocalHooks("afterModifyTransformStart",...t)})),Sx(Ex,this).addLocalHook("beforeTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformEnd",...t)})),Sx(Ex,this).addLocalHook("afterTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return r.runLocalHooks("afterModifyTransformEnd",...t)})),Sx(Ex,this).addLocalHook("insertRowRequire",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return r.runLocalHooks("insertRowRequire",...t)})),Sx(Ex,this).addLocalHook("insertColRequire",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return r.runLocalHooks("insertColRequire",...t)})),Sx(Ex,this).addLocalHook("beforeRowWrap",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return r.runLocalHooks("beforeRowWrap",...t)})),Sx(Ex,this).addLocalHook("beforeColumnWrap",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return r.runLocalHooks("beforeColumnWrap",...t)})),Sx(Ox,this).addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return r.runLocalHooks("beforeModifyTransformFocus",...t)})),Sx(Ox,this).addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return r.runLocalHooks("afterModifyTransformFocus",...t)}))}getSelectedRange(){return this.selectedRange}markSource(e){Rx(xx,this,e)}markEndSource(){Rx(xx,this,"unknown")}getSelectionSource(){return Sx(xx,this)}setExpectedLayers(e){Rx(_x,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Rx(_x,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;const n="multiple"===this.settings.selectionMode,i=Pp(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,s=e.clone();Rx(Mx,this,!1),this.runLocalHooks("beforeSetRangeStart"+(r?"Only":""),s),(!n||n&&!i&&Pp(t))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(o.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.setRangeStart(e,t,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),r=this.tableProps.countRows(),o=this.tableProps.countCols(),n=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||o>0)&&(0===r&&t.col<0&&!n||0===o&&t.row<0&&!n))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const i=this.selectedRange.current();if(this.settings.navigableHeaders||i.highlight.normalize(),"single"===this.settings.selectionMode)i.setFrom(i.highlight),i.setTo(i.highlight);else{const e=i.getHorizontalDirection(),r=i.getVerticalDirection(),o=this.isMultiple();i.setTo(t),o&&(e!==i.getHorizontalDirection()||1===i.getWidth()&&!i.includes(i.highlight))&&i.from.assign({col:i.highlight.col}),o&&(r!==i.getVerticalDirection()||1===i.getHeight()&&!i.includes(i.highlight))&&i.from.assign({row:i.highlight.row})}r>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!i.isSingleHeader())&&i.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const s=-1===Sx(_x,this)||this.selectedRange.size()===Sx(_x,this);this.runLocalHooks("afterSetRangeEnd",e,s)}applyAndCommit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),o=this.tableProps.countCols();t<this.highlight.layerLevel&&(_p(this.highlight.getAreas(),(e=>{e.clear()})),_p(this.highlight.getLayeredAreas(),(e=>{e.clear()})),_p(this.highlight.getRowHeaders(),(e=>{e.clear()})),_p(this.highlight.getColumnHeaders(),(e=>{e.clear()})),_p(this.highlight.getActiveRowHeaders(),(e=>{e.clear()})),_p(this.highlight.getActiveColumnHeaders(),(e=>{e.clear()})),_p(this.highlight.getActiveCornerHeaders(),(e=>{e.clear()})),_p(this.highlight.getRowHighlights(),(e=>{e.clear()})),_p(this.highlight.getColumnHighlights(),(e=>{e.clear()}))),this.highlight.useLayerLevel(t);const n=this.highlight.createArea(),i=this.highlight.createLayeredArea(),s=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),a=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),u=this.highlight.createRowHighlight(),d=this.highlight.createColumnHighlight();if(n.clear(),i.clear(),s.clear(),l.clear(),a.clear(),c.clear(),h.clear(),u.clear(),d.clear(),this.highlight.isEnabledFor(oT,e.highlight)&&(this.isMultiple()||t>=1)&&(n.add(e.from).add(e.to).commit(),i.add(e.from).add(e.to).commit(),1===t)){const e=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(e.from).commit().syncWith(e),this.highlight.createLayeredArea().add(e.from).commit().syncWith(e),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(rT,e.highlight)){if(!e.isSingleHeader()){const t=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),r=this.tableProps.createCellCoords(e.to.row,-1),o=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),n=this.tableProps.createCellCoords(-1,e.to.col);"single"===this.settings.selectionMode?(s.add(t).commit(),l.add(o).commit(),u.add(t).commit(),d.add(o).commit()):(s.add(t).add(r).commit(),l.add(o).add(n).commit(),u.add(t).add(r).commit(),d.add(o).add(n).commit())}const t=!Sx(Hx,this)&&this.isEntireRowSelected()&&(o>0&&o===e.getWidth()||0===o&&this.isSelectedByRowHeader()),n=!Sx(Hx,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||0===r&&this.isSelectedByColumnHeader());t&&a.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),n&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),t&&n&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(nT,t.highlight)&&r.add(t.highlight).commit().syncWith(t),this.inProgress||(Rx(Mx,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders?Sx(Ex,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Sx(Ex,this).resetOffsetSize(),this.setRangeStart(Sx(Ex,this).transformStart(e,t,r))}transformEnd(e,t){this.settings.navigableHeaders?Sx(Ex,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Sx(Ex,this).resetOffsetSize(),this.setRangeEnd(Sx(Ex,this).transformEnd(e,t))}transformFocus(e,t){const r=this.selectedRange.current(),{row:o,col:n}=r.getOuterTopStartCorner(),i=this.tableProps.countRenderableColumnsInRange(0,n-1),s=this.tableProps.countRenderableRowsInRange(0,o-1);r.highlight.isHeader()?Sx(Ox,this).setOffsetSize({x:n<0?Math.abs(n):-i,y:o<0?Math.abs(o):-s}):Sx(Ox,this).setOffsetSize({x:n<0?0:-i,y:o<0?0:-s});const l=Sx(Ox,this).transformStart(e,t);this.setRangeFocus(l.normalize())}shiftRows(e,t){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:o,to:n,highlight:i}=r,s=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),a=this.isSelectedByColumnHeader(),c=a?-1:0,h=a?0:t;this.getSelectedRange().pop();const u=this.tableProps.createCellCoords(rC(o.row+h,c,s-1),o.col),d=this.tableProps.createCellCoords(rC(n.row+t,c,s-1),n.col);this.markSource("shift"),i.row>=e?this.setRangeStartOnly(u,!0,this.tableProps.createCellCoords(rC(i.row+t,0,s-1),i.col)):this.setRangeStartOnly(u,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),a&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:o,to:n,highlight:i}=r,s=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),a=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:t;this.getSelectedRange().pop();const u=this.tableProps.createCellCoords(o.row,rC(o.col+h,c,s-1)),d=this.tableProps.createCellCoords(n.row,rC(n.col+t,c,s-1));this.markSource("shift"),i.col>=e?this.setRangeStartOnly(u,!0,this.tableProps.createCellCoords(i.row,rC(i.col+t,0,s-1))):this.setRangeStartOnly(u,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),a&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=xy(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Sx(Mx,this)}isSelectedByRowHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{const{col:t}=e.getOuterTopStartCorner(),r=this.tableProps.countRowHeaders(),o=this.tableProps.countCols();return(r>0&&t<0||0===r)&&e.getWidth()===o};if(-1===e)return Array.from(this.selectedRange).some((e=>t(e)));const r=this.selectedRange.peekByIndex(e);return!!r&&t(r)}isSelectedByColumnHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{const{row:t}=e.getOuterTopStartCorner(),r=this.tableProps.countColHeaders(),o=this.tableProps.countRows();return(r>0&&t<0||0===r)&&e.getHeight()===o};if(-1===e)return Array.from(this.selectedRange).some((e=>t(e)));const r=this.selectedRange.peekByIndex(e);return!!r&&t(r)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return null!==t.row&&null!==t.col}isAreaCornerVisible(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const n=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),a=r?-l:0,c=t?-s:0;if(0===a&&0===c&&(0===n||0===i))return;let h=null===(e=this.getSelectedRange().current())||void 0===e?void 0:e.highlight;const{focusPosition:u,disableHeadersHighlight:d}=o;Rx(Hx,this,d),u&&Number.isInteger(null==u?void 0:u.row)&&Number.isInteger(null==u?void 0:u.col)&&(h=this.tableProps.createCellCoords(rC(u.row,a,n-1),rC(u.col,c,i-1)));const f=this.tableProps.createCellCoords(a,c),g=this.tableProps.createCellCoords(n-1,i-1);this.clear(),this.setRangeStartOnly(f,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),a<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.finish(),Rx(Hx,this,!1)}selectCells(e){var t=this;const r=vx(e);if(1===r)return!1;if(0===r)throw new Error(Ap`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const o=function(e){let{createCellCoords:t,createCellRange:r,keepDirection:o=!1,propToCol:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!mx.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){const s=3===e;let l=s?i.from.row:i[0],a=s?i.from.col:i[1],c=s?i.to.row:i[2],h=s?i.to.col:i[3];if("function"==typeof n&&("string"==typeof a&&(a=n(a)),"string"==typeof h&&(h=n(h))),Pp(c)&&(c=l),Pp(h)&&(h=a),!o){const e=l,t=a,r=c,o=h;l=Math.min(e,r),a=Math.min(t,o),c=Math.max(e,r),h=Math.max(t,o)}const u=t(l,a),d=t(c,h);return r(u,u,d)}}(r,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:e=>this.tableProps.propToCol(e),keepDirection:!0}),n=this.settings.navigableHeaders,i={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:n?this.tableProps.countRowHeaders():0,countColHeaders:n?this.tableProps.countColHeaders():0},s=!e.some((e=>{const t=o(e),r=t.isValid(i);return!(r&&!t.containsHeaders()||r&&t.containsHeaders()&&t.isSingleHeader())}));return s&&(this.clear(),this.setExpectedLayers(e.length),_p(e,(e=>{const{from:t,to:r}=o(e);this.setRangeStartOnly(t.clone(),!1),this.setRangeEnd(r.clone())})),this.finish()),s}selectColumns(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o="string"==typeof e?this.tableProps.propToCol(e):e,n="string"==typeof t?this.tableProps.propToCol(t):t,i=this.tableProps.countRows(),s=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),a=0===l?0:-l,c=this.tableProps.createCellCoords(a,o),h=this.tableProps.createCellCoords(i-1,n),u=this.tableProps.createCellRange(c,c,h).isValid({countRows:i,countCols:s,countRowHeaders:0,countColHeaders:l});if(u){let e=0,t=0;Number.isInteger(null==r?void 0:r.row)&&Number.isInteger(null==r?void 0:r.col)?(e=rC(r.row,a,i-1),t=rC(r.col,Math.min(o,n),Math.max(o,n))):(e=rC(r,a,i-1),t=o);const s=this.tableProps.createCellCoords(e,t),c=0===l?0:rC(s.row,a,-1),h=i-1,u=this.tableProps.createCellCoords(c,o),d=this.tableProps.createCellCoords(h,n);this.runLocalHooks("beforeSelectColumns",u,d,s),u.row=c,d.row=h,this.setRangeStartOnly(u,void 0,s),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectColumns",u,d,s),this.finish()}return u}selectRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=this.tableProps.countRows(),n=this.tableProps.countCols(),i=this.tableProps.countRowHeaders(),s=0===i?0:-i,l=this.tableProps.createCellCoords(e,s),a=this.tableProps.createCellCoords(t,n-1),c=this.tableProps.createCellRange(l,l,a).isValid({countRows:o,countCols:n,countRowHeaders:i,countColHeaders:0});if(c){let o=0,l=0;Number.isInteger(null==r?void 0:r.row)&&Number.isInteger(null==r?void 0:r.col)?(o=rC(r.row,Math.min(e,t),Math.max(e,t)),l=rC(r.col,s,n-1)):(o=e,l=rC(r,s,n-1));const a=this.tableProps.createCellCoords(o,l),c=0===i?0:rC(a.col,s,-1),h=n-1,u=this.tableProps.createCellCoords(e,c),d=this.tableProps.createCellCoords(t,h);this.runLocalHooks("beforeSelectRows",u,d,a),u.col=c,d.col=h,this.setRangeStartOnly(u,void 0,a),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectRows",u,d,a),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(0===e||0===t)return void this.deselect();const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:o,to:n,highlight:i}=r;this.clear(),i.assign({row:rC(i.row,-Infinity,e-1),col:rC(i.col,-Infinity,t-1)}),o.assign({row:rC(o.row,-Infinity,e-1),col:rC(o.col,-Infinity,t-1)}),n.assign({row:rC(n.row,0,e-1),col:rC(n.col,0,t-1)}),this.selectedRange.ranges.push(r),this.highlight.getFocus().add(i).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach((e=>{e.commit()})),!this.isSelected())return;const e=this.getLayerLevel(),t=this.selectedRange.current();this.highlight.isEnabledFor(nT,t.highlight)&&this.highlight.getFocus().commit().syncWith(t);for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const e=this.highlight.createArea(),t=this.highlight.createLayeredArea(),o=this.highlight.createRowHeader(),n=this.highlight.createColumnHeader(),i=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),l=this.highlight.createActiveCornerHeader(),a=this.highlight.createRowHighlight(),c=this.highlight.createColumnHighlight();e.commit(),t.commit(),o.commit(),n.commit(),i.commit(),s.commit(),l.commit(),a.commit(),c.commit()}this.highlight.useLayerLevel(e)}}Sy(Nx,JR);const Ix=Nx;function Ax(e){let t,r,o,n,i,s="";for(t=0,r=e.length;t<r;t+=1){for(n=e[t].length,o=0;o<n;o+=1)o>0&&(s+="\t"),i=e[t][o],"string"==typeof i?i.indexOf("\n")>-1?s+=`"${i.replace(/"/g,'""')}"`:s+=i:s+=null==i?"":i;t!==r-1&&(s+="\n")}return s}function kx(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Dx{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,r){kx(this,"hot",void 0),kx(this,"metaManager",void 0),kx(this,"tableMeta",void 0),kx(this,"dataSource",void 0),kx(this,"duckSchema",void 0),kx(this,"colToPropCache",void 0),kx(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(void 0===e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,t){let o=0,n=0,i=!1;if("function"==typeof t){const t=Hy(e);o=t>0?t:this.countFirstRowKeys(),i=!0}else{const e=this.tableMeta.maxCols;o=Math.min(e,t.length)}for(r=0;r<o;r++){const e=i?t(r):t[r];if(Ty(e)){if(void 0!==e.data){const t=i?n:r;this.colToPropCache[t]=e.data,this.propToColCache.set(e.data,t)}n+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return tO(this.dataSource)}recursiveDuckColumns(e,t,r){let o,n=t,i=r;return void 0===n&&(n=0,i=""),"object"!=typeof e||Array.isArray(e)||Oy(e,((e,t)=>{null===e?(o=i+t,this.colToPropCache.push(o),this.propToColCache.set(o,n),n+=1):n=this.recursiveDuckColumns(e,n,`${t}.`)})),n}colToProp(e){if(!1===Number.isInteger(e))return e;const t=this.hot.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&Dp(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(Dp(t))return this.hot.toVisualColumn(t);const r=this.hot.toVisualColumn(e);return null===r?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?yy(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:r,mode:o="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=this.hot.countSourceRows();let i=n,s=0,l=e;("number"!=typeof l||l>=n)&&(l=n),l<this.hot.countRows()&&(i=this.hot.toPhysicalRow(l));if(!1===this.hot.runHooks("beforeCreateRow",l,t,r)||null===i)return{delta:0};const a=this.tableMeta.maxRows,c=this.getSchema().length,h=[];for(;s<t&&n+s<a;){let e=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?e=Cy(this.getSchema()):(e=[],eC(c-1,(()=>e.push(null)))):"function"===this.hot.dataType?e=this.tableMeta.dataSchema(l+s):(e={},by(e,this.getSchema())),h.push(e),s+=1}this.hot.rowIndexMapper.insertIndexes(l,s),"below"===o&&(i=Math.min(i+1,n)),this.spliceData(i,0,h);const u=this.hot.toVisualRow(i);return this.hot.countSourceRows()===h.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(null==e?this.metaManager.createRow(null,s):"auto"!==r&&this.metaManager.createRow(i,t)),this.hot.runHooks("afterCreateRow",u,s,r),this.hot.forceFullRender=!0,{delta:s,startPhysicalIndex:i}}createCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:r,mode:o="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const n=this.dataSource,i=this.tableMeta.maxCols,s=this.hot.countSourceCols();let l=e;("number"!=typeof l||l>=s)&&(l=s);if(!1===this.hot.runHooks("beforeCreateCol",l,t,r))return{delta:0};let a=s;l<this.hot.countCols()&&(a=this.hot.toPhysicalColumn(l));const c=this.hot.countSourceRows();let h=this.hot.countCols(),u=0,d=a;"end"===o&&(d=Math.min(d+1,s));const f=d;for(;u<t&&h<i;){if("number"!=typeof l||l>=h)if(c>0)for(let e=0;e<c;e+=1)void 0===n[e]&&(n[e]=[]),n[e].push(null);else n.push([null]);else for(let e=0;e<c;e++)n[e].splice(d,0,null);u+=1,d+=1,h+=1}this.hot.columnIndexMapper.insertIndexes(l,u),u>0&&(null==e?this.metaManager.createColumn(null,u):"auto"!==r&&this.metaManager.createColumn(f,t));const g=this.hot.toVisualColumn(f);return this.hot.runHooks("afterCreateCol",g,u,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:u,startPhysicalIndex:f}}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(e)?e:-t;const n=this.visualRowsToPhysical(o,t),i=this.hot.countSourceRows();o=(i+o)%i;if(!1===this.hot.runHooks("beforeRemoveRow",o,n.length,n,r))return!1;const s=n.length;if(this.filterData(o,s,n),o<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(n);const e=Dp(this.tableMeta.columns)||Dp(this.tableMeta.dataSchema);0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===e&&this.hot.columnIndexMapper.setIndexesSequence([])}return n.slice(0).sort(((e,t)=>t-e)).forEach((e=>{this.metaManager.removeRow(e,1)})),this.hot.runHooks("afterRemoveRow",o,s,n,r),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let o="number"!=typeof e?-t:e;o=(this.hot.countCols()+o)%this.hot.countCols();const n=this.visualColumnsToPhysical(o,t),i=n.slice(0).sort(((e,t)=>t-e));if(!1===this.hot.runHooks("beforeRemoveCol",o,t,n,r))return!1;let s=!0;const l=i.length,a=this.dataSource;for(let c=0;c<l;c++)s&&n[0]!==n[c]-c&&(s=!1);if(s)for(let c=0,h=this.hot.countSourceRows();c<h;c++)a[c].splice(n[0],t),0===c&&this.metaManager.removeColumn(n[0],t);else for(let c=0,h=this.hot.countSourceRows();c<h;c++)for(let e=0;e<l;e++)a[c].splice(i[e],1),0===c&&this.metaManager.removeColumn(i[e],1);return o<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(n),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength()&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",o,t,n,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,r){const o=this.hot.getDataAtCol(e),n=o.slice(t,t+r),i=o.slice(t+r);for(var s=arguments.length,l=new Array(s>3?s-3:0),a=3;a<s;a++)l[a-3]=arguments[a];Ep(l,i);let c=0;for(;c<r;)l.push(null),c+=1;return function(e){const t=e.length;let r=0;for(;r<t;)e[r]=[e[r]],r+=1}(l),this.hot.populateFromArray(t,e,l,null,null,"spliceCol"),n}spliceRow(e,t,r){const o=this.hot.getSourceDataAtRow(e),n=o.slice(t,t+r),i=o.slice(t+r);for(var s=arguments.length,l=new Array(s>3?s-3:0),a=3;a<s;a++)l[a-3]=arguments[a];Ep(l,i);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,t,[l],null,null,"spliceRow"),n}spliceData(e,t,r){if(!1!==this.hot.runHooks("beforeDataSplice",e,t,r)){const t=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,t.forEach((e=>this.dataSource.push(e)))}}filterData(e,t,r){let o=this.hot.runHooks("filterData",e,t,r);!1===Array.isArray(o)&&(o=this.dataSource.filter(((e,t)=>-1===r.indexOf(t)))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}get(e,t){const r=this.hot.toPhysicalRow(e);let o=this.dataSource[r];const n=this.hot.runHooks("modifyRowData",r);o=isNaN(n)?n:o;const{dataDotNotation:i}=this.hot.getSettings();let s=null;if(o&&o.hasOwnProperty&&_y(o,t))s=o[t];else if(i&&"string"==typeof t&&t.indexOf(".")>-1){let e=o;if(!e)return null;const r=t.split(".");for(let t=0,o=r.length;t<o;t++)if(e=e[r[t]],void 0===e)return null;s=e}else"function"==typeof t&&(s=t(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const e=xy(s);this.hot.runHooks("modifyData",r,this.propToCol(t),e,"get"),e.isTouched()&&(s=e.value)}return s}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,r){const o=this.hot.toPhysicalRow(e);let n=r,i=this.dataSource[o];const s=this.hot.runHooks("modifyRowData",o);if(i=isNaN(s)?s:i,this.hot.hasHook("modifyData")){const e=xy(n);this.hot.runHooks("modifyData",o,this.propToCol(t),e,"set"),e.isTouched()&&(n=e.value)}const{dataDotNotation:l}=this.hot.getSettings();if(i&&i.hasOwnProperty&&_y(i,t))i[t]=n;else if(l&&"string"==typeof t&&t.indexOf(".")>-1){let e,r=i,o=0;const s=t.split(".");for(o=0,e=s.length-1;o<e;o++)void 0===r[s[o]]&&(r[s[o]]={}),r=r[s[o]];r[s[o]]=n}else"function"==typeof t?t(this.dataSource.slice(o,o+1)[0],n):i[t]=n}visualRowsToPhysical(e,t){const r=this.hot.countSourceRows(),o=[];let n,i=(r+e)%r,s=t;for(;i<r&&s;)n=this.hot.toPhysicalRow(i),o.push(n),s-=1,i+=1;return o}visualColumnsToPhysical(e,t){const r=this.hot.countCols(),o=[];let n=(r+e)%r,i=t;for(;n<r&&i;){const e=this.hot.toPhysicalColumn(n);o.push(e),i-=1,n+=1}return o}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;t=e<0||0===e?0:e||Infinity;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row!=0||this.hot.countSourceRows()?this.getRange(e,t,Dx.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,r){const o=[];let n,i,s;const l=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===l||0===a)return[];const c=r===Dx.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,t.row)),u=Math.min(Math.max(a-1,0),Math.max(e.col,t.col));for(n=Math.min(e.row,t.row);n<=h;n++){s=[];const r=n>=0?this.hot.toPhysicalRow(n):n;for(i=Math.min(e.col,t.col);i<=u&&null!==r;i++)s.push(c.call(this,n,this.colToProp(i)));null!==r&&o.push(s)}return o}getText(e,t){return Ax(this.getRange(e,t,Dx.DESTINATION_RENDERER))}getCopyableText(e,t){return Ax(this.getRange(e,t,Dx.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const Px=Dx,{register:Lx,getItem:Vx,hasItem:Fx,getNames:Wx,getValues:Bx}=_v("cellTypes");function jx(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const o="string"==typeof t.type?function(e){if(!Fx(e))throw Error(`You declared cell type "${e}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return Vx(e)}(t.type):t.type;if(e._automaticallyAssignedMetaProps&&Oy(t,((t,r)=>{e._automaticallyAssignedMetaProps.delete(r)})),!Ty(o))return;r!==e||e._automaticallyAssignedMetaProps||(e._automaticallyAssignedMetaProps=new Set);const n={};Oy(o,((t,o)=>{var i;(function(e,t){var r;return"CELL_TYPE"!==e&&((null===(r=t._automaticallyAssignedMetaProps)||void 0===r?void 0:r.has(e))||!_y(t,e))})(o,r)&&(n[o]=t,null===(i=e._automaticallyAssignedMetaProps)||void 0===i||i.add(o))})),vy(e,n)}function zx(e){return Number.isInteger(e)&&e>=0}function Ux(e,t){if(!e())throw new Error(`Assertion failed: ${t}`)}function Yx(e){return null==e}const $x=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(e){let t,r,o;for(t=0,r=this.countRows();t<r;t++)if(o=this.getDataAtCell(t,e),!1===Lp(o))return!1;return!0},isEmptyRow(e){let t,r,o,n;for(t=0,r=this.countCols();t<r;t++)if(o=this.getDataAtCell(e,t),!1===Lp(o))return"object"==typeof o&&(n=this.getCellMeta(e,t),Ry(this.getSchema()[n.prop],o));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:Infinity,maxRows:Infinity,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function Gx(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Xx{constructor(e){Gx(this,"metaCtor",class{}),Gx(this,"meta",void 0),this.meta=this.metaCtor.prototype,vy(this.meta,$x()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;vy(this.meta,e),jx(this.meta,a(l({},e),{type:null!==(t=e.type)&&void 0!==t?t:this.meta.type}),e)}}function qx(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Kx{constructor(e){qx(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){vy(this.meta,e),jx(this.meta,e,e)}}function Zx(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Qx{constructor(e){Zx(this,"valueFactory",void 0),Zx(this,"data",[]),Zx(this,"index",[]),Zx(this,"holes",new Set),this.valueFactory=e}obtain(e){Ux((()=>zx(e)),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let r;if(t>=0)r=this.data[t],void 0===r&&(r=this.valueFactory(e),this.data[t]=r);else if(r=this.valueFactory(e),this.holes.size>0){const t=this.holes.values().next().value;this.holes.delete(t),this.data[t]=r,this.index[e]=t}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Ux((()=>zx(e)||Yx(e)),"Expecting an unsigned number or null/undefined argument.");const r=[],o=this.data.length;for(let i=0;i<t;i++)r.push(o+i),this.data.push(void 0);const n=Yx(e)?this.index.length:e;this.index=[...this.index.slice(0,n),...r,...this.index.slice(n)]}remove(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Ux((()=>zx(e)||Yx(e)),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Yx(e)?this.index.length-t:e,t);for(let o=0;o<r.length;o++){const e=r[o];"number"==typeof e&&this.holes.add(e)}}size(){return this.data.length-this.holes.size}values(){return Hp(this.data,((e,t)=>!this.holes.has(t)))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const t=this._getKeyByStorageIndex(r);-1!==t&&e.push([t,this.data[r]])}let t=0;return{next:()=>{if(t<e.length){const r=e[t];return t+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function Jx(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const e_=["data","width"];class t_{constructor(e){Jx(this,"globalMeta",void 0),Jx(this,"metas",new Qx((()=>this._createMeta()))),this.globalMeta=e,this.metas=new Qx((()=>this._createMeta()))}updateMeta(e,t){const r=this.getMeta(e);vy(r,t),jx(r,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function r(){}var o,n;o=r,(n=e).prototype.constructor=n,o.prototype=new n,o.prototype.constructor=o;for(let i=0;i<t.length;i++)r.prototype[t[i]]=void 0;return r}(this.globalMeta.getMetaConstructor(),e_).prototype}}function r_(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class o_{constructor(e){r_(this,"columnMeta",void 0),r_(this,"metas",new Qx((()=>this._createRow()))),this.columnMeta=e}updateMeta(e,t,r){const o=this.getMeta(e,t);vy(o,r),jx(o,r)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,t)}getMeta(e,t,r){const o=this.metas.obtain(e).obtain(t);return void 0===r?o:o[r]}setMeta(e,t,r,o){var n;const i=this.metas.obtain(e).obtain(t);null===(n=i._automaticallyAssignedMetaProps)||void 0===n||n.delete(r),i[r]=o}removeMeta(e,t,r){delete this.metas.obtain(e).obtain(t)[r]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let r=0;r<t.length;r++)Dp(t[r])&&e.push(...t[r].values());return e}getMetasAtRow(e){Ux((()=>zx(e)),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Qx((e=>this._createMeta(e)))}_createMeta(e){return new(this.columnMeta.getMetaConstructor(e))}}class n_{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=e,this.globalMeta=new Xx(e),this.tableMeta=new Kx(this.globalMeta),this.columnMeta=new t_(this.globalMeta),this.cellMeta=new o_(this.columnMeta),r.forEach((e=>new e(this))),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,r){let{visualRow:o,visualColumn:n}=r;const i=this.cellMeta.getMeta(e,t);return i.visualRow=o,i.visualCol=n,i.row=e,i.col=t,this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,t,r){if("string"!=typeof r)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,r)}setCellMeta(e,t,r,o){this.cellMeta.setMeta(e,t,r,o)}updateCellMeta(e,t,r){this.cellMeta.updateMeta(e,t,r)}removeCellMeta(e,t,r){this.cellMeta.removeMeta(e,t,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function i_(e,t,r,o){const{hotInstance:n,dataMap:i,dataSource:s,internalSource:l,source:a,metaManager:c,firstRun:h}=o,u=Xp(l),d=n.getSettings();Array.isArray(d.dataSchema)?n.dataType="array":Ww(d.dataSchema)?n.dataType="function":n.dataType="object",i&&i.destroy(),e=n.runHooks(`before${u}`,e,h,a);const f=new Px(n,e,c);if(t(f),"object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error(`${l} only accepts array of objects or array of arrays (${typeof e} given)`);{const t=f.getSchema();let r;e=[];let o=0,i=0;for(o=0,i=d.startRows;o<i;o++)if("object"!==n.dataType&&"function"!==n.dataType||!d.dataSchema)if("array"===n.dataType)r=Cy(t[0]),e.push(r);else{r=[];for(let e=0,t=d.startCols;e<t;e++)r.push(null);e.push(r)}else r=Cy(t),e.push(r)}}Array.isArray(e[0])&&(n.dataType="array"),d.data=e,f.dataSource=e,s.data=e,s.dataType=n.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),r(f),n.runHooks(`after${u}`,e,h,a),h||(n.runHooks("afterChange",null,l),n.render()),n.getSettings().ariaTags&&dw(n.rootElement,[Zp(-1),Qp(n.countCols()+(n.view?n.countRowHeaders():0))])}function s_(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Sy(n_,JR);class l_{constructor(e){s_(this,"metaManager",void 0),s_(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",(e=>this.extendCellMeta(e))),Mv.getSingleton().add("beforeRender",(e=>{e&&this.metaSyncMemo.clear()}),this.metaManager.hot)}extendCellMeta(e){var t;const{row:r,col:o}=e;if(null!==(t=this.metaSyncMemo.get(r))&&void 0!==t&&t.has(o))return;const{visualRow:n,visualCol:i}=e,s=this.metaManager.hot,l=s.colToProp(i);e.prop=l,s.runHooks("beforeGetCellMeta",n,i,e);const a=_y(e,"type")?e.type:null;let c=Ww(e.cells)?e.cells(r,o,l):null;var h;a&&(c?c.type=null!==(h=c.type)&&void 0!==h?h:a:c={type:a});c&&this.metaManager.updateCellMeta(r,o,c),s.runHooks("afterGetCellMeta",n,i,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(o)}}function a_(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function c_(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h_(e,t){return e.get(function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(e,t))}var u_=new WeakMap;class d_{constructor(e){c_(this,"metaManager",void 0),c_(this,"usageTracker",new Set),c_(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(e){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===e)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),a_(this,u_,((e,t,r)=>{if(!r)throw new Error(`The \`${e}\` option can not be updated after the Handsontable is initialized.`)})),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach(((e,t)=>{const{initOnly:r,target:o,onChange:n}=e,i="string"==typeof o,s=i?o:t,l=`_${s}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[s],n?(this.installPropWatcher(t,l,n),i&&this.installPropWatcher(o,l,n)):r&&(this.installPropWatcher(t,l,h_(u_,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))}))}installPropWatcher(e,t,r){const o=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(n){const i=!o.usageTracker.has(e);o.usageTracker.add(e),r.call(o,e,n,i),this[t]=n},enumerable:!0,configurable:!0})}}const f_="gridDefault",g_="editorManager.handlingEditor",m_={name:"editorCloseAndSave",callback(e){e._getEditorManager().closeEditorAndSaveChanges()}},p_={_hooksStorage:Object.create(null),addHook(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey(e){_p(this._hooksStorage[e]||[],(t=>{this.hot.removeHook(e,t)}))},clearHooks(){Oy(this._hooksStorage,((e,t)=>this.removeHooksByKey(t))),this._hooksStorage={}}};Ey(p_,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});const w_=p_;function y_(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const v_=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class b_{static get EDITOR_TYPE(){return"base"}constructor(e){y_(this,"hot",void 0),y_(this,"state",v_.VIRGIN),y_(this,"_opened",!1),y_(this,"_fullEditMode",!1),y_(this,"_closeCallback",null),y_(this,"TD",null),y_(this,"row",null),y_(this,"col",null),y_(this,"prop",null),y_(this,"originalValue",null),y_(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,r,o,n,i){this.TD=o,this.row=e,this.col=t,this.prop=r,this.originalValue=n,this.cellProperties=i,this.state=this.isOpened()?this.state:v_.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let r,o,n,i;if(t){const e=this.hot.getSelectedLast();r=Math.max(Math.min(e[0],e[2]),0),o=Math.max(Math.min(e[1],e[3]),0),n=Math.max(e[0],e[2]),i=Math.max(e[1],e[3])}else[r,o,n,i]=[this.row,this.col,null,null];const s=this.hot.runHooks("modifyGetCellCoords",r,o,!1,"meta");Array.isArray(s)&&([r,o]=s),this.hot.populateFromArray(r,o,e,n,i,"edit")}beginEditing(e,t){if(this.state!==v_.VIRGIN)return;const r=this.hot,o=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),n=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),i=()=>{if(this.state=v_.EDITING,this.isInFullEditMode()){const t="string"==typeof e?e:kp(this.originalValue);this.setValue(t)}this.open(t),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",i);r.view.scrollViewport(r._createCellCoords(o,n))||(this.hot.removeHook("afterScroll",i),i())}finishEditing(e,t,r){let o;if(r){const e=this._closeCallback;this._closeCallback=t=>{e&&e(t),r(t),this.hot.view.render()}}if(!this.isWaiting())if(this.state!==v_.VIRGIN){if(this.state===v_.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();const r=this.getValue();o=this.cellProperties.trimWhitespace?[["string"==typeof r?String.prototype.trim.call(r||""):r]]:[[r]],this.state=v_.WAITING,this.saveValue(o,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(e=>{this.state=v_.FINISHED,this.discardEditor(e)})):(this.state=v_.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((()=>{this._fireCallbacks(!0)}))}cancelChanges(){this.state=v_.FINISHED,this.discardEditor()}discardEditor(e){if(this.state===v_.FINISHED)if(!1===e&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=v_.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=v_.VIRGIN,this._fireCallbacks(!0);this.hot.getShortcutManager().setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===v_.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:r,wtViewport:o}=this.hot.view._wt,n=this.hot.rootWindow,i=bw(t),s=Hw(t),l=bw(this.hot.rootElement),a=Hw(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,u=c!==n?c.scrollTop:0,d=h!==n?h.scrollLeft:0,f=n.innerWidth-l.left-a,{wtTable:g}=null!==(e=r.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt,m=g.name,p=["master","inline_start"].includes(m)?u:0,w=["master","top","bottom"].includes(m)?d:0,y=i.top===l.top?0:1;let v=i.top-l.top-y-p,b=0;b=this.hot.isRtl()?n.innerWidth-i.left-s-f-1+w:i.left-l.left-1-w,["top","top_inline_start_corner"].includes(m)&&(v+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(b+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const C=this.hot.hasColHeaders(),S=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),T=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(C&&S<=0||S===T)&&(v+=1),R<=0&&(b+=1);const E=o.rowsRenderCalculator.startPosition,O=o.columnsRenderCalculator.startPosition,M=Math.abs(r.inlineStartOverlay.getScrollPosition()),H=r.topOverlay.getScrollPosition(),x=Dw(this.hot.rootDocument);let _=t.offsetTop;if(["inline_start","master"].includes(m)&&(_+=E-H),["bottom","bottom_inline_start_corner"].includes(m)){const{wtViewport:e,wtTable:t}=r.bottomOverlay.clone;_+=e.getWorkspaceHeight()-t.getHeight()-x}let N=t.offsetLeft;this.hot.isRtl()?(N=N>=0?g.getWidth()-t.offsetLeft:Math.abs(N),N+=O-M-s):["top","master","bottom"].includes(m)&&(N+=O-M);const I=n.getComputedStyle(this.TD),A=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",k=parseInt(I[A],10)>0?0:1,D=parseInt(I.borderTopWidth,10)>0?0:1,P=Hw(t)+k,L=xw(t)+D,V=(F=c).offsetWidth!==F.clientWidth?x:0;var F;const W=function(e){return e.offsetHeight!==e.clientHeight}(h)?x:0,B=this.hot.view.maximumVisibleElementWidth(N)-V+k;return{top:v,start:b,height:L,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(_)-W+D,this.hot.view.getDefaultRowHeight()),width:P,maxWidth:B}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}Sy(b_,w_);const C_=[m_,{name:"editorCloseAndSaveByArrowKeys",callback(e,t,r){const o=e._getEditorManager(),n=o.getActiveEditor();n.isInFullEditMode()&&n.state===v_.EDITING||(o.closeEditorAndSaveChanges(),e.getSelected()&&(r.includes("arrowdown")?e.selection.transformStart(1,0):r.includes("arrowup")?e.selection.transformStart(-1,0):r.includes("arrowleft")?e.selection.transformStart(0,-1*e.getDirectionFactor()):r.includes("arrowright")&&e.selection.transformStart(0,e.getDirectionFactor())),t.preventDefault())}},{name:"editorCloseAndSaveByEnter",callback(e,t){const r=e._getEditorManager();r.closeEditorAndSaveChanges(t.ctrlKey||t.metaKey),r.moveSelectionAfterEnter(t)}},{name:"editorCloseWithoutSaving",callback(e){const t=e._getEditorManager();t.closeEditorAndRestoreOriginalValue(e.getShortcutManager().isCtrlPressed()),t.activeEditor.focus()}},{name:"editorFastOpen",callback(e,t){const{highlight:r}=e.getSelectedRangeLast();r.isHeader()||e._getEditorManager().openEditor(null,t,!0)}},{name:"editorOpen",callback(e,t,r){const o=e._getEditorManager(),n=e.getSelectedRangeLast(),{highlight:i}=n;if(e.selection.isMultiple()&&!n.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0){const o=e.getSettings(),n="function"==typeof o.enterMoves?o.enterMoves(t):o.enterMoves;r.includes("shift")?e.selection.transformFocus(-n.row,-n.col):e.selection.transformFocus(n.row,n.col)}else i.isHeader()||(e.getSettings().enterBeginsEditing?o.cellProperties.readOnly?o.moveSelectionAfterEnter(t):o.openEditor(null,t,!0):o.moveSelectionAfterEnter(t),By(t))}},{name:"extendCellsSelectionDown",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())||e.selection.transformEnd(1,0)}},{name:"extendCellsSelectionDownByViewportHeight",callback(e){const{to:t}=e.getSelectedRangeLast(),r=Math.min(t.row+e.countVisibleRows(),e.countRows()-1),o=e.rowIndexMapper.getNearestNotHiddenIndex(r,-1);if(null!==o){const r=e._createCellCoords(o,t.col),n=t.row-e.getFirstFullyVisibleRow(),i=Math.min(r.row-n,e.countRows()-1);e.selection.setRangeEnd(r),e.scrollViewportTo({row:i,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"extendCellsSelectionLeft",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())||e.selection.transformEnd(0,-1*e.getDirectionFactor())}},{name:"extendCellsSelectionRight",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())||e.selection.transformEnd(0,e.getDirectionFactor())}},{name:"extendCellsSelectionToColumns",callback(e){const{highlight:t,from:r,to:o}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()?e.selection.selectAll(!0,!0):e.selectColumns(r.col,o.col,t)}},{name:"extendCellsSelectionToMostBottom",callback(e){const{selection:t,rowIndexMapper:r}=e,{highlight:o,from:n,to:i}=e.getSelectedRangeLast(),s=o.isHeader()&&e.selection.isSelectedByRowHeader();if(o.isCell()||s){const l=r.getNearestNotHiddenIndex(e.countRows()-1,-1),a=n.clone();a.row=o.row,t.setRangeStart(a,void 0,!1,o.clone()),s&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(l,i.col))}}},{name:"extendCellsSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:o,from:n,to:i}=e.getSelectedRangeLast();if(!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&o.isCell()){const s=r.getNearestNotHiddenIndex(e.countCols()-1,-1),l=n.clone();l.col=o.col,t.setRangeStart(l,void 0,!1,o.clone()),t.setRangeEnd(e._createCellCoords(i.row,s))}}},{name:"extendCellsSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:o,from:n,to:i}=e.getSelectedRangeLast();if(!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&o.isCell()){const s=parseInt(e.getSettings().fixedColumnsStart,10),l=r.getNearestNotHiddenIndex(s,1),a=n.clone();a.col=o.col,t.setRangeStart(a,void 0,!1,o.clone()),t.setRangeEnd(e._createCellCoords(i.row,l))}}},{name:"extendCellsSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:o,from:n,to:i}=e.getSelectedRangeLast(),s=o.isHeader()&&e.selection.isSelectedByColumnHeader();if(o.isCell()||s){const l=r.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]),a=n.clone();a.col=o.col,t.setRangeStart(a,void 0,!1,o.clone()),s&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(i.row,l))}}},{name:"extendCellsSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:o,from:n,to:i}=e.getSelectedRangeLast(),s=o.isHeader()&&e.selection.isSelectedByColumnHeader();if(o.isCell()||s){const l=r.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]),a=n.clone();a.col=o.col,t.setRangeStart(a,void 0,!1,o.clone()),s&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(i.row,l))}}},{name:"extendCellsSelectionToMostTop",callback(e){const{selection:t,rowIndexMapper:r}=e,{highlight:o,from:n,to:i}=e.getSelectedRangeLast(),s=o.isHeader()&&e.selection.isSelectedByRowHeader();if(o.isCell()||s){const l=r.getNearestNotHiddenIndex(0,1),a=n.clone();a.row=o.row,t.setRangeStart(a,void 0,!1,o.clone()),s&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(l,i.col))}}},{name:"extendCellsSelectionToRows",callback(e){const{highlight:t,from:r,to:o}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()?e.selection.selectAll(!0,!0):e.selectRows(r.row,o.row,t)}},{name:"extendCellsSelectionUp",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())||e.selection.transformEnd(-1,0)}},{name:"extendCellsSelectionUpByViewportHeight",callback(e){const{to:t}=e.getSelectedRangeLast(),r=Math.max(t.row-e.countVisibleRows(),0),o=e.rowIndexMapper.getNearestNotHiddenIndex(r,1);if(null!==o){const r=e._createCellCoords(o,t.col),n=t.row-e.getFirstFullyVisibleRow(),i=Math.max(r.row-n,0);e.selection.setRangeEnd(r),e.scrollViewportTo({row:i,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"moveCellSelectionDown",callback(e){let{selection:t}=e;t.transformStart(1,0)}},{name:"moveCellSelectionDownByViewportHeight",callback(e){const{navigableHeaders:t}=e.getSettings(),r=t?e.countColHeaders():0,{row:o}=e.getSelectedRangeLast().highlight;let n=e.countVisibleRows()+r;o===e.countRows()-1?n=1:o+n>e.countRows()&&(n=e.countRows()-o-1),e.selection.transformStart(n,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}},{name:"moveCellSelectionInlineEnd",callback(e,t){const r=e.getSettings(),o=e.getSelectedRangeLast(),n="function"==typeof r.tabMoves?r.tabMoves(t):r.tabMoves;e.selection.isMultiple()&&!o.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?e.selection.transformFocus(-n.row,-n.col):e.selection.transformStart(-n.row,-n.col)}},{name:"moveCellSelectionInlineStart",callback(e,t){const r=e.getSettings(),o=e.getSelectedRangeLast(),n="function"==typeof r.tabMoves?r.tabMoves(t):r.tabMoves;e.selection.isMultiple()&&!o.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?e.selection.transformFocus(n.row,n.col):e.selection.transformStart(n.row,n.col)}},{name:"moveCellSelectionLeft",callback(e){e.selection.transformStart(0,-1*e.getDirectionFactor())}},{name:"moveCellSelectionRight",callback(e){e.selection.transformStart(0,e.getDirectionFactor())}},{name:"moveCellSelectionToMostBottom",callback(e){const{col:t}=e.getSelectedRangeLast().highlight;let r=e.rowIndexMapper.getNearestNotHiddenIndex(e.countRows()-1,-1);null===r&&(r=-1),e.selection.setRangeStart(e._createCellCoords(r,t))}},{name:"moveCellSelectionToMostBottomInlineEnd",callback(e){const{selection:t,rowIndexMapper:r,columnIndexMapper:o}=e,n=parseInt(e.getSettings().fixedRowsBottom,10),i=r.getNearestNotHiddenIndex(e.countRows()-n-1,-1),s=o.getNearestNotHiddenIndex(e.countCols()-1,-1);t.setRangeStart(e._createCellCoords(i,s))}},{name:"moveCellSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:r}=e;t.setRangeStart(e._createCellCoords(e.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(e.countCols()-1,-1)))}},{name:"moveCellSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:r}=e,o=parseInt(e.getSettings().fixedColumnsStart,10),n=e.getSelectedRangeLast().highlight.row,i=r.getNearestNotHiddenIndex(o,1);t.setRangeStart(e._createCellCoords(n,i))}},{name:"moveCellSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:r}=e,o=e.getSelectedRangeLast().highlight.row;let n=r.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]);null===n&&(n=e.isRtl()?-1:-e.countRowHeaders()),t.setRangeStart(e._createCellCoords(o,n))}},{name:"moveCellSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:r}=e,{row:o}=e.getSelectedRangeLast().highlight;let n=r.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]);null===n&&(n=e.isRtl()?-e.countRowHeaders():-1),t.setRangeStart(e._createCellCoords(o,n))}},{name:"moveCellSelectionToMostTop",callback(e){const{col:t}=e.getSelectedRangeLast().highlight;let r=e.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===r&&(r=-e.countColHeaders()),e.selection.setRangeStart(e._createCellCoords(r,t))}},{name:"moveCellSelectionToMostTopInlineStart",callback(e){const{selection:t,rowIndexMapper:r,columnIndexMapper:o}=e,n=parseInt(e.getSettings().fixedRowsTop,10),i=parseInt(e.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(n,1),l=o.getNearestNotHiddenIndex(i,1);t.setRangeStart(e._createCellCoords(s,l))}},{name:"moveCellSelectionUp",callback(e){let{selection:t}=e;t.transformStart(-1,0)}},{name:"moveCellSelectionUpByViewportHight",callback(e){const{navigableHeaders:t}=e.getSettings(),r=t?e.countColHeaders():0,{row:o}=e.getSelectedRangeLast().highlight;let n=-(e.countVisibleRows()+r);o===-r?n=-1:o+n<r&&(n=-(o+r)),e.selection.transformStart(n,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}},{name:"emptySelectedCells",callback(e){e.emptySelectedCells(),e._getEditorManager().prepareEditor()}},{name:"scrollToFocusedCell",callback(e){const{highlight:t}=e.getSelectedRangeLast(),r=e.getFirstFullyVisibleRow()-1,o=e.getFirstFullyVisibleColumn()-1,n=e.getLastFullyVisibleRow()+1,i=e.getLastFullyVisibleColumn()+1,s=e._createCellCoords(r,o),c=e._createCellCoords(n,i);if(!e._createCellRange(s,s,c).includes(t)&&(t.row>=0||t.col>=0)){const r={};if(t.col>=0){const o=Math.floor(e.countVisibleCols()/2);r.col=Math.max(t.col-o,0)}if(t.row>=0){const o=Math.floor(e.countVisibleRows()/2);r.row=Math.max(t.row-o,0)}e.scrollViewportTo(a(l({},r),{verticalSnap:"top",horizontalSnap:"start"}))}}},{name:"selectAllCells",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},{name:"selectAllCellsAndHeaders",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},{name:"populateSelectedCellsData",callback(e){const t=e.getSelectedRange(),{row:r,col:o}=t[t.length-1].highlight.normalize(),n=e.getDataAtCell(r,o),i=new Map;for(let s=0;s<t.length;s++)t[s].forAll(((t,s)=>{if(t>=0&&s>=0&&(t!==r||s!==o)){const{readOnly:r}=e.getCellMeta(t,s);r||i.set(`${t}x${s}`,[t,s,n])}}));e.setDataAtCell(Array.from(i.values()))}}];function S_(e){const t={};return C_.forEach((r=>{let{name:o,callback:n}=r;t[o]=function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n(e,...r)}})),t}function R_(e){const t=e.getShortcutManager().addContext("editor"),r=S_(e),o={group:g_};t.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>r.editorCloseAndSaveByEnter(e,t)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(e,t)=>r.editorCloseAndSaveByEnter(e,t)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:(e,t)=>r.editorCloseAndSave(e,t)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(e,t)=>r.editorCloseAndSaveByArrowKeys(e,t)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],o)}function T_(e){const t=e.getShortcutManager().addContext("grid"),r=S_(e),o={runOnlyIf:()=>{const{navigableHeaders:t}=e.getSettings();return Dp(e.getSelected())&&(t||!t&&e.countRenderedRows()>0&&e.countRenderedCols()>0)},group:f_};t.addShortcuts([{keys:[["F2"]],callback:e=>r.editorFastOpen(e)},{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>r.editorOpen(e,t)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:g_,runOnlyIf:()=>Dp(e.getSelected())}),t.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var t;return!(null!==(t=e.getSelectedRangeLast())&&void 0!==t&&t.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var t,r;return!(null!==(t=e.getSelectedRangeLast())&&void 0!==t&&t.highlight.isHeader())&&(null===(r=e.getSelectedRangeLast())||void 0===r?void 0:r.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:e=>r.moveCellSelectionInlineStart(e)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:e=>r.moveCellSelectionInlineEnd(e)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],o)}function E_(e){const t=e.rootDocument.createElement("input");return t.type="text",t.name="__htFocusCatcher",t.classList.add("htFocusCatcher"),e.getSettings().ariaTags&&dw(t,[["role","presentation"],["aria-hidden","true"]]),t}function O_(e){const t=function(e){return t=>{if(!t)return null;const r=M_(e),o=H_(e);return t.col<r.col&&(t.col=r.col),t.col>o.col&&(t.col=o.col),t.row<r.row&&(t.row=r.row),t.row>o.row&&(t.row=o.row),t}}(e);let r;const{activate:o,deactivate:n}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=e.rootElement,o=E_(e),n=E_(e);return o.addEventListener("focus",(()=>null==t?void 0:t.onFocusFromTop())),n.addEventListener("focus",(()=>null==t?void 0:t.onFocusFromBottom())),r.firstChild.before(o),r.lastChild.after(n),{activate(){e._registerTimeout((()=>{o.tabIndex=0,n.tabIndex=0}),10)},deactivate(){e._registerTimeout((()=>{o.tabIndex=-1,n.tabIndex=-1}),10)}}}(e,{onFocusFromTop(){var o;const n=null!==(o=t(r))&&void 0!==o?o:M_(e);n&&(e.runHooks("modifyFocusOnTabNavigation","from_above",n),e.selectCell(n.row,n.col)),e.listen()},onFocusFromBottom(){var o;const n=null!==(o=t(r))&&void 0!==o?o:H_(e);n&&(e.runHooks("modifyFocusOnTabNavigation","from_below",n),e.selectCell(n.row,n.col)),e.listen()}}),i={wrapped:!1,flipped:!1};let s=!0,c=!1,h=!1;e.addHook("afterListen",(()=>n())),e.addHook("afterUnlisten",(()=>o())),e.addHook("afterSelection",((t,o,n,l,a)=>{var u;(c&&(i.wrapped&&i.flipped||h)&&(h=!1,a.value=!0),s)&&(r=null===(u=e.getSelectedRangeLast())||void 0===u?void 0:u.highlight)})),e.addHook("beforeRowWrap",((e,t,r)=>{i.wrapped=!0,i.flipped=r}));const u={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:f_,group:"focusCatcher"};e.getShortcutManager().getContext("grid").addShortcuts([a(l({},u),{callback:()=>{const{tabNavigation:t}=e.getSettings();c=!0,e.getSelectedRangeLast()&&!t&&(s=!1),t||(h=!0)},position:"before"}),a(l({},u),{callback:t=>{const{tabNavigation:o,autoWrapRow:n}=e.getSettings();if(c=!1,s=!0,!o||!e.selection.isSelected()||n&&i.wrapped&&i.flipped||!n&&i.wrapped)return n&&i.wrapped&&i.flipped&&(r=t.shiftKey?M_(e):H_(e)),i.wrapped=!1,i.flipped=!1,e.deselectCell(),e.unlisten(),!1;t.preventDefault()},position:"after"})])}function M_(e){const{rowIndexMapper:t,columnIndexMapper:r}=e,{navigableHeaders:o}=e.getSettings();let n=o&&e.countColHeaders()>0?-e.countColHeaders():0,i=o&&e.countRowHeaders()>0?-e.countRowHeaders():0;return 0===n&&(n=t.getVisualFromRenderableIndex(n)),0===i&&(i=r.getVisualFromRenderableIndex(i)),null===n||null===i?null:e._createCellCoords(n,i)}function H_(e){var t,r;const{rowIndexMapper:o,columnIndexMapper:n}=e,{navigableHeaders:i}=e.getSettings();let s=o.getRenderableIndexesLength()-1,l=n.getRenderableIndexesLength()-1;if(s<0){if(!i||0===e.countColHeaders())return null;s=-1}if(l<0){if(!i||0===e.countColHeaders())return null;l=-1}return e._createCellCoords(null!==(t=o.getVisualFromRenderableIndex(s))&&void 0!==t?t:s,null!==(r=n.getVisualFromRenderableIndex(l))&&void 0!==r?r:l)}const x_=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),__=e=>e.map((e=>{const t=e.toLowerCase();return x_.has(t)?x_.get(t):t})).sort().join("+"),N_=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),I_=e=>{let{which:t,key:r}=e;if(N_.has(t))return N_.get(t);const o=String.fromCharCode(t).toLowerCase();return/^[a-z0-9]$/.test(o)?o:r.toLowerCase()},A_=Symbol("shortcut-context");function k_(e){return Ty(e)&&e.__kindOf===A_}const D_=["meta","alt","shift","control"],P_=function(){const e=new Set;return{press(t){e.add(t)},release(t){e.delete(t)},releaseAll(){e.clear()},isPressed:t=>e.has(t)}}(),L_=[];let V_=0;const F_=e=>{let{ownerWindow:t,handleEvent:r,beforeKeyDown:o,afterKeyDown:n}=e;const i=aC({errorIdExists:e=>`The "${e}" context name is already registered.`});let s="grid";const l=()=>s,a=e=>i.getItem(e);let c=!1;const h=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();const o=k_(r)?r:a(r);let n=!1;if(!o.hasShortcut(t))return n;const i=o.getShortcuts(t);for(let s=0;s<i.length;s++){const{callback:r,runOnlyIf:o,preventDefault:l,stopPropagation:a,captureCtrl:u,forwardToContext:d}=i[s];if(!0===o(e)){if(c=u,n=!1===r(e,t),c=!1,l&&e.preventDefault(),a&&(By(e),e.stopPropagation()),n)break;d&&h(e,t,d)}}return n},u=function(e,t,r,o,n){const i=e=>D_.includes(e),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=[];return e.altKey&&r.push("alt"),t&&(e.ctrlKey||e.metaKey)?r.push("control/meta"):(e.ctrlKey&&r.push("control"),e.metaKey&&r.push("meta")),e.shiftKey&&r.push("shift"),r},l=e=>{if(!1===t(e))return;if(!1===r(e)||229===e.keyCode||"string"!=typeof e.key||jy(e))return;const l=I_(e);let a=[];i(l)||(a=s(e));const c=[l].concat(a);!n(e,c)&&(Vy()&&a.includes("meta")||!Vy()&&a.includes("control"))&&n(e,[l].concat(s(e,!0))),o(e)},a=e=>{if("string"==typeof e.key){const t=I_(e);i(t)&&P_.press(t)}},c=e=>{if("string"==typeof e.key){const t=I_(e);i(t)&&P_.release(t)}},h=()=>{P_.releaseAll()};return{mount:()=>{let t=e;for(V_+=1;t;)1===V_&&(t.document.documentElement.addEventListener("keydown",a),L_.push({event:"keydown",listener:a}),t.document.documentElement.addEventListener("keyup",c),L_.push({event:"keyup",listener:c})),t.document.documentElement.addEventListener("keydown",l),t.document.documentElement.addEventListener("blur",h),t=rw(t)},unmount:()=>{let t=e;for(V_-=1;t;){if(0===V_){for(let e=0;e<L_.length;e++){const{event:r,listener:o}=L_[e];t.document.documentElement.removeEventListener(r,o)}L_.length=0}t.document.documentElement.removeEventListener("keydown",l),t.document.documentElement.removeEventListener("blur",h),t=rw(t)}},isPressed:e=>P_.isPressed(e),releasePressedKeys:()=>P_.releaseAll()}}(t,r,o,n,h);return u.mount(),{addContext:e=>{const t=(e=>{const t=aC({errorIdExists:t=>`The "${t}" shortcut is already registered in the "${e}" context.`}),r=function(){let{keys:e,callback:r,group:o,runOnlyIf:n=()=>!0,captureCtrl:i=!1,preventDefault:s=!0,stopPropagation:l=!1,relativeToGroup:a,position:c,forwardToContext:h}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Pp(o))throw new Error("You need to define the shortcut's group.");if(!1===Ww(r))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(e))throw new Error(Ap`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const u={callback:r,group:o,runOnlyIf:n,captureCtrl:i,preventDefault:s,stopPropagation:l};Dp(a)&&(u.relativeToGroup=a,u.position=c),k_(h)&&(u.forwardToContext=h),e.forEach((e=>{const r=__(e);if(t.hasItem(r)){const e=t.getItem(r);let o=e.findIndex((e=>e.group===a));-1!==o?"before"===c?o-=1:o+=1:o=e.length,e.splice(o,0,u)}else t.addItem(r,[u])}))},o=e=>{const r=__(e);t.removeItem(r)};return{__kindOf:A_,addShortcut:r,addShortcuts:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((e=>{Oy(t,((r,o)=>{!1===Object.prototype.hasOwnProperty.call(e,o)&&(e[o]=t[o])})),r(e)}))},getShortcuts:e=>{const r=__(e),o=t.getItem(r);return Dp(o)?o.slice():[]},hasShortcut:e=>{const r=__(e);return t.hasItem(r)},removeShortcutsByKeys:o,removeShortcutsByGroup:e=>{t.getItems().forEach((t=>{let[r,n]=t;const i=n.filter((t=>t.group!==e));0===i.length?o((e=>e.split("+"))(r)):(n.length=0,n.push(...i))}))}}})(e);return i.addItem(e,t),t},getActiveContextName:l,getContext:a,setActiveContextName:e=>{if(!i.hasItem(e))throw new Error(Ap`You've tried to activate the "${e}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=e},isCtrlPressed:()=>!c&&(u.isPressed("control")||u.isPressed("meta")),releasePressedKeys:()=>u.releasePressedKeys(),destroy:()=>u.unmount()}};function W_(e){const{classNames:t}=function(e,t){const r={element:void 0,classNames:[]};let o=e;for(;null!==o&&o!==e.ownerDocument.documentElement&&!r.element;){if("string"==typeof t&&o.classList.contains(t))r.element=o,r.classNames.push(t);else if(t instanceof RegExp){const e=Array.from(o.classList).filter((e=>t.test(e)));e.length&&(r.element=o,r.classNames.push(...e))}o=o.parentElement}return r}(e,/ht-theme-[a-zA-Z0-9_-]+/);return t.pop()}let B_=null;const j_=new Map;function z_(e,t){var r,o=this;let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this;const s=new Bv(i);let a,c,h,u,d,f,g=!0;var m;n===NE&&(m=this,_E.set(m,!0)),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=null!==(r=null==t?void 0:t.layoutDirection)&&void 0!==r?r:"inherit",w=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",w),this.isRtl=function(){return"rtl"===w},this.isLtr=function(){return!i.isRtl()},this.getDirectionFactor=function(){return i.isLtr()?1:-1},t.language=function(e){let t=zO(e);return IH(t)||(t=EH,UO(e)),t}(t.language);const y=new n_(i,t,[l_,d_]),v=y.getTableMeta(),b=y.getGlobalMeta(),C=aC();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),IE(this)&&(Gp(t.licenseKey,e),hw(e,"ht-wrapper")),this.guid=`ht_${qp()}`,j_.set(this.guid,this),this.columnIndexMapper=new jO,this.rowIndexMapper=new jO,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(e=>{i.runHooks("afterColumnSequenceChange",e)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(e=>{i.runHooks("afterRowSequenceChange",e)})),c=new oO(i),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let S=new Ix(v,{rowIndexMapper:i.rowIndexMapper,columnIndexMapper:i.columnIndexMapper,countCols:()=>i.countCols(),countRows:()=>i.countRows(),propToCol:e=>a.propToCol(e),isEditorOpened:()=>!!i.getActiveEditor()&&i.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return o.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return o.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>i.getShortcutManager(),createCellCoords:(e,t)=>i._createCellCoords(e,t),createCellRange:(e,t,r)=>i._createCellRange(e,t,r),visualToRenderableCoords:e=>{const{row:t,col:r}=e;return i._createCellCoords(t>=0?i.rowIndexMapper.getRenderableFromVisualIndex(t):t,r>=0?i.columnIndexMapper.getRenderableFromVisualIndex(r):r)},renderableToVisualCoords:e=>{const{row:t,col:r}=e;return i._createCellCoords(t>=0?i.rowIndexMapper.getVisualFromRenderableIndex(t):t,r>=0?i.columnIndexMapper.getVisualFromRenderableIndex(r):r)},findFirstNonHiddenRenderableRow:(e,t)=>{const r=t>e?1:-1,o=Math.min(e,t),n=Math.max(e,t),s=i.rowIndexMapper.getNearestNotHiddenIndex(e,r);return null===s||1===r&&s>n||-1===r&&s<o?null:s>=0?i.rowIndexMapper.getRenderableFromVisualIndex(s):s},findFirstNonHiddenRenderableColumn:(e,t)=>{const r=t>e?1:-1,o=Math.min(e,t),n=Math.max(e,t),s=i.columnIndexMapper.getNearestNotHiddenIndex(e,r);return null===s||1===r&&s>n||-1===r&&s<o?null:s>=0?i.columnIndexMapper.getRenderableFromVisualIndex(s):s},isDisabledCellSelection:(e,t)=>e<0||t<0?i.getSettings().disableVisualSelection:i.getCellMeta(e,t).disableVisualSelection});this.selection=S;const R=e=>{let{hiddenIndexesChanged:t}=e;t&&this.selection.commit()};function T(e){const t=zO(e);IH(t)?(i.runHooks("beforeLanguageChange",t),b.language=t,i.runHooks("afterLanguageChange",t)):UO(e)}function E(e,t){const r="className"===e?i.rootElement:i.table;if(g)hw(r,t);else{let o=[],n=[];b[e]&&(o=Array.isArray(b[e])?b[e]:Ip(b[e])),t&&(n=Array.isArray(t)?t:Ip(t));const i=Np(o,n),s=Np(n,o);i.length&&uw(r,i),s.length&&hw(r,s)}b[e]=t}function O(){let e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function M(e){const t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function H(e,t,r){if(!e.length)return void r();const o=i.getActiveEditor(),n=new O;let s=!0;n.onQueueEmpty=()=>{o&&s&&o.cancelChanges(),r()};for(let c=e.length-1;c>=0;c--){const[r,o,,h]=e[c],u=a.propToCol(o);let d;d=Number.isInteger(u)?i.getCellMeta(r,u):l(l({},Object.getPrototypeOf(v)),v),"numeric"===d.type&&"string"==typeof h&&Jb(h,[","])&&(e[c][3]=M(h)),i.getCellValidator(d)&&(n.addValidatorToQueue(),i.validateCell(e[c][3],d,function(t,r){return function(o){if("boolean"!=typeof o)throw new Error("Validation error: result is not boolean");!1===o&&!1===r.allowInvalid&&(s=!1,e.splice(t,1),r.valid=!0),n.removeValidatorFormQueue()}}(c,d),t))}n.checkIfQueueIsEmpty()}function x(e,t){for(let o=e.length-1;o>=0;o--){let r=!1;if(null!==e[o]){if(null!==e[o][2]&&void 0!==e[o][2]||null!==e[o][3]&&void 0!==e[o][3]){if(v.allowInsertRow)for(;e[o][0]>i.countRows()-1;){const{delta:e}=a.createRow(void 0,void 0,{source:t});if(0===e){r=!0;break}}if("array"===i.dataType&&(!v.columns||0===v.columns.length)&&v.allowInsertColumn)for(;a.propToCol(e[o][1])>i.countCols()-1;){const{delta:e}=a.createCol(void 0,void 0,{source:t});if(0===e){r=!0;break}}r||a.set(e[o][0],e[o][1],e[o][3])}}else e.splice(o,1)}const r=e.length>0;if(i.forceFullRender=!0,r){h.adjustRowsAndCols(),i.runHooks("beforeChangeRender",e,t),u.closeEditor(),i.view.render(),u.prepareEditor(),i.view.adjustElementsSize(),i.runHooks("afterChange",e,t||"edit");const r=i.getActiveEditor();r&&Dp(r.refreshValue)&&r.refreshValue()}else i.view.render()}function _(e,t,r){return Array.isArray(e)?e:[[e,t,r]]}function N(e,t){const r=i.getActiveEditor(),o=i.runHooks("beforeChange",e,t||"edit"),n=e.filter((e=>null!==e));return!1===o||0===n.length?(r&&r.cancelChanges(),[]):n}this.columnIndexMapper.addLocalHook("cacheUpdated",R),this.rowIndexMapper.addLocalHook("cacheUpdated",R),this.selection.addLocalHook("afterSetRangeEnd",((e,t)=>{const r=xy(!1),o=this.selection.getSelectedRange(),{from:n,to:s}=o.current(),l=o.size()-1;this.runHooks("afterSelection",n.row,n.col,s.row,s.col,r,l),this.runHooks("afterSelectionByProp",n.row,i.colToProp(n.col),s.row,i.colToProp(s.col),r,l),t&&(!r.isTouched()||r.isTouched()&&!r.value)&&f.scrollTo(e);const a=S.isSelectedByRowHeader(),c=S.isSelectedByColumnHeader();a&&c?hw(this.rootElement,["ht__selection--rows","ht__selection--columns"]):a?(uw(this.rootElement,"ht__selection--columns"),hw(this.rootElement,"ht__selection--rows")):c?(uw(this.rootElement,"ht__selection--rows"),hw(this.rootElement,"ht__selection--columns")):uw(this.rootElement,["ht__selection--rows","ht__selection--columns"]),"shift"!==S.getSelectionSource()&&u.closeEditor(null),i.view.render(),u.prepareEditor()})),this.selection.addLocalHook("beforeSetFocus",(e=>{this.runHooks("beforeSelectionFocusSet",e.row,e.col)})),this.selection.addLocalHook("afterSetFocus",(e=>{const t=xy(!1);this.runHooks("afterSelectionFocusSet",e.row,e.col,t),(!t.isTouched()||t.isTouched()&&!t.value)&&f.scrollTo(e),u.closeEditor(),i.view.render(),u.prepareEditor()})),this.selection.addLocalHook("afterSelectionFinished",(e=>{const t=e.length-1,{from:r,to:o}=e[t];this.runHooks("afterSelectionEnd",r.row,r.col,o.row,o.col,t),this.runHooks("afterSelectionEndByProp",r.row,i.colToProp(r.col),o.row,i.colToProp(o.col),t)})),this.selection.addLocalHook("afterIsMultipleSelection",(e=>{const t=this.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)})),this.selection.addLocalHook("afterDeselect",(()=>{u.closeEditor(),i.view.render(),uw(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")})),this.selection.addLocalHook("beforeHighlightSet",(()=>this.runHooks("beforeSelectionHighlightSet"))).addLocalHook("beforeSetRangeStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.runHooks("beforeSetRangeStart",...t)})).addLocalHook("beforeSetRangeStartOnly",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.runHooks("beforeSetRangeStartOnly",...t)})).addLocalHook("beforeSetRangeEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.runHooks("beforeSetRangeEnd",...t)})).addLocalHook("beforeSelectColumns",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.runHooks("beforeSelectColumns",...t)})).addLocalHook("afterSelectColumns",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.runHooks("afterSelectColumns",...t)})).addLocalHook("beforeSelectRows",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.runHooks("beforeSelectRows",...t)})).addLocalHook("afterSelectRows",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.runHooks("afterSelectRows",...t)})).addLocalHook("beforeModifyTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.runHooks("modifyTransformStart",...t)})).addLocalHook("afterModifyTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.runHooks("afterModifyTransformStart",...t)})).addLocalHook("beforeModifyTransformFocus",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.runHooks("modifyTransformFocus",...t)})).addLocalHook("afterModifyTransformFocus",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.runHooks("afterModifyTransformFocus",...t)})).addLocalHook("beforeModifyTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.runHooks("modifyTransformEnd",...t)})).addLocalHook("afterModifyTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.runHooks("afterModifyTransformEnd",...t)})).addLocalHook("beforeRowWrap",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.runHooks("beforeRowWrap",...t)})).addLocalHook("beforeColumnWrap",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.runHooks("beforeColumnWrap",...t)})).addLocalHook("insertRowRequire",(e=>this.alter("insert_row_above",e,1,"auto"))).addLocalHook("insertColRequire",(e=>this.alter("insert_col_start",e,1,"auto"))),h={alter(e,t){var r,o;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;const c=e=>{if(0===e.length)return[];const t=[...e];t.sort(((e,t)=>{let[r]=e,[o]=t;return r===o?0:r>o?1:-1}));return Mp(t,((e,t)=>{let[r,o]=t;const n=e[e.length-1],[i,s]=n,l=i+s;if(r<=l){const e=Math.max(o-(l-r),0);n[1]+=e}else e.push([r,o]);return e}),[t[0]])};switch(e){case"insert_row_below":case"insert_row_above":const l=i.countSourceRows();if(v.maxRows===l)return;const h="insert_row_below"===e?"below":"above";t=null!==(r=t)&&void 0!==r?r:"below"===h?l:0;const{delta:d,startPhysicalIndex:f}=a.createRow(t,n,{source:s,mode:h});S.shiftRows(i.toVisualRow(f),d);break;case"insert_col_start":case"insert_col_end":const g="insert_col_end"===e?"end":"start";t=null!==(o=t)&&void 0!==o?o:"end"===g?i.countSourceCols():0;const{delta:m,startPhysicalIndex:p}=a.createCol(t,n,{source:s,mode:g});if(m){if(Array.isArray(v.colHeaders)){const e=[i.toVisualColumn(p),0];e.length+=m,Array.prototype.splice.apply(v.colHeaders,e)}S.shiftColumns(i.toVisualColumn(p),m)}break;case"remove_row":const w=e=>{let t=0;_p(e,(e=>{let[r,o]=e;const n=Lp(r)?i.countRows()-1:Math.max(r-t,0);Number.isInteger(r)&&(r=Math.max(r-t,0));if(!a.removeRow(r,o,s))return;if(S.isSelected()){const{row:e}=i.getSelectedRangeLast().highlight;e>=r&&e<=r+o-1&&u.closeEditor(!0)}const l=i.countRows();0===l?S.deselect():"ContextMenu.removeRow"===s?S.refresh():S.shiftRows(r,-o);const c=v.fixedRowsTop;c>=n+1&&(v.fixedRowsTop-=Math.min(o,c-n));const h=v.fixedRowsBottom;h&&n>=l-h&&(v.fixedRowsBottom-=Math.min(o,h)),t+=o}))};Array.isArray(t)?w(c(t)):w([[t,n]]);break;case"remove_col":const y=e=>{let t=0;_p(e,(e=>{let[r,o]=e;const n=Lp(r)?i.countCols()-1:Math.max(r-t,0);let l=i.toPhysicalColumn(n);Number.isInteger(r)&&(r=Math.max(r-t,0));if(!a.removeCol(r,o,s))return;if(S.isSelected()){const{col:e}=i.getSelectedRangeLast().highlight;e>=r&&e<=r+o-1&&u.closeEditor(!0)}0===i.countCols()?S.deselect():"ContextMenu.removeColumn"===s?S.refresh():S.shiftColumns(r,-o);const c=v.fixedColumnsStart;c>=n+1&&(v.fixedColumnsStart-=Math.min(o,c-n)),Array.isArray(v.colHeaders)&&(void 0===l&&(l=-1),v.colHeaders.splice(l,o)),t+=o}))};Array.isArray(t)?y(c(t)):y([[t,n]]);break;default:throw new Error(`There is no such action "${e}"`)}i.view.render(),l||h.adjustRowsAndCols()},adjustRowsAndCols(){const e=v.minRows,t=v.minSpareRows,r=v.minCols,o=v.minSpareCols;if(e){const t=i.countRows();t<e&&a.createRow(t,e-t,{source:"auto"})}if(t){const e=i.countEmptyRows(!0);if(e<t){const r=t-e,o=Math.min(r,v.maxRows-i.countSourceRows());a.createRow(i.countRows(),o,{source:"auto"})}}{let e;(r||o)&&(e=i.countEmptyCols(!0));let t=i.countCols();if(r&&!v.columns&&t<r){const o=r-t;e+=o,a.createCol(t,o,{source:"auto"})}if(o&&!v.columns&&"array"===i.dataType&&e<o){t=i.countCols();const r=o-e,n=Math.min(r,v.maxCols-t);a.createCol(t,n,{source:"auto"})}}i.view&&i.view.adjustElementsSize()},populateFromArray(e,t,r,o,n){let s,l,a,c;const h=[],u={},d=[],f=e.row,g=e.col;if(l=t.length,0===l)return!1;let m=0,p=0;switch(Ty(r)&&(m=r.col-g+1,p=r.row-f+1),n){case"shift_down":const n=Op(t),w=n.length,y=Math.max(w,m),b=i.getData().slice(f),C=Op(b).slice(g,g+y);for(a=0;a<y;a+=1)if(a<w){for(s=0,l=n[a].length;s<p-l;s+=1)n[a].push(n[a][s%l]);a<C.length?d.push(n[a].concat(C[a])):d.push(n[a].concat(new Array(b.length).fill(null)))}else d.push(n[a%w].concat(C[a]));i.populateFromArray(f,g,Op(d));break;case"shift_right":const S=t.length,R=Math.max(S,p),T=i.getData().slice(f).map((e=>e.slice(g)));for(s=0;s<R;s+=1)if(s<S){for(a=0,c=t[s].length;a<m-c;a+=1)t[s].push(t[s][a%c]);if(s<T.length)for(let e=0;e<T[s].length;e+=1)t[s].push(T[s][e]);else t[s].push(...new Array(T[0].length).fill(null))}else t.push(t[s%l].slice(0,R).concat(T[s]));i.populateFromArray(f,g,t);break;default:u.row=e.row,u.col=e.col;let E,O=0,M=0,H=!0;const x=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const o=t[e%t.length];return null!==r?o[r%o.length]:o},_=t.length,N=r?r.row-e.row+1:0;for(l=r?N:Math.max(_,N),s=0;s<l&&!(r&&u.row>r.row&&N>_||!v.allowInsertRow&&u.row>i.countRows()-1||u.row>=v.maxRows);s++){const t=s-O,n=x(t).length,d=r?r.col-e.col+1:0;if(c=r?d:Math.max(n,d),u.col=e.col,E=i.getCellMeta(u.row,u.col),"CopyPaste.paste"!==o&&"Autofill.fill"!==o||!E.skipRowOnPaste){for(M=0,a=0;a<c&&!(r&&u.col>r.col&&d>n||!v.allowInsertColumn&&u.col>i.countCols()-1||u.col>=v.maxCols);a++){if(E=i.getCellMeta(u.row,u.col),("CopyPaste.paste"===o||"Autofill.fill"===o)&&E.skipColumnOnPaste){M+=1,u.col+=1,c+=1;continue}if(E.readOnly&&"UndoRedo.undo"!==o){u.col+=1;continue}let e=x(t,a-M),r=i.getDataAtCell(u.row,u.col);if(null!==e&&"object"==typeof e)if(Array.isArray(e)&&null===r&&(r=[]),null===r||"object"!=typeof r)H=!1;else{const t=yy(Array.isArray(r)?r:r[0]||r),o=yy(Array.isArray(e)?e:e[0]||e);Ry(t,o)||Array.isArray(t)&&Array.isArray(o)?e=Cy(e):H=!1}else null!==r&&"object"==typeof r&&(H=!1);H&&h.push([u.row,u.col,e]),H=!0,u.col+=1}u.row+=1}else O+=1,u.row+=1,l+=1}i.setDataAtCell(h,null,null,o||"populateFromArray")}}},this.init=function(){c.setData(v.data),i.runHooks("beforeInit"),(Py()||function(){let{maxTouchPoints:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e>2&&ky.mac.value}())&&hw(i.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new KE(this);const e=v.themeName||W_(i.rootElement);i.useTheme(e),i.view.addClassNameToLicenseElement(i.getCurrentThemeName()),u=Kv.getInstance(i,v,S),f=function(e){const{selection:t}=e;let r=!1,o=!1;return{resume(){o=!1},suspend(){o=!0},skipNextScrollCycle(){r=!0},scrollTo(n){var i;if(r||o)return void(r=!1);let s;t.isFocusSelectionChanged()?s=function(e){return t=>{e.scrollViewportTo(t.toObject())}}(e):t.isSelectedByCorner()?s=()=>{}:t.isSelectedByRowHeader()?s=function(e){return t=>{let{row:r}=t;e.scrollViewportTo({row:r})}}(e):t.isSelectedByColumnHeader()?s=function(e){return t=>{let{col:r}=t;e.scrollViewportTo({col:r})}}(e):1===t.getSelectedRange().size()&&t.isMultiple()?s=function(e){return t=>{e.scrollViewportTo(t.toObject())}}(e):1!==t.getSelectedRange().size()||t.isMultiple()?t.getSelectedRange().size()>1&&(s=function(e){return t=>{e.scrollViewportTo(t.toObject())}}(e)):s=function(e){return t=>{const r=e.selection.getSelectionSource(),{row:o,col:n}=t;if(o<0&&n>=0)e.scrollViewportTo({col:n});else if(n<0&&o>=0)e.scrollViewportTo({row:o});else{if("mouse"===r&&(n===e.view.getLastPartiallyVisibleColumn()||o===e.view.getLastPartiallyVisibleRow()))return;e.scrollViewportTo({row:o,col:n})}}}(e),null===(i=s)||void 0===i||i(n)}}}(i),d=new cb(i),IE(this)&&O_(i),i.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&null===i.rootElement.offsetParent&&function(e,t){new IntersectionObserver(((r,o)=>{r.forEach((r=>{r.isIntersecting&&null!==e.offsetParent&&(t(),o.unobserve(e))}))}),{root:e.ownerDocument.body}).observe(e)}(i.rootElement,(()=>{i.view._wt.wtOverlays.updateLastSpreaderSize(),i.render(),i.view.adjustElementsSize()})),"object"==typeof g&&(i.runHooks("afterChange",g[0],g[1]),g=!1),i.runHooks("afterInit")},this._createCellCoords=function(e,t){return i.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,r){return i.view._wt.createCellRange(e,t,r)},this.validateCell=function(e,t,r,o){let n=i.getCellValidator(t);function s(e){if(!(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])||!0===t.hidden)return void r(e);const o=t.visualCol,n=t.visualRow,s=i.getCell(n,o,!0);if(s&&"TH"!==s.nodeName){const e=i.rowIndexMapper.getRenderableFromVisualIndex(n),t=i.columnIndexMapper.getRenderableFromVisualIndex(o);i.view._wt.getSetting("cellRenderer",e,t,s)}r(e)}var l,a;a=n,"[object RegExp]"===Object.prototype.toString.call(a)&&(l=n,n=function(e,t){t(l.test(e))}),Ww(n)?(e=i.runHooks("beforeValidate",e,t.visualRow,t.prop,o),i._registerImmediate((()=>{n.call(t,e,(r=>{i&&(r=i.runHooks("afterValidate",r,e,t.visualRow,t.prop,o),t.valid=r,s(r),i.runHooks("postAfterValidate",r,e,t.visualRow,t.prop,o))}))}))):i._registerImmediate((()=>{t.valid=!0,s(t.valid,!1)}))},this.setDataAtCell=function(e,t,r,o){const n=_(e,t,r),s=[];let l,h,u,d=o;for(l=0,h=n.length;l<h;l++){if("object"!=typeof n[l])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof n[l][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");u=n[l][1]>=this.countCols()?n[l][1]:a.colToProp(n[l][1]),s.push([n[l][0],u,c.getAtCell(this.toPhysicalRow(n[l][0]),n[l][1]),n[l][2]])}d||"object"!=typeof e||(d=t);const f=N(s,d);i.runHooks("afterSetDataAtCell",f,d),H(f,d,(()=>{x(f,d)}))},this.setDataAtRowProp=function(e,t,r,o){const n=_(e,t,r),s=[];let l,a,h=o;for(l=0,a=n.length;l<a;l++)s.push([n[l][0],n[l][1],c.getAtCell(this.toPhysicalRow(n[l][0]),n[l][1]),n[l][2]]);h||"object"!=typeof e||(h=t);const u=N(s,o);i.runHooks("afterSetDataAtRowProp",u,h),H(u,h,(()=>{x(u,h)}))},this.listen=function(){i&&!i.isListening()&&(j_.forEach((e=>{i!==e&&e.unlisten()})),B_=i.guid,i.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(B_=null,i.runHooks("afterUnlisten"))},this.isListening=function(){return B_===i.guid},this.destroyEditor=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];u.closeEditor(e),i.view.render(),t&&S.isSelected()&&u.prepareEditor()},this.populateFromArray=function(e,t,r,o,n,s,l){if("object"!=typeof r||"object"!=typeof r[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const a="number"==typeof o?i._createCellCoords(o,n):null;return h.populateFromArray(i._createCellCoords(e,t),r,a,s,l)},this.spliceCol=function(e,t,r){for(var o=arguments.length,n=new Array(o>3?o-3:0),i=3;i<o;i++)n[i-3]=arguments[i];return a.spliceCol(e,t,r,...n)},this.spliceRow=function(e,t,r){for(var o=arguments.length,n=new Array(o>3?o-3:0),i=3;i<o;i++)n[i-3]=arguments[i];return a.spliceRow(e,t,r,...n)},this.getSelected=function(){if(S.isSelected())return xp(S.getSelectedRange(),(e=>{let{from:t,to:r}=e;return[t.row,t.col,r.row,r.col]}))},this.getSelectedLast=function(){const e=this.getSelected();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedRange=function(){if(S.isSelected())return Array.from(S.getSelectedRange())},this.getSelectedRangeLast=function(){const e=this.getSelectedRange();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.emptySelectedCells=function(e){if(!S.isSelected()||0===this.countRows()||0===this.countCols())return;const t=[];_p(S.getSelectedRange(),(e=>{if(e.isSingleHeader())return;const r=e.getTopStartCorner(),o=e.getBottomEndCorner();eC(r.row,o.row,(e=>{eC(r.col,o.col,(r=>{this.getCellMeta(e,r).readOnly||t.push([e,r,null])}))}))})),t.length>0&&this.setDataAtCell(t,e)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():i.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||i.view.render())},this.batchRender=function(e){this.suspendRender();const t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const r=e();return this.resumeExecution(t),r},this.batch=function(e){this.suspendRender(),this.suspendExecution();const t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(!i.view)return;const{width:e,height:t}=i.view.getLastSize(),{width:r,height:o}=i.rootElement.getBoundingClientRect(),n=r!==e||o!==t;!1===i.runHooks("beforeRefreshDimensions",{width:e,height:t},{width:r,height:o},n)||((n||i.view._wt.wtOverlays.scrollableElement===i.rootWindow)&&(i.view.setLastSize(r,o),i.render()),i.runHooks("afterRefreshDimensions",{width:e,height:t},{width:r,height:o},n))},this.updateData=function(e,t){i_(e,(e=>{a=e}),(e=>{a=e,i.columnIndexMapper.fitToLength(this.getInitialColumnCount()),i.rowIndexMapper.fitToLength(this.countSourceRows()),h.adjustRowsAndCols(),S.refresh()}),{hotInstance:i,dataMap:a,dataSource:c,internalSource:"updateData",source:t,metaManager:y,firstRun:g})},this.loadData=function(e,t){i_(e,(e=>{a=e}),(()=>{y.clearCellsCache(),i.initIndexMappers(),h.adjustRowsAndCols(),S.refresh(),g&&(g=[null,"loadData"])}),{hotInstance:i,dataMap:a,dataSource:c,internalSource:"loadData",source:t,metaManager:y,firstRun:g})},this.getInitialColumnCount=function(){const e=v.columns;let t=0;if(Array.isArray(e))t=e.length;else if(Ww(e))if("array"===i.dataType){const r=this.countSourceCols();for(let o=0;o<r;o+=1)e(o)&&(t+=1)}else"object"!==i.dataType&&"function"!==i.dataType||(t=a.colToPropCache.length);else if(Dp(v.dataSchema)){const e=a.getSchema();t=Array.isArray(e)?e.length:Hy(e)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,r,o){return Pp(e)?a.getAll():a.getRange(i._createCellCoords(e,t),i._createCellCoords(r,o),a.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,r,o){return a.getCopyableText(i._createCellCoords(e,t),i._createCellCoords(r,o))},this.getCopyableData=function(e,t){return a.getCopyable(e,a.colToProp(t))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=(g?i.loadData:i.updateData).bind(this);let o,n,s=!1;if(Dp(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Dp(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Dp(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(o in e)"data"===o||("language"===o?T(e.language):"className"===o?E("className",e.className):"tableClassName"===o&&i.table?(E("tableClassName",e.tableClassName),i.view._wt.wtOverlays.syncOverlayTableClassNames()):Mv.getSingleton().isRegistered(o)||Mv.getSingleton().isDeprecated(o)?Ww(e[o])?Mv.getSingleton().addAsFixed(o,e[o],i):Array.isArray(e[o])&&Mv.getSingleton().add(o,e[o],i):!t&&_y(e,o)&&(b[o]=e[o]));void 0===e.data&&void 0===v.data?r(null,"updateSettings"):void 0!==e.data?r(e.data,"updateSettings"):void 0!==e.columns&&(a.createMap(),i.initIndexMappers());const l=i.countCols(),c=v.columns;if(c&&Ww(c)&&(s=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||y.clearCache(),l>0)for(o=0,n=0;o<l;o++){if(c){const e=s?c(o):c[n];e&&y.updateColumnMeta(n,e)}n+=1}Dp(e.cell)&&Oy(e.cell,(e=>{i.setCellMetaObject(e.row,e.col,e)})),i.runHooks("afterCellMetaReset");let u=i.rootElement.style.height;""!==u&&(u=parseInt(i.rootElement.style.height,10));let d=e.height;if(Ww(d)&&(d=d()),t){i.rootElement.getAttribute("style")&&i.rootElement.setAttribute("data-initialstyle",i.rootElement.getAttribute("style"))}if(null===d){const e=i.rootElement.getAttribute("data-initialstyle");e&&(e.indexOf("height")>-1||e.indexOf("overflow")>-1)?i.rootElement.setAttribute("style",e):(i.rootElement.style.height="",i.rootElement.style.overflow="")}else void 0!==d&&(i.rootElement.style.height=isNaN(d)?`${d}`:`${d}px`,i.rootElement.style.overflow="hidden");if(void 0!==e.width){let t=e.width;Ww(t)&&(t=t()),i.rootElement.style.width=isNaN(t)?`${t}`:`${t}px`}if(!t){if(i.view){i.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),i.view._wt.exportSettingsAsClassNames();const t=i.getCurrentThemeName(),r=_y(e,"themeName");t&&r&&(i.view.getStylesHandler().removeClassNames(),i.view.removeClassNameFromLicenseElement(t));const o=r&&e.themeName||W_(i.rootElement);i.useTheme(o),i.view.addClassNameToLicenseElement(i.getCurrentThemeName())}i.runHooks("afterUpdateSettings",e)}h.adjustRowsAndCols(),i.view&&!g&&(i.forceFullRender=!0,i.view.render(),i.view._wt.wtOverlays.adjustElementsSize()),t||!i.view||""!==u&&""!==d&&void 0!==d||u===d||i.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const e=i.getSelectedLast();if(v.getValue){if(Ww(v.getValue))return v.getValue.call(i);if(e)return i.getData()[e[0][0]][v.getValue]}else if(e)return i.getDataAtCell(e[0],e[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,r,o,n){h.alter(e,t,r,o,n)},this.getCell=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t,n=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;o=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;n=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===n||null===o||void 0===n||void 0===o?null:i.view.getCellAtCoords(i._createCellCoords(n,o),r)},this.getCoords=function(e){const t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;const{row:r,col:o}=t;let n=r,s=o;return r>=0&&(n=this.rowIndexMapper.getVisualFromRenderableIndex(r)),o>=0&&(s=this.columnIndexMapper.getVisualFromRenderableIndex(o)),i._createCellCoords(n,s)},this.colToProp=function(e){return a.colToProp(e)},this.propToCol=function(e){return a.propToCol(e)},this.toVisualRow=e=>this.rowIndexMapper.getVisualFromPhysicalIndex(e),this.toVisualColumn=e=>this.columnIndexMapper.getVisualFromPhysicalIndex(e),this.toPhysicalRow=e=>this.rowIndexMapper.getPhysicalFromVisualIndex(e),this.toPhysicalColumn=e=>this.columnIndexMapper.getPhysicalFromVisualIndex(e),this.getDataAtCell=function(e,t){return a.get(e,a.colToProp(t))},this.getDataAtRowProp=function(e,t){return a.get(e,t)},this.getDataAtCol=function(e){const t=[],r=a.getRange(i._createCellCoords(0,e),i._createCellCoords(v.data.length-1,e),a.DESTINATION_RENDERER);for(let o=0;o<r.length;o+=1)for(let e=0;e<r[o].length;e+=1)t.push(r[o][e]);return t},this.getDataAtProp=function(e){const t=[],r=a.getRange(i._createCellCoords(0,a.propToCol(e)),i._createCellCoords(v.data.length-1,a.propToCol(e)),a.DESTINATION_RENDERER);for(let o=0;o<r.length;o+=1)for(let e=0;e<r[o].length;e+=1)t.push(r[o][e]);return t},this.getSourceData=function(e,t,r,o){let n;return n=void 0===e?c.getData():c.getByRange(i._createCellCoords(e,t),i._createCellCoords(r,o)),n},this.getSourceDataArray=function(e,t,r,o){let n;return n=void 0===e?c.getData(!0):c.getByRange(i._createCellCoords(e,t),i._createCellCoords(r,o),!0),n},this.getSourceDataAtCol=function(e){return c.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,r,o){const n=_(e,t,r),s=this.hasHook("afterSetSourceDataAtCell"),l=[];s&&_p(n,(e=>{let[t,r,o]=e;l.push([t,r,c.getAtCell(t,r),o])})),_p(n,(e=>{let[t,r,o]=e;c.setAtCell(t,r,o)})),s&&this.runHooks("afterSetSourceDataAtCell",l,o),this.render();const a=i.getActiveEditor();a&&Dp(a.refreshValue)&&a.refreshValue()},this.getSourceDataAtRow=function(e){return c.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return c.getAtCell(e,t)},this.getDataAtRow=function(e){return a.getRange(i._createCellCoords(e,0),i._createCellCoords(e,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,r,o){const n=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,r,o],[i,s]=n;let[,,l,a]=n,c=null,h=null;void 0===l&&(l=i),void 0===a&&(a=s);let u="mixed";return eC(Math.max(Math.min(i,l),0),Math.max(i,l),(e=>{let t=!0;return eC(Math.max(Math.min(s,a),0),Math.max(s,a),(r=>{const o=this.getCellMeta(e,r);return h=o.type,c?t=c===h:c=h,t})),u=t?h:"mixed",t})),u},this.removeCellMeta=function(e,t,r){const[o,n]=[this.toPhysicalRow(e),this.toPhysicalColumn(t)];let s=y.getCellMetaKeyValue(o,n,r);!1!==i.runHooks("beforeRemoveCellMeta",e,t,r,s)&&(y.removeCellMeta(o,n,r),i.runHooks("afterRemoveCellMeta",e,t,r,s)),s=null},this.spliceCellsMeta=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var r=arguments.length,o=new Array(r>2?r-2:0),n=2;n<r;n++)o[n-2]=arguments[n];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");t>0&&y.removeRow(this.toPhysicalRow(e),t),o.length>0&&_p(o.reverse(),(t=>{y.createRow(this.toPhysicalRow(e)),_p(t,((t,r)=>this.setCellMetaObject(e,r,t)))})),i.render()},this.setCellMetaObject=function(e,t,r){"object"==typeof r&&Oy(r,((r,o)=>{this.setCellMeta(e,t,o,r)}))},this.setCellMeta=function(e,t,r,o){if(!1===i.runHooks("beforeSetCellMeta",e,t,r,o))return;let n=e,s=t;e<this.countRows()&&(n=this.toPhysicalRow(e)),t<this.countCols()&&(s=this.toPhysicalColumn(t)),y.setCellMeta(n,s,r,o),i.runHooks("afterSetCellMeta",e,t,r,o)},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(e,t){let r=this.toPhysicalRow(e),o=this.toPhysicalColumn(t);return null===r&&(r=e),null===o&&(o=t),y.getCellMeta(r,o,{visualRow:e,visualColumn:t})},this.getColumnMeta=function(e){return y.getColumnMeta(this.toPhysicalColumn(e))},this.getCellMetaAtRow=function(e){return y.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===i.dataType||v.columns)},this.getCellRenderer=function(e,t){const r="number"==typeof e?i.getCellMeta(e,t).renderer:e.renderer;return"string"==typeof r?vC(r):Pp(r)?vC("text"):r},this.getCellEditor=function(e,t){const r="number"==typeof e?i.getCellMeta(e,t).editor:e.editor;return"string"==typeof r?Vv(r):Pp(r)?Vv("text"):r},this.getCellValidator=function(e,t){const r="number"==typeof e?i.getCellMeta(e,t).validator:e.validator;return"string"==typeof r?function(e){if("function"==typeof e)return e;if(!SC(e))throw Error(`No registered validator found under "${e}" name`);return CC(e)}(r):r},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,r){const o=new O;e&&(o.onQueueEmpty=e);let n=i.countRows()-1;for(;n>=0;){if(void 0!==t&&-1===t.indexOf(n)){n-=1;continue}let e=i.countCols()-1;for(;e>=0;)void 0===r||-1!==r.indexOf(e)?(o.addValidatorToQueue(),i.validateCell(i.getDataAtCell(n,e),i.getCellMeta(n,e),(e=>{if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(o.valid=!1),o.removeValidatorFormQueue()}),"validateCells"),e-=1):e-=1;n-=1}o.checkIfQueueIsEmpty()},this.getRowHeader=function(e){let t=v.rowHeaders,r=e;return void 0!==r&&(r=i.runHooks("modifyRowHeader",r)),void 0===r?(t=[],eC(i.countRows()-1,(e=>{t.push(i.getRowHeader(e))}))):Array.isArray(t)&&void 0!==t[r]?t=t[r]:Ww(t)?t=t(r):t&&"string"!=typeof t&&"number"!=typeof t&&(t=r+1),t},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(void 0!==v.colHeaders&&null!==v.colHeaders)return!!v.colHeaders;for(let e=0,t=i.countCols();e<t;e++)if(i.getColHeader(e))return!0;return!1},this.getColHeader=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const r=i.runHooks("modifyColHeader",e);if(void 0===r){const e=[],t=i.countCols();for(let r=0;r<t;r++)e.push(i.getColHeader(r));return e}let o=v.colHeaders;const n=i.toPhysicalColumn(r),s=function(e){const t=[],r=i.countCols();let o=0;for(;o<r;o++)Ww(v.columns)&&v.columns(o)&&t.push(o);return t[e]}(n);return!1===v.colHeaders?o=null:v.columns&&Ww(v.columns)&&v.columns(s)&&v.columns(s).title?o=v.columns(s).title:v.columns&&v.columns[n]&&v.columns[n].title?o=v.columns[n].title:Array.isArray(v.colHeaders)&&void 0!==v.colHeaders[n]?o=v.colHeaders[n]:Ww(v.colHeaders)?o=v.colHeaders(n):v.colHeaders&&"string"!=typeof v.colHeaders&&"number"!=typeof v.colHeaders&&(o=function(e){let t,r=e+1,o="";for(;r>0;)t=(r-1)%26,o=String.fromCharCode(65+t)+o,r=parseInt((r-t)/26,10);return o}(r)),o=i.runHooks("modifyColumnHeaderValue",o,e,t),o},this._getColWidthFromSettings=function(e){let t;if(e>=0){t=i.getCellMeta(0,e).width}if(void 0!==t&&t!==v.width||(t=v.colWidths),null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e,t){let r=i._getColWidthFromSettings(e);return r=i.runHooks("modifyColWidth",r,e,t),void 0===r&&(r=50),r},this._getRowHeightFromSettings=function(e){let t=v.rowHeights;if(null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e,t){let r=i._getRowHeightFromSettings(e);return r=i.runHooks("modifyRowHeight",r,e,t),r},this.countSourceRows=function(){return c.countRows()},this.countSourceCols=function(){return c.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const e=v.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return i.view._wt.drawn?i.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return i.view._wt.drawn?i.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return i.view._wt.drawn?i.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return i.view._wt.drawn?i.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return tC(i.countRows()-1,(r=>{if(i.isEmptyRow(r))t+=1;else if(!0===e)return!1})),t},this.countEmptyCols=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return tC(i.countCols()-1,(r=>{if(i.isEmptyCol(r))t+=1;else if(!0===e)return!1})),t},this.isEmptyRow=function(e){return v.isEmptyRow.call(i,e)},this.isEmptyCol=function(e){return v.isEmptyCol.call(i,e)},this.selectCell=function(e,t,r,o){let n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Pp(e)&&!Pp(t)&&this.selectCells([[e,t,r,o]],n,i)},this.selectCells=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&f.suspend();const r=S.selectCells(e);return r&&t&&i.listen(),f.resume(),r},this.selectColumns=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2?arguments[2]:void 0;return S.selectColumns(e,t,r)},this.selectRows=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2?arguments[2]:void 0;return S.selectRows(e,t,r)},this.deselectCell=function(){S.deselect()},this.selectAll=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2?arguments[2]:void 0;f.skipNextScrollCycle(),S.selectAll(e,t,r)};const I=(e,t)=>e.getNearestNotHiddenIndex(t,1,!0);this.scrollViewportTo=function(e){var t,r;"number"==typeof e&&(e={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(r=arguments[4])||void 0===r||r});const{row:o,col:n,considerHiddenIndexes:s}=null!==(t=e)&&void 0!==t?t:{};let l=o,a=n;if(void 0===s||s){const e=Number.isInteger(o)&&o>=0,t=Number.isInteger(n)&&n>=0,r=e?I(this.rowIndexMapper,o):void 0,s=t?I(this.columnIndexMapper,n):void 0;if(null===r||null===s)return!1;l=e?i.rowIndexMapper.getRenderableFromVisualIndex(r):o,a=t?i.columnIndexMapper.getRenderableFromVisualIndex(s):n}const c=Number.isInteger(l),h=Number.isInteger(a);return c&&l>=0&&h&&a>=0?i.view.scrollViewport(i._createCellCoords(l,a),e.horizontalSnap,e.verticalSnap):c&&l>=0&&(h&&a<0||!h)?i.view.scrollViewportVertically(l,e.verticalSnap):!!(h&&a>=0&&(c&&l<0||!c))&&i.view.scrollViewportHorizontally(a,e.horizontalSnap)},this.scrollToFocusedCell=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",e);const{highlight:t}=this.getSelectedRangeLast();this.scrollViewportTo(t.toObject())?this.view.render():(this.removeHook("afterScroll",e),this._registerImmediate((()=>e())))},this.destroy=function(){if(i._clearTimeouts(),i._clearImmediates(),i.view&&i.view.destroy(),c&&c.destroy(),c=null,this.getShortcutManager().destroy(),y.clearCache(),j_.delete(this.guid),IE(i)){const e=this.rootDocument.querySelector(".hot-display-license-info");e&&e.parentNode.removeChild(e)}mw(i.rootElement),s.destroy(),u&&u.destroy(),i.batchExecution((()=>{i.rowIndexMapper.unregisterAll(),i.columnIndexMapper.unregisterAll(),C.getItems().forEach((e=>{let[,t]=e;t.destroy()})),C.clear(),i.runHooks("afterDestroy")}),!0),Mv.getSingleton().destroy(i),Oy(i,((e,t,r)=>{var o;Ww(e)?r[t]=(o=t,()=>{throw new Error(`The "${o}" method cannot be called because this Handsontable instance has been destroyed`)}):"guid"!==t&&(r[t]=null)})),i.isDestroyed=!0,a&&a.destroy(),a=null,h=null,S=null,u=null,i=null},this.getActiveEditor=function(){return u.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return i.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return i.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return i.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return i.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return i.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return i.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return i.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return i.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return i.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return i.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return i.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return i.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(e){const t=Xp(e);return"UndoRedo"===t?this.undoRedo:C.getItem(t)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:C.getId(e)},this.getInstance=function(){return i},this.addHook=function(e,t,r){Mv.getSingleton().add(e,t,i,r)},this.hasHook=function(e){return Mv.getSingleton().has(e,i)||Mv.getSingleton().has(e)},this.addHookOnce=function(e,t,r){Mv.getSingleton().once(e,t,i,r)},this.removeHook=function(e,t){Mv.getSingleton().remove(e,t,i)},this.runHooks=function(e,t,r,o,n,s,l){return Mv.getSingleton().run(i,e,t,r,o,n,s,l)},this.getTranslatedPhrase=function(e,t){return AH(v.language,e,t)},this.toHTML=()=>Qb(this),this.toTableElement=()=>{const e=this.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",Qb(this)),e.firstElementChild},this.timeouts=[],this.useTheme=e=>{this.view.getStylesHandler().useTheme(e),this.runHooks("afterSetTheme",e,!!g)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(e){let t=e;"function"==typeof t&&(t=setTimeout(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(t)},this._clearTimeouts=function(){_p(this.timeouts,(e=>{clearTimeout(e)}))},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){_p(this.immediates,(e=>{clearImmediate(e)}))},this._getEditorManager=function(){return u},this.isRtl=function(){return"rtl"===i.rootWindow.getComputedStyle(i.rootElement).direction},this.isLtr=function(){return!i.isRtl()},this.getDirectionFactor=function(){return i.isLtr()?1:-1};const A=F_({handleEvent:()=>i.isListening(),beforeKeyDown:e=>this.runHooks("beforeKeyDown",e),afterKeyDown:e=>{this.isDestroyed||i.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});var k;this.addHook("beforeOnCellMouseDown",(e=>{!1===e.ctrlKey&&!1===e.metaKey&&A.releasePressedKeys()})),this.getShortcutManager=function(){return A},this.getFocusManager=function(){return d},[...uC.getItems(),...dC.getItems()].forEach((e=>{const t=function(e){const t=Xp(e);return fC.getItem(t)}(e);C.addItem(e,new t(this))})),k=i,[T_,R_].forEach((e=>e(k))),A.setActiveContextName("grid"),Mv.getSingleton().run(i,"construct")}function U_(e,t,r){e.addEventListener(t,r,!1)}function Y_(e,t,r){e.removeEventListener(t,r,!1)}function $_(e){return e.ownerDocument.defaultView.getComputedStyle(e)}function G_(e){const t=l({minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:e=>e.value},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),r=e.body,o=e.createTextNode(""),n=e.createElement("span");let i;function s(){var e,s;o.textContent=t.textContent(i),n.style.position="absolute",n.style.fontSize=$_(i).fontSize,n.style.fontFamily=$_(i).fontFamily,n.style.whiteSpace="pre",r.appendChild(n);const l=parseInt((null===(e=$_(i))||void 0===e?void 0:e.paddingInlineStart)||0,10),a=parseInt((null===(s=$_(i))||void 0===s?void 0:s.paddingInlineEnd)||0,10),c=n.clientWidth+2+l+a;r.removeChild(n);const h=i.style;h.height=`${t.minHeight}px`,t.minWidth>c?h.width=`${t.minWidth}px`:c>t.maxWidth?h.width=`${t.maxWidth}px`:h.width=`${c}px`;const u=i.scrollHeight?i.scrollHeight-1:0;t.minHeight>u?h.height=`${t.minHeight}px`:t.maxHeight<u?(h.height=`${t.maxHeight}px`,h.overflowY="visible"):h.height=`${u}px`}function a(){e.defaultView.setTimeout(s,0)}return{init:function(e,r){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i=e,function(e){if(e&&e.minHeight)if("inherit"===e.minHeight)t.minHeight=i.clientHeight;else{const r=parseInt(e.minHeight,10);isNaN(r)||(t.minHeight=r)}if(e&&e.maxHeight)if("inherit"===e.maxHeight)t.maxHeight=i.clientHeight;else{const r=parseInt(e.maxHeight,10);isNaN(r)||(t.maxHeight=r)}if(e&&e.minWidth)if("inherit"===e.minWidth)t.minWidth=i.clientWidth;else{const r=parseInt(e.minWidth,10);isNaN(r)||(t.minWidth=r)}if(e&&e.maxWidth)if("inherit"===e.maxWidth)t.maxWidth=i.clientWidth;else{const r=parseInt(e.maxWidth,10);isNaN(r)||(t.maxWidth=r)}n.firstChild||(n.className="autoResize",n.style.display="inline-block",n.appendChild(o))}(r),"TEXTAREA"===i.nodeName&&(i.style.resize="none",i.style.height=`${t.minHeight}px`,i.style.minWidth=`${t.minWidth}px`,i.style.maxWidth=`${t.maxWidth}px`,i.style.overflowY="hidden"),l&&(U_(i,"input",s),U_(i,"keydown",a)),s()},resize:s,unObserve(){Y_(i,"input",s),Y_(i,"keydown",a)}}}function X_(e,t){const r=(o=t).selectionStart?o.selectionStart:0;var o;const n=t.value.split("\n");let i=r,s=0;for(let l=0;l<n.length;l++){const t=n[l];0!==l&&(s+=n[l-1].length+1);const o=s+t.length;if("home"===e?i=s:"end"===e&&(i=o),r<=o)break}Aw(t,i)}function q_(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const K_="ht_editor_hidden",Z_="textEditor";function Q_(e,t,r,o,n,i,s){const l=s.ariaTags,a=[],c=[],h=[],u=[];s.className&&hw(t,s.className),s.readOnly?(a.push(s.readOnlyCellClassName),l&&u.push(["aria-readonly","true"])):l&&h.push("aria-readonly"),!1===s.valid&&s.invalidCellClassName?(a.push(s.invalidCellClassName),l&&u.push(["aria-invalid","true"])):(c.push(s.invalidCellClassName),l&&h.push("aria-invalid")),!1===s.wordWrap&&s.noWordWrapClassName&&a.push(s.noWordWrapClassName),!i&&s.placeholder&&a.push(s.placeholderCellClassName),uw(t,c),hw(t,a),fw(t,h),dw(t,u)}Q_.RENDERER_TYPE="base";function J_(e,t,r,o,n,i,s){Q_.apply(this,[e,t,r,o,n,i,s]);let l=i;if(!l&&s.placeholder&&(l=s.placeholder),l=kp(l),s.trimWhitespace&&(l=l.trim()),s.rendererTemplate){mw(t);const o=e.rootDocument.createElement("TEMPLATE");o.setAttribute("bind","{{}}"),o.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(o),o.model=e.getSourceDataAtRow(r),t.appendChild(o)}else yw(t,l)}J_.RENDERER_TYPE="text";function eN(e,t){const r=new z_(e,t||{},NE);return r.init(),r}!function(e,t){"string"!=typeof e&&(e=(t=e).CELL_TYPE);const{editor:r,renderer:o,validator:n}=t;r&&Fv(e,r),o&&function(e,t){"string"!=typeof e&&(e=(t=e).RENDERER_TYPE),gC(e,t)}(e,o),n&&function(e,t){"string"!=typeof e&&(e=(t=e).VALIDATOR_TYPE),bC(e,t)}(e,n),Lx(e,t)}({CELL_TYPE:"text",editor:class extends b_{static get EDITOR_TYPE(){return"text"}constructor(e){super(e),q_(this,"eventManager",new Bv(this)),q_(this,"autoResize",G_(this.hot.rootDocument)),q_(this,"TEXTAREA",void 0),q_(this,"textareaStyle",void 0),q_(this,"TEXTAREA_PARENT",void 0),q_(this,"textareaParentStyle",void 0),q_(this,"layerClass",void 0),this.eventManager=new Bv(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",(()=>this.destroy()))}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),function(e,t){const r=e.closest(".handsontable");return!!r&&(r.parentNode===t||r===t)}(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,r,o,n,i){const s=this.state;if(super.prepare(e,t,r,o,n,i),!i.readOnly){this.refreshDimensions(!0);const{allowInvalid:e}=i;e&&!this.isOpened()&&(this.TEXTAREA.value=""),s===v_.FINISHED||this.isOpened()||this.hideEditableElement()}}beginEditing(e,t){this.state===v_.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),Aw(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),dw(this.TEXTAREA,[["data-hot-input",""],Kp(-1)]),hw(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),hw(this.TEXTAREA_PARENT,"handsontableInputHolder"),cw(this.TEXTAREA_PARENT,this.layerClass)&&uw(this.TEXTAREA_PARENT,this.layerClass),hw(this.TEXTAREA_PARENT,K_),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Ay.edge.value&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",uw(this.TEXTAREA_PARENT,this.layerClass),hw(this.TEXTAREA_PARENT,K_)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;eC(e.length-1,(r=>{if(cw(e[r],"handsontableEditor"))return t=!0,!1})),cw(this.TEXTAREA_PARENT,K_)&&uw(this.TEXTAREA_PARENT,K_),t?(this.layerClass="ht_editor_visible",hw(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),hw(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==v_.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD)return void(e||this.close());const{top:t,start:r,width:o,maxWidth:n,height:i,maxHeight:s}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(o,n),minHeight:Math.min(i,s),maxWidth:n,maxHeight:s},!0)}bindEvents(){Ly()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(()=>this.finishEditing(!1))),this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>{this.refreshDimensions(),this.state===v_.EDITING&&this.focus()})),this.addHook("afterRowResize",(()=>{this.refreshDimensions(),this.state===v_.EDITING&&this.focus()}))}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor"),t={runOnlyIf:()=>Dp(this.hot.getSelected()),group:Z_},r=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:e=>!this.hot.selection.isMultiple()&&!e.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(e,t)=>{let[r]=t;X_(r,this.TEXTAREA)}},{keys:[["End"]],callback:(e,t)=>{let[r]=t;X_(r,this.TEXTAREA)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Z_)}},renderer:J_}),eN.editors={BaseEditor:b_},eN.Core=function(e){return new z_(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},NE)},eN.DefaultSettings=$x(),eN.hooks=Mv.getSingleton(),eN.CellCoords=hS,eN.CellRange=wS,eN.packageName="handsontable",eN.buildDate="16/12/2024 13:19:38",eN.version="15.0.0",eN.languages={dictionaryKeys:TH,getLanguageDictionary:NH,getLanguagesDictionaries:function(){return xH()},registerLanguageDictionary:_H,getTranslatedPhrase:AH};var tN=null;function rN(){var e;"undefined"!=typeof console&&(e=console).warn.apply(e,arguments)}function oN(e){return nN(e,"hot-renderer")?(rN("Providing a component-based renderer using `hot-renderer`-annotated component is no longer supported. Pass your component using `renderer` prop of the `HotTable` or `HotColumn` component instead."),!0):!!nN(e,"hot-editor")&&(rN("Providing a component-based editor using `hot-editor`-annotated component is no longer supported. Pass your component using `editor` prop of the `HotTable` or `HotColumn` component instead."),!0)}function nN(e,t){return d.Children.toArray(e).some((function(e){return void 0!==e.props[t]}))}function iN(e,t){if(!e||!t)return null;var r=d.createElement(t,null),o=sN({},!1);return o.className="".concat("hot-wrapper-editor-container"," ").concat(o.className),f.createPortal(d.createElement("div",Object.assign({},o),r),e.body)}function sN(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{id:e.id||(t?"hot-"+Math.random().toString(36).substring(5):void 0),className:e.className||"",style:e.style||{}}}function lN(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=Array(t);r<t;r++)o[r]=e[r];return o}function aN(e,t,r){return t=dN(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,fN()?Reflect.construct(t,r||[],dN(e).constructor):t.apply(e,r))}function cN(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hN(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,wN(o.key),o)}}function uN(e,t,r){return t&&hN(e.prototype,t),r&&hN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dN(e){return(dN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fN(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(fN=function(){return!!e})()}function gN(e,t){return(gN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function mN(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var o,n,i,s,l=[],a=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t);else for(;!(a=(o=i.call(r)).done)&&(l.push(o.value),l.length!==t);a=!0);}catch(h){c=!0,n=h}finally{try{if(!a&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw n}}return l}}(e,t)||yN(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pN(e){return function(e){if(Array.isArray(e))return lN(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||yN(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wN(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function yN(e,t){if(e){if("string"==typeof e)return lN(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?lN(e,t):void 0}}var vN=function(){return uN((function e(){cN(this,e)}),null,[{key:"getSettings",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.prevProps,n=void 0===o?{}:o,i=r.isInit,s=void 0!==i&&i,l=r.initOnlySettingKeys,a=void 0===l?[]:l,c={};for(var h in e)"children"!==h&&(t=h,s||!a.includes(t)||n[t]!==e[t])&&e.hasOwnProperty(h)&&(c[h]=e[h]);return c}}])}(),bN=u.createContext(void 0),CN=function(e){var t=e.children,r=u.useRef([]),o=u.useCallback((function(e,t){r.current[t]=e}),[]),n=u.useRef(new Map),i=u.useRef(new Map),s=u.useCallback((function(){return i.current.clear()}),[]),l=u.useRef(new Map),a=u.useCallback((function(){return l.current.clear()}),[]),c=u.useRef(new Map),h=u.useCallback((function(e){return function(t,r,o,n,s,a,h){var u="".concat(o,"-").concat(n),g=t.guid,m="".concat(g,"-").concat(u),p="".concat(u,"-").concat(g);if(i.current.has(u)&&(r.innerHTML=i.current.get(u).innerHTML),r&&!r.getAttribute("ghost-table")){for(var w=l.current.get(p),y=c.current.get(m);r.firstChild;)r.removeChild(r.firstChild);if(w&&y)r.appendChild(y);else{var v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;t||(t=document),tN||(tN=t.createDocumentFragment());var n=null!=o?o:t.createElement("DIV");return tN.appendChild(n),{portal:f.createPortal(e,n,r),portalContainer:n}}(d.createElement(e,{instance:t,TD:r,row:o,col:n,prop:s,value:a,cellProperties:h}),r.ownerDocument,p,y),b=v.portal,C=v.portalContainer;c.current.set(m,C),r.appendChild(C),l.current.set(p,b)}}return i.current.set("".concat(o,"-").concat(n),r),r}}),[]),g=u.useRef((function(){})),m=u.useCallback((function(e){g.current=e}),[]),p=u.useCallback((function(){g.current(pN(l.current.values()))}),[]),w=u.useMemo((function(){return{componentRendererColumns:n.current,columnsSettings:r.current,emitColumnSettings:o,getRendererWrapper:h,clearPortalCache:a,clearRenderedCellCache:s,setRenderersPortalManagerRef:m,pushCellPortalsIntoPortalManager:p}}),[o,h,s,m,p]);return d.createElement(bN.Provider,{value:w},t)};function SN(){return u.useContext(bN)}var RN=u.createContext(void 0),TN=function(e){var t=e.columnIndex,r=e.getOwnerDocument,o=e.children,n=u.useMemo((function(){return{columnIndex:t,getOwnerDocument:r}}),[t,r]);return d.createElement(RN.Provider,{value:n},o)},EN=["close","focus","open"],ON=["getValue","setValue"],MN={open:"onOpen",close:"onClose",prepare:"onPrepare",focus:"onFocus"};function HN(e,t){return function(){function r(o){var n;return cN(this,r),n=aN(this,r,[o]),t.current=n,Object.getOwnPropertyNames(eN.editors.BaseEditor.prototype).forEach((function(t){if("constructor"!==t&&!ON.includes(t)){var o=eN.editors.BaseEditor.prototype[t];r.prototype[t]=function(){for(var r,n,i,s=arguments.length,l=new Array(s),a=0;a<s;a++)l[a]=arguments[a];(EN.includes(t)||(n=o.call.apply(o,[this].concat(l))),MN[t]&&null!==(r=e.current)&&void 0!==r&&r[MN[t]])&&(n=(i=e.current[MN[t]]).call.apply(i,[this].concat(l)));return n}.bind(n)}})),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gN(e,t)}(r,eN.editors.BaseEditor),uN(r,[{key:"focus",value:function(){}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(e){this.value=e}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}()}var xN=u.createContext(void 0),_N=function(e){var t=e.hooksRef,r=e.hotCustomEditorInstanceRef,o=e.children;return d.createElement(xN.Provider,{value:{hooksRef:t,hotCustomEditorInstanceRef:r}},o)},NN=function(e){return e.type===AN},IN=["_columnIndex","_getOwnerDocument","children"],AN=function(e){var t=SN(),r=t.componentRendererColumns,o=t.emitColumnSettings,n=t.getRendererWrapper,i=u.useContext(RN),s=i.columnIndex,l=i.getOwnerDocument,a=u.useRef(null),c=u.useRef(null);u.useEffect((function(){var t,i,l=(t=vN.getSettings(Object.keys(e).filter((function(e){return!IN.includes(e)})).reduce((function(t,r){return t[r]=e[r],t}),{})),e.renderer?(t.renderer=n(e.renderer),r.set(s,!0)):e.hotRenderer&&(t.renderer=e.hotRenderer),e.editor?t.editor=HN(a,c):e.hotEditor&&(t.editor=e.hotEditor),t);o(l,s),oN(e.children)||(i=e.children,d.Children.toArray(i).length&&rN("Unexpected children nodes found in HotColumn component. HotColumn components do not support any children."))}));var h=iN(l(),e.editor);return d.createElement(_N,{hooksRef:a,hotCustomEditorInstanceRef:c},h)},kN=u.forwardRef((function(e,t){var r=mN(u.useState([]),2),o=r[0],n=r[1];return u.useImperativeHandle(t,(function(){return n})),d.createElement(u.Fragment,null,o)}));function DN(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var PN,LN,VN,FN,WN={exports:{}};WN.exports=function(){if(FN)return VN;FN=1;var e=LN?PN:(LN=1,PN="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");function t(){}function r(){}return r.resetWarningCache=t,VN=function(){function o(t,r,o,n,i,s){if(s!==e){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function n(){return o}o.isRequired=o;var i={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:n,element:o,elementType:o,instanceOf:n,node:o,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:r,resetWarningCache:t};return i.PropTypes=i,i}}()();var BN=DN(WN.exports),jN=u.forwardRef((function(e,t){var r,o,n,i=u.useRef(null),s=u.useRef(null),l=u.useRef(null),a=u.useRef(null),c=u.useRef(),h=SN(),f=u.useCallback((function(){return i.current&&i.current.isDestroyed?null:i.current}),[i]),g=u.useCallback((function(){return!i.current||i.current.isDestroyed}),[i]),m=u.useCallback((function(){h.clearRenderedCellCache(),h.componentRendererColumns.clear()}),[h]),p=u.useCallback((function(){return"undefined"!=typeof window?s.current?s.current.ownerDocument:document:null}),[s]),w=function(){var t,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=g()?[]:(null===(t=f())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t._initOnlySettings)||[],i=vN.getSettings(e,{prevProps:o,isInit:r,initOnlySettingKeys:n});return i.columns=h.columnsSettings.length?h.columnsSettings:i.columns,e.renderer?(i.renderer=h.getRendererWrapper(e.renderer),h.componentRendererColumns.set("global",!0)):i.renderer=e.hotRenderer||vC("text"),e.editor?i.editor=HN(l,a):i.editor=e.hotEditor||Vv("text"),i},y=function(e){var t,r;e&&(null!==(t=e.getPlugin("autoRowSize"))&&void 0!==t&&t.enabled||null!==(r=e.getPlugin("autoColumnSize"))&&void 0!==r&&r.enabled)&&h.componentRendererColumns.size>0&&rN("Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.")};u.useEffect((function(){var t,r,o=w(!0);return c.current=e,i.current=new eN.Core(s.current,o),i.current.addHook("beforeViewRender",(function(){h.clearPortalCache(),h.clearRenderedCellCache()})),i.current.addHook("afterViewRender",(function(){h.pushCellPortalsIntoPortalManager()})),i.current.init(),y(i.current),oN(e.children)||(t=e.children,r=AN,d.Children.toArray(t).some((function(e){return e.type!==r}))&&rN("Unexpected children nodes found in HotTable component. Only HotColumn components are allowed.")),function(){var e;m(),null===(e=f())||void 0===e||e.destroy()}}),[]),r=function(){m();var t=f(),r=w(!1,c.current);c.current=e,null==t||t.updateSettings(r,!1),y(t),oN(e.children)},n=d.useRef(!1),u.useEffect((function(){if(n.current)return r();n.current=!0}),o),u.useImperativeHandle(t,(function(){return{get hotElementRef(){return s.current},get hotInstance(){return f()}}}));var v=u.Children.toArray(e.children).filter(NN).map((function(e,t){return d.createElement(TN,{columnIndex:t,getOwnerDocument:p,key:t},e)})),b=sN(e),C=iN(p(),e.editor);return d.createElement(u.Fragment,null,d.createElement("div",Object.assign({ref:s},b),v),d.createElement(kN,{ref:h.setRenderersPortalManagerRef}),d.createElement(_N,{hooksRef:l,hotCustomEditorInstanceRef:a},C))}));jN.propTypes={style:BN.object,id:BN.string,className:BN.string};var zN=["children"],UN=u.forwardRef((function(e,t){var r,o=e.children,n=function(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.includes(o))continue;r[o]=e[o]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,zN),i=null!==(r=n.id)&&void 0!==r?r:u.useId();return d.createElement(CN,null,d.createElement(jN,Object.assign({id:i},n,{ref:t}),o))}));UN.version="15.0.0";const YN="_handsontable-page_fvviw_1",$N="_handsontable-tools_fvviw_7",GN="_handsontable-body_fvviw_13",XN=()=>{},qN=()=>g.jsx(m,{children:g.jsxs("div",{className:YN,children:[g.jsx("div",{className:$N,children:g.jsx(p,{align:"middle",gutter:8,children:g.jsx(w,{children:g.jsx(y,{onClick:XN,children:"å¯¼å¥Excel"})})})}),g.jsx("div",{className:GN,children:g.jsx(UN,{data:[["","Tesla","Volvo","Toyota","Ford"],["2019",10,11,12,13],["2020",20,11,14,13],["2021",30,15,12,13]],rowHeaders:!0,colHeaders:!0,height:"auto",autoWrapRow:!0,autoWrapCol:!0,licenseKey:"non-commercial-and-evaluation"})})]})});export{qN as default};
