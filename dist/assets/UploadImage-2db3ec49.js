import{j as e,B as t,O as n}from"./index-2823d128.js";import{U as o}from"./index-5c1414bf.js";function r(e){const t=e.split(","),n=t[0].match(/:(.*?);/)[1],o=window.atob(t[1]);let r=o.length;const i=new Uint8Array(r);for(;r--;)i[r]=o.charCodeAt(r);return new Blob([i],{type:n})}function i(e,t){return new Promise(((n,o)=>{let r=document.createElement("CANVAS");const i=r.getContext("2d"),a=new Image;a.crossOrigin="",a.onload=function(){if(!r||!i)return o();r.width=a.width,r.height=a.height,i.drawImage(a,0,0);const e=r.toDataURL(t||"image/png");r=null,n(e)},a.src=e}))}function a(e){return new Promise(((t,n)=>{const o=new Image;o.onload=function(){t({width:o.width,height:o.height})},o.onerror=function(){n()},o.src=e}))}function s(e,t){return new Promise(((n,o)=>{const{width:r,height:i,quality:a,mimeType:s}=t;let c=document.createElement("CANVAS");const g=c.getContext("2d"),l=new Image;l.crossOrigin="",l.onload=function(){if(!c||!g)return o();c.width=r,c.height=i,g.drawImage(l,0,0,r,i);const e=c.toDataURL(s||"image/png",a);c=null,n(e)},l.src=e}))}function c(e,t,n,o){let[r,i,a]=[0,0,0];if(e>t)if(e>=n){const s=t*(n/e);s>=n?(r=e*(o/t),i=o,a=t/o):(r=n,i=s,a=e/n)}else r=e,i=t,a=1;else t>=o?(r=e*(o/t),i=o,a=t/o):(r=e,i=t,a=1);return{width:r,height:i,ratio:a}}const g=({name:r="上传图片",isFull:i,onSuccess:a})=>{const s=e=>{const t=new FileReader;t.onload=e=>{const t=e.target&&e.target.result,n="object"==typeof t?window.URL.createObjectURL(new Blob([t])):t;a(n)},t.readAsDataURL(e),t.onerror=()=>{n.error("图片读取出错!")}};return e.jsx(o,{action:"",accept:".jpg, .jpeg, .gif, .png, .bmp",multiple:!1,showUploadList:!1,beforeUpload:()=>!1,onChange:e=>{const{file:t}=e;if(!/\.(jpg|png|bmp|jpeg|webp)$/.test(t.name))return void n.warning("图片只支持.jpg, .png, .bmp, .jpeg, .webp格式!");t.size/1024/1024<5?s(t):n.warning("上传的图片大小不能超过5M!")},children:e.jsx(t,{type:"primary",style:{width:i?"100%":"auto"},children:r})})};export{g as U,c as a,r as b,s as c,a as g,i as u};
